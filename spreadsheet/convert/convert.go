//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_c "github.com/unidoc/unioffice/v2/common/logger";_fb "github.com/unidoc/unioffice/v2/common/tempstorage";_df "github.com/unidoc/unioffice/v2/internal/convertutils";_fe "github.com/unidoc/unioffice/v2/measurement";_da "github.com/unidoc/unioffice/v2/schema/soo/dml";
_ef "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_be "github.com/unidoc/unioffice/v2/schema/soo/ofc/sharedTypes";_ee "github.com/unidoc/unioffice/v2/schema/soo/sml";_e "github.com/unidoc/unioffice/v2/spreadsheet";_ff "github.com/unidoc/unioffice/v2/spreadsheet/formula";
_d "github.com/unidoc/unioffice/v2/spreadsheet/reference";_ac "github.com/unidoc/unipdf/v4/creator";_bc "github.com/unidoc/unipdf/v4/model";_b "image";_g "math";_f "sort";_gf "strconv";);func (_fcdb *convertContext )addRowToPage (_gfec []*cell ,_gebg int ){_cab :=0.0;
_ceg :=_fcdb ._afda ;for _ ,_gfbe :=range _gfec {if len (_gfbe ._cfdg )!=0{_gfbe ._eadf =_cab ;_cab =_gfbe ._aacff +_gfbe ._ecca ;};};for _ffcg :=len (_gfec )-1;_ffcg >=0;_ffcg --{_bga :=_gfec [_ffcg ];if len (_bga ._cfdg )!=0{_bga ._efbf =_ceg ;_ceg =_bga ._aacff ;
};};_fcdb ._geba ._gbbg =append (_fcdb ._geba ._gbbg ,&pageRow {_fafg :_gebg ,_eggf :_gfec });};var _bcbe =map[uint32 ]_ac .PageSize {1:_ac .PageSize {8.5*_fe .Inch ,11*_fe .Inch },2:_ac .PageSize {8.5*_fe .Inch ,11*_fe .Inch },3:_ac .PageSize {11*_fe .Inch ,17*_fe .Inch },4:_ac .PageSize {17*_fe .Inch ,11*_fe .Inch },5:_ac .PageSize {8.5*_fe .Inch ,14*_fe .Inch },6:_ac .PageSize {5.5*_fe .Inch ,8.5*_fe .Inch },7:_ac .PageSize {7.5*_fe .Inch ,10*_fe .Inch },8:_ac .PageSize {_cdbf (297),_cdbf (420)},9:_ac .PageSize {_cdbf (210),_cdbf (297)},10:_ac .PageSize {_cdbf (210),_cdbf (297)},11:_ac .PageSize {_cdbf (148),_cdbf (210)},70:_ac .PageSize {_cdbf (105),_cdbf (148)},12:_ac .PageSize {_cdbf (250),_cdbf (354)},13:_ac .PageSize {_cdbf (182),_cdbf (257)},14:_ac .PageSize {8.5*_fe .Inch ,13*_fe .Inch },20:_ac .PageSize {4.125*_fe .Inch ,9.5*_fe .Inch },27:_ac .PageSize {_cdbf (110),_cdbf (220)},28:_ac .PageSize {_cdbf (162),_cdbf (229)},34:_ac .PageSize {_cdbf (250),_cdbf (176)},29:_ac .PageSize {_cdbf (324),_cdbf (458)},30:_ac .PageSize {_cdbf (229),_cdbf (324)},31:_ac .PageSize {_cdbf (114),_cdbf (162)},37:_ac .PageSize {3.88*_fe .Inch ,7.5*_fe .Inch },43:_ac .PageSize {_cdbf (100),_cdbf (148)},69:_ac .PageSize {_cdbf (200),_cdbf (148)}};
func _cdbf (_acbe float64 )float64 {return _acbe *_fe .Millimeter };type pagespan struct{_fcbd float64 ;_gggc []*page ;_ged int ;_dgdga int ;};func (_ebgc *convertContext )getContentFromCell (_beb *_e .Sheet ,_fge _e .Cell ,_bbbd *style ,_gbaa float64 ,_cfag ,_acfd bool )([]*line ,_ee .ST_CellType ){if _acfd {return []*line {},_ee .ST_CellTypeS ;
};_aag :=_fge .X ();var _dfbc []*symbol ;switch _aag .TAttr {case _ee .ST_CellTypeS :_aad :=_aag .V ;if _aad !=nil {_ccac ,_faa :=_gf .Atoi (*_aad );if _faa ==nil {_dac :=_ebgc ._ecd .SharedStrings .X ().Si [_ccac ];if _dac .T !=nil {_dfbc =_ebgc .getSymbolsFromString (*_dac .T ,_bbbd );
}else if _dac .R !=nil {_dfbc =_ebgc .getSymbolsFromR (_dac .R ,_bbbd );};};};case _ee .ST_CellTypeB :_gfea :=_aag .V ;if _gfea !=nil {if *_gfea =="\u0030"{_dfbc =_ebgc .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_bbbd );}else {_dfbc =_ebgc .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_bbbd );
};};case _ee .ST_CellTypeStr :if _aag .F !=nil {_ffd :=_ff .NewEvaluator ();_ggda :=_beb .FormulaContext ().Cell (_fge .Reference (),_ffd );_dfbc =_ebgc .getSymbolsFromString (_ggda .Value (),_bbbd );};default:_dfbc =_ebgc .getSymbolsFromString (_fge .GetFormattedValue (),_bbbd );
};_ffgc :=0.0;_agee :=0.0;var _ecgg []*line ;var _afec bool ;if _bbbd !=nil {if _bbbd ._ecc !=nil {if *_bbbd ._ecc {_afec =true ;};};if _bbbd ._egdb !=nil {if *_bbbd ._egdb {_afec =true ;};};};if _cfag {_ecgg =[]*line {};_gegbg :=_gbaa -2*_beg ;_ead :=[]*symbol {};
for _ ,_agg :=range _dfbc {_ebb (_agg );if _ffgc +_agg ._aaa >=_gegbg {_eeb :=_bdgc (_ead );if _afec {_eeb /=_eb ;};_ecgg =append (_ecgg ,&line {_efaf :_agee ,_faac :_ead ,_ebda :_eeb });_ead =[]*symbol {_agg };_ffgc =_agg ._aaa ;_agee +=_eeb ;}else {_agg ._dcab =_ffgc ;
_ffgc +=_agg ._aaa ;_ead =append (_ead ,_agg );};};_defab :=_bdgc (_ead );if _afec {_defab /=_eb ;};if len (_ead )> 0{_ecgg =append (_ecgg ,&line {_efaf :_agee ,_faac :_ead ,_ebda :_defab });};}else {for _ ,_cddd :=range _dfbc {_ebb (_cddd );_cddd ._dcab =_ffgc ;
_ffgc +=_cddd ._aaa ;};if len (_dfbc )> 0{_ecgg =[]*line {&line {_faac :_dfbc ,_ebda :_bdgc (_dfbc )}};};};_feff :=_aag .TAttr ;if _feff ==_ee .ST_CellTypeUnset {_feff =_ee .ST_CellTypeN ;};return _ecgg ,_feff ;};var _gc =_cdbf (0.0625);func (_ccad *convertContext )getStyle (_agbd *uint32 )*style {_ggeg :=&style {};
_bdf :=false ;if _agbd !=nil {_bead :=_ccad ._agff .GetCellStyle (*_agbd );if _ccad ._agff .GetNumberFormat (_bead .NumberFormat ()).GetFormat ()=="\u003b\u003b\u003b"{_ggeg ._ggdf =true ;};_fcgc :=_bead .GetFill ();if _fcgc !=nil &&_fcgc .FillChoice !=nil &&_fcgc .FillChoice .PatternFill !=nil {if _fcgc .FillChoice .PatternFill .FgColor !=nil {_ggeg ._eaedg =_ccad .getColorStringFromSmlColor (_fcgc .FillChoice .PatternFill .FgColor );
}else if _fcgc .FillChoice .PatternFill .BgColor !=nil {_ggeg ._eaedg =_ccad .getColorStringFromSmlColor (_fcgc .FillChoice .PatternFill .BgColor );};};_gfdb :=_bead .GetFont ();for _ ,_adfb :=range _gfdb .FontChoice {if _adfb .Name !=nil {_ggeg ._dgcg =&_adfb .Name .ValAttr ;
_bdf =true ;}else if _adfb .B !=nil {_aebd :=_adfb .B .ValAttr ==nil ||*_adfb .B .ValAttr ;_ggeg ._geca =&_aebd ;_bdf =true ;}else if _adfb .I !=nil {_dbae :=_adfb .I .ValAttr ==nil ||*_adfb .I .ValAttr ;_ggeg ._efba =&_dbae ;_bdf =true ;}else if _adfb .U !=nil {_gabf :=_adfb .U .ValAttr ==_ee .ST_UnderlineValuesSingle ||_adfb .U .ValAttr ==_ee .ST_UnderlineValuesUnset ;
_ggeg ._addd =&_gabf ;_bdf =true ;}else if _adfb .Sz !=nil {_acef :=_adfb .Sz .ValAttr ;_ggeg ._dfge =&_acef ;_bdf =true ;}else if _adfb .VertAlign !=nil {_bafe :=_adfb .VertAlign .ValAttr ==_be .ST_VerticalAlignRunSuperscript ;_ggeg ._ecc =&_bafe ;_ggc :=_adfb .VertAlign .ValAttr ==_be .ST_VerticalAlignRunSubscript ;
_ggeg ._egdb =&_ggc ;_bdf =true ;}else if _adfb .Color !=nil {_ggeg ._faaa =_ccad .getColorStringFromSmlColor (_adfb .Color );_bdf =true ;};};_dafc :=_bead .GetBorder ();if _dafc !=nil {if _dafc .Top !=nil {_ggeg ._aafa =_ccad .getBorder (_dafc .Top );
_bdf =true ;};if _dafc .Bottom !=nil {_ggeg ._aec =_ccad .getBorder (_dafc .Bottom );_bdf =true ;};if _dafc .Left !=nil {_ggeg ._fdb =_ccad .getBorder (_dafc .Left );_bdf =true ;};if _dafc .Right !=nil {_ggeg ._fggdf =_ccad .getBorder (_dafc .Right );_bdf =true ;
};};if _bead .Wrapped (){_ggeg ._eccg =true ;_bdf =true ;};if _edab :=_bead .GetVerticalAlignment ();_edab !=_ee .ST_VerticalAlignmentUnset {_ggeg ._egg =_edab ;_bdf =true ;};if _bacd :=_bead .GetHorizontalAlignment ();_bacd !=_ee .ST_HorizontalAlignmentUnset {_ggeg ._fgbb =_bacd ;
_bdf =true ;};};if _bdf {return _ggeg ;};return nil ;};func (_eca *convertContext )makeMergedCells (){_cbd :=[]*mergedCell {};for _ ,_agb :=range _eca ._ebbc .MergedCells (){_cbe ,_edd ,_afdc :=_d .ParseRangeReference (_agb .Reference ());if _afdc !=nil {_c .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_afdc );
continue ;};_fgcb :=mergedCell {_beeb :_cbe .RowIdx ,_gca :_cbe .ColumnIdx ,_cega :_edd .RowIdx ,_dea :_edd .ColumnIdx };for _bdb :=_fgcb ._gca -1;_bdb < _fgcb ._dea ;_bdb ++{_fgcb ._bggbg +=_eca ._bbc [_bdb ]._fcfe ;};for _gea :=_fgcb ._beeb -1;_gea < _fgcb ._cega ;
_gea ++{_fgcb ._aca +=_eca ._caea [_gea ]._gebge ;};_cbd =append (_cbd ,&_fgcb );};_eca ._bcad =_cbd ;};func (_gbfa *convertContext )drawPage (_cbb *page ){_bee :=_gbfa ._gda ;_aga :=_gbfa ._eecg ;for _ ,_baae :=range _cbb ._gbbg {_ggg :=_gbfa ._caea [_baae ._fafg ];
for _ ,_agag :=range _baae ._eggf {var _befgf float64 ;if _baae ._fafg > 1{_befgf =_gbfa ._caea [_baae ._fafg -1]._gdgf ;};var _aae ,_fgd float64 ;if _acbd :=_agag ._dfbe ;_acbd !=nil {_aae =_acbd ._afba ;};if _gba :=_agag ._bgea ;_gba !=nil {_fgd =_gba ._afba ;
};_bfaa :=_bee +_ggg ._fdaa -0.5*(_befgf -_aae );_cdd :=_bee +_ggg ._fdaa +_ggg ._gebge +0.5*(_ggg ._gdgf +_fgd );_dbf :=_aga +_agag ._aacff ;_fec :=_dbf +_agag ._cdg ;if _agag ._gcef !=nil &&_agag ._gcef !=_ac .ColorBlack {_df .FillRectangle (_gbfa ._adda ,_dbf ,_bfaa ,_fec -_dbf ,_cdd -_bfaa ,_agag ._gcef );
};};};for _ ,_gead :=range _cbb ._gbbg {_dba :=_gbfa ._caea [_gead ._fafg ];for _ ,_gdf :=range _gead ._eggf {_fdgd :=_gdf ._eadf < _gdf ._aacff ;_ddfc :=_gdf ._efbf > _gdf ._aacff +_gdf ._ecca ;var _acfg ,_adfc bool ;for _ ,_edg :=range _gdf ._cfdg {for _ ,_cca :=range _edg ._faac {if _fdgd &&!_acfg {_acfg =_cca ._dcab < 0;
};if _ddfc &&!_adfc {_adfc =_gdf ._ecca < _cca ._dcab +_cca ._aaa ;};if _gdf ._aacff +_cca ._dcab >=_gdf ._eadf &&_gdf ._aacff +_cca ._dcab +_cca ._aaa <=_gdf ._efbf {_bcca :=_gbfa ._adda .NewStyledParagraph ();_fdc :=_aga +_gdf ._aacff +_cca ._dcab ;_gcgb :=_bee +_dba ._fdaa +_edg ._efaf -_cca ._gbaad -_cdbf (0.5);
_bcca .SetPos (_fdc ,_gcgb );var _dbde *_ac .TextChunk ;if _cca ._dbgf !=""{_dbde =_bcca .AddExternalLink (_cca ._badd ,_cca ._dbgf );}else {_dbde =_bcca .Append (_cca ._badd );};if _cca ._acd !=nil {_dbde .Style =*_cca ._acd ;};_gbfa ._adda .Draw (_bcca );
};};};var _gegb ,_bedg ,_eaeg ,_bgg ,_deef ,_ffc float64 ;var _fgcbg ,_cedc ,_ebabe ,_gbbe _ac .Color ;if _fcfb :=_gdf ._dfbe ;_fcfb !=nil {_gegb =_fcfb ._afba ;_fgcbg =_fcfb ._cbc ;};if _agd :=_gdf ._bgea ;_agd !=nil {_bedg =_agd ._afba ;_cedc =_agd ._cbc ;
};if _ggbb :=_gdf ._bebd ;_ggbb !=nil {_eaeg =_ggbb ._afba ;_deef =_eaeg /2;_ebabe =_ggbb ._cbc ;};if _dffb :=_gdf ._gbbb ;_dffb !=nil {_bgg =_dffb ._afba ;_ffc =_bgg /2;_gbbe =_dffb ._cbc ;};var _beff float64 ;if _gead ._fafg > 1{_beff =_gbfa ._caea [_gead ._fafg -1]._gdgf ;
};_edc :=_bee +_dba ._fdaa -0.5*(_beff -_gegb );_ffce :=_bee +_dba ._fdaa +_dba ._gebge +0.5*(_dba ._gdgf +_bedg );_eafa :=_aga +_gdf ._aacff ;_gege :=_eafa +_gdf ._cdg ;_df .DrawLine (_gbfa ._adda ,_eafa ,_edc ,_gege ,_edc ,_gegb ,_fgcbg );_df .DrawLine (_gbfa ._adda ,_eafa ,_ffce ,_gege ,_ffce ,_bedg ,_cedc );
if !_acfg {_df .DrawLine (_gbfa ._adda ,_eafa -_deef ,_edc ,_eafa -_deef ,_ffce ,_eaeg ,_ebabe );};if !_adfc {_df .DrawLine (_gbfa ._adda ,_gege -_ffc ,_edc ,_gege -_ffc ,_ffce ,_bgg ,_gbbe );};};};for _ ,_fcbb :=range _cbb ._efbg {if _fcbb !=nil {_gbfa ._adda .Draw (_fcbb );
};};};func (_bfbe *convertContext )makeTextStyleFromCellStyle (_bdbe *style )*_ac .TextStyle {_efcc :=_bfbe ._adda .NewTextStyle ();if _bdbe ==nil {_efcc .FontSize =_df .DefaultFontSize ;_efcc .Font =_df .AssignStdFontByName (_efcc ,_df .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);
return &_efcc ;};if _gbfc (_bdbe ._addd ){_efcc .Underline =true ;_efcc .UnderlineStyle =_ac .TextDecorationLineStyle {Offset :0.5,Thickness :_cdbf (1/32)};};var _eeba FontStyle ;if _gbfc (_bdbe ._geca )&&_gbfc (_bdbe ._efba ){_eeba =FontStyle_BoldItalic ;
}else if _gbfc (_bdbe ._geca ){_eeba =FontStyle_Bold ;}else if _gbfc (_bdbe ._efba ){_eeba =FontStyle_Italic ;}else {_eeba =FontStyle_Regular ;};_edf :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _bdbe ._dgcg !=nil {_edf =*_bdbe ._dgcg ;};if _gaab ,_bbfe :=_df .StdFontsMap [_edf ];
_bbfe {_efcc .Font =_df .AssignStdFontByName (_efcc ,_gaab [_eeba ]);}else if _gaaf :=_df .GetRegisteredFont (_edf ,_eeba );_gaaf !=nil {_efcc .Font =_gaaf ;}else {_c .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_edf ,_eeba );
_efcc .Font =_df .AssignStdFontByName (_efcc ,_df .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_eeba ]);};if _bdbe ._dfge !=nil {_efcc .FontSize =_g .Round (*_bdbe ._dfge *_bfbe ._ddcd );};if _bdbe ._faaa !=nil {_efcc .Color =_ac .ColorRGBFromHex (*_bdbe ._faaa );
};if _bdbe ._ecc !=nil &&*_bdbe ._ecc {_efcc .FontSize *=_eb ;}else if _bdbe ._egdb !=nil &&*_bdbe ._egdb {_efcc .FontSize *=_eb ;};return &_efcc ;};func (_gce *convertContext )makeCols (){_ccc :=_gce ._ebbc ;_cb :=_ccc .X ();_eceg :=[]*colInfo {};_def :=[]colWidthRange {};
if _cfe :=_cb .Cols ;len (_cfe )> 0{for _ ,_ga :=range _cfe [0].Col {_faf :=_fa ;if _ca :=_ga .WidthAttr ;_ca !=nil {if *_ca > 0.83{*_ca -=0.83;};if *_ca <=1{_faf =*_ca *11;}else {_faf =5+*_ca *6;};};_egd :=int (_ga .MinAttr -1);_bef :=int (_ga .MaxAttr -1);
_def =append (_def ,colWidthRange {_ecbae :_egd ,_dfff :_bef ,_defe :_faf ,_fgfc :_gce .getStyle (_ga .StyleAttr )});};};_fcf :=0;for _cce :=0;_cce <=_gce ._aacf ;_cce ++{if _cce < _gce ._acec ||(_cce > _gce ._eaa &&_gce ._eaa > 0){continue ;};var _ad float64 ;
var _fae *style ;if len (_def )==0{_ad =_fa ;}else if _fcf < len (_def ){_fbc :=_def [_fcf ];if _cce >=_fbc ._ecbae &&_cce <=_fbc ._dfff {_ad =_fbc ._defe ;_fae =_fbc ._fgfc ;if _cce ==_fbc ._dfff {_fcf ++;};}else {continue ;};};_eceg =append (_eceg ,&colInfo {_fcfe :_ad ,_cagg :_fae });
};_acf :=0.0;for _ ,_dfb :=range _eceg {_acf +=_dfb ._fcfe ;};_gce ._ddcd =1.0;if _acf > _gce ._afda {_gce ._ddcd =_gce ._afda /_acf ;for _ ,_fac :=range _eceg {_fac ._fcfe *=_gce ._ddcd ;};};_gce ._bbc =_eceg ;};func (_abg *convertContext )makeRows (){_ggb :=[]*rowInfo {};
_bfb :=_abg ._ebbc .Rows ();_fce :=0;_afde :=0.0;for _adc ,_ebc :=range _bfb {if _adc < _abg ._gfafg ||(_adc > _abg ._bac &&_abg ._bac > 0){continue ;};_fce ++;_ege :=int (_ebc .RowNumber ());if _ege > _fce {for _cba :=_fce ;_cba < _ege ;_cba ++{_ggb =append (_ggb ,&rowInfo {_gebge :_bb /_efe });
_afde +=_bb /_efe ;};_fce =_ege ;};var _cag float64 ;if _ebc .X ().HtAttr ==nil {_cag =_bb ;}else {_cag =*_ebc .X ().HtAttr ;};_ggb =append (_ggb ,&rowInfo {_gebge :_cag /_efe ,_ddab :true ,_gffe :_abg .getStyle (_ebc .X ().SAttr )});_afde +=_cag /_efe ;
};for _dcb :=len (_ggb );_dcb < _abg ._abed ;_dcb ++{_ggb =append (_ggb ,&rowInfo {_gebge :_bb /_efe });_afde +=_bb /_efe ;};if _abg ._ccf ||_afde >=_abg ._adcb {_ea :=_abg ._ddcd ;if _abg ._adcb /_afde < _abg ._ddcd {_ea =_abg ._adcb /_afde ;};for _ ,_gab :=range _ggb {_gab ._gebge *=_ea ;
};};_abg ._caea =_ggb ;};const _eb =0.64;type mergedCell struct{_beeb uint32 ;_gca uint32 ;_cega uint32 ;_dea uint32 ;_bggbg float64 ;_aca float64 ;};func (_gbfg *convertContext )combineCellStyleWithRPrElt (_edgg *style ,_edgc *_ee .CT_RPrElt )*style {_aegg :=*_edgg ;
_ggeb :=_gbfg .getStyleFromRPrElt (_edgc );if _ggeb ==nil {return &_aegg ;};if _ggeb ._faaa !=nil {_aegg ._faaa =_ggeb ._faaa ;};if _ggeb ._dfge !=nil {_aegg ._dfge =_ggeb ._dfge ;};if _ggeb ._dgcg !=nil {_aegg ._dgcg =_ggeb ._dgcg ;};if _ggeb ._geca !=nil {_aegg ._geca =_ggeb ._geca ;
};if _ggeb ._efba !=nil {_aegg ._efba =_ggeb ._efba ;};if _ggeb ._addd !=nil {_aegg ._addd =_ggeb ._addd ;};if _ggeb ._ecc !=nil {_aegg ._ecc =_ggeb ._ecc ;};if _ggeb ._egdb !=nil {_aegg ._egdb =_ggeb ._egdb ;};return &_aegg ;};func _ceba (_dbca ,_bafg *style ){if _bafg ==nil {return ;
};if _dbca ==nil {_dbca =_bafg ;return ;};if _dbca ._eaedg ==nil {_dbca ._eaedg =_bafg ._eaedg ;};if _dbca ._dgcg ==nil {_dbca ._dgcg =_bafg ._dgcg ;};if _dbca ._faaa ==nil {_dbca ._faaa =_bafg ._faaa ;};if _dbca ._dfge ==nil {_dbca ._dfge =_bafg ._dfge ;
};if _dbca ._geca ==nil {_dbca ._geca =_bafg ._geca ;};if _dbca ._efba ==nil {_dbca ._efba =_bafg ._efba ;};if _dbca ._addd ==nil {_dbca ._addd =_bafg ._addd ;};if _dbca ._ecc ==nil {_dbca ._ecc =_bafg ._ecc ;};if _dbca ._egdb ==nil {_dbca ._egdb =_bafg ._egdb ;
};if _dbca ._aafa ==nil {_dbca ._aafa =_bafg ._aafa ;};if _dbca ._aec ==nil {_dbca ._aec =_bafg ._aec ;};if _dbca ._fdb ==nil {_dbca ._fdb =_bafg ._fdb ;};if _dbca ._fggdf ==nil {_dbca ._fggdf =_bafg ._fggdf ;};if _dbca ._egg ==_ee .ST_VerticalAlignmentUnset {_dbca ._egg =_bafg ._egg ;
};if _dbca ._fgbb ==_ee .ST_HorizontalAlignmentUnset {_dbca ._fgbb =_bafg ._fgbb ;};};func (_daf *convertContext )getSymbolsFromR (_gffg []*_ee .CT_RElt ,_dgdg *style )[]*symbol {_fgb :=[]*symbol {};for _ ,_beaf :=range _gffg {_fccd :=_daf .combineCellStyleWithRPrElt (_dgdg ,_beaf .RPr );
for _ ,_dga :=range _beaf .T {_fgb =append (_fgb ,&symbol {_badd :string (_dga ),_acd :_daf .makeTextStyleFromCellStyle (_fccd )});};};return _fgb ;};func _bdgc (_afcd []*symbol )float64 {_dfcc :=0.0;for _ ,_gef :=range _afcd {if _gef ._gbaad > _dfcc {_dfcc =_gef ._gbaad ;
};};return _dfcc ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_e .Sheet )*_ac .Creator {return ConvertToPdfWithOptions (s ,nil )};func (_fbe *convertContext )getStyleFromCell (_ddg _e .Cell ,_ecgd ,_defac ,_fdab *style )*style {if _fdab !=nil {_ceba (_fdab ,_ecgd );_ceba (_fdab ,_defac );return _fdab ;
};_fefb :=_ddg .X ();_acfga :=_fbe .getStyle (_fefb .SAttr );_ceba (_acfga ,_ecgd );_ceba (_acfga ,_defac );return _acfga ;};type rowspan struct{_deg float64 ;_fda int ;_cegb int ;};const _beg =3;const _bg =2;func (_bff *convertContext )drawSheet (){for _bcc ,_baa :=range _bff ._ddce {_abe :=len (_baa ._gggc );
if _bcc ==len (_bff ._ddce )-1{for _agfg :=len (_baa ._gggc )-1;_agfg >=0;_agfg --{if !_baa ._gggc [_agfg ]._ecba {_abe =_agfg ;};};};_dddf :=_baa ._gggc [:_abe ];for _ ,_cfd :=range _dddf {_bff ._adda .NewPage ();_bff .drawPage (_cfd );};};};

// Options contains the options for convert process
type Options struct{

// DefaultPageSize is applied when there is no page size explicitly set in the document.
// A4 is the default option.
DefaultPageSize _df .PageSize ;};func (_aggc *convertContext )getStyleFromRPrElt (_ddfe *_ee .CT_RPrElt )*style {if _ddfe ==nil ||_ddfe .RPrEltChoice ==nil ||len (_ddfe .RPrEltChoice )==0{return nil ;};_afef :=&style {};for _ ,_ffbc :=range _ddfe .RPrEltChoice {if _ffbc .RFont !=nil {_afef ._dgcg =&_ffbc .RFont .ValAttr ;
};if _dafce :=_ffbc .B ;_dafce !=nil {_bfca :=_dafce .ValAttr ==nil ||*_dafce .ValAttr ;_afef ._geca =&_bfca ;};if _bfd :=_ffbc .I ;_bfd !=nil {_dafa :=_bfd .ValAttr ==nil ||*_bfd .ValAttr ;_afef ._efba =&_dafa ;};if _egef :=_ffbc .U ;_egef !=nil {_fdcg :=_egef .ValAttr ==_ee .ST_UnderlineValuesSingle ||_egef .ValAttr ==_ee .ST_UnderlineValuesUnset ;
_afef ._addd =&_fdcg ;};if _afge :=_ffbc .VertAlign ;_afge !=nil {_cbdb :=_afge .ValAttr ==_be .ST_VerticalAlignRunSuperscript ;_afef ._ecc =&_cbdb ;_aeg :=_afge .ValAttr ==_be .ST_VerticalAlignRunSubscript ;_afef ._egdb =&_aeg ;};if _fgea :=_ffbc .Sz ;
_fgea !=nil {_cfg :=_fgea .ValAttr ;_afef ._dfge =&_cfg ;};if _ded :=_ffbc .Color ;_ded !=nil {_afef ._faaa =_aggc .getColorStringFromSmlColor (_ded );};};return _afef ;};var _egdf =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};
const _bb =15.0;func (_abbe *convertContext )alignSymbolsHorizontally (_cbbd *cell ,_cggg _ee .ST_HorizontalAlignment ){if _cggg ==_ee .ST_HorizontalAlignmentUnset {switch _cbbd ._aaga {case _ee .ST_CellTypeB :_cggg =_ee .ST_HorizontalAlignmentCenter ;
case _ee .ST_CellTypeN :_cggg =_ee .ST_HorizontalAlignmentRight ;default:_cggg =_ee .ST_HorizontalAlignmentLeft ;};};var _fgaa float64 ;for _ ,_fag :=range _cbbd ._cfdg {switch _cggg {case _ee .ST_HorizontalAlignmentLeft :_fgaa =_beg ;case _ee .ST_HorizontalAlignmentRight :_gacb :=_cdc (_fag ._faac );
_fgaa =_cbbd ._ecca -_beg -_gacb ;case _ee .ST_HorizontalAlignmentCenter :_gdg :=_cdc (_fag ._faac );_fgaa =(_cbbd ._ecca -_gdg )/2;};for _ ,_gfac :=range _fag ._faac {_gfac ._dcab +=_fgaa ;};};};type line struct{_efaf float64 ;_faac []*symbol ;_ebda float64 ;
};func (_afc *convertContext )makeCells (){_acfc :=_afc ._ebbc ;_ebg :=_acfc .Rows ();_gac :=0;for _add ,_eaf :=range _afc ._caea {if _add < _afc ._gfafg ||(_add > _afc ._bac &&_afc ._bac > 0){continue ;};_eaf ._agcf =[]*cell {};_afcb :=0.0;_fff :=_eaf ._gffe ;
if _eaf ._ddab {_dgg :=_ebg [_gac ];_gac ++;_dgb :=_eaf ._gebge ;for _ ,_egb :=range _dgg .Cells (){_egc ,_gaa :=_d .ParseCellReference (_egb .Reference ());if _gaa !=nil {_c .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_gaa );
continue ;};if int (_egc .ColumnIdx )< _afc ._acec ||(int (_egc .ColumnIdx )> _afc ._eaa &&_afc ._eaa > 0){continue ;};_abgd :=_afc ._bbc [_egc .ColumnIdx ];_dbb :=_abgd ._fcfe ;_bfbf :=_dbb ;_defa :=_abgd ._cagg ;var _gbb ,_efg ,_bbf ,_bfg bool ;for _ ,_begd :=range _afc ._bcad {if _egc .RowIdx >=_begd ._beeb &&_egc .RowIdx <=_begd ._cega &&_egc .ColumnIdx >=_begd ._gca &&_egc .ColumnIdx <=_begd ._dea {if _egc .ColumnIdx ==_begd ._gca &&_egc .RowIdx ==_begd ._beeb {_dbb =_begd ._bggbg ;
_dgb =_begd ._aca ;};_gbb =_egc .RowIdx !=_begd ._beeb ;_efg =_egc .RowIdx !=_begd ._cega ;_bbf =_egc .ColumnIdx !=_begd ._gca ;_bfg =_egc .ColumnIdx !=_begd ._dea ;};};var _cfa *style ;for _ ,_ggd :=range _afc ._befd {_dda ,_bfae ,_eab :=_d .ParseRangeReference (_ggd .Reference ());
if _eab !=nil ||_dda .RowIdx > _egc .RowIdx ||_dda .ColumnIdx > _egc .ColumnIdx ||_bfae .RowIdx < _egc .RowIdx ||_bfae .ColumnIdx < _egc .ColumnIdx ||_afc ._ecd .StyleSheet .X ().TableStyles ==nil {continue ;};_bgf :=_egc .RowIdx ==_dda .RowIdx ;for _ ,_ba :=range _afc ._ecd .StyleSheet .X ().TableStyles .TableStyle {if _ggd .X ().TableStyleInfo .NameAttr !=nil &&_ba .NameAttr ==*_ggd .X ().TableStyleInfo .NameAttr {for _ ,_ebd :=range _ba .TableStyleElement {if !_bgf &&_ebd .TypeAttr ==_ee .ST_TableStyleTypeWholeTable {_cfa =_afc .getDxfStyle (_ebd .DxfIdAttr );
};if _bgf &&_ebd .TypeAttr ==_ee .ST_TableStyleTypeHeaderRow {_cfa =_afc .getDxfStyle (_ebd .DxfIdAttr );};};};};};_gbd :=_afc .getStyleFromCell (_egb ,_fff ,_defa ,_cfa );var _adf ,_cdb ,_eae ,_cceg bool ;var _daga ,_afe ,_gebd ,_cbf *border ;var _ebac _ee .ST_VerticalAlignment ;
var _gad _ee .ST_HorizontalAlignment ;if _gbd !=nil {if !_gbb {_daga =_gbd ._aafa ;};if !_efg {_afe =_gbd ._aec ;};if !_bbf {_gebd =_gbd ._fdb ;};if !_bfg {_cbf =_gbd ._fggdf ;};if _afe !=nil &&_afe ._afba > _afcb {_afcb =_afe ._afba ;};_ebac =_gbd ._egg ;
_gad =_gbd ._fgbb ;if _gbd ._ecc !=nil {_adf =*_gbd ._ecc ;};if _gbd ._egdb !=nil {_cdb =*_gbd ._egdb ;};_eae =_gbd ._eccg ;_cceg =_gbd ._ggdf ;};var _acg _ac .Color ;if _gbd !=nil &&_gbd ._eaedg !=nil {_acg =_ac .ColorRGBFromHex (*_gbd ._eaedg );};_fd ,_gcb :=_afc .getContentFromCell (_acfc ,_egb ,_gbd ,_dbb ,_eae ,_cceg );
_bgb :=&cell {_aaga :_gcb ,_ecca :_dbb ,_cdg :_bfbf ,_fcgd :_dgb ,_cfdg :_fd ,_dfbe :_daga ,_bgea :_afe ,_bebd :_gebd ,_gbbb :_cbf ,_egca :_adf ,_gbg :_cdb ,_gcef :_acg };_afc .alignSymbolsHorizontally (_bgb ,_gad );_afc .alignSymbolsVertically (_bgb ,_ebac );
_eaf ._agcf =append (_eaf ._agcf ,_bgb );};};_eaf ._gdgf =_afcb ;};};type pageRow struct{_fafg int ;_eggf []*cell ;};var _gg =_cdbf (1);func (_bda *convertContext )getColorFromTheme (_bdac uint32 )string {_debg :=_bda ._ecd .Themes ();if len (_debg )!=0{_bcfe :=_debg [0];
if _cfagd :=_bcfe .ThemeElements ;_cfagd !=nil {if _aecf :=_cfagd .ClrScheme ;_aecf !=nil {switch _bdac {case 0:return _df .GetColorStringFromDmlColor (_aecf .Lt1 );case 1:return _df .GetColorStringFromDmlColor (_aecf .Dk1 );case 2:return _df .GetColorStringFromDmlColor (_aecf .Lt2 );
case 3:return _df .GetColorStringFromDmlColor (_aecf .Dk2 );case 4:return _df .GetColorStringFromDmlColor (_aecf .Accent1 );case 5:return _df .GetColorStringFromDmlColor (_aecf .Accent2 );case 6:return _df .GetColorStringFromDmlColor (_aecf .Accent3 );
case 7:return _df .GetColorStringFromDmlColor (_aecf .Accent4 );case 8:return _df .GetColorStringFromDmlColor (_aecf .Accent5 );case 9:return _df .GetColorStringFromDmlColor (_aecf .Accent6 );};};};};return "";};func (_gaf *convertContext )alignSymbolsVertically (_cdf *cell ,_dcg _ee .ST_VerticalAlignment ){var _cbbb float64 ;
switch _dcg {case _ee .ST_VerticalAlignmentTop :_cbbb =_bg ;if _cdf ._egca {_cbbb -=_fg ;}else if _cdf ._gbg {_cbbb +=4*_fg ;};for _ ,_eed :=range _cdf ._cfdg {_cbbb +=_eed ._ebda ;_eed ._efaf =_cbbb ;_cbbb +=_gg ;};case _ee .ST_VerticalAlignmentCenter :_ada :=0.0;
for _ ,_eeg :=range _cdf ._cfdg {_ada +=_eeg ._ebda +_cdbf (1);};_cbbb =0.5*(_cdf ._fcgd -_ada );if _cdf ._egca {_cbbb -=2*_fg ;}else if _cdf ._gbg {_cbbb +=2*_fg ;};for _ ,_gebe :=range _cdf ._cfdg {_cbbb +=_gebe ._ebda +0.5*_gg ;_gebe ._efaf =_cbbb ;
_cbbb +=0.5*_gg ;};default:_cbbb =_cdf ._fcgd -_bg ;if _cdf ._egca {_cbbb -=4*_fg ;}else if _cdf ._gbg {_cbbb +=_fg ;};for _bcb :=len (_cdf ._cfdg )-1;_bcb >=0;_bcb --{_cdf ._cfdg [_bcb ]._efaf =_cbbb ;_cbbb -=_cdf ._cfdg [_bcb ]._ebda ;_cbbb -=_gg ;};
};};type colWidthRange struct{_ecbae int ;_dfff int ;_defe float64 ;_fgfc *style ;};func (_dee *convertContext )fillPages (){for _cbg ,_agc :=range _dee ._addb {_ddae :=_dee ._caea [_agc ._fda :_agc ._cegb ];for _gfa ,_dcaa :=range _ddae {_bae :=0;_afb :=0.0;
_adg :=[]*cell {};if _dcaa ._ddab {for _ ,_befg :=range _dcaa ._agcf {_daa :=_dee ._ddce [_bae ];_dee ._geba =_daa ._gggc [_cbg ];_dee ._geba ._ecba =true ;_aa :=_befg ._cdg ;if _afb +_aa > _daa ._fcbd {_dee .addRowToPage (_adg ,_gfa );_adg =[]*cell {_befg };
_afb =_aa ;_bae ++;}else {_befg ._aacff =_afb ;_adg =append (_adg ,_befg );_afb +=_aa ;};};if len (_adg )> 0{_dff :=_dee ._ddce [_bae ];_dee ._geba =_dff ._gggc [_cbg ];_dee ._geba ._ecba =true ;_dee .addRowToPage (_adg ,_gfa );};};};};};func (_cfcg *convertContext )makePages (){for _ ,_fcb :=range _cfcg ._ddce {for _ ,_afcf :=range _cfcg ._addb {_fcb ._gggc =append (_fcb ._gggc ,&page {_gbbg :[]*pageRow {},_edb :_fcb ,_dbg :_afcf });
};};};type convertContext struct{_adda *_ac .Creator ;_ecd *_e .Workbook ;_ggga *_da .Theme ;_ebbc *_e .Sheet ;_agff *_e .StyleSheet ;_abed int ;_aacf int ;_ddce []*pagespan ;_geba *page ;_bbc []*colInfo ;_caea []*rowInfo ;_addb []*rowspan ;_gda float64 ;
_eecg float64 ;_adcb float64 ;_afda float64 ;_bcad []*mergedCell ;_aaf []*anchor ;_ddcd float64 ;_acec int ;_eaa int ;_gfafg int ;_bac int ;_ccf bool ;_befd []_e .Table ;};var _efe =3.025/_cdbf (1);type page struct{_gbbg []*pageRow ;_ecba bool ;_efbg []*_ac .Image ;
_edb *pagespan ;_dbg *rowspan ;};const _dad =0.25;func (_ddb *convertContext )makeAnchors (){_efd ,_dag :=_ddb ._ebbc .GetDrawing ();if _efd !=nil {for _ ,_de :=range _efd .EG_Anchor {_cgc :=&anchor {};if _cfc :=_de .AnchorChoice .TwoCellAnchor ;_cfc !=nil {_cgg ,_fef :=_cfc .From ,_cfc .To ;
if _cgg ==nil ||_fef ==nil {return ;};_cgc ._bcd =int (_cgg .Row );_cgc ._baf =_df .FromSTCoordinate (_cgg .RowOff );_cgc ._abede =int (_cgg .Col );_cgc ._cde =_df .FromSTCoordinate (_cgg .ColOff );_cgc ._bfcd =int (_fef .Row );_cgc ._efdc =_df .FromSTCoordinate (_fef .RowOff );
_cgc ._dge =int (_fef .Col );_cgc ._baaed =_df .FromSTCoordinate (_fef .ColOff );if _ceb :=_cfc .ObjectChoicesChoice ;_ceb !=nil {if _bfc :=_ceb .Pic ;_bfc !=nil {if _cda :=_bfc .BlipFill ;_cda !=nil {if _fee :=_cda .Blip ;_fee !=nil {if _dfd :=_fee .EmbedAttr ;
_dfd !=nil {for _ ,_gbfd :=range _dag .X ().Relationship {if _gbfd .IdAttr ==*_dfd {for _ ,_bbd :=range _ddb ._ecd .Images {if _bbd .Target ()==_gbfd .TargetAttr {_efa ,_fc :=_fb .Open (_bbd .Path ());if _fc !=nil {_c .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_fc );
continue ;};_eg ,_ ,_fc :=_b .Decode (_efa );if _fc !=nil {_c .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_fc );continue ;};_cgc ._egba =_eg ;};};};};};};};}else if _ddf :=_ceb .GraphicFrame ;
_ddf !=nil {if _gcg :=_ddf .Graphic ;_gcg !=nil {if _cff :=_gcg .GraphicData ;_cff !=nil {for _ ,_ed :=range _cff .Any {if _cgb ,_fga :=_ed .(*_ef .Chart );_fga {for _ ,_bea :=range _dag .X ().Relationship {if _bea .IdAttr ==_cgb .IdAttr {_ced :=_ddb ._ecd .GetChartByTargetId (_bea .TargetAttr );
if _ced !=nil {_cgc ._aeb =_ced ;};};};};};};};};};};if _cgc ._egba !=nil ||_cgc ._aeb !=nil {_ddb ._aaf =append (_ddb ._aaf ,_cgc );};};};};func _gbfc (_cggc *bool )bool {return _cggc !=nil &&*_cggc };

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _df .RegisterFontsFromDirectory (dirName )};type border struct{_afba float64 ;_cbc _ac .Color ;};type rowInfo struct{_fdaa float64 ;_ddab bool ;_gebge float64 ;_gffe *style ;_agcf []*cell ;
_gdgf float64 ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_df .FontStyle ;func (_aagab *convertContext )getDxfStyle (_afdcb *uint32 )*style {_gbe :=&style {};_cbag :=false ;if _afdcb !=nil {var _egad *_ee .CT_Dxf ;for _ccaca ,_bgbf :=range _aagab ._agff .X ().Dxfs .Dxf {if uint32 (_ccaca )==*_afdcb {_egad =_bgbf ;
};};if _egad ==nil {return nil ;};if _egad .Fill !=nil &&_egad .Fill .FillChoice !=nil &&_egad .Fill .FillChoice .PatternFill !=nil {if _egad .Fill .FillChoice .PatternFill .FgColor !=nil {_gbe ._eaedg =_aagab .getColorStringFromSmlColor (_egad .Fill .FillChoice .PatternFill .FgColor );
}else if _egad .Fill .FillChoice .PatternFill .BgColor !=nil {_gbe ._eaedg =_aagab .getColorStringFromSmlColor (_egad .Fill .FillChoice .PatternFill .BgColor );};};_ggbe :=_egad .Font ;for _ ,_fffa :=range _ggbe .FontChoice {if _fffa .Name !=nil {_gbe ._dgcg =&_fffa .Name .ValAttr ;
_cbag =true ;}else if _fffa .B !=nil {_gccg :=_fffa .B .ValAttr ==nil ||*_fffa .B .ValAttr ;_gbe ._geca =&_gccg ;_cbag =true ;}else if _fffa .I !=nil {_acae :=_fffa .I .ValAttr ==nil ||*_fffa .I .ValAttr ;_gbe ._efba =&_acae ;_cbag =true ;}else if _fffa .U !=nil {_beba :=_fffa .U .ValAttr ==_ee .ST_UnderlineValuesSingle ||_fffa .U .ValAttr ==_ee .ST_UnderlineValuesUnset ;
_gbe ._addd =&_beba ;_cbag =true ;}else if _fffa .Sz !=nil {_eccb :=_fffa .Sz .ValAttr ;_gbe ._dfge =&_eccb ;_cbag =true ;}else if _fffa .VertAlign !=nil {_ebbf :=_fffa .VertAlign .ValAttr ==_be .ST_VerticalAlignRunSuperscript ;_gbe ._ecc =&_ebbf ;_adb :=_fffa .VertAlign .ValAttr ==_be .ST_VerticalAlignRunSubscript ;
_gbe ._egdb =&_adb ;_cbag =true ;}else if _fffa .Color !=nil {_gbe ._faaa =_aagab .getColorStringFromSmlColor (_fffa .Color );_cbag =true ;};};_ecge :=_egad .Border ;if _ecge !=nil {if _ecge .Top !=nil {_gbe ._aafa =_aagab .getBorder (_ecge .Top );_cbag =true ;
};if _ecge .Bottom !=nil {_gbe ._aec =_aagab .getBorder (_ecge .Bottom );_cbag =true ;};if _ecge .Left !=nil {_gbe ._fdb =_aagab .getBorder (_ecge .Left );_cbag =true ;};if _ecge .Right !=nil {_gbe ._fggdf =_aagab .getBorder (_ecge .Right );_cbag =true ;
};};if _egad .Alignment !=nil {if _fbga :=_egad .Alignment .VerticalAttr ;_fbga !=_ee .ST_VerticalAlignmentUnset {_gbe ._egg =_fbga ;_cbag =true ;};if _bbfa :=_egad .Alignment .HorizontalAttr ;_bbfa !=_ee .ST_HorizontalAlignmentUnset {_gbe ._fgbb =_bbfa ;
_cbag =true ;};};};if _cbag {return _gbe ;};return nil ;};func (_fgab *convertContext )imageFromAnchor (_fgce *anchor ,_efc ,_bggb float64 )_b .Image {if _fgce ._egba !=nil {return _fgce ._egba ;};if _fgce ._aeb !=nil {_fccdg ,_befc :=_df .MakeImageFromChartSpace (_fgce ._aeb ,_efc ,_bggb ,_fgab ._ggga ,_fgab ._ecd );
if _befc !=nil {_c .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_befc );
return nil ;};return _fccdg ;};return nil ;};type symbol struct{_badd string ;_dcab float64 ;_gbaad float64 ;_aaa float64 ;_acd *_ac .TextStyle ;_dbgf string ;};func _cdc (_ace []*symbol )float64 {_eda :=0.0;for _ ,_gfc :=range _ace {_eda +=_gfc ._aaa ;
};return _eda ;};func (_deb *convertContext )getColorStringFromSmlColor (_fbd *_ee .CT_Color )*string {var _affd string ;if _fbd .RgbAttr !=nil {_affd =*_fbd .RgbAttr ;}else if _fbd .IndexedAttr !=nil &&*_fbd .IndexedAttr < 64{_affd =_egdf [*_fbd .IndexedAttr ];
}else if _fbd .ThemeAttr !=nil {_egf :=*_fbd .ThemeAttr ;_affd =_deb .getColorFromTheme (_egf );};if _affd ==""{return nil ;};if len (_affd )> 6{_affd =_affd [(len (_affd )-6):];};if _fbd .TintAttr !=nil {_ddcc :=*_fbd .TintAttr ;_affd =_df .AdjustColorByTint (_affd ,_ddcc );
};_affd ="\u0023"+_affd ;return &_affd ;};func (_beage *convertContext )getImage (_bca _b .Image ,_agfe ,_fbgd ,_fgge ,_ageg ,_aacd ,_bgga float64 ,_eag _df .ImgPart )*_ac .Image {_ageg +=_beage ._gda ;_fgge +=_beage ._eecg ;_cea ,_ddec :=_df .GetImage (_beage ._adda ,_bca ,_agfe ,_fbgd ,_fgge ,_ageg ,_aacd ,_bgga ,_eag );
if _ddec !=nil {_c .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_ddec );return nil ;};return _cea ;};func (_agfa *convertContext )makeRowspans (){var _ddfg float64 ;
_dadf :=0;for _dca ,_bgfd :=range _agfa ._caea {_ccd :=_bgfd ._gebge +_bgfd ._gdgf ;if _ddfg +_ccd <=_agfa ._adcb {_bgfd ._fdaa =_ddfg ;_ddfg +=_ccd ;}else {_agfa ._addb =append (_agfa ._addb ,&rowspan {_deg :_ddfg ,_fda :_dadf ,_cegb :_dca });_dadf =_dca ;
_bgfd ._fdaa =0;_ddfg =_ccd ;};};_agfa ._addb =append (_agfa ._addb ,&rowspan {_deg :_ddfg ,_fda :_dadf ,_cegb :len (_agfa ._caea )});};type anchor struct{_egba _b .Image ;_aeb *_ef .ChartSpace ;_bcd int ;_baf int64 ;_abede int ;_cde int64 ;_bfcd int ;
_efdc int64 ;_dge int ;_baaed int64 ;};const _fa =64.0;func (_abb *convertContext )getSymbolsFromString (_edcf string ,_ecf *style )[]*symbol {_cfea :=[]*symbol {};_agge :=_abb .makeTextStyleFromCellStyle (_ecf );for _ ,_gabb :=range _edcf {_cfea =append (_cfea ,&symbol {_badd :string (_gabb ),_acd :_agge });
};return _cfea ;};func (_fcg *convertContext )makePagespans (){_fcg ._ddce =[]*pagespan {};_bad :=0.0;_cdbb :=0;for _dbd ,_edeb :=range _fcg ._bbc {_cae :=_edeb ._fcfe ;if _bad +_cae <=_fcg ._afda {_edeb ._dcba =_bad ;_bad +=_cae ;}else {_edeb ._dcba =0;
_fcg ._ddce =append (_fcg ._ddce ,&pagespan {_fcbd :_bad ,_ged :_cdbb ,_dgdga :_dbd });_bad =_cae ;_cdbb =_dbd ;};};_fcg ._ddce =append (_fcg ._ddce ,&pagespan {_fcbd :_bad ,_ged :_cdbb ,_dgdga :len (_fcg ._bbc )});};const _ge =0.0;func (_ab *convertContext )determineMaxIndexes (){var _ecb ,_eec int ;
_ecb =int (_ab ._ebbc .MaxColumnIdx ());_cga :=_ab ._ebbc .Rows ();if len (_cga )> 0{_eec =int (_cga [len (_cga )-1].RowNumber ());};for _ ,_gfb :=range _ab ._aaf {if _gfb ._bfcd >=_eec {_eec =_gfb ._bfcd +1;};if _gfb ._dge >=_ecb {_ecb =_gfb ._dge +1;
};};_ab ._abed =_eec ;_ab ._aacf =_ecb ;};type style struct{_eaedg *string ;_faaa *string ;_dfge *float64 ;_dgcg *string ;_geca *bool ;_efba *bool ;_addd *bool ;_ecc *bool ;_egdb *bool ;_aafa *border ;_aec *border ;_fdb *border ;_fggdf *border ;_eccg bool ;
_egg _ee .ST_VerticalAlignment ;_fgbb _ee .ST_HorizontalAlignment ;_ggdf bool ;};

// ConvertToPdfWithOptions convert a sheet to PDF with given options.
func ConvertToPdfWithOptions (s *_e .Sheet ,opts *Options )*_ac .Creator {_ce :=s .X ();if _ce ==nil {return nil ;};var _dd _ac .PageSize ;_gb :=true ;_cd :=false ;if _ce .SheetPr !=nil &&_ce .SheetPr .PageSetUpPr !=nil &&_ce .SheetPr .PageSetUpPr .FitToPageAttr !=nil &&*_ce .SheetPr .PageSetUpPr .FitToPageAttr {_cd =true ;
};if _af :=_ce .PageSetup ;_af !=nil {_gb =_af .OrientationAttr ==_ee .ST_OrientationLandscape ;if _dfc :=_af .PaperSizeAttr ;_dfc !=nil {_dd =_bcbe [*_dfc ];};};if (_dd ==_ac .PageSize {}){_dd =_df .GetDefaultPageSize ();if opts !=nil &&opts .DefaultPageSize !=_df .DefaultPageSize {_dd =_df .GetPageDimensions (opts .DefaultPageSize );
};};if _gb {_dd [0],_dd [1]=_dd [1],_dd [0];};_fed :=_ac .New ();_fed .SetPageSize (_dd );var _ag ,_afd ,_gge ,_gd float64 ;if _dfcf :=_ce .PageMargins ;_dfcf !=nil {_gge =_dfcf .LeftAttr ;_gd =_dfcf .RightAttr ;_ag =_dfcf .TopAttr ;_afd =_dfcf .BottomAttr ;
};if _gge < _dad {_gge =_dad ;};if _gd < _dad {_gd =_dad ;};if _ag < _ge {_ag =_ge ;};if _afd < _ge {_afd =_ge ;};_ag *=_fe .Inch ;_afd *=_fe .Inch ;_gge *=_fe .Inch ;_gd *=_fe .Inch ;_fed .SetPageMargins (_gge ,_gd ,_ag ,_afd );_fgc :=s .Workbook ();var _dg *_da .Theme ;
if len (_fgc .Themes ())> 0{_dg =_fgc .Themes ()[0];};var _eba ,_afg ,_cc ,_dae int ;for _ ,_cf :=range _fgc .DefinedNames (){if _cf .Name ()=="\u005f\u0078l\u006e\u006d\u002eP\u0072\u0069\u006e\u0074\u005f\u0041\u0072\u0065\u0061"{_agf ,_bed ,_dde ,_bf :=_df .ParseExcelRange (_cf .Content ());
if _bf ==nil &&s .Name ()==_agf {_eba =int (_bed .ColumnIdx );_afg =int (_dde .ColumnIdx );_cc =int (_bed .RowIdx );_dae =int (_dde .RowIdx );};};};_ddc :=[]_e .Table {};if _ce .TableParts !=nil &&_ce .TableParts .TablePart !=nil {_dc :=0;_db :=s .Workbook ().Tables ();
_f .Slice (_db [:],func (_gfe ,_efb int )bool {return _db [_gfe ].X ().IdAttr < _db [_efb ].X ().IdAttr });for _ ,_ec :=range s .Workbook ().Sheets (){if _ec .Name ()==s .Name (){break ;}else {if _ec .X ().TableParts !=nil &&_ec .X ().TableParts .TablePart !=nil {_dc +=len (_ec .X ().TableParts .TablePart );
};};};if len (_db )>=_dc +len (_ce .TableParts .TablePart ){_ddc =append (_ddc ,_db [_dc :_dc +len (_ce .TableParts .TablePart )]...);};};_gcc :=&convertContext {_adda :_fed ,_ebbc :s ,_ecd :s .Workbook (),_ggga :_dg ,_agff :&s .Workbook ().StyleSheet ,_gda :_ag ,_eecg :_gge ,_adcb :_dd [1]-_afd -_ag ,_afda :_dd [0]-_gd -_gge ,_acec :_eba ,_eaa :_afg ,_gfafg :_cc ,_bac :_dae ,_ccf :_cd ,_befd :_ddc };
_gcc .makeAnchors ();_gcc .determineMaxIndexes ();if _gcc ._abed ==0&&_gcc ._aacf ==0{_fed .NewPage ();return _fed ;};_gcc .makeCols ();_gcc .makeRows ();_gcc .makeMergedCells ();_gcc .makeCells ();_gcc .makePagespans ();_gcc .makeRowspans ();_gcc .makePages ();
_gcc .fillPages ();_gcc .distributeAnchors ();_gcc .drawSheet ();return _fed ;};type colInfo struct{_dcba float64 ;_fcfe float64 ;_cagg *style ;};func (_bebe *convertContext )getBorder (_gabg *_ee .CT_BorderPr )*border {_cfb :=&border {};switch _gabg .StyleAttr {case _ee .ST_BorderStyleHair :_cfb ._afba =_gc /2;
case _ee .ST_BorderStyleThin :_cfb ._afba =_gc ;case _ee .ST_BorderStyleMedium :_cfb ._afba =_gc *2;case _ee .ST_BorderStyleThick :_cfb ._afba =_gc *4;};if _cfb ._afba ==0.0{return nil ;};if _efcg :=_gabg .Color ;_efcg !=nil {_aee :=_bebe .getColorStringFromSmlColor (_efcg );
if _aee !=nil {_cfb ._cbc =_ac .ColorRGBFromHex (*_aee );}else {_cfb ._cbc =_ac .ColorBlack ;};};return _cfb ;};func _ebb (_cfec *symbol ){_bgc :=_ac .New ();_eadg :=_bgc .NewStyledParagraph ();_eadg .SetMargins (0,0,0,0);_bdgcg :=_eadg .Append (_cfec ._badd );
if _cfec ._acd !=nil {_bdgcg .Style =*_cfec ._acd ;};_cfec ._gbaad =_eadg .Height ();if _cfec ._aaa ==0{_cfec ._aaa =_eadg .Width ();};};func (_ggbc *convertContext )distributeAnchors (){for _ ,_cfcc :=range _ggbc ._aaf {_acc ,_fgf :=_cfcc ._bcd ,_cfcc ._baf ;
_fcc ,_befb :=_cfcc ._abede ,_cfcc ._cde ;_adcc ,_facc :=_cfcc ._bfcd ,_cfcc ._efdc ;_bfcc ,_gfaf :=_cfcc ._dge ,_cfcc ._baaed ;if _acc < _ggbc ._gfafg ||(_adcc > _ggbc ._bac &&_ggbc ._bac > 0){continue ;};if _fcc < _ggbc ._acec ||(_bfcc > _ggbc ._eaa &&_ggbc ._eaa > 0){continue ;
};var _eecb ,_gfee ,_bfbg ,_gec *page ;for _ ,_ae :=range _ggbc ._ddce {for _ ,_eabd :=range _ae ._gggc {if _acc >=_eabd ._dbg ._fda &&_acc < _eabd ._dbg ._cegb {if _fcc >=_eabd ._edb ._ged &&_fcc < _eabd ._edb ._dgdga {_eabd ._ecba =true ;_eecb =_eabd ;
};if _bfcc >=_eabd ._edb ._ged &&_bfcc < _eabd ._edb ._dgdga {_eabd ._ecba =true ;_gfee =_eabd ;};};if _adcc >=_eabd ._dbg ._fda &&_adcc < _eabd ._dbg ._cegb {if _fcc >=_eabd ._edb ._ged &&_fcc < _eabd ._edb ._dgdga {_eabd ._ecba =true ;_gec =_eabd ;};
if _bfcc >=_eabd ._edb ._ged &&_bfcc < _eabd ._edb ._dgdga {_eabd ._ecba =true ;_bfbg =_eabd ;};};};};_cgcb :=_eecb !=_gfee ;_eecc :=_eecb !=_gec ;if _cgcb &&_eecc {_acgf :=_ggbc ._bbc [_fcc ]._dcba +_fe .FromEMU (_befb );_cfccc :=_eecb ._edb ._fcbd ;_ega :=_ggbc ._bbc [_bfcc ]._dcba +_fe .FromEMU (_gfaf );
_gfeg :=_ggbc ._caea [_acc ]._fdaa +_fe .FromEMU (_fgf );_beag :=float64 (_eecb ._dbg ._deg );_bfee :=_ggbc ._caea [_adcc ]._fdaa +_fe .FromEMU (_facc );_feeb :=_ega +_cfccc -_acgf ;_bba :=_bfee +_beag -_gfeg ;_eece :=_ggbc .imageFromAnchor (_cfcc ,_feeb ,_bba );
_eecb ._efbg =append (_eecb ._efbg ,_ggbc .getImage (_eece ,_bba ,_feeb ,_acgf ,_gfeg ,_cfccc -_acgf ,_beag -_gfeg ,_df .ImgPart_lt ));_gfee ._efbg =append (_gfee ._efbg ,_ggbc .getImage (_eece ,_bba ,_feeb ,0,_gfeg ,_cfccc -_acgf ,_beag -_gfeg ,_df .ImgPart_rt ));
_gec ._efbg =append (_gec ._efbg ,_ggbc .getImage (_eece ,_bba ,_feeb ,_acgf ,0,_cfccc -_acgf ,_beag -_gfeg ,_df .ImgPart_lb ));_bfbg ._efbg =append (_bfbg ._efbg ,_ggbc .getImage (_eece ,_bba ,_feeb ,0,0,_cfccc -_acgf ,_beag -_gfeg ,_df .ImgPart_rb ));
}else if _cgcb {_fbg :=_ggbc ._caea [_acc ]._fdaa +_fe .FromEMU (_fgf );_bbb :=_ggbc ._caea [_adcc ]._fdaa +_fe .FromEMU (_facc );_fbgf :=_ggbc ._bbc [_fcc ]._dcba +_fe .FromEMU (_befb );_fccg :=_eecb ._edb ._fcbd ;_dgga :=_ggbc ._bbc [_bfcc ]._dcba +_fe .FromEMU (_gfaf );
_eaef :=_dgga +_fccg -_fbgf ;_bab :=_bbb -_fbg ;_fgg :=_ggbc .imageFromAnchor (_cfcc ,_eaef ,_bab );_eecb ._efbg =append (_eecb ._efbg ,_ggbc .getImage (_fgg ,_bab ,_eaef ,_fbgf ,_fbg ,_fccg -_fbgf ,0,_df .ImgPart_l ));_gfee ._efbg =append (_gfee ._efbg ,_ggbc .getImage (_fgg ,_bab ,_eaef ,0,_fbg ,_fccg -_fbgf ,0,_df .ImgPart_r ));
}else if _eecc {_fggd :=_ggbc ._bbc [_fcc ]._dcba +_fe .FromEMU (_befb );_gbfde :=_ggbc ._bbc [_bfcc ]._dcba +_fe .FromEMU (_gfaf );_cef :=_ggbc ._caea [_acc ]._fdaa +_fe .FromEMU (_fgf );_dffe :=float64 (_eecb ._dbg ._deg );_aff :=_ggbc ._caea [_adcc ]._fdaa +_fe .FromEMU (_facc );
_dec :=_gbfde -_fggd ;_acb :=_aff +_dffe -_cef ;_gfd :=_ggbc .imageFromAnchor (_cfcc ,_dec ,_acb );_eecb ._efbg =append (_eecb ._efbg ,_ggbc .getImage (_gfd ,_acb ,_dec ,_fggd ,_cef ,0,_dffe -_cef ,_df .ImgPart_t ));_gec ._efbg =append (_gec ._efbg ,_ggbc .getImage (_gfd ,_acb ,_dec ,_fggd ,0,0,_dffe -_cef ,_df .ImgPart_b ));
}else {_ddd :=_ggbc ._bbc [_fcc ]._dcba +_fe .FromEMU (_befb );_eef :=_ggbc ._bbc [_bfcc ]._dcba +_fe .FromEMU (_gfaf );_gcgg :=_ggbc ._caea [_acc ]._fdaa +_fe .FromEMU (_fgf );_ecg :=_ggbc ._caea [_adcc ]._fdaa +_fe .FromEMU (_facc );_gae :=_eef -_ddd ;
_eecf :=_ecg -_gcgg ;_bcf :=_ggbc .imageFromAnchor (_cfcc ,_gae ,_eecf );_eecb ._efbg =append (_eecb ._efbg ,_ggbc .getImage (_bcf ,_eecf ,_gae ,_ddd ,_gcgg ,0,0,_df .ImgPart_whole ));};};};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_bc .PdfFont ){_df .RegisterFont (name ,style ,font );};const _fg =1.5;type cell struct{_aaga _ee .ST_CellType ;_ecdf int ;_aacff float64 ;_cfdg []*line ;_ecca float64 ;_cdg float64 ;_fcgd float64 ;
_eadf float64 ;_efbf float64 ;_dfa *_ac .TextStyle ;_dfbe *border ;_bgea *border ;_bebd *border ;_gbbb *border ;_egca bool ;_gbg bool ;_gcef _ac .Color ;};