//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_gc "github.com/unidoc/unioffice/v2/common/logger";_ff "github.com/unidoc/unioffice/v2/common/tempstorage";_cd "github.com/unidoc/unioffice/v2/internal/convertutils";_cfa "github.com/unidoc/unioffice/v2/measurement";_fa "github.com/unidoc/unioffice/v2/schema/soo/dml";
_ab "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_gg "github.com/unidoc/unioffice/v2/schema/soo/ofc/sharedTypes";_bb "github.com/unidoc/unioffice/v2/schema/soo/sml";_eb "github.com/unidoc/unioffice/v2/spreadsheet";_ac "github.com/unidoc/unioffice/v2/spreadsheet/formula";
_cg "github.com/unidoc/unioffice/v2/spreadsheet/reference";_b "github.com/unidoc/unipdf/v4/creator";_e "github.com/unidoc/unipdf/v4/model";_a "image";_g "math";_cf "sort";_f "strconv";);func (_feed *convertContext )alignSymbolsHorizontally (_cfd *cell ,_ffba _bb .ST_HorizontalAlignment ){if _ffba ==_bb .ST_HorizontalAlignmentUnset {switch _cfd ._fcdf {case _bb .ST_CellTypeB :_ffba =_bb .ST_HorizontalAlignmentCenter ;
case _bb .ST_CellTypeN :_ffba =_bb .ST_HorizontalAlignmentRight ;default:_ffba =_bb .ST_HorizontalAlignmentLeft ;};};var _bddg float64 ;for _ ,_efb :=range _cfd ._dcd {switch _ffba {case _bb .ST_HorizontalAlignmentLeft :_bddg =_cb ;case _bb .ST_HorizontalAlignmentRight :_afd :=_ecdf (_efb ._cbge );
_bddg =_cfd ._bgafe -_cb -_afd ;case _bb .ST_HorizontalAlignmentCenter :_ecbg :=_ecdf (_efb ._cbge );_bddg =(_cfd ._bgafe -_ecbg )/2;};for _ ,_gee :=range _efb ._cbge {_gee ._ddcb +=_bddg ;};};};type convertContext struct{_dab *_b .Creator ;_gfcc *_eb .Workbook ;
_bffb *_fa .Theme ;_beac *_eb .Sheet ;_fbc *_eb .StyleSheet ;_dgdb int ;_bgdb int ;_cccc []*pagespan ;_ccca *page ;_bef []*colInfo ;_ceac []*rowInfo ;_gffff []*rowspan ;_cgd float64 ;_gae float64 ;_ffbac float64 ;_fbf float64 ;_gccb []*mergedCell ;_efgee []*anchor ;
_gbe float64 ;_ebgc int ;_deag int ;_afdg int ;_fag int ;_fef bool ;_cbg []_eb .Table ;};func (_dee *convertContext )makeRows (){_gebf :=[]*rowInfo {};_ad :=_dee ._beac .Rows ();_ga :=0;_bd :=0.0;for _ecf ,_fc :=range _ad {if _ecf < _dee ._afdg ||(_ecf > _dee ._fag &&_dee ._fag > 0){continue ;
};_ga ++;_cfcc :=int (_fc .RowNumber ());if _cfcc > _ga {for _feg :=_ga ;_feg < _cfcc ;_feg ++{_gebf =append (_gebf ,&rowInfo {_aeabg :_gcb /_cbb });_bd +=_gcb /_cbb ;};_ga =_cfcc ;};var _gfc float64 ;if _fc .X ().HtAttr ==nil {_gfc =_gcb ;}else {_gfc =*_fc .X ().HtAttr ;
};_gebf =append (_gebf ,&rowInfo {_aeabg :_gfc /_cbb ,_bcf :true ,_aedf :_dee .getStyle (_fc .X ().SAttr )});_bd +=_gfc /_cbb ;};for _eeea :=len (_gebf );_eeea < _dee ._dgdb ;_eeea ++{_gebf =append (_gebf ,&rowInfo {_aeabg :_gcb /_cbb });_bd +=_gcb /_cbb ;
};if _dee ._fef ||_bd >=_dee ._ffbac {_acb :=_dee ._gbe ;if _dee ._ffbac /_bd < _dee ._gbe {_acb =_dee ._ffbac /_bd ;};for _ ,_bbg :=range _gebf {_bbg ._aeabg *=_acb ;};};_dee ._ceac =_gebf ;};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_eb .Sheet )*_b .Creator {return ConvertToPdfWithOptions (s ,nil )};func _abbc (_dacgd *bool )bool {return _dacgd !=nil &&*_dacgd };type line struct{_gcce float64 ;_cbge []*symbol ;_eded float64 ;};func (_bgfa *convertContext )getColorFromTheme (_cca uint32 )string {_ecaa :=_bgfa ._gfcc .Themes ();
if len (_ecaa )!=0{_fafgb :=_ecaa [0];if _cddb :=_fafgb .ThemeElements ;_cddb !=nil {if _gfde :=_cddb .ClrScheme ;_gfde !=nil {switch _cca {case 0:return _cd .GetColorStringFromDmlColor (_gfde .Lt1 );case 1:return _cd .GetColorStringFromDmlColor (_gfde .Dk1 );
case 2:return _cd .GetColorStringFromDmlColor (_gfde .Lt2 );case 3:return _cd .GetColorStringFromDmlColor (_gfde .Dk2 );case 4:return _cd .GetColorStringFromDmlColor (_gfde .Accent1 );case 5:return _cd .GetColorStringFromDmlColor (_gfde .Accent2 );case 6:return _cd .GetColorStringFromDmlColor (_gfde .Accent3 );
case 7:return _cd .GetColorStringFromDmlColor (_gfde .Accent4 );case 8:return _cd .GetColorStringFromDmlColor (_gfde .Accent5 );case 9:return _cd .GetColorStringFromDmlColor (_gfde .Accent6 );};};};};return "";};func (_eeed *convertContext )makeCells (){_cdd :=_eeed ._beac ;
_gcae :=_cdd .Rows ();_fdf :=0;for _bba ,_adf :=range _eeed ._ceac {if _bba < _eeed ._afdg ||(_bba > _eeed ._fag &&_eeed ._fag > 0){continue ;};_adf ._fcbba =[]*cell {};_bgf :=0.0;_ggf :=_adf ._aedf ;if _adf ._bcf {_aba :=_gcae [_fdf ];_fdf ++;_edf :=_adf ._aeabg ;
for _ ,_fdd :=range _aba .Cells (){_fed ,_fbed :=_cg .ParseCellReference (_fdd .Reference ());if _fbed !=nil {_gc .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_fbed );
continue ;};if int (_fed .ColumnIdx )< _eeed ._ebgc ||(int (_fed .ColumnIdx )> _eeed ._deag &&_eeed ._deag > 0){continue ;};_ccc :=_eeed ._bef [_fed .ColumnIdx ];_ddf :=_ccc ._dgdc ;_bbc :=_ddf ;_daf :=_ccc ._egab ;var _accb ,_agda ,_bbae ,_deeb bool ;
for _ ,_ggfb :=range _eeed ._gccb {if _fed .RowIdx >=_ggfb ._fbgga &&_fed .RowIdx <=_ggfb ._ebag &&_fed .ColumnIdx >=_ggfb ._bgae &&_fed .ColumnIdx <=_ggfb ._cefg {if _fed .ColumnIdx ==_ggfb ._bgae &&_fed .RowIdx ==_ggfb ._fbgga {_ddf =_ggfb ._fabg ;_edf =_ggfb ._beae ;
};_accb =_fed .RowIdx !=_ggfb ._fbgga ;_agda =_fed .RowIdx !=_ggfb ._ebag ;_bbae =_fed .ColumnIdx !=_ggfb ._bgae ;_deeb =_fed .ColumnIdx !=_ggfb ._cefg ;};};var _cddf *style ;for _ ,_fbb :=range _eeed ._cbg {_edfe ,_gac ,_dcg :=_cg .ParseRangeReference (_fbb .Reference ());
if _dcg !=nil ||_edfe .RowIdx > _fed .RowIdx ||_edfe .ColumnIdx > _fed .ColumnIdx ||_gac .RowIdx < _fed .RowIdx ||_gac .ColumnIdx < _fed .ColumnIdx ||_eeed ._gfcc .StyleSheet .X ().TableStyles ==nil {continue ;};_abaa :=_fed .RowIdx ==_edfe .RowIdx ;for _ ,_dcb :=range _eeed ._gfcc .StyleSheet .X ().TableStyles .TableStyle {if _fbb .X ().TableStyleInfo .NameAttr !=nil &&_dcb .NameAttr ==*_fbb .X ().TableStyleInfo .NameAttr {for _ ,_fab :=range _dcb .TableStyleElement {if !_abaa &&_fab .TypeAttr ==_bb .ST_TableStyleTypeWholeTable {_cddf =_eeed .getDxfStyle (_fab .DxfIdAttr );
};if _abaa &&_fab .TypeAttr ==_bb .ST_TableStyleTypeHeaderRow {_cddf =_eeed .getDxfStyle (_fab .DxfIdAttr );};};};};};_gce :=_eeed .getStyleFromCell (_fdd ,_ggf ,_daf ,_cddf );var _caf ,_bcc ,_ecc ,_afg bool ;var _cccf ,_bcg ,_fce ,_ffd *border ;var _eff _bb .ST_VerticalAlignment ;
var _ccec _bb .ST_HorizontalAlignment ;if _gce !=nil {if !_accb {_cccf =_gce ._dgge ;};if !_agda {_bcg =_gce ._gbcg ;};if !_bbae {_fce =_gce ._bfac ;};if !_deeb {_ffd =_gce ._gfaf ;};if _bcg !=nil &&_bcg ._cbfc > _bgf {_bgf =_bcg ._cbfc ;};_eff =_gce ._bbad ;
_ccec =_gce ._ffce ;if _gce ._dcga !=nil {_caf =*_gce ._dcga ;};if _gce ._fgf !=nil {_bcc =*_gce ._fgf ;};_ecc =_gce ._ggfd ;_afg =_gce ._abfa ;};var _acd _b .Color ;if _gce !=nil &&_gce ._dggc !=nil {_acd =_b .ColorRGBFromHex (*_gce ._dggc );};_cgf ,_dcc :=_eeed .getContentFromCell (_cdd ,_fdd ,_gce ,_ddf ,_ecc ,_afg );
_eae :=&cell {_fcdf :_dcc ,_bgafe :_ddf ,_abg :_bbc ,_cfde :_edf ,_dcd :_cgf ,_fdee :_cccf ,_bcaf :_bcg ,_dfgb :_fce ,_agec :_ffd ,_eefe :_caf ,_dabe :_bcc ,_cdbc :_acd };_eeed .alignSymbolsHorizontally (_eae ,_ccec );_eeed .alignSymbolsVertically (_eae ,_eff );
_adf ._fcbba =append (_adf ._fcbba ,_eae );};};_adf ._eca =_bgf ;};};func (_effd *convertContext )getImage (_cdbb _a .Image ,_aaae ,_ecccf ,_acfe ,_cab ,_ebcg ,_efge float64 ,_adc _cd .ImgPart )*_b .Image {_cab +=_effd ._cgd ;_acfe +=_effd ._gae ;_abaf ,_baa :=_cd .GetImage (_effd ._dab ,_cdbb ,_aaae ,_ecccf ,_acfe ,_cab ,_ebcg ,_efge ,_adc );
if _baa !=nil {_gc .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_baa );return nil ;};return _abaf ;};func (_aeb *convertContext )makePagespans (){_aeb ._cccc =[]*pagespan {};
_bfad :=0.0;_dbff :=0;for _fdc ,_bbaf :=range _aeb ._bef {_acac :=_bbaf ._dgdc ;if _bfad +_acac <=_aeb ._fbf {_bbaf ._bgge =_bfad ;_bfad +=_acac ;}else {_bbaf ._bgge =0;_aeb ._cccc =append (_aeb ._cccc ,&pagespan {_ggad :_bfad ,_dbffd :_dbff ,_fgcg :_fdc });
_bfad =_acac ;_dbff =_fdc ;};};_aeb ._cccc =append (_aeb ._cccc ,&pagespan {_ggad :_bfad ,_dbffd :_dbff ,_fgcg :len (_aeb ._bef )});};func (_ebdfe *convertContext )distributeAnchors (){for _ ,_bcgd :=range _ebdfe ._efgee {_egga ,_adfb :=_bcgd ._cafb ,_bcgd ._edb ;
_acacc ,_dcce :=_bcgd ._gfdg ,_bcgd ._fgag ;_edcf ,_dedf :=_bcgd ._efa ,_bcgd ._dgb ;_gfbc ,_cffd :=_bcgd ._cfff ,_bcgd ._bgfgc ;if _egga < _ebdfe ._afdg ||(_edcf > _ebdfe ._fag &&_ebdfe ._fag > 0){continue ;};if _acacc < _ebdfe ._ebgc ||(_gfbc > _ebdfe ._deag &&_ebdfe ._deag > 0){continue ;
};var _gdeb ,_fdca ,_dff ,_ebb *page ;for _ ,_add :=range _ebdfe ._cccc {for _ ,_aef :=range _add ._afga {if _egga >=_aef ._efdc ._dbe &&_egga < _aef ._efdc ._fbdb {if _acacc >=_aef ._ceg ._dbffd &&_acacc < _aef ._ceg ._fgcg {_aef ._bdba =true ;_gdeb =_aef ;
};if _gfbc >=_aef ._ceg ._dbffd &&_gfbc < _aef ._ceg ._fgcg {_aef ._bdba =true ;_fdca =_aef ;};};if _edcf >=_aef ._efdc ._dbe &&_edcf < _aef ._efdc ._fbdb {if _acacc >=_aef ._ceg ._dbffd &&_acacc < _aef ._ceg ._fgcg {_aef ._bdba =true ;_ebb =_aef ;};if _gfbc >=_aef ._ceg ._dbffd &&_gfbc < _aef ._ceg ._fgcg {_aef ._bdba =true ;
_dff =_aef ;};};};};_fceb :=_gdeb !=_fdca ;_dfg :=_gdeb !=_ebb ;if _fceb &&_dfg {_bda :=_ebdfe ._bef [_acacc ]._bgge +_cfa .FromEMU (_dcce );_cfe :=_gdeb ._ceg ._ggad ;_dccg :=_ebdfe ._bef [_gfbc ]._bgge +_cfa .FromEMU (_cffd );_gaa :=_ebdfe ._ceac [_egga ]._cbfa +_cfa .FromEMU (_adfb );
_gga :=float64 (_gdeb ._efdc ._gfgbc );_gfgb :=_ebdfe ._ceac [_edcf ]._cbfa +_cfa .FromEMU (_dedf );_dafa :=_dccg +_cfe -_bda ;_eefa :=_gfgb +_gga -_gaa ;_cfac :=_ebdfe .imageFromAnchor (_bcgd ,_dafa ,_eefa );_gdeb ._agf =append (_gdeb ._agf ,_ebdfe .getImage (_cfac ,_eefa ,_dafa ,_bda ,_gaa ,_cfe -_bda ,_gga -_gaa ,_cd .ImgPart_lt ));
_fdca ._agf =append (_fdca ._agf ,_ebdfe .getImage (_cfac ,_eefa ,_dafa ,0,_gaa ,_cfe -_bda ,_gga -_gaa ,_cd .ImgPart_rt ));_ebb ._agf =append (_ebb ._agf ,_ebdfe .getImage (_cfac ,_eefa ,_dafa ,_bda ,0,_cfe -_bda ,_gga -_gaa ,_cd .ImgPart_lb ));_dff ._agf =append (_dff ._agf ,_ebdfe .getImage (_cfac ,_eefa ,_dafa ,0,0,_cfe -_bda ,_gga -_gaa ,_cd .ImgPart_rb ));
}else if _fceb {_ggee :=_ebdfe ._ceac [_egga ]._cbfa +_cfa .FromEMU (_adfb );_gfe :=_ebdfe ._ceac [_edcf ]._cbfa +_cfa .FromEMU (_dedf );_ffe :=_ebdfe ._bef [_acacc ]._bgge +_cfa .FromEMU (_dcce );_fbgg :=_gdeb ._ceg ._ggad ;_cgfc :=_ebdfe ._bef [_gfbc ]._bgge +_cfa .FromEMU (_cffd );
_ddfg :=_cgfc +_fbgg -_ffe ;_cgc :=_gfe -_ggee ;_fgab :=_ebdfe .imageFromAnchor (_bcgd ,_ddfg ,_cgc );_gdeb ._agf =append (_gdeb ._agf ,_ebdfe .getImage (_fgab ,_cgc ,_ddfg ,_ffe ,_ggee ,_fbgg -_ffe ,0,_cd .ImgPart_l ));_fdca ._agf =append (_fdca ._agf ,_ebdfe .getImage (_fgab ,_cgc ,_ddfg ,0,_ggee ,_fbgg -_ffe ,0,_cd .ImgPart_r ));
}else if _dfg {_gebb :=_ebdfe ._bef [_acacc ]._bgge +_cfa .FromEMU (_dcce );_efg :=_ebdfe ._bef [_gfbc ]._bgge +_cfa .FromEMU (_cffd );_dba :=_ebdfe ._ceac [_egga ]._cbfa +_cfa .FromEMU (_adfb );_dge :=float64 (_gdeb ._efdc ._gfgbc );_bfb :=_ebdfe ._ceac [_edcf ]._cbfa +_cfa .FromEMU (_dedf );
_bdb :=_efg -_gebb ;_agde :=_bfb +_dge -_dba ;_bfe :=_ebdfe .imageFromAnchor (_bcgd ,_bdb ,_agde );_gdeb ._agf =append (_gdeb ._agf ,_ebdfe .getImage (_bfe ,_agde ,_bdb ,_gebb ,_dba ,0,_dge -_dba ,_cd .ImgPart_t ));_ebb ._agf =append (_ebb ._agf ,_ebdfe .getImage (_bfe ,_agde ,_bdb ,_gebb ,0,0,_dge -_dba ,_cd .ImgPart_b ));
}else {_afa :=_ebdfe ._bef [_acacc ]._bgge +_cfa .FromEMU (_dcce );_fgc :=_ebdfe ._bef [_gfbc ]._bgge +_cfa .FromEMU (_cffd );_dac :=_ebdfe ._ceac [_egga ]._cbfa +_cfa .FromEMU (_adfb );_gfcg :=_ebdfe ._ceac [_edcf ]._cbfa +_cfa .FromEMU (_dedf );_dgd :=_fgc -_afa ;
_bbf :=_gfcg -_dac ;_gfdc :=_ebdfe .imageFromAnchor (_bcgd ,_dgd ,_bbf );_gdeb ._agf =append (_gdeb ._agf ,_ebdfe .getImage (_gfdc ,_bbf ,_dgd ,_afa ,_dac ,0,0,_cd .ImgPart_whole ));};};};func (_ffc *convertContext )drawPage (_ggbc *page ){_fde :=_ffc ._cgd ;
_agg :=_ffc ._gae ;for _ ,_fae :=range _ggbc ._cfcce {_cffa :=_ffc ._ceac [_fae ._dfd ];for _ ,_acca :=range _fae ._fbaa {var _aggg float64 ;if _fae ._dfd > 1{_aggg =_ffc ._ceac [_fae ._dfd -1]._eca ;};var _egc ,_ecd float64 ;if _ggea :=_acca ._fdee ;_ggea !=nil {_egc =_ggea ._cbfc ;
};if _dbb :=_acca ._bcaf ;_dbb !=nil {_ecd =_dbb ._cbfc ;};_ebea :=_fde +_cffa ._cbfa -0.5*(_aggg -_egc );_dbbg :=_fde +_cffa ._cbfa +_cffa ._aeabg +0.5*(_cffa ._eca +_ecd );_cga :=_agg +_acca ._fbef ;_gced :=_cga +_acca ._abg ;if _acca ._cdbc !=nil &&_acca ._cdbc !=_b .ColorBlack {_cd .FillRectangle (_ffc ._dab ,_cga ,_ebea ,_gced -_cga ,_dbbg -_ebea ,_acca ._cdbc );
};};};for _ ,_cbff :=range _ggbc ._cfcce {_dbaa :=_ffc ._ceac [_cbff ._dfd ];for _ ,_fcb :=range _cbff ._fbaa {_faa :=_fcb ._bcagg < _fcb ._fbef ;_aee :=_fcb ._aaec > _fcb ._fbef +_fcb ._bgafe ;var _cee ,_ega bool ;for _ ,_dga :=range _fcb ._dcd {for _ ,_gb :=range _dga ._cbge {if _faa &&!_cee {_cee =_gb ._ddcb < 0;
};if _aee &&!_ega {_ega =_fcb ._bgafe < _gb ._ddcb +_gb ._fdb ;};if _fcb ._fbef +_gb ._ddcb >=_fcb ._bcagg &&_fcb ._fbef +_gb ._ddcb +_gb ._fdb <=_fcb ._aaec {_fgb :=_ffc ._dab .NewStyledParagraph ();_ccb :=_agg +_fcb ._fbef +_gb ._ddcb ;_aac :=_fde +_dbaa ._cbfa +_dga ._gcce -_gb ._febg -_cccb (0.5);
_fgb .SetPos (_ccb ,_aac );var _eccc *_b .TextChunk ;if _gb ._cdba !=""{_eccc =_fgb .AddExternalLink (_gb ._ddbf ,_gb ._cdba );}else {_eccc =_fgb .Append (_gb ._ddbf );};if _gb ._ggcd !=nil {_eccc .Style =*_gb ._ggcd ;};_ffc ._dab .Draw (_fgb );};};};var _ggg ,_bgd ,_cefc ,_ggeb ,_agdc ,_fee float64 ;
var _cedc ,_fbad ,_gag ,_eaf _b .Color ;if _fdeb :=_fcb ._fdee ;_fdeb !=nil {_ggg =_fdeb ._cbfc ;_cedc =_fdeb ._fcae ;};if _fcbc :=_fcb ._bcaf ;_fcbc !=nil {_bgd =_fcbc ._cbfc ;_fbad =_fcbc ._fcae ;};if _fafg :=_fcb ._dfgb ;_fafg !=nil {_cefc =_fafg ._cbfc ;
_agdc =_cefc /2;_gag =_fafg ._fcae ;};if _ggec :=_fcb ._agec ;_ggec !=nil {_ggeb =_ggec ._cbfc ;_fee =_ggeb /2;_eaf =_ggec ._fcae ;};var _aaa float64 ;if _cbff ._dfd > 1{_aaa =_ffc ._ceac [_cbff ._dfd -1]._eca ;};_bafe :=_fde +_dbaa ._cbfa -0.5*(_aaa -_ggg );
_ggac :=_fde +_dbaa ._cbfa +_dbaa ._aeabg +0.5*(_dbaa ._eca +_bgd );_gcc :=_agg +_fcb ._fbef ;_ggcb :=_gcc +_fcb ._abg ;_cd .DrawLine (_ffc ._dab ,_gcc ,_bafe ,_ggcb ,_bafe ,_ggg ,_cedc );_cd .DrawLine (_ffc ._dab ,_gcc ,_ggac ,_ggcb ,_ggac ,_bgd ,_fbad );
if !_cee {_cd .DrawLine (_ffc ._dab ,_gcc -_agdc ,_bafe ,_gcc -_agdc ,_ggac ,_cefc ,_gag );};if !_ega {_cd .DrawLine (_ffc ._dab ,_ggcb -_fee ,_bafe ,_ggcb -_fee ,_ggac ,_ggeb ,_eaf );};};};for _ ,_abd :=range _ggbc ._agf {if _abd !=nil {_ffc ._dab .Draw (_abd );
};};};const _bc =1.5;func (_dggeg *convertContext )getStyleFromRPrElt (_beg *_bb .CT_RPrElt )*style {if _beg ==nil ||_beg .RPrEltChoice ==nil ||len (_beg .RPrEltChoice )==0{return nil ;};_fcf :=&style {};for _ ,_gdg :=range _beg .RPrEltChoice {if _gdg .RFont !=nil {_fcf ._gfbcc =&_gdg .RFont .ValAttr ;
};if _ffbc :=_gdg .B ;_ffbc !=nil {_fec :=_ffbc .ValAttr ==nil ||*_ffbc .ValAttr ;_fcf ._gef =&_fec ;};if _gcbgb :=_gdg .I ;_gcbgb !=nil {_gdaa :=_gcbgb .ValAttr ==nil ||*_gcbgb .ValAttr ;_fcf ._fgbc =&_gdaa ;};if _gfdd :=_gdg .U ;_gfdd !=nil {_deege :=_gfdd .ValAttr ==_bb .ST_UnderlineValuesSingle ||_gfdd .ValAttr ==_bb .ST_UnderlineValuesUnset ;
_fcf ._cbfg =&_deege ;};if _cdbac :=_gdg .VertAlign ;_cdbac !=nil {_fage :=_cdbac .ValAttr ==_gg .ST_VerticalAlignRunSuperscript ;_fcf ._dcga =&_fage ;_gcee :=_cdbac .ValAttr ==_gg .ST_VerticalAlignRunSubscript ;_fcf ._fgf =&_gcee ;};if _ggcg :=_gdg .Sz ;
_ggcg !=nil {_fbag :=_ggcg .ValAttr ;_fcf ._bbfd =&_fbag ;};if _dfa :=_gdg .Color ;_dfa !=nil {_fcf ._dbfc =_dggeg .getColorStringFromSmlColor (_dfa );};};return _fcf ;};func (_gdcf *convertContext )alignSymbolsVertically (_beb *cell ,_bddf _bb .ST_VerticalAlignment ){var _efd float64 ;
switch _bddf {case _bb .ST_VerticalAlignmentTop :_efd =_gge ;if _beb ._eefe {_efd -=_bc ;}else if _beb ._dabe {_efd +=4*_bc ;};for _ ,_ccea :=range _beb ._dcd {_efd +=_ccea ._eded ;_ccea ._gcce =_efd ;_efd +=_ea ;};case _bb .ST_VerticalAlignmentCenter :_bed :=0.0;
for _ ,_aeab :=range _beb ._dcd {_bed +=_aeab ._eded +_cccb (1);};_efd =0.5*(_beb ._cfde -_bed );if _beb ._eefe {_efd -=2*_bc ;}else if _beb ._dabe {_efd +=2*_bc ;};for _ ,_fbgf :=range _beb ._dcd {_efd +=_fbgf ._eded +0.5*_ea ;_fbgf ._gcce =_efd ;_efd +=0.5*_ea ;
};default:_efd =_beb ._cfde -_gge ;if _beb ._eefe {_efd -=4*_bc ;}else if _beb ._dabe {_efd +=_bc ;};for _aab :=len (_beb ._dcd )-1;_aab >=0;_aab --{_beb ._dcd [_aab ]._gcce =_efd ;_efd -=_beb ._dcd [_aab ]._eded ;_efd -=_ea ;};};};type rowspan struct{_gfgbc float64 ;
_dbe int ;_fbdb int ;};type page struct{_cfcce []*pageRow ;_bdba bool ;_agf []*_b .Image ;_ceg *pagespan ;_efdc *rowspan ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _cd .RegisterFontsFromDirectory (dirName )};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_e .PdfFont ){_cd .RegisterFont (name ,style ,font );};func (_abf *convertContext )drawSheet (){for _dad ,_bdc :=range _abf ._cccc {_gdca :=len (_bdc ._afga );if _dad ==len (_abf ._cccc )-1{for _eec :=len (_bdc ._afga )-1;
_eec >=0;_eec --{if !_bdc ._afga [_eec ]._bdba {_gdca =_eec ;};};};_eaed :=_bdc ._afga [:_gdca ];for _ ,_cfcd :=range _eaed {_abf ._dab .NewPage ();_abf .drawPage (_cfcd );};};};func (_geb *convertContext )determineMaxIndexes (){var _gdc ,_ef int ;_gdc =int (_geb ._beac .MaxColumnIdx ());
_cbbe :=_geb ._beac .Rows ();if len (_cbbe )> 0{_ef =int (_cbbe [len (_cbbe )-1].RowNumber ());};for _ ,_dbc :=range _geb ._efgee {if _dbc ._efa >=_ef {_ef =_dbc ._efa +1;};if _dbc ._cfff >=_gdc {_gdc =_dbc ._cfff +1;};};_geb ._dgdb =_ef ;_geb ._bgdb =_gdc ;
};const _ce =0.0;func (_dc *convertContext )makeMergedCells (){_ed :=[]*mergedCell {};for _ ,_dg :=range _dc ._beac .MergedCells (){_fbg ,_gded ,_baf :=_cg .ParseRangeReference (_dg .Reference ());if _baf !=nil {_gc .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_baf );
continue ;};_bgaa :=mergedCell {_fbgga :_fbg .RowIdx ,_bgae :_fbg .ColumnIdx ,_ebag :_gded .RowIdx ,_cefg :_gded .ColumnIdx };for _fbe :=_bgaa ._bgae -1;_fbe < _bgaa ._cefg ;_fbe ++{_bgaa ._fabg +=_dc ._bef [_fbe ]._dgdc ;};for _egg :=_bgaa ._fbgga -1;
_egg < _bgaa ._ebag ;_egg ++{_bgaa ._beae +=_dc ._ceac [_egg ]._aeabg ;};_ed =append (_ed ,&_bgaa );};_dc ._gccb =_ed ;};const _cb =3;const _gcb =15.0;func _bad (_bee *symbol ){_bdbc :=_b .New ();_caa :=_bdbc .NewStyledParagraph ();_caa .SetMargins (0,0,0,0);
_fca :=_caa .Append (_bee ._ddbf );if _bee ._ggcd !=nil {_fca .Style =*_bee ._ggcd ;};_bee ._febg =_caa .Height ();if _bee ._fdb ==0{_bee ._fdb =_caa .Width ();};};func (_eef *convertContext )makePages (){for _ ,_ece :=range _eef ._cccc {for _ ,_bcb :=range _eef ._gffff {_ece ._afga =append (_ece ._afga ,&page {_cfcce :[]*pageRow {},_ceg :_ece ,_efdc :_bcb });
};};};func (_eaae *convertContext )getContentFromCell (_eba *_eb .Sheet ,_cgg _eb .Cell ,_bcgdd *style ,_gcfa float64 ,_fabe ,_eecb bool )([]*line ,_bb .ST_CellType ){if _eecb {return []*line {},_bb .ST_CellTypeS ;};_gfff :=_cgg .X ();var _dcgc []*symbol ;
switch _gfff .TAttr {case _bb .ST_CellTypeS :_ceff :=_gfff .V ;if _ceff !=nil {_cddg ,_gbc :=_f .Atoi (*_ceff );if _gbc ==nil {_gcba :=_eaae ._gfcc .SharedStrings .X ().Si [_cddg ];if _gcba .T !=nil {_dcgc =_eaae .getSymbolsFromString (*_gcba .T ,_bcgdd );
}else if _gcba .R !=nil {_dcgc =_eaae .getSymbolsFromR (_gcba .R ,_bcgdd );};};};case _bb .ST_CellTypeB :_gab :=_gfff .V ;if _gab !=nil {if *_gab =="\u0030"{_dcgc =_eaae .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_bcgdd );}else {_dcgc =_eaae .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_bcgdd );
};};case _bb .ST_CellTypeStr :if _gfff .F !=nil {_aeag :=_ac .NewEvaluator ();_dea :=_eba .FormulaContext ().Cell (_cgg .Reference (),_aeag );_dcgc =_eaae .getSymbolsFromString (_dea .Value (),_bcgdd );};default:_dcgc =_eaae .getSymbolsFromString (_cgg .GetFormattedValue (),_bcgdd );
};_fbeg :=0.0;_fdce :=0.0;var _gad []*line ;var _ecfc bool ;if _bcgdd !=nil {if _bcgdd ._dcga !=nil {if *_bcgdd ._dcga {_ecfc =true ;};};if _bcgdd ._fgf !=nil {if *_bcgdd ._fgf {_ecfc =true ;};};};if _fabe {_gad =[]*line {};_ccg :=_gcfa -2*_cb ;_ggge :=[]*symbol {};
for _ ,_dfe :=range _dcgc {_bad (_dfe );if _fbeg +_dfe ._fdb >=_ccg {_cecb :=_feea (_ggge );if _ecfc {_cecb /=_ag ;};_gad =append (_gad ,&line {_gcce :_fdce ,_cbge :_ggge ,_eded :_cecb });_ggge =[]*symbol {_dfe };_fbeg =_dfe ._fdb ;_fdce +=_cecb ;}else {_dfe ._ddcb =_fbeg ;
_fbeg +=_dfe ._fdb ;_ggge =append (_ggge ,_dfe );};};_eeeab :=_feea (_ggge );if _ecfc {_eeeab /=_ag ;};if len (_ggge )> 0{_gad =append (_gad ,&line {_gcce :_fdce ,_cbge :_ggge ,_eded :_eeeab });};}else {for _ ,_bgfg :=range _dcgc {_bad (_bgfg );_bgfg ._ddcb =_fbeg ;
_fbeg +=_bgfg ._fdb ;};if len (_dcgc )> 0{_gad =[]*line {&line {_cbge :_dcgc ,_eded :_feea (_dcgc )}};};};_cecg :=_gfff .TAttr ;if _cecg ==_bb .ST_CellTypeUnset {_cecg =_bb .ST_CellTypeN ;};return _gad ,_cecg ;};func (_cbba *convertContext )makeCols (){_dbf :=_cbba ._beac ;
_eed :=_dbf .X ();_ggc :=[]*colInfo {};_cef :=[]colWidthRange {};if _bfd :=_eed .Cols ;len (_bfd )> 0{for _ ,_eaa :=range _bfd [0].Col {_cc :=_d ;if _fge :=_eaa .WidthAttr ;_fge !=nil {if *_fge > 0.83{*_fge -=0.83;};if *_fge <=1{_cc =*_fge *11;}else {_cc =5+*_fge *6;
};};_gff :=int (_eaa .MinAttr -1);_bea :=int (_eaa .MaxAttr -1);_cef =append (_cef ,colWidthRange {_effc :_gff ,_agce :_bea ,_deeg :_cc ,_dca :_cbba .getStyle (_eaa .StyleAttr )});};};_gdf :=0;for _fac :=0;_fac <=_cbba ._bgdb ;_fac ++{if _fac < _cbba ._ebgc ||(_fac > _cbba ._deag &&_cbba ._deag > 0){continue ;
};var _ffg float64 ;var _ggb *style ;if len (_cef )==0{_ffg =_d ;}else if _gdf < len (_cef ){_fda :=_cef [_gdf ];if _fac >=_fda ._effc &&_fac <=_fda ._agce {_ffg =_fda ._deeg ;_ggb =_fda ._dca ;if _fac ==_fda ._agce {_gdf ++;};}else {continue ;};};_ggc =append (_ggc ,&colInfo {_dgdc :_ffg ,_egab :_ggb });
};_bgaf :=0.0;for _ ,_bbe :=range _ggc {_bgaf +=_bbe ._dgdc ;};_cbba ._gbe =1.0;if _bgaf > _cbba ._fbf {_cbba ._gbe =_cbba ._fbf /_bgaf ;for _ ,_bca :=range _ggc {_bca ._dgdc *=_cbba ._gbe ;};};_cbba ._bef =_ggc ;};const _ag =0.64;var _cbb =3.025/_cccb (1);
type cell struct{_fcdf _bb .ST_CellType ;_gdae int ;_fbef float64 ;_dcd []*line ;_bgafe float64 ;_abg float64 ;_cfde float64 ;_bcagg float64 ;_aaec float64 ;_ccbg *_b .TextStyle ;_fdee *border ;_bcaf *border ;_dfgb *border ;_agec *border ;_eefe bool ;_dabe bool ;
_cdbc _b .Color ;};func _ecdf (_dgg []*symbol )float64 {_eecc :=0.0;for _ ,_gaaf :=range _dgg {_eecc +=_gaaf ._fdb ;};return _eecc ;};func (_faab *convertContext )getColorStringFromSmlColor (_gbgb *_bb .CT_Color )*string {var _dacg string ;if _gbgb .RgbAttr !=nil {_dacg =*_gbgb .RgbAttr ;
}else if _gbgb .IndexedAttr !=nil &&*_gbgb .IndexedAttr < 64{_dacg =_eccce [*_gbgb .IndexedAttr ];}else if _gbgb .ThemeAttr !=nil {_fdfga :=*_gbgb .ThemeAttr ;_dacg =_faab .getColorFromTheme (_fdfga );};if _dacg ==""{return nil ;};if len (_dacg )> 6{_dacg =_dacg [(len (_dacg )-6):];
};if _gbgb .TintAttr !=nil {_gagd :=*_gbgb .TintAttr ;_dacg =_cd .AdjustColorByTint (_dacg ,_gagd );};_dacg ="\u0023"+_dacg ;return &_dacg ;};func (_ada *convertContext )imageFromAnchor (_dec *anchor ,_ecff ,_bab float64 )_a .Image {if _dec ._cgda !=nil {return _dec ._cgda ;
};if _dec ._cfba !=nil {_acf ,_afad :=_cd .MakeImageFromChartSpace (_dec ._cfba ,_ecff ,_bab ,_ada ._bffb ,_ada ._gfcc );if _afad !=nil {_gc .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_afad );
return nil ;};return _acf ;};return nil ;};type symbol struct{_ddbf string ;_ddcb float64 ;_febg float64 ;_fdb float64 ;_ggcd *_b .TextStyle ;_cdba string ;};type mergedCell struct{_fbgga uint32 ;_bgae uint32 ;_ebag uint32 ;_cefg uint32 ;_fabg float64 ;
_beae float64 ;};

// ConvertToPdfWithOptions convert a sheet to PDF with given options.
func ConvertToPdfWithOptions (s *_eb .Sheet ,opts *Options )*_b .Creator {_ebc :=s .X ();if _ebc ==nil {return nil ;};var _da _b .PageSize ;_eg :=true ;_bce :=false ;if _ebc .SheetPr !=nil &&_ebc .SheetPr .PageSetUpPr !=nil &&_ebc .SheetPr .PageSetUpPr .FitToPageAttr !=nil &&*_ebc .SheetPr .PageSetUpPr .FitToPageAttr {_bce =true ;
};if _ba :=_ebc .PageSetup ;_ba !=nil {_eg =_ba .OrientationAttr ==_bb .ST_OrientationLandscape ;if _gd :=_ba .PaperSizeAttr ;_gd !=nil {_da =_cagf [*_gd ];};};if (_da ==_b .PageSize {}){_da =_cd .GetDefaultPageSize ();if opts !=nil &&opts .DefaultPageSize !=_cd .DefaultPageSize {_da =_cd .GetPageDimensions (opts .DefaultPageSize );
};};if _eg {_da [0],_da [1]=_da [1],_da [0];};_ebd :=_b .New ();_ebd .SetPageSize (_da );var _be ,_fg ,_ca ,_fe float64 ;if _db :=_ebc .PageMargins ;_db !=nil {_ca =_db .LeftAttr ;_fe =_db .RightAttr ;_be =_db .TopAttr ;_fg =_db .BottomAttr ;};if _ca < _age {_ca =_age ;
};if _fe < _age {_fe =_age ;};if _be < _ce {_be =_ce ;};if _fg < _ce {_fg =_ce ;};_be *=_cfa .Inch ;_fg *=_cfa .Inch ;_ca *=_cfa .Inch ;_fe *=_cfa .Inch ;_ebd .SetPageMargins (_ca ,_fe ,_be ,_fg );_fad :=s .Workbook ();var _gca *_fa .Theme ;if len (_fad .Themes ())> 0{_gca =_fad .Themes ()[0];
};var _cba ,_abc ,_ffb ,_ebde int ;for _ ,_ffa :=range _fad .DefinedNames (){if _ffa .Name ()=="\u005f\u0078l\u006e\u006d\u002eP\u0072\u0069\u006e\u0074\u005f\u0041\u0072\u0065\u0061"{_bbd ,_bf ,_ee ,_bcee :=_cd .ParseExcelRange (_ffa .Content ());if _bcee ==nil &&s .Name ()==_bbd {_cba =int (_bf .ColumnIdx );
_abc =int (_ee .ColumnIdx );_ffb =int (_bf .RowIdx );_ebde =int (_ee .RowIdx );};};};_bg :=[]_eb .Table {};if _ebc .TableParts !=nil &&_ebc .TableParts .TablePart !=nil {_fga :=0;_cae :=s .Workbook ().Tables ();_cf .Slice (_cae [:],func (_dd ,_gf int )bool {return _cae [_dd ].X ().IdAttr < _cae [_gf ].X ().IdAttr });
for _ ,_eee :=range s .Workbook ().Sheets (){if _eee .Name ()==s .Name (){break ;}else {if _eee .X ().TableParts !=nil &&_eee .X ().TableParts .TablePart !=nil {_fga +=len (_eee .X ().TableParts .TablePart );};};};if len (_cae )>=_fga +len (_ebc .TableParts .TablePart ){_bg =append (_bg ,_cae [_fga :_fga +len (_ebc .TableParts .TablePart )]...);
};};_agd :=&convertContext {_dab :_ebd ,_beac :s ,_gfcc :s .Workbook (),_bffb :_gca ,_fbc :&s .Workbook ().StyleSheet ,_cgd :_be ,_gae :_ca ,_ffbac :_da [1]-_fg -_be ,_fbf :_da [0]-_fe -_ca ,_ebgc :_cba ,_deag :_abc ,_afdg :_ffb ,_fag :_ebde ,_fef :_bce ,_cbg :_bg };
_agd .makeAnchors ();_agd .determineMaxIndexes ();if _agd ._dgdb ==0&&_agd ._bgdb ==0{_ebd .NewPage ();return _ebd ;};_agd .makeCols ();_agd .makeRows ();_agd .makeMergedCells ();_agd .makeCells ();_agd .makePagespans ();_agd .makeRowspans ();_agd .makePages ();
_agd .fillPages ();_agd .distributeAnchors ();_agd .drawSheet ();return _ebd ;};

// Options contains the options for convert process
type Options struct{

// DefaultPageSize is applied when there is no page size explicitly set in the document.
// A4 is the default option.
DefaultPageSize _cd .PageSize ;};func (_feb *convertContext )makeRowspans (){var _aea float64 ;_cbe :=0;for _gfd ,_gfgg :=range _feb ._ceac {_gfb :=_gfgg ._aeabg +_gfgg ._eca ;if _aea +_gfb <=_feb ._ffbac {_gfgg ._cbfa =_aea ;_aea +=_gfb ;}else {_feb ._gffff =append (_feb ._gffff ,&rowspan {_gfgbc :_aea ,_dbe :_cbe ,_fbdb :_gfd });
_cbe =_gfd ;_gfgg ._cbfa =0;_aea =_gfb ;};};_feb ._gffff =append (_feb ._gffff ,&rowspan {_gfgbc :_aea ,_dbe :_cbe ,_fbdb :len (_feb ._ceac )});};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_cd .FontStyle ;var _eccce =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};
func (_fgbb *convertContext )getSymbolsFromString (_cfb string ,_cgfd *style )[]*symbol {_gaf :=[]*symbol {};_bbee :=_fgbb .makeTextStyleFromCellStyle (_cgfd );for _ ,_ede :=range _cfb {_gaf =append (_gaf ,&symbol {_ddbf :string (_ede ),_ggcd :_bbee });
};return _gaf ;};var _cagf =map[uint32 ]_b .PageSize {1:_b .PageSize {8.5*_cfa .Inch ,11*_cfa .Inch },2:_b .PageSize {8.5*_cfa .Inch ,11*_cfa .Inch },3:_b .PageSize {11*_cfa .Inch ,17*_cfa .Inch },4:_b .PageSize {17*_cfa .Inch ,11*_cfa .Inch },5:_b .PageSize {8.5*_cfa .Inch ,14*_cfa .Inch },6:_b .PageSize {5.5*_cfa .Inch ,8.5*_cfa .Inch },7:_b .PageSize {7.5*_cfa .Inch ,10*_cfa .Inch },8:_b .PageSize {_cccb (297),_cccb (420)},9:_b .PageSize {_cccb (210),_cccb (297)},10:_b .PageSize {_cccb (210),_cccb (297)},11:_b .PageSize {_cccb (148),_cccb (210)},70:_b .PageSize {_cccb (105),_cccb (148)},12:_b .PageSize {_cccb (250),_cccb (354)},13:_b .PageSize {_cccb (182),_cccb (257)},14:_b .PageSize {8.5*_cfa .Inch ,13*_cfa .Inch },20:_b .PageSize {4.125*_cfa .Inch ,9.5*_cfa .Inch },27:_b .PageSize {_cccb (110),_cccb (220)},28:_b .PageSize {_cccb (162),_cccb (229)},34:_b .PageSize {_cccb (250),_cccb (176)},29:_b .PageSize {_cccb (324),_cccb (458)},30:_b .PageSize {_cccb (229),_cccb (324)},31:_b .PageSize {_cccb (114),_cccb (162)},37:_b .PageSize {3.88*_cfa .Inch ,7.5*_cfa .Inch },43:_b .PageSize {_cccb (100),_cccb (148)},69:_b .PageSize {_cccb (200),_cccb (148)}};
type border struct{_cbfc float64 ;_fcae _b .Color ;};func _edcg (_gdea ,_dcgce *style ){if _dcgce ==nil {return ;};if _gdea ==nil {_gdea =_dcgce ;return ;};if _gdea ._dggc ==nil {_gdea ._dggc =_dcgce ._dggc ;};if _gdea ._gfbcc ==nil {_gdea ._gfbcc =_dcgce ._gfbcc ;
};if _gdea ._dbfc ==nil {_gdea ._dbfc =_dcgce ._dbfc ;};if _gdea ._bbfd ==nil {_gdea ._bbfd =_dcgce ._bbfd ;};if _gdea ._gef ==nil {_gdea ._gef =_dcgce ._gef ;};if _gdea ._fgbc ==nil {_gdea ._fgbc =_dcgce ._fgbc ;};if _gdea ._cbfg ==nil {_gdea ._cbfg =_dcgce ._cbfg ;
};if _gdea ._dcga ==nil {_gdea ._dcga =_dcgce ._dcga ;};if _gdea ._fgf ==nil {_gdea ._fgf =_dcgce ._fgf ;};if _gdea ._dgge ==nil {_gdea ._dgge =_dcgce ._dgge ;};if _gdea ._gbcg ==nil {_gdea ._gbcg =_dcgce ._gbcg ;};if _gdea ._bfac ==nil {_gdea ._bfac =_dcgce ._bfac ;
};if _gdea ._gfaf ==nil {_gdea ._gfaf =_dcgce ._gfaf ;};if _gdea ._bbad ==_bb .ST_VerticalAlignmentUnset {_gdea ._bbad =_dcgce ._bbad ;};if _gdea ._ffce ==_bb .ST_HorizontalAlignmentUnset {_gdea ._ffce =_dcgce ._ffce ;};};type colInfo struct{_bgge float64 ;
_dgdc float64 ;_egab *style ;};func (_bff *convertContext )addRowToPage (_gdff []*cell ,_dfc int ){_cbef :=0.0;_fcbb :=_bff ._fbf ;for _ ,_cdg :=range _gdff {if len (_cdg ._dcd )!=0{_cdg ._bcagg =_cbef ;_cbef =_cdg ._fbef +_cdg ._bgafe ;};};for _dbaf :=len (_gdff )-1;
_dbaf >=0;_dbaf --{_afge :=_gdff [_dbaf ];if len (_afge ._dcd )!=0{_afge ._aaec =_fcbb ;_fcbb =_afge ._fbef ;};};_bff ._ccca ._cfcce =append (_bff ._ccca ._cfcce ,&pageRow {_dfd :_dfc ,_fbaa :_gdff });};type pageRow struct{_dfd int ;_fbaa []*cell ;};func (_abb *convertContext )makeTextStyleFromCellStyle (_bcaggc *style )*_b .TextStyle {_acada :=_abb ._dab .NewTextStyle ();
if _bcaggc ==nil {_acada .FontSize =_cd .DefaultFontSize ;_acada .Font =_cd .AssignStdFontByName (_acada ,_cd .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_acada ;};if _abbc (_bcaggc ._cbfg ){_acada .Underline =true ;
_acada .UnderlineStyle =_b .TextDecorationLineStyle {Offset :0.5,Thickness :_cccb (1/32)};};var _aad FontStyle ;if _abbc (_bcaggc ._gef )&&_abbc (_bcaggc ._fgbc ){_aad =FontStyle_BoldItalic ;}else if _abbc (_bcaggc ._gef ){_aad =FontStyle_Bold ;}else if _abbc (_bcaggc ._fgbc ){_aad =FontStyle_Italic ;
}else {_aad =FontStyle_Regular ;};_bfef :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _bcaggc ._gfbcc !=nil {_bfef =*_bcaggc ._gfbcc ;};if _aabc ,_caaf :=_cd .StdFontsMap [_bfef ];_caaf {_acada .Font =_cd .AssignStdFontByName (_acada ,_aabc [_aad ]);}else if _bgbf :=_cd .GetRegisteredFont (_bfef ,_aad );
_bgbf !=nil {_acada .Font =_bgbf ;}else {_gc .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_bfef ,_aad );
_acada .Font =_cd .AssignStdFontByName (_acada ,_cd .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_aad ]);};if _bcaggc ._bbfd !=nil {_acada .FontSize =_g .Round (*_bcaggc ._bbfd *_abb ._gbe );};if _bcaggc ._dbfc !=nil {_acada .Color =_b .ColorRGBFromHex (*_bcaggc ._dbfc );
};if _bcaggc ._dcga !=nil &&*_bcaggc ._dcga {_acada .FontSize *=_ag ;}else if _bcaggc ._fgf !=nil &&*_bcaggc ._fgf {_acada .FontSize *=_ag ;};return &_acada ;};var _df =_cccb (0.0625);func (_cccd *convertContext )getBorder (_edfd *_bb .CT_BorderPr )*border {_fdfa :=&border {};
switch _edfd .StyleAttr {case _bb .ST_BorderStyleHair :_fdfa ._cbfc =_df /2;case _bb .ST_BorderStyleThin :_fdfa ._cbfc =_df ;case _bb .ST_BorderStyleMedium :_fdfa ._cbfc =_df *2;case _bb .ST_BorderStyleThick :_fdfa ._cbfc =_df *4;};if _fdfa ._cbfc ==0.0{return nil ;
};if _afgc :=_edfd .Color ;_afgc !=nil {_gabe :=_cccd .getColorStringFromSmlColor (_afgc );if _gabe !=nil {_fdfa ._fcae =_b .ColorRGBFromHex (*_gabe );}else {_fdfa ._fcae =_b .ColorBlack ;};};return _fdfa ;};func (_acea *convertContext )getStyleFromCell (_bafc _eb .Cell ,_dae ,_gfef ,_dabb *style )*style {if _dabb !=nil {_edcg (_dabb ,_dae );
_edcg (_dabb ,_gfef );return _dabb ;};_ecfb :=_bafc .X ();_fdfg :=_acea .getStyle (_ecfb .SAttr );_edcg (_fdfg ,_dae );_edcg (_fdfg ,_gfef );return _fdfg ;};const _gge =2;const _age =0.25;const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;
FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func (_dbfb *convertContext )getDxfStyle (_cbc *uint32 )*style {_abfd :=&style {};_fdcag :=false ;if _cbc !=nil {var _bde *_bb .CT_Dxf ;for _dgc ,_abce :=range _dbfb ._fbc .X ().Dxfs .Dxf {if uint32 (_dgc )==*_cbc {_bde =_abce ;
};};if _bde ==nil {return nil ;};if _bde .Fill !=nil &&_bde .Fill .FillChoice !=nil &&_bde .Fill .FillChoice .PatternFill !=nil {if _bde .Fill .FillChoice .PatternFill .FgColor !=nil {_abfd ._dggc =_dbfb .getColorStringFromSmlColor (_bde .Fill .FillChoice .PatternFill .FgColor );
}else if _bde .Fill .FillChoice .PatternFill .BgColor !=nil {_abfd ._dggc =_dbfb .getColorStringFromSmlColor (_bde .Fill .FillChoice .PatternFill .BgColor );};};_dce :=_bde .Font ;for _ ,_cbgec :=range _dce .FontChoice {if _cbgec .Name !=nil {_abfd ._gfbcc =&_cbgec .Name .ValAttr ;
_fdcag =true ;}else if _cbgec .B !=nil {_dbcd :=_cbgec .B .ValAttr ==nil ||*_cbgec .B .ValAttr ;_abfd ._gef =&_dbcd ;_fdcag =true ;}else if _cbgec .I !=nil {_bebc :=_cbgec .I .ValAttr ==nil ||*_cbgec .I .ValAttr ;_abfd ._fgbc =&_bebc ;_fdcag =true ;}else if _cbgec .U !=nil {_gcd :=_cbgec .U .ValAttr ==_bb .ST_UnderlineValuesSingle ||_cbgec .U .ValAttr ==_bb .ST_UnderlineValuesUnset ;
_abfd ._cbfg =&_gcd ;_fdcag =true ;}else if _cbgec .Sz !=nil {_ggcbg :=_cbgec .Sz .ValAttr ;_abfd ._bbfd =&_ggcbg ;_fdcag =true ;}else if _cbgec .VertAlign !=nil {_dde :=_cbgec .VertAlign .ValAttr ==_gg .ST_VerticalAlignRunSuperscript ;_abfd ._dcga =&_dde ;
_gfda :=_cbgec .VertAlign .ValAttr ==_gg .ST_VerticalAlignRunSubscript ;_abfd ._fgf =&_gfda ;_fdcag =true ;}else if _cbgec .Color !=nil {_abfd ._dbfc =_dbfb .getColorStringFromSmlColor (_cbgec .Color );_fdcag =true ;};};_efgg :=_bde .Border ;if _efgg !=nil {if _efgg .Top !=nil {_abfd ._dgge =_dbfb .getBorder (_efgg .Top );
_fdcag =true ;};if _efgg .Bottom !=nil {_abfd ._gbcg =_dbfb .getBorder (_efgg .Bottom );_fdcag =true ;};if _efgg .Left !=nil {_abfd ._bfac =_dbfb .getBorder (_efgg .Left );_fdcag =true ;};if _efgg .Right !=nil {_abfd ._gfaf =_dbfb .getBorder (_efgg .Right );
_fdcag =true ;};};if _bde .Alignment !=nil {if _bbcb :=_bde .Alignment .VerticalAttr ;_bbcb !=_bb .ST_VerticalAlignmentUnset {_abfd ._bbad =_bbcb ;_fdcag =true ;};if _faef :=_bde .Alignment .HorizontalAttr ;_faef !=_bb .ST_HorizontalAlignmentUnset {_abfd ._ffce =_faef ;
_fdcag =true ;};};};if _fdcag {return _abfd ;};return nil ;};func (_cbf *convertContext )fillPages (){for _aed ,_bgb :=range _cbf ._gffff {_acaa :=_cbf ._ceac [_bgb ._dbe :_bgb ._fbdb ];for _dfb ,_fba :=range _acaa {_ged :=0;_bbeg :=0.0;_fdcd :=[]*cell {};
if _fba ._bcf {for _ ,_eac :=range _fba ._fcbba {_bgfd :=_cbf ._cccc [_ged ];_cbf ._ccca =_bgfd ._afga [_aed ];_cbf ._ccca ._bdba =true ;_gfa :=_eac ._abg ;if _bbeg +_gfa > _bgfd ._ggad {_cbf .addRowToPage (_fdcd ,_dfb );_fdcd =[]*cell {_eac };_bbeg =_gfa ;
_ged ++;}else {_eac ._fbef =_bbeg ;_fdcd =append (_fdcd ,_eac );_bbeg +=_gfa ;};};if len (_fdcd )> 0{_aae :=_cbf ._cccc [_ged ];_cbf ._ccca =_aae ._afga [_aed ];_cbf ._ccca ._bdba =true ;_cbf .addRowToPage (_fdcd ,_dfb );};};};};};type colWidthRange struct{_effc int ;
_agce int ;_deeg float64 ;_dca *style ;};func _feea (_gggec []*symbol )float64 {_aeagg :=0.0;for _ ,_gggf :=range _gggec {if _gggf ._febg > _aeagg {_aeagg =_gggf ._febg ;};};return _aeagg ;};func (_ege *convertContext )makeAnchors (){_bgg ,_cbae :=_ege ._beac .GetDrawing ();
if _bgg !=nil {for _ ,_de :=range _bgg .EG_Anchor {_cec :=&anchor {};if _cdc :=_de .AnchorChoice .TwoCellAnchor ;_cdc !=nil {_gde ,_cea :=_cdc .From ,_cdc .To ;if _gde ==nil ||_cea ==nil {return ;};_cec ._cafb =int (_gde .Row );_cec ._edb =_cd .FromSTCoordinate (_gde .RowOff );
_cec ._gfdg =int (_gde .Col );_cec ._fgag =_cd .FromSTCoordinate (_gde .ColOff );_cec ._efa =int (_cea .Row );_cec ._dgb =_cd .FromSTCoordinate (_cea .RowOff );_cec ._cfff =int (_cea .Col );_cec ._bgfgc =_cd .FromSTCoordinate (_cea .ColOff );if _gcbg :=_cdc .ObjectChoicesChoice ;
_gcbg !=nil {if _fd :=_gcbg .Pic ;_fd !=nil {if _ae :=_fd .BlipFill ;_ae !=nil {if _ebe :=_ae .Blip ;_ebe !=nil {if _ec :=_ebe .EmbedAttr ;_ec !=nil {for _ ,_af :=range _cbae .X ().Relationship {if _af .IdAttr ==*_ec {for _ ,_gfg :=range _ege ._gfcc .Images {if _gfg .Target ()==_af .TargetAttr {_bfa ,_cdb :=_ff .Open (_gfg .Path ());
if _cdb !=nil {_gc .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_cdb );continue ;};_cff ,_ ,_cdb :=_a .Decode (_bfa );if _cdb !=nil {_gc .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_cdb );
continue ;};_cec ._cgda =_cff ;};};};};};};};}else if _ebdf :=_gcbg .GraphicFrame ;_ebdf !=nil {if _fdg :=_ebdf .Graphic ;_fdg !=nil {if _ddc :=_fdg .GraphicData ;_ddc !=nil {for _ ,_aa :=range _ddc .Any {if _gda ,_ebdg :=_aa .(*_ab .Chart );_ebdg {for _ ,_ge :=range _cbae .X ().Relationship {if _ge .IdAttr ==_gda .IdAttr {_bfg :=_ege ._gfcc .GetChartByTargetId (_ge .TargetAttr );
if _bfg !=nil {_cec ._cfba =_bfg ;};};};};};};};};};};if _cec ._cgda !=nil ||_cec ._cfba !=nil {_ege ._efgee =append (_ege ._efgee ,_cec );};};};};func _cccb (_ccf float64 )float64 {return _ccf *_cfa .Millimeter };type anchor struct{_cgda _a .Image ;_cfba *_ab .ChartSpace ;
_cafb int ;_edb int64 ;_gfdg int ;_fgag int64 ;_efa int ;_dgb int64 ;_cfff int ;_bgfgc int64 ;};type rowInfo struct{_cbfa float64 ;_bcf bool ;_aeabg float64 ;_aedf *style ;_fcbba []*cell ;_eca float64 ;};type style struct{_dggc *string ;_dbfc *string ;
_bbfd *float64 ;_gfbcc *string ;_gef *bool ;_fgbc *bool ;_cbfg *bool ;_dcga *bool ;_fgf *bool ;_dgge *border ;_gbcg *border ;_bfac *border ;_gfaf *border ;_ggfd bool ;_bbad _bb .ST_VerticalAlignment ;_ffce _bb .ST_HorizontalAlignment ;_abfa bool ;};var _ea =_cccb (1);
func (_ggd *convertContext )combineCellStyleWithRPrElt (_bdaf *style ,_dcbd *_bb .CT_RPrElt )*style {_ddee :=*_bdaf ;_fgg :=_ggd .getStyleFromRPrElt (_dcbd );if _fgg ==nil {return &_ddee ;};if _fgg ._dbfc !=nil {_ddee ._dbfc =_fgg ._dbfc ;};if _fgg ._bbfd !=nil {_ddee ._bbfd =_fgg ._bbfd ;
};if _fgg ._gfbcc !=nil {_ddee ._gfbcc =_fgg ._gfbcc ;};if _fgg ._gef !=nil {_ddee ._gef =_fgg ._gef ;};if _fgg ._fgbc !=nil {_ddee ._fgbc =_fgg ._fgbc ;};if _fgg ._cbfg !=nil {_ddee ._cbfg =_fgg ._cbfg ;};if _fgg ._dcga !=nil {_ddee ._dcga =_fgg ._dcga ;
};if _fgg ._fgf !=nil {_ddee ._fgf =_fgg ._fgf ;};return &_ddee ;};func (_egd *convertContext )getSymbolsFromR (_abe []*_bb .CT_RElt ,_fbede *style )[]*symbol {_ecdd :=[]*symbol {};for _ ,_dgee :=range _abe {_gacc :=_egd .combineCellStyleWithRPrElt (_fbede ,_dgee .RPr );
for _ ,_fedd :=range _dgee .T {_ecdd =append (_ecdd ,&symbol {_ddbf :string (_fedd ),_ggcd :_egd .makeTextStyleFromCellStyle (_gacc )});};};return _ecdd ;};type pagespan struct{_ggad float64 ;_afga []*page ;_dbffd int ;_fgcg int ;};func (_fgfc *convertContext )getStyle (_gdfb *uint32 )*style {_accab :=&style {};
_bfgd :=false ;if _gdfb !=nil {_cccce :=_fgfc ._fbc .GetCellStyle (*_gdfb );if _fgfc ._fbc .GetNumberFormat (_cccce .NumberFormat ()).GetFormat ()=="\u003b\u003b\u003b"{_accab ._abfa =true ;};_gfec :=_cccce .GetFill ();if _gfec !=nil &&_gfec .FillChoice !=nil &&_gfec .FillChoice .PatternFill !=nil {if _gfec .FillChoice .PatternFill .FgColor !=nil {_accab ._dggc =_fgfc .getColorStringFromSmlColor (_gfec .FillChoice .PatternFill .FgColor );
}else if _gfec .FillChoice .PatternFill .BgColor !=nil {_accab ._dggc =_fgfc .getColorStringFromSmlColor (_gfec .FillChoice .PatternFill .BgColor );};};_gdfe :=_cccce .GetFont ();for _ ,_fgac :=range _gdfe .FontChoice {if _fgac .Name !=nil {_accab ._gfbcc =&_fgac .Name .ValAttr ;
_bfgd =true ;}else if _fgac .B !=nil {_ddcbe :=_fgac .B .ValAttr ==nil ||*_fgac .B .ValAttr ;_accab ._gef =&_ddcbe ;_bfgd =true ;}else if _fgac .I !=nil {_cad :=_fgac .I .ValAttr ==nil ||*_fgac .I .ValAttr ;_accab ._fgbc =&_cad ;_bfgd =true ;}else if _fgac .U !=nil {_ecae :=_fgac .U .ValAttr ==_bb .ST_UnderlineValuesSingle ||_fgac .U .ValAttr ==_bb .ST_UnderlineValuesUnset ;
_accab ._cbfg =&_ecae ;_bfgd =true ;}else if _fgac .Sz !=nil {_afaa :=_fgac .Sz .ValAttr ;_accab ._bbfd =&_afaa ;_bfgd =true ;}else if _fgac .VertAlign !=nil {_dag :=_fgac .VertAlign .ValAttr ==_gg .ST_VerticalAlignRunSuperscript ;_accab ._dcga =&_dag ;
_gbg :=_fgac .VertAlign .ValAttr ==_gg .ST_VerticalAlignRunSubscript ;_accab ._fgf =&_gbg ;_bfgd =true ;}else if _fgac .Color !=nil {_accab ._dbfc =_fgfc .getColorStringFromSmlColor (_fgac .Color );_bfgd =true ;};};_bbb :=_cccce .GetBorder ();if _bbb .Top !=nil {_accab ._dgge =_fgfc .getBorder (_bbb .Top );
_bfgd =true ;};if _bbb .Bottom !=nil {_accab ._gbcg =_fgfc .getBorder (_bbb .Bottom );_bfgd =true ;};if _bbb .Left !=nil {_accab ._bfac =_fgfc .getBorder (_bbb .Left );_bfgd =true ;};if _bbb .Right !=nil {_accab ._gfaf =_fgfc .getBorder (_bbb .Right );
_bfgd =true ;};if _cccce .Wrapped (){_accab ._ggfd =true ;_bfgd =true ;};if _bfba :=_cccce .GetVerticalAlignment ();_bfba !=_bb .ST_VerticalAlignmentUnset {_accab ._bbad =_bfba ;_bfgd =true ;};if _dbg :=_cccce .GetHorizontalAlignment ();_dbg !=_bb .ST_HorizontalAlignmentUnset {_accab ._ffce =_dbg ;
_bfgd =true ;};};if _bfgd {return _accab ;};return nil ;};const _d =64.0;