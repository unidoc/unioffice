//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_e "github.com/unidoc/unioffice/v2/common/logger";_bee "github.com/unidoc/unioffice/v2/common/tempstorage";_gg "github.com/unidoc/unioffice/v2/internal/convertutils";_ff "github.com/unidoc/unioffice/v2/measurement";_cd "github.com/unidoc/unioffice/v2/schema/soo/dml";
_gd "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_cg "github.com/unidoc/unioffice/v2/schema/soo/ofc/sharedTypes";_ad "github.com/unidoc/unioffice/v2/schema/soo/sml";_fg "github.com/unidoc/unioffice/v2/spreadsheet";_ac "github.com/unidoc/unioffice/v2/spreadsheet/formula";
_g "github.com/unidoc/unioffice/v2/spreadsheet/reference";_ed "github.com/unidoc/unipdf/v4/creator";_be "github.com/unidoc/unipdf/v4/model";_f "image";_fc "math";_c "sort";_a "strconv";);const _ca =64.0;func (_cfa *convertContext )alignSymbolsHorizontally (_cdaa *cell ,_gfbb _ad .ST_HorizontalAlignment ){if _gfbb ==_ad .ST_HorizontalAlignmentUnset {switch _cdaa ._bbbc {case _ad .ST_CellTypeB :_gfbb =_ad .ST_HorizontalAlignmentCenter ;
case _ad .ST_CellTypeN :_gfbb =_ad .ST_HorizontalAlignmentRight ;default:_gfbb =_ad .ST_HorizontalAlignmentLeft ;};};var _ebc float64 ;for _ ,_gdcc :=range _cdaa ._beee {switch _gfbb {case _ad .ST_HorizontalAlignmentLeft :_ebc =_cf ;case _ad .ST_HorizontalAlignmentRight :_fagdd :=_daac (_gdcc ._bgbb );
_ebc =_cdaa ._efc -_cf -_fagdd ;case _ad .ST_HorizontalAlignmentCenter :_efaa :=_daac (_gdcc ._bgbb );_ebc =(_cdaa ._efc -_efaa )/2;};for _ ,_ccbb :=range _gdcc ._bgbb {_ccbb ._dcbg +=_ebc ;};};};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_fg .Sheet )*_ed .Creator {return ConvertToPdfWithOptions (s ,nil )};var _ggg =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};
func _cce (_cagc *bool )bool {return _cagc !=nil &&*_cagc };type pagespan struct{_abdf float64 ;_aadc []*page ;_agec int ;_efgd int ;};type rowInfo struct{_gfae float64 ;_ggc bool ;_bagd float64 ;_gaf *style ;_bgbg []*cell ;_ged float64 ;};const _fb =0.25;
func (_afa *convertContext )getContentFromCell (_cbcf *_fg .Sheet ,_aefe _fg .Cell ,_egba *style ,_egca float64 ,_bcf ,_bea bool )([]*line ,_ad .ST_CellType ){if _bea {return []*line {},_ad .ST_CellTypeS ;};_fgeb :=_aefe .X ();var _fggb []*symbol ;switch _fgeb .TAttr {case _ad .ST_CellTypeS :_fcde :=_fgeb .V ;
if _fcde !=nil {_fdg ,_gfaa :=_a .Atoi (*_fcde );if _gfaa ==nil {_afcd :=_afa ._cfdb .SharedStrings .X ().Si [_fdg ];if _afcd .T !=nil {_fggb =_afa .getSymbolsFromString (*_afcd .T ,_egba );}else if _afcd .R !=nil {_fggb =_afa .getSymbolsFromR (_afcd .R ,_egba );
};};};case _ad .ST_CellTypeB :_cbed :=_fgeb .V ;if _cbed !=nil {if *_cbed =="\u0030"{_fggb =_afa .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_egba );}else {_fggb =_afa .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_egba );};};case _ad .ST_CellTypeStr :if _fgeb .F !=nil {_gdfg :=_ac .NewEvaluator ();
_bafd :=_cbcf .FormulaContext ().Cell (_aefe .Reference (),_gdfg );_fggb =_afa .getSymbolsFromString (_bafd .Value (),_egba );};default:_fggb =_afa .getSymbolsFromString (_aefe .GetFormattedValue (),_egba );};_gdbg :=0.0;_cbaca :=0.0;var _dfg []*line ;
var _eb bool ;if _egba !=nil {if _egba ._afbb !=nil {if *_egba ._afbb {_eb =true ;};};if _egba ._gdd !=nil {if *_egba ._gdd {_eb =true ;};};};if _bcf {_dfg =[]*line {};_dce :=_egca -2*_cf ;_aeac :=[]*symbol {};for _ ,_aag :=range _fggb {_fed (_aag );if _gdbg +_aag ._gef >=_dce {_gfcg :=_aaeb (_aeac );
if _eb {_gfcg /=_gf ;};_dfg =append (_dfg ,&line {_cbaf :_cbaca ,_bgbb :_aeac ,_ggbc :_gfcg });_aeac =[]*symbol {_aag };_gdbg =_aag ._gef ;_cbaca +=_gfcg ;}else {_aag ._dcbg =_gdbg ;_gdbg +=_aag ._gef ;_aeac =append (_aeac ,_aag );};};_bdg :=_aaeb (_aeac );
if _eb {_bdg /=_gf ;};if len (_aeac )> 0{_dfg =append (_dfg ,&line {_cbaf :_cbaca ,_bgbb :_aeac ,_ggbc :_bdg });};}else {for _ ,_ebb :=range _fggb {_fed (_ebb );_ebb ._dcbg =_gdbg ;_gdbg +=_ebb ._gef ;};if len (_fggb )> 0{_dfg =[]*line {&line {_bgbb :_fggb ,_ggbc :_aaeb (_fggb )}};
};};_fege :=_fgeb .TAttr ;if _fege ==_ad .ST_CellTypeUnset {_fege =_ad .ST_CellTypeN ;};return _dfg ,_fege ;};func (_bgc *convertContext )determineMaxIndexes (){var _ggb ,_cbg int ;_ggb =int (_bgc ._fced .MaxColumnIdx ());_fgb :=_bgc ._fced .Rows ();if len (_fgb )> 0{_cbg =int (_fgb [len (_fgb )-1].RowNumber ());
};for _ ,_ag :=range _bgc ._cdae {if _ag ._cac >=_cbg {_cbg =_ag ._cac +1;};if _ag ._dbad >=_ggb {_ggb =_ag ._dbad +1;};};_bgc ._bbef =_cbg ;_bgc ._cdbfa =_ggb ;};func (_eaggg *convertContext )getColorStringFromSmlColor (_aaebf *_ad .CT_Color )*string {var _cgcb string ;
if _aaebf .RgbAttr !=nil {_cgcb =*_aaebf .RgbAttr ;}else if _aaebf .IndexedAttr !=nil &&*_aaebf .IndexedAttr < 64{_cgcb =_ggg [*_aaebf .IndexedAttr ];}else if _aaebf .ThemeAttr !=nil {_gdgb :=*_aaebf .ThemeAttr ;_cgcb =_eaggg .getColorFromTheme (_gdgb );
};if _cgcb ==""{return nil ;};if len (_cgcb )> 6{_cgcb =_cgcb [(len (_cgcb )-6):];};if _aaebf .TintAttr !=nil {_bega :=*_aaebf .TintAttr ;_cgcb =_gg .AdjustColorByTint (_cgcb ,_bega );};_cgcb ="\u0023"+_cgcb ;return &_cgcb ;};func (_agf *convertContext )makeCols (){_dfc :=_agf ._fced ;
_fef :=_dfc .X ();_ggd :=[]*colInfo {};_ecgc :=[]colWidthRange {};if _aga :=_fef .Cols ;len (_aga )> 0{for _ ,_bgd :=range _aga [0].Col {_eddd :=_ca ;if _efd :=_bgd .WidthAttr ;_efd !=nil {if *_efd > 0.83{*_efd -=0.83;};if *_efd <=1{_eddd =*_efd *11;}else {_eddd =5+*_efd *6;
};};_daa :=int (_bgd .MinAttr -1);_gbb :=int (_bgd .MaxAttr -1);_ecgc =append (_ecgc ,colWidthRange {_eaba :_daa ,_faaf :_gbb ,_dded :_eddd ,_adc :_agf .getStyle (_bgd .StyleAttr )});};};_gce :=0;for _dc :=0;_dc <=_agf ._cdbfa ;_dc ++{if _dc < _agf ._cfg ||(_dc > _agf ._ebf &&_agf ._ebf > 0){continue ;
};var _eg float64 ;var _gbc *style ;if len (_ecgc )==0{_eg =_ca ;}else if _gce < len (_ecgc ){_ceg :=_ecgc [_gce ];if _dc >=_ceg ._eaba &&_dc <=_ceg ._faaf {_eg =_ceg ._dded ;_gbc =_ceg ._adc ;if _dc ==_ceg ._faaf {_gce ++;};}else {continue ;};};_ggd =append (_ggd ,&colInfo {_faca :_eg ,_fcbg :_gbc });
};_ae :=0.0;for _ ,_cab :=range _ggd {_ae +=_cab ._faca ;};_agf ._geef =1.0;if _ae > _agf ._bcab {_agf ._geef =_agf ._bcab /_ae ;for _ ,_eab :=range _ggd {_eab ._faca *=_agf ._geef ;};};_agf ._dcbc =_ggd ;};type cell struct{_bbbc _ad .ST_CellType ;_fefe int ;
_acae float64 ;_beee []*line ;_efc float64 ;_bcde float64 ;_edddb float64 ;_gbee float64 ;_cbf float64 ;_ecd *_ed .TextStyle ;_bcag *border ;_eca *border ;_feaf *border ;_gdcd *border ;_aaae bool ;_aeae bool ;_bbbg _ed .Color ;};func (_gc *convertContext )makeAnchors (){_bbc ,_df :=_gc ._fced .GetDrawing ();
if _bbc !=nil {for _ ,_ea :=range _bbc .EG_Anchor {_gge :=&anchor {};if _bd :=_ea .AnchorChoice .TwoCellAnchor ;_bd !=nil {_ecg ,_cefb :=_bd .From ,_bd .To ;if _ecg ==nil ||_cefb ==nil {return ;};_gge ._bddf =int (_ecg .Row );_gge ._eba =_gg .FromSTCoordinate (_ecg .RowOff );
_gge ._gab =int (_ecg .Col );_gge ._debc =_gg .FromSTCoordinate (_ecg .ColOff );_gge ._cac =int (_cefb .Row );_gge ._fded =_gg .FromSTCoordinate (_cefb .RowOff );_gge ._dbad =int (_cefb .Col );_gge ._gbdcf =_gg .FromSTCoordinate (_cefb .ColOff );if _cdb :=_bd .ObjectChoicesChoice ;
_cdb !=nil {if _gbe :=_cdb .Pic ;_gbe !=nil {if _eag :=_gbe .BlipFill ;_eag !=nil {if _gda :=_eag .Blip ;_gda !=nil {if _ffg :=_gda .EmbedAttr ;_ffg !=nil {for _ ,_fd :=range _df .X ().Relationship {if _fd .IdAttr ==*_ffg {for _ ,_fag :=range _gc ._cfdb .Images {if _fag .Target ()==_fd .TargetAttr {_def ,_db :=_bee .Open (_fag .Path ());
if _db !=nil {_e .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_db );continue ;};_fge ,_ ,_db :=_f .Decode (_def );if _db !=nil {_e .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_db );
continue ;};_gge ._bfgg =_fge ;};};};};};};};}else if _bdc :=_cdb .GraphicFrame ;_bdc !=nil {if _bcb :=_bdc .Graphic ;_bcb !=nil {if _dfd :=_bcb .GraphicData ;_dfd !=nil {for _ ,_faa :=range _dfd .Any {if _ba ,_bcc :=_faa .(*_gd .Chart );_bcc {for _ ,_aaa :=range _df .X ().Relationship {if _aaa .IdAttr ==_ba .IdAttr {_abdb :=_gc ._cfdb .GetChartByTargetId (_aaa .TargetAttr );
if _abdb !=nil {_gge ._acbf =_abdb ;};};};};};};};};};};if _gge ._bfgg !=nil ||_gge ._acbf !=nil {_gc ._cdae =append (_gc ._cdae ,_gge );};};};};func _fed (_gcda *symbol ){_debg :=_ed .New ();_bdgb :=_debg .NewStyledParagraph ();_bdgb .SetMargins (0,0,0,0);
_bac :=_bdgb .Append (_gcda ._dead );if _gcda ._gbba !=nil {_bac .Style =*_gcda ._gbba ;};_gcda ._abg =_bdgb .Height ();if _gcda ._gef ==0{_gcda ._gef =_bdgb .Width ();};};func (_ebbd *convertContext )getColorFromTheme (_abdc uint32 )string {_fcgf :=_ebbd ._cfdb .Themes ();
if len (_fcgf )!=0{_fffd :=_fcgf [0];if _dgba :=_fffd .ThemeElements ;_dgba !=nil {if _fagdda :=_dgba .ClrScheme ;_fagdda !=nil {switch _abdc {case 0:return _gg .GetColorStringFromDmlColor (_fagdda .Lt1 );case 1:return _gg .GetColorStringFromDmlColor (_fagdda .Dk1 );
case 2:return _gg .GetColorStringFromDmlColor (_fagdda .Lt2 );case 3:return _gg .GetColorStringFromDmlColor (_fagdda .Dk2 );case 4:return _gg .GetColorStringFromDmlColor (_fagdda .Accent1 );case 5:return _gg .GetColorStringFromDmlColor (_fagdda .Accent2 );
case 6:return _gg .GetColorStringFromDmlColor (_fagdda .Accent3 );case 7:return _gg .GetColorStringFromDmlColor (_fagdda .Accent4 );case 8:return _gg .GetColorStringFromDmlColor (_fagdda .Accent5 );case 9:return _gg .GetColorStringFromDmlColor (_fagdda .Accent6 );
};};};};return "";};var _ace =_gdfa (1);type symbol struct{_dead string ;_dcbg float64 ;_abg float64 ;_gef float64 ;_gbba *_ed .TextStyle ;_ffcb string ;};func (_gbd *convertContext )makePages (){for _ ,_dgb :=range _gbd ._cdbe {for _ ,_agb :=range _gbd ._edbge {_dgb ._aadc =append (_dgb ._aadc ,&page {_bcfd :[]*pageRow {},_cgcag :_dgb ,_fcc :_agb });
};};};var _d =3.025/_gdfa (1);func (_gdag *convertContext )getImage (_debf _f .Image ,_bgge ,_gdbc ,_bbab ,_bec ,_bfc ,_gbdc float64 ,_gee _gg .ImgPart )*_ed .Image {_bec +=_gdag ._adab ;_bbab +=_gdag ._aaac ;_dfdb ,_cgc :=_gg .GetImage (_gdag ._egf ,_debf ,_bgge ,_gdbc ,_bbab ,_bec ,_bfc ,_gbdc ,_gee );
if _cgc !=nil {_e .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_cgc );return nil ;};return _dfdb ;};func _aaeb (_fgf []*symbol )float64 {_ageb :=0.0;for _ ,_fda :=range _fgf {if _fda ._abg > _ageb {_ageb =_fda ._abg ;
};};return _ageb ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func (_ggge *convertContext )getBorder (_gdbge *_ad .CT_BorderPr )*border {_beedg :=&border {};switch _gdbge .StyleAttr {case _ad .ST_BorderStyleHair :_beedg ._bdgc =_ec /2;
case _ad .ST_BorderStyleThin :_beedg ._bdgc =_ec ;case _ad .ST_BorderStyleMedium :_beedg ._bdgc =_ec *2;case _ad .ST_BorderStyleThick :_beedg ._bdgc =_ec *4;};if _beedg ._bdgc ==0.0{return nil ;};if _dega :=_gdbge .Color ;_dega !=nil {_dcff :=_ggge .getColorStringFromSmlColor (_dega );
if _dcff !=nil {_beedg ._gafc =_ed .ColorRGBFromHex (*_dcff );}else {_beedg ._gafc =_ed .ColorBlack ;};};return _beedg ;};const _gf =0.64;

// ConvertToPdfWithOptions convert a sheet to PDF with given options.
func ConvertToPdfWithOptions (s *_fg .Sheet ,opts *Options )*_ed .Creator {_aa :=s .X ();if _aa ==nil {return nil ;};var _beg _ed .PageSize ;_ef :=true ;_de :=false ;if _aa .SheetPr !=nil &&_aa .SheetPr .PageSetUpPr !=nil &&_aa .SheetPr .PageSetUpPr .FitToPageAttr !=nil &&*_aa .SheetPr .PageSetUpPr .FitToPageAttr {_de =true ;
};if _bb :=_aa .PageSetup ;_bb !=nil {_ef =_bb .OrientationAttr ==_ad .ST_OrientationLandscape ;if _fcd :=_bb .PaperSizeAttr ;_fcd !=nil {_beg =_fegb [*_fcd ];};};if (_beg ==_ed .PageSize {}){_beg =_gg .GetDefaultPageSize ();if opts !=nil &&opts .DefaultPageSize !=_gg .DefaultPageSize {_beg =_gg .GetPageDimensions (opts .DefaultPageSize );
};};if _ef {_beg [0],_beg [1]=_beg [1],_beg [0];};_edd :=_ed .New ();_edd .SetPageSize (_beg );var _cfc ,_ce ,_edg ,_cb float64 ;if _cfd :=_aa .PageMargins ;_cfd !=nil {_edg =_cfd .LeftAttr ;_cb =_cfd .RightAttr ;_cfc =_cfd .TopAttr ;_ce =_cfd .BottomAttr ;
};if _edg < _fb {_edg =_fb ;};if _cb < _fb {_cb =_fb ;};if _cfc < _fcg {_cfc =_fcg ;};if _ce < _fcg {_ce =_fcg ;};_cfc *=_ff .Inch ;_ce *=_ff .Inch ;_edg *=_ff .Inch ;_cb *=_ff .Inch ;_edd .SetPageMargins (_edg ,_cb ,_cfc ,_ce );_cef :=s .Workbook ();var _ffb *_cd .Theme ;
if len (_cef .Themes ())> 0{_ffb =_cef .Themes ()[0];};var _ab ,_fe ,_fbe ,_cc int ;for _ ,_fcb :=range _cef .DefinedNames (){if _fcb .Name ()=="\u005f\u0078l\u006e\u006d\u002eP\u0072\u0069\u006e\u0074\u005f\u0041\u0072\u0065\u0061"{_gfa ,_fff ,_bc ,_ccb :=_gg .ParseExcelRange (_fcb .Content ());
if _ccb ==nil &&s .Name ()==_gfa {_ab =int (_fff .ColumnIdx );_fe =int (_bc .ColumnIdx );_fbe =int (_fff .RowIdx );_cc =int (_bc .RowIdx );};};};_bg :=[]_fg .Table {};if _aa .TableParts !=nil &&_aa .TableParts .TablePart !=nil {_dg :=0;_cgd :=s .Workbook ().Tables ();
_c .Slice (_cgd [:],func (_ee ,_abd int )bool {return _cgd [_ee ].X ().IdAttr < _cgd [_abd ].X ().IdAttr });for _ ,_bgg :=range s .Workbook ().Sheets (){if _bgg .Name ()==s .Name (){break ;}else {if _bgg .X ().TableParts !=nil &&_bgg .X ().TableParts .TablePart !=nil {_dg +=len (_bgg .X ().TableParts .TablePart );
};};};if len (_cgd )>=_dg +len (_aa .TableParts .TablePart ){_bg =append (_bg ,_cgd [_dg :_dg +len (_aa .TableParts .TablePart )]...);};};_gb :=&convertContext {_egf :_edd ,_fced :s ,_cfdb :s .Workbook (),_decc :_ffb ,_dgd :&s .Workbook ().StyleSheet ,_adab :_cfc ,_aaac :_edg ,_dfdf :_beg [1]-_ce -_cfc ,_bcab :_beg [0]-_cb -_edg ,_cfg :_ab ,_ebf :_fe ,_aeedg :_fbe ,_ecgf :_cc ,_cgca :_de ,_dcag :_bg };
_gb .makeAnchors ();_gb .determineMaxIndexes ();if _gb ._bbef ==0&&_gb ._cdbfa ==0{_edd .NewPage ();return _edd ;};_gb .makeCols ();_gb .makeRows ();_gb .makeMergedCells ();_gb .makeCells ();_gb .makePagespans ();_gb .makeRowspans ();_gb .makePages ();
_gb .fillPages ();_gb .distributeAnchors ();_gb .drawSheet ();return _edd ;};func (_dgfb *convertContext )combineCellStyleWithRPrElt (_caag *style ,_gba *_ad .CT_RPrElt )*style {_bccg :=*_caag ;_becc :=_dgfb .getStyleFromRPrElt (_gba );if _becc ==nil {return &_bccg ;
};if _becc ._bgdb !=nil {_bccg ._bgdb =_becc ._bgdb ;};if _becc ._cadc !=nil {_bccg ._cadc =_becc ._cadc ;};if _becc ._becf !=nil {_bccg ._becf =_becc ._becf ;};if _becc ._dgbd !=nil {_bccg ._dgbd =_becc ._dgbd ;};if _becc ._eec !=nil {_bccg ._eec =_becc ._eec ;
};if _becc ._beb !=nil {_bccg ._beb =_becc ._beb ;};if _becc ._afbb !=nil {_bccg ._afbb =_becc ._afbb ;};if _becc ._gdd !=nil {_bccg ._gdd =_becc ._gdd ;};return &_bccg ;};type page struct{_bcfd []*pageRow ;_bcac bool ;_bfe []*_ed .Image ;_cgcag *pagespan ;
_fcc *rowspan ;};func (_dcce *convertContext )getSymbolsFromString (_dcf string ,_bae *style )[]*symbol {_fgcf :=[]*symbol {};_dad :=_dcce .makeTextStyleFromCellStyle (_bae );for _ ,_cedb :=range _dcf {_fgcf =append (_fgcf ,&symbol {_dead :string (_cedb ),_gbba :_dad });
};return _fgcf ;};func (_faafg *convertContext )getDxfStyle (_edddba *uint32 )*style {_bbgea :=&style {};_bbga :=false ;if _edddba !=nil {var _ffce *_ad .CT_Dxf ;for _dge ,_aabf :=range _faafg ._dgd .X ().Dxfs .Dxf {if uint32 (_dge )==*_edddba {_ffce =_aabf ;
};};if _ffce ==nil {return nil ;};if _ffce .Fill !=nil &&_ffce .Fill .FillChoice !=nil &&_ffce .Fill .FillChoice .PatternFill !=nil {if _ffce .Fill .FillChoice .PatternFill .FgColor !=nil {_bbgea ._fdda =_faafg .getColorStringFromSmlColor (_ffce .Fill .FillChoice .PatternFill .FgColor );
}else if _ffce .Fill .FillChoice .PatternFill .BgColor !=nil {_bbgea ._fdda =_faafg .getColorStringFromSmlColor (_ffce .Fill .FillChoice .PatternFill .BgColor );};};_beeeb :=_ffce .Font ;for _ ,_dda :=range _beeeb .FontChoice {if _dda .Name !=nil {_bbgea ._becf =&_dda .Name .ValAttr ;
_bbga =true ;}else if _dda .B !=nil {_bbcd :=_dda .B .ValAttr ==nil ||*_dda .B .ValAttr ;_bbgea ._dgbd =&_bbcd ;_bbga =true ;}else if _dda .I !=nil {_ggbe :=_dda .I .ValAttr ==nil ||*_dda .I .ValAttr ;_bbgea ._eec =&_ggbe ;_bbga =true ;}else if _dda .U !=nil {_ead :=_dda .U .ValAttr ==_ad .ST_UnderlineValuesSingle ||_dda .U .ValAttr ==_ad .ST_UnderlineValuesUnset ;
_bbgea ._beb =&_ead ;_bbga =true ;}else if _dda .Sz !=nil {_dadb :=_dda .Sz .ValAttr ;_bbgea ._cadc =&_dadb ;_bbga =true ;}else if _dda .VertAlign !=nil {_dfcf :=_dda .VertAlign .ValAttr ==_cg .ST_VerticalAlignRunSuperscript ;_bbgea ._afbb =&_dfcf ;_gafa :=_dda .VertAlign .ValAttr ==_cg .ST_VerticalAlignRunSubscript ;
_bbgea ._gdd =&_gafa ;_bbga =true ;}else if _dda .Color !=nil {_bbgea ._bgdb =_faafg .getColorStringFromSmlColor (_dda .Color );_bbga =true ;};};_ddfgb :=_ffce .Border ;if _ddfgb !=nil {if _ddfgb .Top !=nil {_bbgea ._fbde =_faafg .getBorder (_ddfgb .Top );
_bbga =true ;};if _ddfgb .Bottom !=nil {_bbgea ._cadf =_faafg .getBorder (_ddfgb .Bottom );_bbga =true ;};if _ddfgb .Left !=nil {_bbgea ._eafd =_faafg .getBorder (_ddfgb .Left );_bbga =true ;};if _ddfgb .Right !=nil {_bbgea ._gbea =_faafg .getBorder (_ddfgb .Right );
_bbga =true ;};};if _ffce .Alignment !=nil {if _fafa :=_ffce .Alignment .VerticalAttr ;_fafa !=_ad .ST_VerticalAlignmentUnset {_bbgea ._cabg =_fafa ;_bbga =true ;};if _eadf :=_ffce .Alignment .HorizontalAttr ;_eadf !=_ad .ST_HorizontalAlignmentUnset {_bbgea ._dfec =_eadf ;
_bbga =true ;};};};if _bbga {return _bbgea ;};return nil ;};type style struct{_fdda *string ;_bgdb *string ;_cadc *float64 ;_becf *string ;_dgbd *bool ;_eec *bool ;_beb *bool ;_afbb *bool ;_gdd *bool ;_fbde *border ;_cadf *border ;_eafd *border ;_gbea *border ;
_dac bool ;_cabg _ad .ST_VerticalAlignment ;_dfec _ad .ST_HorizontalAlignment ;_bgae bool ;};func (_gafg *convertContext )getStyle (_eda *uint32 )*style {_fbdb :=&style {};_aec :=false ;if _eda !=nil {_cadd :=_gafg ._dgd .GetCellStyle (*_eda );if _gafg ._dgd .GetNumberFormat (_cadd .NumberFormat ()).GetFormat ()=="\u003b\u003b\u003b"{_fbdb ._bgae =true ;
};_caba :=_cadd .GetFill ();if _caba !=nil &&_caba .FillChoice !=nil &&_caba .FillChoice .PatternFill !=nil {if _caba .FillChoice .PatternFill .FgColor !=nil {_fbdb ._fdda =_gafg .getColorStringFromSmlColor (_caba .FillChoice .PatternFill .FgColor );}else if _caba .FillChoice .PatternFill .BgColor !=nil {_fbdb ._fdda =_gafg .getColorStringFromSmlColor (_caba .FillChoice .PatternFill .BgColor );
};};_dbcg :=_cadd .GetFont ();for _ ,_ecag :=range _dbcg .FontChoice {if _ecag .Name !=nil {_fbdb ._becf =&_ecag .Name .ValAttr ;_aec =true ;}else if _ecag .B !=nil {_egcb :=_ecag .B .ValAttr ==nil ||*_ecag .B .ValAttr ;_fbdb ._dgbd =&_egcb ;_aec =true ;
}else if _ecag .I !=nil {_ccgc :=_ecag .I .ValAttr ==nil ||*_ecag .I .ValAttr ;_fbdb ._eec =&_ccgc ;_aec =true ;}else if _ecag .U !=nil {_gcb :=_ecag .U .ValAttr ==_ad .ST_UnderlineValuesSingle ||_ecag .U .ValAttr ==_ad .ST_UnderlineValuesUnset ;_fbdb ._beb =&_gcb ;
_aec =true ;}else if _ecag .Sz !=nil {_ddgd :=_ecag .Sz .ValAttr ;_fbdb ._cadc =&_ddgd ;_aec =true ;}else if _ecag .VertAlign !=nil {_egeg :=_ecag .VertAlign .ValAttr ==_cg .ST_VerticalAlignRunSuperscript ;_fbdb ._afbb =&_egeg ;_gbga :=_ecag .VertAlign .ValAttr ==_cg .ST_VerticalAlignRunSubscript ;
_fbdb ._gdd =&_gbga ;_aec =true ;}else if _ecag .Color !=nil {_fbdb ._bgdb =_gafg .getColorStringFromSmlColor (_ecag .Color );_aec =true ;};};_affb :=_cadd .GetBorder ();if _affb .Top !=nil {_fbdb ._fbde =_gafg .getBorder (_affb .Top );_aec =true ;};if _affb .Bottom !=nil {_fbdb ._cadf =_gafg .getBorder (_affb .Bottom );
_aec =true ;};if _affb .Left !=nil {_fbdb ._eafd =_gafg .getBorder (_affb .Left );_aec =true ;};if _affb .Right !=nil {_fbdb ._gbea =_gafg .getBorder (_affb .Right );_aec =true ;};if _cadd .Wrapped (){_fbdb ._dac =true ;_aec =true ;};if _gfg :=_cadd .GetVerticalAlignment ();
_gfg !=_ad .ST_VerticalAlignmentUnset {_fbdb ._cabg =_gfg ;_aec =true ;};if _fddf :=_cadd .GetHorizontalAlignment ();_fddf !=_ad .ST_HorizontalAlignmentUnset {_fbdb ._dfec =_fddf ;_aec =true ;};};if _aec {return _fbdb ;};return nil ;};func (_bab *convertContext )alignSymbolsVertically (_baa *cell ,_dga _ad .ST_VerticalAlignment ){var _bca float64 ;
switch _dga {case _ad .ST_VerticalAlignmentTop :_bca =_bf ;if _baa ._aaae {_bca -=_fa ;}else if _baa ._aeae {_bca +=4*_fa ;};for _ ,_bdga :=range _baa ._beee {_bca +=_bdga ._ggbc ;_bdga ._cbaf =_bca ;_bca +=_ace ;};case _ad .ST_VerticalAlignmentCenter :_bfgd :=0.0;
for _ ,_beda :=range _baa ._beee {_bfgd +=_beda ._ggbc +_gdfa (1);};_bca =0.5*(_baa ._edddb -_bfgd );if _baa ._aaae {_bca -=2*_fa ;}else if _baa ._aeae {_bca +=2*_fa ;};for _ ,_fec :=range _baa ._beee {_bca +=_fec ._ggbc +0.5*_ace ;_fec ._cbaf =_bca ;_bca +=0.5*_ace ;
};default:_bca =_baa ._edddb -_bf ;if _baa ._aaae {_bca -=4*_fa ;}else if _baa ._aeae {_bca +=_fa ;};for _bad :=len (_baa ._beee )-1;_bad >=0;_bad --{_baa ._beee [_bad ]._cbaf =_bca ;_bca -=_baa ._beee [_bad ]._ggbc ;_bca -=_ace ;};};};type border struct{_bdgc float64 ;
_gafc _ed .Color ;};func _daac (_ggeg []*symbol )float64 {_gfbf :=0.0;for _ ,_dbgf :=range _ggeg {_gfbf +=_dbgf ._gef ;};return _gfbf ;};func (_bdb *convertContext )makeMergedCells (){_dcb :=[]*mergedCell {};for _ ,_gdb :=range _bdb ._fced .MergedCells (){_agaf ,_abc ,_gcf :=_g .ParseRangeReference (_gdb .Reference ());
if _gcf !=nil {_e .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_gcf );continue ;};_fgg :=mergedCell {_aedg :_agaf .RowIdx ,_dfb :_agaf .ColumnIdx ,_abgd :_abc .RowIdx ,_adge :_abc .ColumnIdx };
for _faad :=_fgg ._dfb -1;_faad < _fgg ._adge ;_faad ++{_fgg ._bfgc +=_bdb ._dcbc [_faad ]._faca ;};for _eabc :=_fgg ._aedg -1;_eabc < _fgg ._abgd ;_eabc ++{_fgg ._acad +=_bdb ._agff [_eabc ]._bagd ;};_dcb =append (_dcb ,&_fgg );};_bdb ._eefa =_dcb ;};
var _ec =_gdfa (0.0625);func (_ege *convertContext )distributeAnchors (){for _ ,_caac :=range _ege ._cdae {_fca ,_cbde :=_caac ._bddf ,_caac ._eba ;_fddb ,_gfc :=_caac ._gab ,_caac ._debc ;_ada ,_ade :=_caac ._cac ,_caac ._fded ;_aac ,_cga :=_caac ._dbad ,_caac ._gbdcf ;
if _fca < _ege ._aeedg ||(_ada > _ege ._ecgf &&_ege ._ecgf > 0){continue ;};if _fddb < _ege ._cfg ||(_aac > _ege ._ebf &&_ege ._ebf > 0){continue ;};var _cad ,_ced ,_cbce ,_edb *page ;for _ ,_dbb :=range _ege ._cdbe {for _ ,_gec :=range _dbb ._aadc {if _fca >=_gec ._fcc ._dbga &&_fca < _gec ._fcc ._fbc {if _fddb >=_gec ._cgcag ._agec &&_fddb < _gec ._cgcag ._efgd {_gec ._bcac =true ;
_cad =_gec ;};if _aac >=_gec ._cgcag ._agec &&_aac < _gec ._cgcag ._efgd {_gec ._bcac =true ;_ced =_gec ;};};if _ada >=_gec ._fcc ._dbga &&_ada < _gec ._fcc ._fbc {if _fddb >=_gec ._cgcag ._agec &&_fddb < _gec ._cgcag ._efgd {_gec ._bcac =true ;_edb =_gec ;
};if _aac >=_gec ._cgcag ._agec &&_aac < _gec ._cgcag ._efgd {_gec ._bcac =true ;_cbce =_gec ;};};};};_bfg :=_cad !=_ced ;_aea :=_cad !=_edb ;if _bfg &&_aea {_adg :=_ege ._dcbc [_fddb ]._cfde +_ff .FromEMU (_gfc );_afb :=_cad ._cgcag ._abdf ;_dee :=_ege ._dcbc [_aac ]._cfde +_ff .FromEMU (_cga );
_acd :=_ege ._agff [_fca ]._gfae +_ff .FromEMU (_cbde );_bcd :=float64 (_cad ._fcc ._abcf );_agce :=_ege ._agff [_ada ]._gfae +_ff .FromEMU (_ade );_aff :=_dee +_afb -_adg ;_cdg :=_agce +_bcd -_acd ;_baf :=_ege .imageFromAnchor (_caac ,_aff ,_cdg );_cad ._bfe =append (_cad ._bfe ,_ege .getImage (_baf ,_cdg ,_aff ,_adg ,_acd ,_afb -_adg ,_bcd -_acd ,_gg .ImgPart_lt ));
_ced ._bfe =append (_ced ._bfe ,_ege .getImage (_baf ,_cdg ,_aff ,0,_acd ,_afb -_adg ,_bcd -_acd ,_gg .ImgPart_rt ));_edb ._bfe =append (_edb ._bfe ,_ege .getImage (_baf ,_cdg ,_aff ,_adg ,0,_afb -_adg ,_bcd -_acd ,_gg .ImgPart_lb ));_cbce ._bfe =append (_cbce ._bfe ,_ege .getImage (_baf ,_cdg ,_aff ,0,0,_afb -_adg ,_bcd -_acd ,_gg .ImgPart_rb ));
}else if _bfg {_afe :=_ege ._agff [_fca ]._gfae +_ff .FromEMU (_cbde );_fbga :=_ege ._agff [_ada ]._gfae +_ff .FromEMU (_ade );_bga :=_ege ._dcbc [_fddb ]._cfde +_ff .FromEMU (_gfc );_ddd :=_cad ._cgcag ._abdf ;_dfag :=_ege ._dcbc [_aac ]._cfde +_ff .FromEMU (_cga );
_aef :=_dfag +_ddd -_bga ;_ece :=_fbga -_afe ;_gbef :=_ege .imageFromAnchor (_caac ,_aef ,_ece );_cad ._bfe =append (_cad ._bfe ,_ege .getImage (_gbef ,_ece ,_aef ,_bga ,_afe ,_ddd -_bga ,0,_gg .ImgPart_l ));_ced ._bfe =append (_ced ._bfe ,_ege .getImage (_gbef ,_ece ,_aef ,0,_afe ,_ddd -_bga ,0,_gg .ImgPart_r ));
}else if _aea {_bbge :=_ege ._dcbc [_fddb ]._cfde +_ff .FromEMU (_gfc );_cdbf :=_ege ._dcbc [_aac ]._cfde +_ff .FromEMU (_cga );_dgg :=_ege ._agff [_fca ]._gfae +_ff .FromEMU (_cbde );_aceg :=float64 (_cad ._fcc ._abcf );_eabcg :=_ege ._agff [_ada ]._gfae +_ff .FromEMU (_ade );
_ddg :=_cdbf -_bbge ;_geb :=_eabcg +_aceg -_dgg ;_cec :=_ege .imageFromAnchor (_caac ,_ddg ,_geb );_cad ._bfe =append (_cad ._bfe ,_ege .getImage (_cec ,_geb ,_ddg ,_bbge ,_dgg ,0,_aceg -_dgg ,_gg .ImgPart_t ));_edb ._bfe =append (_edb ._bfe ,_ege .getImage (_cec ,_geb ,_ddg ,_bbge ,0,0,_aceg -_dgg ,_gg .ImgPart_b ));
}else {_cbef :=_ege ._dcbc [_fddb ]._cfde +_ff .FromEMU (_gfc );_dab :=_ege ._dcbc [_aac ]._cfde +_ff .FromEMU (_cga );_agd :=_ege ._agff [_fca ]._gfae +_ff .FromEMU (_cbde );_eaa :=_ege ._agff [_ada ]._gfae +_ff .FromEMU (_ade );_bdfb :=_dab -_cbef ;_deb :=_eaa -_agd ;
_bgb :=_ege .imageFromAnchor (_caac ,_bdfb ,_deb );_cad ._bfe =append (_cad ._bfe ,_ege .getImage (_bgb ,_deb ,_bdfb ,_cbef ,_agd ,0,0,_gg .ImgPart_whole ));};};};const _bf =2;type pageRow struct{_eagg int ;_bgba []*cell ;};type line struct{_cbaf float64 ;
_bgbb []*symbol ;_ggbc float64 ;};func (_acb *convertContext )makeCells (){_dd :=_acb ._fced ;_dff :=_dd .Rows ();_agc :=0;for _gdc ,_ffd :=range _acb ._agff {if _gdc < _acb ._aeedg ||(_gdc > _acb ._ecgf &&_acb ._ecgf > 0){continue ;};_ffd ._bgbg =[]*cell {};
_fea :=0.0;_dde :=_ffd ._gaf ;if _ffd ._ggc {_bge :=_dff [_agc ];_agc ++;_bgf :=_ffd ._bagd ;for _ ,_af :=range _bge .Cells (){_ffc ,_faf :=_g .ParseCellReference (_af .Reference ());if _faf !=nil {_e .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_faf );
continue ;};if int (_ffc .ColumnIdx )< _acb ._cfg ||(int (_ffc .ColumnIdx )> _acb ._ebf &&_acb ._ebf > 0){continue ;};_egg :=_acb ._dcbc [_ffc .ColumnIdx ];_aba :=_egg ._faca ;_dba :=_aba ;_cdfd :=_egg ._fcbg ;var _eaf ,_aad ,_gbg ,_fcdg bool ;for _ ,_ddf :=range _acb ._eefa {if _ffc .RowIdx >=_ddf ._aedg &&_ffc .RowIdx <=_ddf ._abgd &&_ffc .ColumnIdx >=_ddf ._dfb &&_ffc .ColumnIdx <=_ddf ._adge {if _ffc .ColumnIdx ==_ddf ._dfb &&_ffc .RowIdx ==_ddf ._aedg {_aba =_ddf ._bfgc ;
_bgf =_ddf ._acad ;};_eaf =_ffc .RowIdx !=_ddf ._aedg ;_aad =_ffc .RowIdx !=_ddf ._abgd ;_gbg =_ffc .ColumnIdx !=_ddf ._dfb ;_fcdg =_ffc .ColumnIdx !=_ddf ._adge ;};};var _bba *style ;for _ ,_fcbf :=range _acb ._dcag {_ge ,_agfc ,_dec :=_g .ParseRangeReference (_fcbf .Reference ());
if _dec !=nil ||_ge .RowIdx > _ffc .RowIdx ||_ge .ColumnIdx > _ffc .ColumnIdx ||_agfc .RowIdx < _ffc .RowIdx ||_agfc .ColumnIdx < _ffc .ColumnIdx ||_acb ._cfdb .StyleSheet .X ().TableStyles ==nil {continue ;};_gbgf :=_ffc .RowIdx ==_ge .RowIdx ;for _ ,_fad :=range _acb ._cfdb .StyleSheet .X ().TableStyles .TableStyle {if _fcbf .X ().TableStyleInfo .NameAttr !=nil &&_fad .NameAttr ==*_fcbf .X ().TableStyleInfo .NameAttr {for _ ,_aadb :=range _fad .TableStyleElement {if !_gbgf &&_aadb .TypeAttr ==_ad .ST_TableStyleTypeWholeTable {_bba =_acb .getDxfStyle (_aadb .DxfIdAttr );
};if _gbgf &&_aadb .TypeAttr ==_ad .ST_TableStyleTypeHeaderRow {_bba =_acb .getDxfStyle (_aadb .DxfIdAttr );};};};};};_fae :=_acb .getStyleFromCell (_af ,_dde ,_cdfd ,_bba );var _bgcf ,_fagd ,_fgd ,_abaa bool ;var _fafc ,_ccf ,_eed ,_bggf *border ;var _caa _ad .ST_VerticalAlignment ;
var _dcg _ad .ST_HorizontalAlignment ;if _fae !=nil {if !_eaf {_fafc =_fae ._fbde ;};if !_aad {_ccf =_fae ._cadf ;};if !_gbg {_eed =_fae ._eafd ;};if !_fcdg {_bggf =_fae ._gbea ;};if _ccf !=nil &&_ccf ._bdgc > _fea {_fea =_ccf ._bdgc ;};_caa =_fae ._cabg ;
_dcg =_fae ._dfec ;if _fae ._afbb !=nil {_bgcf =*_fae ._afbb ;};if _fae ._gdd !=nil {_fagd =*_fae ._gdd ;};_fgd =_fae ._dac ;_abaa =_fae ._bgae ;};var _ccg _ed .Color ;if _fae !=nil &&_fae ._fdda !=nil {_ccg =_ed .ColorRGBFromHex (*_fae ._fdda );};_cfe ,_age :=_acb .getContentFromCell (_dd ,_af ,_fae ,_aba ,_fgd ,_abaa );
_faeb :=&cell {_bbbc :_age ,_efc :_aba ,_bcde :_dba ,_edddb :_bgf ,_beee :_cfe ,_bcag :_fafc ,_eca :_ccf ,_feaf :_eed ,_gdcd :_bggf ,_aaae :_bgcf ,_aeae :_fagd ,_bbbg :_ccg };_acb .alignSymbolsHorizontally (_faeb ,_dcg );_acb .alignSymbolsVertically (_faeb ,_caa );
_ffd ._bgbg =append (_ffd ._bgbg ,_faeb );};};_ffd ._ged =_fea ;};};func (_bdae *convertContext )getStyleFromRPrElt (_cdad *_ad .CT_RPrElt )*style {if _cdad ==nil ||_cdad .RPrEltChoice ==nil ||len (_cdad .RPrEltChoice )==0{return nil ;};_daba :=&style {};
for _ ,_gdg :=range _cdad .RPrEltChoice {if _gdg .RFont !=nil {_daba ._becf =&_gdg .RFont .ValAttr ;};if _bgff :=_gdg .B ;_bgff !=nil {_egd :=_bgff .ValAttr ==nil ||*_bgff .ValAttr ;_daba ._dgbd =&_egd ;};if _ecgca :=_gdg .I ;_ecgca !=nil {_gaa :=_ecgca .ValAttr ==nil ||*_ecgca .ValAttr ;
_daba ._eec =&_gaa ;};if _beeef :=_gdg .U ;_beeef !=nil {_gcee :=_beeef .ValAttr ==_ad .ST_UnderlineValuesSingle ||_beeef .ValAttr ==_ad .ST_UnderlineValuesUnset ;_daba ._beb =&_gcee ;};if _dcab :=_gdg .VertAlign ;_dcab !=nil {_cdgbd :=_dcab .ValAttr ==_cg .ST_VerticalAlignRunSuperscript ;
_daba ._afbb =&_cdgbd ;_egcaa :=_dcab .ValAttr ==_cg .ST_VerticalAlignRunSubscript ;_daba ._gdd =&_egcaa ;};if _cbdbe :=_gdg .Sz ;_cbdbe !=nil {_ffdb :=_cbdbe .ValAttr ;_daba ._cadc =&_ffdb ;};if _adga :=_gdg .Color ;_adga !=nil {_daba ._bgdb =_bdae .getColorStringFromSmlColor (_adga );
};};return _daba ;};func (_egc *convertContext )drawSheet (){for _dbg ,_fgda :=range _egc ._cdbe {_acc :=len (_fgda ._aadc );if _dbg ==len (_egc ._cdbe )-1{for _bda :=len (_fgda ._aadc )-1;_bda >=0;_bda --{if !_fgda ._aadc [_bda ]._bcac {_acc =_bda ;};
};};_aee :=_fgda ._aadc [:_acc ];for _ ,_gga :=range _aee {_egc ._egf .NewPage ();_egc .drawPage (_gga );};};};type colWidthRange struct{_eaba int ;_faaf int ;_dded float64 ;_adc *style ;};func (_dfaa *convertContext )makePagespans (){_dfaa ._cdbe =[]*pagespan {};
_dbab :=0.0;_aaf :=0;for _bef ,_bbg :=range _dfaa ._dcbc {_dfce :=_bbg ._faca ;if _dbab +_dfce <=_dfaa ._bcab {_bbg ._cfde =_dbab ;_dbab +=_dfce ;}else {_bbg ._cfde =0;_dfaa ._cdbe =append (_dfaa ._cdbe ,&pagespan {_abdf :_dbab ,_agec :_aaf ,_efgd :_bef });
_dbab =_dfce ;_aaf =_bef ;};};_dfaa ._cdbe =append (_dfaa ._cdbe ,&pagespan {_abdf :_dbab ,_agec :_aaf ,_efgd :len (_dfaa ._dcbc )});};type colInfo struct{_cfde float64 ;_faca float64 ;_fcbg *style ;};func (_cabe *convertContext )makeRowspans (){var _dgfe float64 ;
_gdf :=0;for _add ,_aca :=range _cabe ._agff {_gcc :=_aca ._bagd +_aca ._ged ;if _dgfe +_gcc <=_cabe ._dfdf {_aca ._gfae =_dgfe ;_dgfe +=_gcc ;}else {_cabe ._edbge =append (_cabe ._edbge ,&rowspan {_abcf :_dgfe ,_dbga :_gdf ,_fbc :_add });_gdf =_add ;_aca ._gfae =0;
_dgfe =_gcc ;};};_cabe ._edbge =append (_cabe ._edbge ,&rowspan {_abcf :_dgfe ,_dbga :_gdf ,_fbc :len (_cabe ._agff )});};func (_gdfd *convertContext )getSymbolsFromR (_cgb []*_ad .CT_RElt ,_bdee *style )[]*symbol {_ecgg :=[]*symbol {};for _ ,_efa :=range _cgb {_dgbga :=_gdfd .combineCellStyleWithRPrElt (_bdee ,_efa .RPr );
for _ ,_gff :=range _efa .T {_ecgg =append (_ecgg ,&symbol {_dead :string (_gff ),_gbba :_gdfd .makeTextStyleFromCellStyle (_dgbga )});};};return _ecgg ;};func (_ded *convertContext )makeTextStyleFromCellStyle (_dffg *style )*_ed .TextStyle {_dbf :=_ded ._egf .NewTextStyle ();
if _dffg ==nil {_dbf .FontSize =_gg .DefaultFontSize ;_dbf .Font =_gg .AssignStdFontByName (_dbf ,_gg .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_dbf ;};if _cce (_dffg ._beb ){_dbf .Underline =true ;_dbf .UnderlineStyle =_ed .TextDecorationLineStyle {Offset :0.5,Thickness :_gdfa (1/32)};
};var _fdgf FontStyle ;if _cce (_dffg ._dgbd )&&_cce (_dffg ._eec ){_fdgf =FontStyle_BoldItalic ;}else if _cce (_dffg ._dgbd ){_fdgf =FontStyle_Bold ;}else if _cce (_dffg ._eec ){_fdgf =FontStyle_Italic ;}else {_fdgf =FontStyle_Regular ;};_decca :="\u0064e\u0066\u0061\u0075\u006c\u0074";
if _dffg ._becf !=nil {_decca =*_dffg ._becf ;};if _cbb ,_facad :=_gg .StdFontsMap [_decca ];_facad {_dbf .Font =_gg .AssignStdFontByName (_dbf ,_cbb [_fdgf ]);}else if _bfd :=_gg .GetRegisteredFont (_decca ,_fdgf );_bfd !=nil {_dbf .Font =_bfd ;}else {_e .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_decca ,_fdgf );
_dbf .Font =_gg .AssignStdFontByName (_dbf ,_gg .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_fdgf ]);};if _dffg ._cadc !=nil {_dbf .FontSize =_fc .Round (*_dffg ._cadc *_ded ._geef );};if _dffg ._bgdb !=nil {_dbf .Color =_ed .ColorRGBFromHex (*_dffg ._bgdb );
};if _dffg ._afbb !=nil &&*_dffg ._afbb {_dbf .FontSize *=_gf ;}else if _dffg ._gdd !=nil &&*_dffg ._gdd {_dbf .FontSize *=_gf ;};return &_dbf ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_be .PdfFont ){_gg .RegisterFont (name ,style ,font );};const _gfb =15.0;var _fegb =map[uint32 ]_ed .PageSize {1:_ed .PageSize {8.5*_ff .Inch ,11*_ff .Inch },2:_ed .PageSize {8.5*_ff .Inch ,11*_ff .Inch },3:_ed .PageSize {11*_ff .Inch ,17*_ff .Inch },4:_ed .PageSize {17*_ff .Inch ,11*_ff .Inch },5:_ed .PageSize {8.5*_ff .Inch ,14*_ff .Inch },6:_ed .PageSize {5.5*_ff .Inch ,8.5*_ff .Inch },7:_ed .PageSize {7.5*_ff .Inch ,10*_ff .Inch },8:_ed .PageSize {_gdfa (297),_gdfa (420)},9:_ed .PageSize {_gdfa (210),_gdfa (297)},10:_ed .PageSize {_gdfa (210),_gdfa (297)},11:_ed .PageSize {_gdfa (148),_gdfa (210)},70:_ed .PageSize {_gdfa (105),_gdfa (148)},12:_ed .PageSize {_gdfa (250),_gdfa (354)},13:_ed .PageSize {_gdfa (182),_gdfa (257)},14:_ed .PageSize {8.5*_ff .Inch ,13*_ff .Inch },20:_ed .PageSize {4.125*_ff .Inch ,9.5*_ff .Inch },27:_ed .PageSize {_gdfa (110),_gdfa (220)},28:_ed .PageSize {_gdfa (162),_gdfa (229)},34:_ed .PageSize {_gdfa (250),_gdfa (176)},29:_ed .PageSize {_gdfa (324),_gdfa (458)},30:_ed .PageSize {_gdfa (229),_gdfa (324)},31:_ed .PageSize {_gdfa (114),_gdfa (162)},37:_ed .PageSize {3.88*_ff .Inch ,7.5*_ff .Inch },43:_ed .PageSize {_gdfa (100),_gdfa (148)},69:_ed .PageSize {_gdfa (200),_gdfa (148)}};
func (_efg *convertContext )drawPage (_feg *page ){_gbf :=_efg ._adab ;_dccf :=_efg ._aaac ;for _ ,_aed :=range _feg ._bcfd {_cdgb :=_efg ._agff [_aed ._eagg ];for _ ,_agcc :=range _aed ._bgba {var _ddfg float64 ;if _aed ._eagg > 1{_ddfg =_efg ._agff [_aed ._eagg -1]._ged ;
};var _bbae ,_cda float64 ;if _gdfb :=_agcc ._bcag ;_gdfb !=nil {_bbae =_gdfb ._bdgc ;};if _ggaf :=_agcc ._eca ;_ggaf !=nil {_cda =_ggaf ._bdgc ;};_dbgc :=_gbf +_cdgb ._gfae -0.5*(_ddfg -_bbae );_dbc :=_gbf +_cdgb ._gfae +_cdgb ._bagd +0.5*(_cdgb ._ged +_cda );
_cdbfe :=_dccf +_agcc ._acae ;_cbdb :=_cdbfe +_agcc ._bcde ;if _agcc ._bbbg !=nil &&_agcc ._bbbg !=_ed .ColorBlack {_gg .FillRectangle (_efg ._egf ,_cdbfe ,_dbgc ,_cbdb -_cdbfe ,_dbc -_dbgc ,_agcc ._bbbg );};};};for _ ,_edbg :=range _feg ._bcfd {_bdd :=_efg ._agff [_edbg ._eagg ];
for _ ,_eff :=range _edbg ._bgba {_dae :=_eff ._gbee < _eff ._acae ;_dgbcg :=_eff ._cbf > _eff ._acae +_eff ._efc ;var _bdag ,_eef bool ;for _ ,_bbf :=range _eff ._beee {for _ ,_eaaa :=range _bbf ._bgbb {if _dae &&!_bdag {_bdag =_eaaa ._dcbg < 0;};if _dgbcg &&!_eef {_eef =_eff ._efc < _eaaa ._dcbg +_eaaa ._gef ;
};if _eff ._acae +_eaaa ._dcbg >=_eff ._gbee &&_eff ._acae +_eaaa ._dcbg +_eaaa ._gef <=_eff ._cbf {_bdcc :=_efg ._egf .NewStyledParagraph ();_defb :=_dccf +_eff ._acae +_eaaa ._dcbg ;_adgg :=_gbf +_bdd ._gfae +_bbf ._cbaf -_eaaa ._abg -_gdfa (0.5);_bdcc .SetPos (_defb ,_adgg );
var _ffff *_ed .TextChunk ;if _eaaa ._ffcb !=""{_ffff =_bdcc .AddExternalLink (_eaaa ._dead ,_eaaa ._ffcb );}else {_ffff =_bdcc .Append (_eaaa ._dead );};if _eaaa ._gbba !=nil {_ffff .Style =*_eaaa ._gbba ;};_efg ._egf .Draw (_bdcc );};};};var _fbgb ,_agag ,_gebd ,_aae ,_egb ,_fdc float64 ;
var _dca ,_fce ,_efb ,_caf _ed .Color ;if _acf :=_eff ._bcag ;_acf !=nil {_fbgb =_acf ._bdgc ;_dca =_acf ._gafc ;};if _ede :=_eff ._eca ;_ede !=nil {_agag =_ede ._bdgc ;_fce =_ede ._gafc ;};if _gac :=_eff ._feaf ;_gac !=nil {_gebd =_gac ._bdgc ;_egb =_gebd /2;
_efb =_gac ._gafc ;};if _beed :=_eff ._gdcd ;_beed !=nil {_aae =_beed ._bdgc ;_fdc =_aae /2;_caf =_beed ._gafc ;};var _ffe float64 ;if _edbg ._eagg > 1{_ffe =_efg ._agff [_edbg ._eagg -1]._ged ;};_bddc :=_gbf +_bdd ._gfae -0.5*(_ffe -_fbgb );_fbd :=_gbf +_bdd ._gfae +_bdd ._bagd +0.5*(_bdd ._ged +_agag );
_ceb :=_dccf +_eff ._acae ;_bafc :=_ceb +_eff ._bcde ;_gg .DrawLine (_efg ._egf ,_ceb ,_bddc ,_bafc ,_bddc ,_fbgb ,_dca );_gg .DrawLine (_efg ._egf ,_ceb ,_fbd ,_bafc ,_fbd ,_agag ,_fce );if !_bdag {_gg .DrawLine (_efg ._egf ,_ceb -_egb ,_bddc ,_ceb -_egb ,_fbd ,_gebd ,_efb );
};if !_eef {_gg .DrawLine (_efg ._egf ,_bafc -_fdc ,_bddc ,_bafc -_fdc ,_fbd ,_aae ,_caf );};};};for _ ,_aeed :=range _feg ._bfe {if _aeed !=nil {_efg ._egf .Draw (_aeed );};};};type rowspan struct{_abcf float64 ;_dbga int ;_fbc int ;};func (_fac *convertContext )imageFromAnchor (_dbba *anchor ,_fbb ,_acg float64 )_f .Image {if _dbba ._bfgg !=nil {return _dbba ._bfgg ;
};if _dbba ._acbf !=nil {_bedg ,_baag :=_gg .MakeImageFromChartSpace (_dbba ._acbf ,_fbb ,_acg ,_fac ._decc ,_fac ._cfdb );if _baag !=nil {_e .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_baag );
return nil ;};return _bedg ;};return nil ;};func _gdfa (_bcfe float64 )float64 {return _bcfe *_ff .Millimeter };func (_cbc *convertContext )fillPages (){for _bgeg ,_dgbc :=range _cbc ._edbge {_bgdg :=_cbc ._agff [_dgbc ._dbga :_dgbc ._fbc ];for _dcbf ,_bbe :=range _bgdg {_adb :=0;
_fbg :=0.0;_aab :=[]*cell {};if _bbe ._ggc {for _ ,_cbd :=range _bbe ._bgbg {_agbd :=_cbc ._cdbe [_adb ];_cbc ._daf =_agbd ._aadc [_bgeg ];_cbc ._daf ._bcac =true ;_begg :=_cbd ._bcde ;if _fbg +_begg > _agbd ._abdf {_cbc .addRowToPage (_aab ,_dcbf );_aab =[]*cell {_cbd };
_fbg =_begg ;_adb ++;}else {_cbd ._acae =_fbg ;_aab =append (_aab ,_cbd );_fbg +=_begg ;};};if len (_aab )> 0{_gdbd :=_cbc ._cdbe [_adb ];_cbc ._daf =_gdbd ._aadc [_bgeg ];_cbc ._daf ._bcac =true ;_cbc .addRowToPage (_aab ,_dcbf );};};};};};func (_aabg *convertContext )addRowToPage (_cba []*cell ,_egga int ){_cbac :=0.0;
_cag :=_aabg ._bcab ;for _ ,_bbb :=range _cba {if len (_bbb ._beee )!=0{_bbb ._gbee =_cbac ;_cbac =_bbb ._acae +_bbb ._efc ;};};for _afg :=len (_cba )-1;_afg >=0;_afg --{_cbca :=_cba [_afg ];if len (_cbca ._beee )!=0{_cbca ._cbf =_cag ;_cag =_cbca ._acae ;
};};_aabg ._daf ._bcfd =append (_aabg ._daf ._bcfd ,&pageRow {_eagg :_egga ,_bgba :_cba });};type anchor struct{_bfgg _f .Image ;_acbf *_gd .ChartSpace ;_bddf int ;_eba int64 ;_gab int ;_debc int64 ;_cac int ;_fded int64 ;_dbad int ;_gbdcf int64 ;};func _gbgb (_eeff ,_cabc *style ){if _cabc ==nil {return ;
};if _eeff ==nil {_eeff =_cabc ;return ;};if _eeff ._fdda ==nil {_eeff ._fdda =_cabc ._fdda ;};if _eeff ._becf ==nil {_eeff ._becf =_cabc ._becf ;};if _eeff ._bgdb ==nil {_eeff ._bgdb =_cabc ._bgdb ;};if _eeff ._cadc ==nil {_eeff ._cadc =_cabc ._cadc ;
};if _eeff ._dgbd ==nil {_eeff ._dgbd =_cabc ._dgbd ;};if _eeff ._eec ==nil {_eeff ._eec =_cabc ._eec ;};if _eeff ._beb ==nil {_eeff ._beb =_cabc ._beb ;};if _eeff ._afbb ==nil {_eeff ._afbb =_cabc ._afbb ;};if _eeff ._gdd ==nil {_eeff ._gdd =_cabc ._gdd ;
};if _eeff ._fbde ==nil {_eeff ._fbde =_cabc ._fbde ;};if _eeff ._cadf ==nil {_eeff ._cadf =_cabc ._cadf ;};if _eeff ._eafd ==nil {_eeff ._eafd =_cabc ._eafd ;};if _eeff ._gbea ==nil {_eeff ._gbea =_cabc ._gbea ;};if _eeff ._cabg ==_ad .ST_VerticalAlignmentUnset {_eeff ._cabg =_cabc ._cabg ;
};if _eeff ._dfec ==_ad .ST_HorizontalAlignmentUnset {_eeff ._dfec =_cabc ._dfec ;};};type convertContext struct{_egf *_ed .Creator ;_cfdb *_fg .Workbook ;_decc *_cd .Theme ;_fced *_fg .Sheet ;_dgd *_fg .StyleSheet ;_bbef int ;_cdbfa int ;_cdbe []*pagespan ;
_daf *page ;_dcbc []*colInfo ;_agff []*rowInfo ;_edbge []*rowspan ;_adab float64 ;_aaac float64 ;_dfdf float64 ;_bcab float64 ;_eefa []*mergedCell ;_cdae []*anchor ;_geef float64 ;_cfg int ;_ebf int ;_aeedg int ;_ecgf int ;_cgca bool ;_dcag []_fg .Table ;
};func (_bcae *convertContext )getStyleFromCell (_ddgg _fg .Cell ,_acab ,_ddgf ,_bgea *style )*style {if _bgea !=nil {_gbgb (_bgea ,_acab );_gbgb (_bgea ,_ddgf );return _bgea ;};_ccfb :=_ddgg .X ();_eeea :=_bcae .getStyle (_ccfb .SAttr );_gbgb (_eeea ,_acab );
_gbgb (_eeea ,_ddgf );return _eeea ;};const _fa =1.5;

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_gg .FontStyle ;

// Options contains the options for convert process
type Options struct{

// DefaultPageSize is applied when there is no page size explicitly set in the document.
// A4 is the default option.
DefaultPageSize _gg .PageSize ;};func (_fdd *convertContext )makeRows (){_fba :=[]*rowInfo {};_dfe :=_fdd ._fced .Rows ();_bccc :=0;_bed :=0.0;for _cdf ,_agg :=range _dfe {if _cdf < _fdd ._aeedg ||(_cdf > _fdd ._ecgf &&_fdd ._ecgf > 0){continue ;};_bccc ++;
_dcc :=int (_agg .RowNumber ());if _dcc > _bccc {for _dgf :=_bccc ;_dgf < _dcc ;_dgf ++{_fba =append (_fba ,&rowInfo {_bagd :_gfb /_d });_bed +=_gfb /_d ;};_bccc =_dcc ;};var _bde float64 ;if _agg .X ().HtAttr ==nil {_bde =_gfb ;}else {_bde =*_agg .X ().HtAttr ;
};_fba =append (_fba ,&rowInfo {_bagd :_bde /_d ,_ggc :true ,_gaf :_fdd .getStyle (_agg .X ().SAttr )});_bed +=_bde /_d ;};for _ffgg :=len (_fba );_ffgg < _fdd ._bbef ;_ffgg ++{_fba =append (_fba ,&rowInfo {_bagd :_gfb /_d });_bed +=_gfb /_d ;};if _fdd ._cgca ||_bed >=_fdd ._dfdf {_dfda :=_fdd ._geef ;
if _fdd ._dfdf /_bed < _fdd ._geef {_dfda =_fdd ._dfdf /_bed ;};for _ ,_cca :=range _fba {_cca ._bagd *=_dfda ;};};_fdd ._agff =_fba ;};const _fcg =0.0;type mergedCell struct{_aedg uint32 ;_dfb uint32 ;_abgd uint32 ;_adge uint32 ;_bfgc float64 ;_acad float64 ;
};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _gg .RegisterFontsFromDirectory (dirName )};const _cf =3;