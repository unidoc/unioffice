//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_c "github.com/unidoc/unioffice/v2/common/logger";_bb "github.com/unidoc/unioffice/v2/common/tempstorage";_bf "github.com/unidoc/unioffice/v2/internal/convertutils";_fd "github.com/unidoc/unioffice/v2/measurement";_fe "github.com/unidoc/unioffice/v2/schema/soo/dml";
_ed "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_fg "github.com/unidoc/unioffice/v2/schema/soo/ofc/sharedTypes";_ef "github.com/unidoc/unioffice/v2/schema/soo/sml";_g "github.com/unidoc/unioffice/v2/spreadsheet";_a "github.com/unidoc/unioffice/v2/spreadsheet/formula";
_ee "github.com/unidoc/unioffice/v2/spreadsheet/reference";_be "github.com/unidoc/unipdf/v4/creator";_e "github.com/unidoc/unipdf/v4/model";_fc "image";_d "math";_dg "sort";_b "strconv";);func (_ebfb *convertContext )makeCells (){_dfa :=_ebfb ._fcb ;_edd :=_dfa .Rows ();
_cgd :=0;for _gba ,_faa :=range _ebfb ._gcbg {if _gba < _ebfb ._cgdc ||(_gba > _ebfb ._fgbc &&_ebfb ._fgbc > 0){continue ;};_faa ._ecd =[]*cell {};_fga :=0.0;_dcge :=_faa ._fdbb ;if _faa ._cebc {_fdgc :=_edd [_cgd ];_cgd ++;_fac :=_faa ._dgbbd ;for _ ,_gdgd :=range _fdgc .Cells (){_eecg ,_bag :=_ee .ParseCellReference (_gdgd .Reference ());
if _bag !=nil {_c .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_bag );continue ;};if int (_eecg .ColumnIdx )< _ebfb ._gcfcd ||(int (_eecg .ColumnIdx )> _ebfb ._fcbd &&_ebfb ._fcbd > 0){continue ;
};_gdb :=_ebfb ._dfdg [_eecg .ColumnIdx ];_gfb :=_gdb ._aeba ;_cdb :=_gfb ;_dcgg :=_gdb ._eggc ;var _dea ,_cfg ,_bbe ,_bga bool ;for _ ,_aeg :=range _ebfb ._bcb {if _eecg .RowIdx >=_aeg ._aef &&_eecg .RowIdx <=_aeg ._bfbfe &&_eecg .ColumnIdx >=_aeg ._fafb &&_eecg .ColumnIdx <=_aeg ._gbed {if _eecg .ColumnIdx ==_aeg ._fafb &&_eecg .RowIdx ==_aeg ._aef {_gfb =_aeg ._bac ;
_fac =_aeg ._fgc ;};_dea =_eecg .RowIdx !=_aeg ._aef ;_cfg =_eecg .RowIdx !=_aeg ._bfbfe ;_bbe =_eecg .ColumnIdx !=_aeg ._fafb ;_bga =_eecg .ColumnIdx !=_aeg ._gbed ;};};var _gbab *style ;for _ ,_cgb :=range _ebfb ._dagd {_cgdg ,_abcb ,_baa :=_ee .ParseRangeReference (_cgb .Reference ());
if _baa !=nil ||_cgdg .RowIdx > _eecg .RowIdx ||_cgdg .ColumnIdx > _eecg .ColumnIdx ||_abcb .RowIdx < _eecg .RowIdx ||_abcb .ColumnIdx < _eecg .ColumnIdx ||_ebfb ._ddee .StyleSheet .X ().TableStyles ==nil {continue ;};_bdf :=_eecg .RowIdx ==_cgdg .RowIdx ;
for _ ,_bgd :=range _ebfb ._ddee .StyleSheet .X ().TableStyles .TableStyle {if _cgb .X ().TableStyleInfo .NameAttr !=nil &&_bgd .NameAttr ==*_cgb .X ().TableStyleInfo .NameAttr {for _ ,_bgad :=range _bgd .TableStyleElement {if !_bdf &&_bgad .TypeAttr ==_ef .ST_TableStyleTypeWholeTable {_gbab =_ebfb .getDxfStyle (_bgad .DxfIdAttr );
};if _bdf &&_bgad .TypeAttr ==_ef .ST_TableStyleTypeHeaderRow {_gbab =_ebfb .getDxfStyle (_bgad .DxfIdAttr );};};};};};_dfab :=_ebfb .getStyleFromCell (_gdgd ,_dcge ,_dcgg ,_gbab );var _aeb ,_agg ,_cec ,_abdb bool ;var _efcg ,_adg ,_agb ,_gdc *border ;
var _ddf _ef .ST_VerticalAlignment ;var _aed _ef .ST_HorizontalAlignment ;if _dfab !=nil {if !_dea {_efcg =_dfab ._dada ;};if !_cfg {_adg =_dfab ._bfaa ;};if !_bbe {_agb =_dfab ._becd ;};if !_bga {_gdc =_dfab ._cgae ;};if _adg !=nil &&_adg ._feg > _fga {_fga =_adg ._feg ;
};_ddf =_dfab ._adf ;_aed =_dfab ._fffg ;if _dfab ._bfbd !=nil {_aeb =*_dfab ._bfbd ;};if _dfab ._eba !=nil {_agg =*_dfab ._eba ;};_cec =_dfab ._bbce ;_abdb =_dfab ._geec ;};var _bfda _be .Color ;if _dfab !=nil &&_dfab ._efffa !=nil {_bfda =_be .ColorRGBFromHex (*_dfab ._efffa );
};_gde ,_cead :=_ebfb .getContentFromCell (_dfa ,_gdgd ,_dfab ,_gfb ,_cec ,_abdb );_dbg :=&cell {_gca :_cead ,_gcca :_gfb ,_eed :_cdb ,_dadac :_fac ,_agac :_gde ,_eabe :_efcg ,_ccfa :_adg ,_gfaa :_agb ,_fcf :_gdc ,_gbea :_aeb ,_acda :_agg ,_bfbf :_bfda };
_ebfb .alignSymbolsHorizontally (_dbg ,_aed );_ebfb .alignSymbolsVertically (_dbg ,_ddf );_faa ._ecd =append (_faa ._ecd ,_dbg );};};_faa ._fgd =_fga ;};};var _fbec =map[uint32 ]_be .PageSize {1:_be .PageSize {8.5*_fd .Inch ,11*_fd .Inch },2:_be .PageSize {8.5*_fd .Inch ,11*_fd .Inch },3:_be .PageSize {11*_fd .Inch ,17*_fd .Inch },4:_be .PageSize {17*_fd .Inch ,11*_fd .Inch },5:_be .PageSize {8.5*_fd .Inch ,14*_fd .Inch },6:_be .PageSize {5.5*_fd .Inch ,8.5*_fd .Inch },7:_be .PageSize {7.5*_fd .Inch ,10*_fd .Inch },8:_be .PageSize {_ecfa (297),_ecfa (420)},9:_be .PageSize {_ecfa (210),_ecfa (297)},10:_be .PageSize {_ecfa (210),_ecfa (297)},11:_be .PageSize {_ecfa (148),_ecfa (210)},70:_be .PageSize {_ecfa (105),_ecfa (148)},12:_be .PageSize {_ecfa (250),_ecfa (354)},13:_be .PageSize {_ecfa (182),_ecfa (257)},14:_be .PageSize {8.5*_fd .Inch ,13*_fd .Inch },20:_be .PageSize {4.125*_fd .Inch ,9.5*_fd .Inch },27:_be .PageSize {_ecfa (110),_ecfa (220)},28:_be .PageSize {_ecfa (162),_ecfa (229)},34:_be .PageSize {_ecfa (250),_ecfa (176)},29:_be .PageSize {_ecfa (324),_ecfa (458)},30:_be .PageSize {_ecfa (229),_ecfa (324)},31:_be .PageSize {_ecfa (114),_ecfa (162)},37:_be .PageSize {3.88*_fd .Inch ,7.5*_fd .Inch },43:_be .PageSize {_ecfa (100),_ecfa (148)},69:_be .PageSize {_ecfa (200),_ecfa (148)}};
func (_gccf *convertContext )makePages (){for _ ,_bba :=range _gccf ._cca {for _ ,_bfe :=range _gccf ._cag {_bba ._cceg =append (_bba ._cceg ,&page {_cfef :[]*pageRow {},_ded :_bba ,_bda :_bfe });};};};const _eeb =64.0;func (_bbfe *convertContext )drawPage (_deb *page ){_gfa :=_bbfe ._aedd ;
_fdaf :=_bbfe ._ccea ;for _ ,_ged :=range _deb ._cfef {_afc :=_bbfe ._gcbg [_ged ._fcg ];for _ ,_bfab :=range _ged ._fba {var _dccd float64 ;if _ged ._fcg > 1{_dccd =_bbfe ._gcbg [_ged ._fcg -1]._fgd ;};var _agd ,_ceff float64 ;if _fgb :=_bfab ._eabe ;
_fgb !=nil {_agd =_fgb ._feg ;};if _gbad :=_bfab ._ccfa ;_gbad !=nil {_ceff =_gbad ._feg ;};_fefb :=_gfa +_afc ._beee -0.5*(_dccd -_agd );_bcd :=_gfa +_afc ._beee +_afc ._dgbbd +0.5*(_afc ._fgd +_ceff );_afff :=_fdaf +_bfab ._aeag ;_cbd :=_afff +_bfab ._eed ;
if _bfab ._bfbf !=nil &&_bfab ._bfbf !=_be .ColorBlack {_bf .FillRectangle (_bbfe ._ddaf ,_afff ,_fefb ,_cbd -_afff ,_bcd -_fefb ,_bfab ._bfbf );};};};for _ ,_dfb :=range _deb ._cfef {_fbe :=_bbfe ._gcbg [_dfb ._fcg ];for _ ,_aaeb :=range _dfb ._fba {_cedf :=_aaeb ._acg < _aaeb ._aeag ;
_egee :=_aaeb ._bcbd > _aaeb ._aeag +_aaeb ._gcca ;var _afcd ,_gdeg bool ;for _ ,_eab :=range _aaeb ._agac {for _ ,_bedd :=range _eab ._abbc {if _cedf &&!_afcd {_afcd =_bedd ._debg < 0;};if _egee &&!_gdeg {_gdeg =_aaeb ._gcca < _bedd ._debg +_bedd ._fbdg ;
};if _aaeb ._aeag +_bedd ._debg >=_aaeb ._acg &&_aaeb ._aeag +_bedd ._debg +_bedd ._fbdg <=_aaeb ._bcbd {_gdge :=_bbfe ._ddaf .NewStyledParagraph ();_bgf :=_fdaf +_aaeb ._aeag +_bedd ._debg ;_daf :=_gfa +_fbe ._beee +_eab ._efca -_bedd ._ffgg -_ecfa (0.5);
_gdge .SetPos (_bgf ,_daf );var _cecc *_be .TextChunk ;if _bedd ._egea !=""{_cecc =_gdge .AddExternalLink (_bedd ._bagd ,_bedd ._egea );}else {_cecc =_gdge .Append (_bedd ._bagd );};if _bedd ._fcac !=nil {_cecc .Style =*_bedd ._fcac ;};_bbfe ._ddaf .Draw (_gdge );
};};};var _dagc ,_abcf ,_fbd ,_cce ,_afd ,_cgag float64 ;var _afcc ,_eddb ,_agcag ,_gfgf _be .Color ;if _gaf :=_aaeb ._eabe ;_gaf !=nil {_dagc =_gaf ._feg ;_afcc =_gaf ._dacg ;};if _fcaf :=_aaeb ._ccfa ;_fcaf !=nil {_abcf =_fcaf ._feg ;_eddb =_fcaf ._dacg ;
};if _afg :=_aaeb ._gfaa ;_afg !=nil {_fbd =_afg ._feg ;_afd =_fbd /2;_agcag =_afg ._dacg ;};if _facc :=_aaeb ._fcf ;_facc !=nil {_cce =_facc ._feg ;_cgag =_cce /2;_gfgf =_facc ._dacg ;};var _bbg float64 ;if _dfb ._fcg > 1{_bbg =_bbfe ._gcbg [_dfb ._fcg -1]._fgd ;
};_eeg :=_gfa +_fbe ._beee -0.5*(_bbg -_dagc );_cfaa :=_gfa +_fbe ._beee +_fbe ._dgbbd +0.5*(_fbe ._fgd +_abcf );_agge :=_fdaf +_aaeb ._aeag ;_ccba :=_agge +_aaeb ._eed ;_bf .DrawLine (_bbfe ._ddaf ,_agge ,_eeg ,_ccba ,_eeg ,_dagc ,_afcc );_bf .DrawLine (_bbfe ._ddaf ,_agge ,_cfaa ,_ccba ,_cfaa ,_abcf ,_eddb );
if !_afcd {_bf .DrawLine (_bbfe ._ddaf ,_agge -_afd ,_eeg ,_agge -_afd ,_cfaa ,_fbd ,_agcag );};if !_gdeg {_bf .DrawLine (_bbfe ._ddaf ,_ccba -_cgag ,_eeg ,_ccba -_cgag ,_cfaa ,_cce ,_gfgf );};};};for _ ,_dff :=range _deb ._ede {if _dff !=nil {_bbfe ._ddaf .Draw (_dff );
};};};

// Options contains the options for convert process
type Options struct{

// DefaultPageSize is applied when there is no page size explicitly set in the document.
// A4 is the default option.
DefaultPageSize _bf .PageSize ;};type colInfo struct{_fbc float64 ;_aeba float64 ;_eggc *style ;};const _edg =3;func (_agab *convertContext )getImage (_dcgc _fc .Image ,_cgfa ,_ccdc ,_ecbg ,_adga ,_adc ,_eddd float64 ,_efag _bf .ImgPart )*_be .Image {_adga +=_agab ._aedd ;
_ecbg +=_agab ._ccea ;_ddbd ,_dbge :=_bf .GetImage (_agab ._ddaf ,_dcgc ,_cgfa ,_ccdc ,_ecbg ,_adga ,_adc ,_eddd ,_efag );if _dbge !=nil {_c .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_dbge );
return nil ;};return _ddbd ;};func (_eeag *convertContext )getStyleFromRPrElt (_cefg *_ef .CT_RPrElt )*style {if _cefg ==nil ||_cefg .RPrEltChoice ==nil ||len (_cefg .RPrEltChoice )==0{return nil ;};_gbcf :=&style {};for _ ,_ffb :=range _cefg .RPrEltChoice {if _ffb .RFont !=nil {_gbcf ._cbcd =&_ffb .RFont .ValAttr ;
};if _cfdf :=_ffb .B ;_cfdf !=nil {_ebc :=_cfdf .ValAttr ==nil ||*_cfdf .ValAttr ;_gbcf ._acec =&_ebc ;};if _fbg :=_ffb .I ;_fbg !=nil {_egaa :=_fbg .ValAttr ==nil ||*_fbg .ValAttr ;_gbcf ._ddc =&_egaa ;};if _ffcf :=_ffb .U ;_ffcf !=nil {_gedg :=_ffcf .ValAttr ==_ef .ST_UnderlineValuesSingle ||_ffcf .ValAttr ==_ef .ST_UnderlineValuesUnset ;
_gbcf ._eecc =&_gedg ;};if _gacd :=_ffb .VertAlign ;_gacd !=nil {_dgg :=_gacd .ValAttr ==_fg .ST_VerticalAlignRunSuperscript ;_gbcf ._bfbd =&_dgg ;_aebgd :=_gacd .ValAttr ==_fg .ST_VerticalAlignRunSubscript ;_gbcf ._eba =&_aebgd ;};if _fdff :=_ffb .Sz ;
_fdff !=nil {_dcf :=_fdff .ValAttr ;_gbcf ._ddfg =&_dcf ;};if _ecde :=_ffb .Color ;_ecde !=nil {_gbcf ._fgac =_eeag .getColorStringFromSmlColor (_ecde );};};return _gbcf ;};func (_beda *convertContext )getColorStringFromSmlColor (_bgff *_ef .CT_Color )*string {var _addd string ;
if _bgff .RgbAttr !=nil {_addd =*_bgff .RgbAttr ;}else if _bgff .IndexedAttr !=nil &&*_bgff .IndexedAttr < 64{_addd =_bgfg [*_bgff .IndexedAttr ];}else if _bgff .ThemeAttr !=nil {_fbb :=*_bgff .ThemeAttr ;_addd =_beda .getColorFromTheme (_fbb );};if _addd ==""{return nil ;
};if len (_addd )> 6{_addd =_addd [(len (_addd )-6):];};if _bgff .TintAttr !=nil {_dbddg :=*_bgff .TintAttr ;_addd =_bf .AdjustColorByTint (_addd ,_dbddg );};_addd ="\u0023"+_addd ;return &_addd ;};func (_aaf *convertContext )makePagespans (){_aaf ._cca =[]*pagespan {};
_egc :=0.0;_aag :=0;for _edb ,_fae :=range _aaf ._dfdg {_fda :=_fae ._aeba ;if _egc +_fda <=_aaf ._ceb {_fae ._fbc =_egc ;_egc +=_fda ;}else {_fae ._fbc =0;_aaf ._cca =append (_aaf ._cca ,&pagespan {_gegf :_egc ,_fggg :_aag ,_cedc :_edb });_egc =_fda ;
_aag =_edb ;};};_aaf ._cca =append (_aaf ._cca ,&pagespan {_gegf :_egc ,_fggg :_aag ,_cedc :len (_aaf ._dfdg )});};func _gafe (_gbcg ,_cge *style ){if _cge ==nil {return ;};if _gbcg ==nil {_gbcg =_cge ;return ;};if _gbcg ._efffa ==nil {_gbcg ._efffa =_cge ._efffa ;
};if _gbcg ._cbcd ==nil {_gbcg ._cbcd =_cge ._cbcd ;};if _gbcg ._fgac ==nil {_gbcg ._fgac =_cge ._fgac ;};if _gbcg ._ddfg ==nil {_gbcg ._ddfg =_cge ._ddfg ;};if _gbcg ._acec ==nil {_gbcg ._acec =_cge ._acec ;};if _gbcg ._ddc ==nil {_gbcg ._ddc =_cge ._ddc ;
};if _gbcg ._eecc ==nil {_gbcg ._eecc =_cge ._eecc ;};if _gbcg ._bfbd ==nil {_gbcg ._bfbd =_cge ._bfbd ;};if _gbcg ._eba ==nil {_gbcg ._eba =_cge ._eba ;};if _gbcg ._dada ==nil {_gbcg ._dada =_cge ._dada ;};if _gbcg ._bfaa ==nil {_gbcg ._bfaa =_cge ._bfaa ;
};if _gbcg ._becd ==nil {_gbcg ._becd =_cge ._becd ;};if _gbcg ._cgae ==nil {_gbcg ._cgae =_cge ._cgae ;};if _gbcg ._adf ==_ef .ST_VerticalAlignmentUnset {_gbcg ._adf =_cge ._adf ;};if _gbcg ._fffg ==_ef .ST_HorizontalAlignmentUnset {_gbcg ._fffg =_cge ._fffg ;
};};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _bf .RegisterFontsFromDirectory (dirName )};type pageRow struct{_fcg int ;_fba []*cell ;};func _eef (_efce []*symbol )float64 {_fbdc :=0.0;for _ ,_becc :=range _efce {_fbdc +=_becc ._fbdg ;
};return _fbdc ;};func (_ccc *convertContext )fillPages (){for _dda ,_geee :=range _ccc ._cag {_gbbg :=_ccc ._gcbg [_geee ._ega :_geee ._cbg ];for _dgcc ,_acdc :=range _gbbg {_degda :=0;_dgb :=0.0;_dcc :=[]*cell {};if _acdc ._cebc {for _ ,_cegb :=range _acdc ._ecd {_agca :=_ccc ._cca [_degda ];
_ccc ._eagd =_agca ._cceg [_dda ];_ccc ._eagd ._gbc =true ;_agce :=_cegb ._eed ;if _dgb +_agce > _agca ._gegf {_ccc .addRowToPage (_dcc ,_dgcc );_dcc =[]*cell {_cegb };_dgb =_agce ;_degda ++;}else {_cegb ._aeag =_dgb ;_dcc =append (_dcc ,_cegb );_dgb +=_agce ;
};};if len (_dcc )> 0{_aaeg :=_ccc ._cca [_degda ];_ccc ._eagd =_aaeg ._cceg [_dda ];_ccc ._eagd ._gbc =true ;_ccc .addRowToPage (_dcc ,_dgcc );};};};};};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;
);const _cc =0.0;func _dgdg (_ggbb []*symbol )float64 {_bgg :=0.0;for _ ,_ddef :=range _ggbb {if _ddef ._ffgg > _bgg {_bgg =_ddef ._ffgg ;};};return _bgg ;};const _eec =0.64;type colWidthRange struct{_faee int ;_bae int ;_dded float64 ;_eegb *style ;};
func (_dfgb *convertContext )determineMaxIndexes (){var _da ,_bdb int ;_da =int (_dfgb ._fcb .MaxColumnIdx ());_gag :=_dfgb ._fcb .Rows ();if len (_gag )> 0{_bdb =int (_gag [len (_gag )-1].RowNumber ());};for _ ,_ec :=range _dfgb ._ecag {if _ec ._ddff >=_bdb {_bdb =_ec ._ddff +1;
};if _ec ._dee >=_da {_da =_ec ._dee +1;};};_dfgb ._egff =_bdb ;_dfgb ._fcd =_da ;};func (_dac *convertContext )makeRows (){_aff :=[]*rowInfo {};_cd :=_dac ._fcb .Rows ();_ffg :=0;_fab :=0.0;for _cfa ,_dbb :=range _cd {if _cfa < _dac ._cgdc ||(_cfa > _dac ._fgbc &&_dac ._fgbc > 0){continue ;
};_ffg ++;_fb :=int (_dbb .RowNumber ());if _fb > _ffg {for _acf :=_ffg ;_acf < _fb ;_acf ++{_aff =append (_aff ,&rowInfo {_dgbbd :_cf /_gc });_fab +=_cf /_gc ;};_ffg =_fb ;};var _aae float64 ;if _dbb .X ().HtAttr ==nil {_aae =_cf ;}else {_aae =*_dbb .X ().HtAttr ;
};_aff =append (_aff ,&rowInfo {_dgbbd :_aae /_gc ,_cebc :true ,_fdbb :_dac .getStyle (_dbb .X ().SAttr )});_fab +=_aae /_gc ;};for _dca :=len (_aff );_dca < _dac ._egff ;_dca ++{_aff =append (_aff ,&rowInfo {_dgbbd :_cf /_gc });_fab +=_cf /_gc ;};if _dac ._cddc ||_fab >=_dac ._bggb {_gcg :=_dac ._agec ;
if _dac ._bggb /_fab < _dac ._agec {_gcg =_dac ._bggb /_fab ;};for _ ,_gf :=range _aff {_gf ._dgbbd *=_gcg ;};};_dac ._gcbg =_aff ;};func (_bfb *convertContext )makeCols (){_ggd :=_bfb ._fcb ;_fdg :=_ggd .X ();_beg :=[]*colInfo {};_bfa :=[]colWidthRange {};
if _bbd :=_fdg .Cols ;len (_bbd )> 0{for _ ,_dgf :=range _bbd [0].Col {_ffe :=_eeb ;if _eca :=_dgf .WidthAttr ;_eca !=nil {if *_eca > 0.83{*_eca -=0.83;};if *_eca <=1{_ffe =*_eca *11;}else {_ffe =5+*_eca *6;};};_fee :=int (_dgf .MinAttr -1);_fca :=int (_dgf .MaxAttr -1);
_bfa =append (_bfa ,colWidthRange {_faee :_fee ,_bae :_fca ,_dded :_ffe ,_eegb :_bfb .getStyle (_dgf .StyleAttr )});};};_egf :=0;for _gbe :=0;_gbe <=_bfb ._fcd ;_gbe ++{if _gbe < _bfb ._gcfcd ||(_gbe > _bfb ._fcbd &&_bfb ._fcbd > 0){continue ;};var _dcg float64 ;
var _cgf *style ;if len (_bfa )==0{_dcg =_eeb ;}else if _egf < len (_bfa ){_gae :=_bfa [_egf ];if _gbe >=_gae ._faee &&_gbe <=_gae ._bae {_dcg =_gae ._dded ;_cgf =_gae ._eegb ;if _gbe ==_gae ._bae {_egf ++;};}else {continue ;};};_beg =append (_beg ,&colInfo {_aeba :_dcg ,_eggc :_cgf });
};_aceb :=0.0;for _ ,_fge :=range _beg {_aceb +=_fge ._aeba ;};_bfb ._agec =1.0;if _aceb > _bfb ._ceb {_bfb ._agec =_bfb ._ceb /_aceb ;for _ ,_bec :=range _beg {_bec ._aeba *=_bfb ._agec ;};};_bfb ._dfdg =_beg ;};type symbol struct{_bagd string ;_debg float64 ;
_ffgg float64 ;_fbdg float64 ;_fcac *_be .TextStyle ;_egea string ;};func (_efd *convertContext )makeAnchors (){_fea ,_bg :=_efd ._fcb .GetDrawing ();if _fea !=nil {for _ ,_eg :=range _fea .EG_Anchor {_cea :=&anchor {};if _gd :=_eg .AnchorChoice .TwoCellAnchor ;
_gd !=nil {_ccg ,_bdg :=_gd .From ,_gd .To ;if _ccg ==nil ||_bdg ==nil {return ;};_cea ._bddd =int (_ccg .Row );_cea ._cafe =_bf .FromSTCoordinate (_ccg .RowOff );_cea ._gdee =int (_ccg .Col );_cea ._ccgd =_bf .FromSTCoordinate (_ccg .ColOff );_cea ._ddff =int (_bdg .Row );
_cea ._fbce =_bf .FromSTCoordinate (_bdg .RowOff );_cea ._dee =int (_bdg .Col );_cea ._gceb =_bf .FromSTCoordinate (_bdg .ColOff );if _ced :=_gd .ObjectChoicesChoice ;_ced !=nil {if _ege :=_ced .Pic ;_ege !=nil {if _acc :=_ege .BlipFill ;_acc !=nil {if _af :=_acc .Blip ;
_af !=nil {if _ebf :=_af .EmbedAttr ;_ebf !=nil {for _ ,_cfd :=range _bg .X ().Relationship {if _cfd .IdAttr ==*_ebf {for _ ,_bfdb :=range _efd ._ddee .Images {if _bfdb .Target ()==_cfd .TargetAttr {_fef ,_abf :=_bb .Open (_bfdb .Path ());if _abf !=nil {_c .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_abf );
continue ;};_bc ,_ ,_abf :=_fc .Decode (_fef );if _abf !=nil {_c .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_abf );continue ;};_cea ._baec =_bc ;};};};};};};};}else if _dga :=_ced .GraphicFrame ;
_dga !=nil {if _gdg :=_dga .Graphic ;_gdg !=nil {if _aga :=_gdg .GraphicData ;_aga !=nil {for _ ,_dc :=range _aga .Any {if _degg ,_ace :=_dc .(*_ed .Chart );_ace {for _ ,_ff :=range _bg .X ().Relationship {if _ff .IdAttr ==_degg .IdAttr {_abd :=_efd ._ddee .GetChartByTargetId (_ff .TargetAttr );
if _abd !=nil {_cea ._fgbe =_abd ;};};};};};};};};};};if _cea ._baec !=nil ||_cea ._fgbe !=nil {_efd ._ecag =append (_efd ._ecag ,_cea );};};};};const _de =2;type convertContext struct{_ddaf *_be .Creator ;_ddee *_g .Workbook ;_accd *_fe .Theme ;_fcb *_g .Sheet ;
_bde *_g .StyleSheet ;_egff int ;_fcd int ;_cca []*pagespan ;_eagd *page ;_dfdg []*colInfo ;_gcbg []*rowInfo ;_cag []*rowspan ;_aedd float64 ;_ccea float64 ;_bggb float64 ;_ceb float64 ;_bcb []*mergedCell ;_ecag []*anchor ;_agec float64 ;_gcfcd int ;_fcbd int ;
_cgdc int ;_fgbc int ;_cddc bool ;_dagd []_g .Table ;};const _cf =15.0;type cell struct{_gca _ef .ST_CellType ;_bdgg int ;_aeag float64 ;_agac []*line ;_gcca float64 ;_eed float64 ;_dadac float64 ;_acg float64 ;_bcbd float64 ;_ccgb *_be .TextStyle ;_eabe *border ;
_ccfa *border ;_gfaa *border ;_fcf *border ;_gbea bool ;_acda bool ;_bfbf _be .Color ;};func (_cab *convertContext )alignSymbolsVertically (_ffd *cell ,_cced _ef .ST_VerticalAlignment ){var _ceffc float64 ;switch _cced {case _ef .ST_VerticalAlignmentTop :_ceffc =_de ;
if _ffd ._gbea {_ceffc -=_ga ;}else if _ffd ._acda {_ceffc +=4*_ga ;};for _ ,_ecef :=range _ffd ._agac {_ceffc +=_ecef ._cfag ;_ecef ._efca =_ceffc ;_ceffc +=_cg ;};case _ef .ST_VerticalAlignmentCenter :_dfc :=0.0;for _ ,_aee :=range _ffd ._agac {_dfc +=_aee ._cfag +_ecfa (1);
};_ceffc =0.5*(_ffd ._dadac -_dfc );if _ffd ._gbea {_ceffc -=2*_ga ;}else if _ffd ._acda {_ceffc +=2*_ga ;};for _ ,_cee :=range _ffd ._agac {_ceffc +=_cee ._cfag +0.5*_cg ;_cee ._efca =_ceffc ;_ceffc +=0.5*_cg ;};default:_ceffc =_ffd ._dadac -_de ;if _ffd ._gbea {_ceffc -=4*_ga ;
}else if _ffd ._acda {_ceffc +=_ga ;};for _faec :=len (_ffd ._agac )-1;_faec >=0;_faec --{_ffd ._agac [_faec ]._efca =_ceffc ;_ceffc -=_ffd ._agac [_faec ]._cfag ;_ceffc -=_cg ;};};};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_e .PdfFont ){_bf .RegisterFont (name ,style ,font );};func _ffgb (_gfc *symbol ){_gefg :=_be .New ();_gda :=_gefg .NewStyledParagraph ();_gda .SetMargins (0,0,0,0);_fabb :=_gda .Append (_gfc ._bagd );
if _gfc ._fcac !=nil {_fabb .Style =*_gfc ._fcac ;};_gfc ._ffgg =_gda .Height ();if _gfc ._fbdg ==0{_gfc ._fbdg =_gda .Width ();};};func (_cgef *convertContext )getColorFromTheme (_gfff uint32 )string {_debfc :=_cgef ._ddee .Themes ();if len (_debfc )!=0{_eefa :=_debfc [0];
if _aaee :=_eefa .ThemeElements ;_aaee !=nil {if _gabe :=_aaee .ClrScheme ;_gabe !=nil {switch _gfff {case 0:return _bf .GetColorStringFromDmlColor (_gabe .Lt1 );case 1:return _bf .GetColorStringFromDmlColor (_gabe .Dk1 );case 2:return _bf .GetColorStringFromDmlColor (_gabe .Lt2 );
case 3:return _bf .GetColorStringFromDmlColor (_gabe .Dk2 );case 4:return _bf .GetColorStringFromDmlColor (_gabe .Accent1 );case 5:return _bf .GetColorStringFromDmlColor (_gabe .Accent2 );case 6:return _bf .GetColorStringFromDmlColor (_gabe .Accent3 );
case 7:return _bf .GetColorStringFromDmlColor (_gabe .Accent4 );case 8:return _bf .GetColorStringFromDmlColor (_gabe .Accent5 );case 9:return _bf .GetColorStringFromDmlColor (_gabe .Accent6 );};};};};return "";};var _bgfg =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};
func (_dbfg *convertContext )getSymbolsFromR (_ffgf []*_ef .CT_RElt ,_agcb *style )[]*symbol {_fafc :=[]*symbol {};for _ ,_gce :=range _ffgf {_dgag :=_dbfg .combineCellStyleWithRPrElt (_agcb ,_gce .RPr );for _ ,_gge :=range _gce .T {_fafc =append (_fafc ,&symbol {_bagd :string (_gge ),_fcac :_dbfg .makeTextStyleFromCellStyle (_dgag )});
};};return _fafc ;};type style struct{_efffa *string ;_fgac *string ;_ddfg *float64 ;_cbcd *string ;_acec *bool ;_ddc *bool ;_eecc *bool ;_bfbd *bool ;_eba *bool ;_dada *border ;_bfaa *border ;_becd *border ;_cgae *border ;_bbce bool ;_adf _ef .ST_VerticalAlignment ;
_fffg _ef .ST_HorizontalAlignment ;_geec bool ;};func (_cgca *convertContext )getStyle (_fgcc *uint32 )*style {_aaa :=&style {};_cgdbc :=false ;if _fgcc !=nil {_fgdd :=_cgca ._bde .GetCellStyle (*_fgcc );if _cgca ._bde .GetNumberFormat (_fgdd .NumberFormat ()).GetFormat ()=="\u003b\u003b\u003b"{_aaa ._geec =true ;
};_aadc :=_fgdd .GetFill ();if _aadc !=nil &&_aadc .FillChoice !=nil &&_aadc .FillChoice .PatternFill !=nil {if _aadc .FillChoice .PatternFill .FgColor !=nil {_aaa ._efffa =_cgca .getColorStringFromSmlColor (_aadc .FillChoice .PatternFill .FgColor );}else if _aadc .FillChoice .PatternFill .BgColor !=nil {_aaa ._efffa =_cgca .getColorStringFromSmlColor (_aadc .FillChoice .PatternFill .BgColor );
};};_baf :=_fgdd .GetFont ();for _ ,_edae :=range _baf .FontChoice {if _edae .Name !=nil {_aaa ._cbcd =&_edae .Name .ValAttr ;_cgdbc =true ;}else if _edae .B !=nil {_cabd :=_edae .B .ValAttr ==nil ||*_edae .B .ValAttr ;_aaa ._acec =&_cabd ;_cgdbc =true ;
}else if _edae .I !=nil {_gaff :=_edae .I .ValAttr ==nil ||*_edae .I .ValAttr ;_aaa ._ddc =&_gaff ;_cgdbc =true ;}else if _edae .U !=nil {_becdf :=_edae .U .ValAttr ==_ef .ST_UnderlineValuesSingle ||_edae .U .ValAttr ==_ef .ST_UnderlineValuesUnset ;_aaa ._eecc =&_becdf ;
_cgdbc =true ;}else if _edae .Sz !=nil {_egad :=_edae .Sz .ValAttr ;_aaa ._ddfg =&_egad ;_cgdbc =true ;}else if _edae .VertAlign !=nil {_aafe :=_edae .VertAlign .ValAttr ==_fg .ST_VerticalAlignRunSuperscript ;_aaa ._bfbd =&_aafe ;_acga :=_edae .VertAlign .ValAttr ==_fg .ST_VerticalAlignRunSubscript ;
_aaa ._eba =&_acga ;_cgdbc =true ;}else if _edae .Color !=nil {_aaa ._fgac =_cgca .getColorStringFromSmlColor (_edae .Color );_cgdbc =true ;};};_feag :=_fgdd .GetBorder ();if _feag .Top !=nil {_aaa ._dada =_cgca .getBorder (_feag .Top );_cgdbc =true ;};
if _feag .Bottom !=nil {_aaa ._bfaa =_cgca .getBorder (_feag .Bottom );_cgdbc =true ;};if _feag .Left !=nil {_aaa ._becd =_cgca .getBorder (_feag .Left );_cgdbc =true ;};if _feag .Right !=nil {_aaa ._cgae =_cgca .getBorder (_feag .Right );_cgdbc =true ;
};if _fgdd .Wrapped (){_aaa ._bbce =true ;_cgdbc =true ;};if _abfe :=_fgdd .GetVerticalAlignment ();_abfe !=_ef .ST_VerticalAlignmentUnset {_aaa ._adf =_abfe ;_cgdbc =true ;};if _bdef :=_fgdd .GetHorizontalAlignment ();_bdef !=_ef .ST_HorizontalAlignmentUnset {_aaa ._fffg =_bdef ;
_cgdbc =true ;};};if _cgdbc {return _aaa ;};return nil ;};type line struct{_efca float64 ;_abbc []*symbol ;_cfag float64 ;};func (_aec *convertContext )makeRowspans (){var _gbeb float64 ;_fag :=0;for _gbb ,_cdd :=range _aec ._gcbg {_cfaf :=_cdd ._dgbbd +_cdd ._fgd ;
if _gbeb +_cfaf <=_aec ._bggb {_cdd ._beee =_gbeb ;_gbeb +=_cfaf ;}else {_aec ._cag =append (_aec ._cag ,&rowspan {_aebg :_gbeb ,_ega :_fag ,_cbg :_gbb });_fag =_gbb ;_cdd ._beee =0;_gbeb =_cfaf ;};};_aec ._cag =append (_aec ._cag ,&rowspan {_aebg :_gbeb ,_ega :_fag ,_cbg :len (_aec ._gcbg )});
};func (_cbb *convertContext )getDxfStyle (_bbde *uint32 )*style {_cfac :=&style {};_ddba :=false ;if _bbde !=nil {var _abbe *_ef .CT_Dxf ;for _cgbc ,_dgca :=range _cbb ._bde .X ().Dxfs .Dxf {if uint32 (_cgbc )==*_bbde {_abbe =_dgca ;};};if _abbe ==nil {return nil ;
};if _abbe .Fill !=nil &&_abbe .Fill .FillChoice !=nil &&_abbe .Fill .FillChoice .PatternFill !=nil {if _abbe .Fill .FillChoice .PatternFill .FgColor !=nil {_cfac ._efffa =_cbb .getColorStringFromSmlColor (_abbe .Fill .FillChoice .PatternFill .FgColor );
}else if _abbe .Fill .FillChoice .PatternFill .BgColor !=nil {_cfac ._efffa =_cbb .getColorStringFromSmlColor (_abbe .Fill .FillChoice .PatternFill .BgColor );};};_ffed :=_abbe .Font ;for _ ,_dcd :=range _ffed .FontChoice {if _dcd .Name !=nil {_cfac ._cbcd =&_dcd .Name .ValAttr ;
_ddba =true ;}else if _dcd .B !=nil {_cefb :=_dcd .B .ValAttr ==nil ||*_dcd .B .ValAttr ;_cfac ._acec =&_cefb ;_ddba =true ;}else if _dcd .I !=nil {_eeca :=_dcd .I .ValAttr ==nil ||*_dcd .I .ValAttr ;_cfac ._ddc =&_eeca ;_ddba =true ;}else if _dcd .U !=nil {_fcdd :=_dcd .U .ValAttr ==_ef .ST_UnderlineValuesSingle ||_dcd .U .ValAttr ==_ef .ST_UnderlineValuesUnset ;
_cfac ._eecc =&_fcdd ;_ddba =true ;}else if _dcd .Sz !=nil {_gaeb :=_dcd .Sz .ValAttr ;_cfac ._ddfg =&_gaeb ;_ddba =true ;}else if _dcd .VertAlign !=nil {_dab :=_dcd .VertAlign .ValAttr ==_fg .ST_VerticalAlignRunSuperscript ;_cfac ._bfbd =&_dab ;_fgf :=_dcd .VertAlign .ValAttr ==_fg .ST_VerticalAlignRunSubscript ;
_cfac ._eba =&_fgf ;_ddba =true ;}else if _dcd .Color !=nil {_cfac ._fgac =_cbb .getColorStringFromSmlColor (_dcd .Color );_ddba =true ;};};_gcee :=_abbe .Border ;if _gcee !=nil {if _gcee .Top !=nil {_cfac ._dada =_cbb .getBorder (_gcee .Top );_ddba =true ;
};if _gcee .Bottom !=nil {_cfac ._bfaa =_cbb .getBorder (_gcee .Bottom );_ddba =true ;};if _gcee .Left !=nil {_cfac ._becd =_cbb .getBorder (_gcee .Left );_ddba =true ;};if _gcee .Right !=nil {_cfac ._cgae =_cbb .getBorder (_gcee .Right );_ddba =true ;
};};if _abbe .Alignment !=nil {if _bdcc :=_abbe .Alignment .VerticalAttr ;_bdcc !=_ef .ST_VerticalAlignmentUnset {_cfac ._adf =_bdcc ;_ddba =true ;};if _agbf :=_abbe .Alignment .HorizontalAttr ;_agbf !=_ef .ST_HorizontalAlignmentUnset {_cfac ._fffg =_agbf ;
_ddba =true ;};};};if _ddba {return _cfac ;};return nil ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_bf .FontStyle ;func (_bgc *convertContext )getBorder (_adgf *_ef .CT_BorderPr )*border {_eaee :=&border {};switch _adgf .StyleAttr {case _ef .ST_BorderStyleHair :_eaee ._feg =_gcb /2;case _ef .ST_BorderStyleThin :_eaee ._feg =_gcb ;case _ef .ST_BorderStyleMedium :_eaee ._feg =_gcb *2;
case _ef .ST_BorderStyleThick :_eaee ._feg =_gcb *4;};if _eaee ._feg ==0.0{return nil ;};if _ffgc :=_adgf .Color ;_ffgc !=nil {_fceg :=_bgc .getColorStringFromSmlColor (_ffgc );if _fceg !=nil {_eaee ._dacg =_be .ColorRGBFromHex (*_fceg );}else {_eaee ._dacg =_be .ColorBlack ;
};};return _eaee ;};type border struct{_feg float64 ;_dacg _be .Color ;};func (_eaa *convertContext )makeMergedCells (){_ecf :=[]*mergedCell {};for _ ,_fbf :=range _eaa ._fcb .MergedCells (){_gbf ,_cfb ,_degd :=_ee .ParseRangeReference (_fbf .Reference ());
if _degd !=nil {_c .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_degd );continue ;};_dbf :=mergedCell {_aef :_gbf .RowIdx ,_fafb :_gbf .ColumnIdx ,_bfbfe :_cfb .RowIdx ,_gbed :_cfb .ColumnIdx };
for _gbg :=_dbf ._fafb -1;_gbg < _dbf ._gbed ;_gbg ++{_dbf ._bac +=_eaa ._dfdg [_gbg ]._aeba ;};for _geb :=_dbf ._aef -1;_geb < _dbf ._bfbfe ;_geb ++{_dbf ._fgc +=_eaa ._gcbg [_geb ]._dgbbd ;};_ecf =append (_ecf ,&_dbf );};_eaa ._bcb =_ecf ;};func (_cef *convertContext )distributeAnchors (){for _ ,_efad :=range _cef ._ecag {_gcbf ,_bad :=_efad ._bddd ,_efad ._cafe ;
_cfe ,_dbfd :=_efad ._gdee ,_efad ._ccgd ;_dag ,_geeec :=_efad ._ddff ,_efad ._fbce ;_beca ,_gdcg :=_efad ._dee ,_efad ._gceb ;if _gcbf < _cef ._cgdc ||(_dag > _cef ._fgbc &&_cef ._fgbc > 0){continue ;};if _cfe < _cef ._gcfcd ||(_beca > _cef ._fcbd &&_cef ._fcbd > 0){continue ;
};var _dcgf ,_fce ,_cga ,_feac *page ;for _ ,_dgd :=range _cef ._cca {for _ ,_fff :=range _dgd ._cceg {if _gcbf >=_fff ._bda ._ega &&_gcbf < _fff ._bda ._cbg {if _cfe >=_fff ._ded ._fggg &&_cfe < _fff ._ded ._cedc {_fff ._gbc =true ;_dcgf =_fff ;};if _beca >=_fff ._ded ._fggg &&_beca < _fff ._ded ._cedc {_fff ._gbc =true ;
_fce =_fff ;};};if _dag >=_fff ._bda ._ega &&_dag < _fff ._bda ._cbg {if _cfe >=_fff ._ded ._fggg &&_cfe < _fff ._ded ._cedc {_fff ._gbc =true ;_feac =_fff ;};if _beca >=_fff ._ded ._fggg &&_beca < _fff ._ded ._cedc {_fff ._gbc =true ;_cga =_fff ;};};};
};_cccf :=_dcgf !=_fce ;_gcf :=_dcgf !=_feac ;if _cccf &&_gcf {_bdbf :=_cef ._dfdg [_cfe ]._fbc +_fd .FromEMU (_dbfd );_ccb :=_dcgf ._ded ._gegf ;_bagg :=_cef ._dfdg [_beca ]._fbc +_fd .FromEMU (_gdcg );_beb :=_cef ._gcbg [_gcbf ]._beee +_fd .FromEMU (_bad );
_dba :=float64 (_dcgf ._bda ._aebg );_egb :=_cef ._gcbg [_dag ]._beee +_fd .FromEMU (_geeec );_cbf :=_bagg +_ccb -_bdbf ;_bbaf :=_egb +_dba -_beb ;_eag :=_cef .imageFromAnchor (_efad ,_cbf ,_bbaf );_dcgf ._ede =append (_dcgf ._ede ,_cef .getImage (_eag ,_bbaf ,_cbf ,_bdbf ,_beb ,_ccb -_bdbf ,_dba -_beb ,_bf .ImgPart_lt ));
_fce ._ede =append (_fce ._ede ,_cef .getImage (_eag ,_bbaf ,_cbf ,0,_beb ,_ccb -_bdbf ,_dba -_beb ,_bf .ImgPart_rt ));_feac ._ede =append (_feac ._ede ,_cef .getImage (_eag ,_bbaf ,_cbf ,_bdbf ,0,_ccb -_bdbf ,_dba -_beb ,_bf .ImgPart_lb ));_cga ._ede =append (_cga ._ede ,_cef .getImage (_eag ,_bbaf ,_cbf ,0,0,_ccb -_bdbf ,_dba -_beb ,_bf .ImgPart_rb ));
}else if _cccf {_gfg :=_cef ._gcbg [_gcbf ]._beee +_fd .FromEMU (_bad );_fgag :=_cef ._gcbg [_dag ]._beee +_fd .FromEMU (_geeec );_fcee :=_cef ._dfdg [_cfe ]._fbc +_fd .FromEMU (_dbfd );_bbb :=_dcgf ._ded ._gegf ;_gccc :=_cef ._dfdg [_beca ]._fbc +_fd .FromEMU (_gdcg );
_gfgd :=_gccc +_bbb -_fcee ;_gbbd :=_fgag -_gfg ;_faf :=_cef .imageFromAnchor (_efad ,_gfgd ,_gbbd );_dcgf ._ede =append (_dcgf ._ede ,_cef .getImage (_faf ,_gbbd ,_gfgd ,_fcee ,_gfg ,_bbb -_fcee ,0,_bf .ImgPart_l ));_fce ._ede =append (_fce ._ede ,_cef .getImage (_faf ,_gbbd ,_gfgd ,0,_gfg ,_bbb -_fcee ,0,_bf .ImgPart_r ));
}else if _gcf {_cgce :=_cef ._dfdg [_cfe ]._fbc +_fd .FromEMU (_dbfd );_def :=_cef ._dfdg [_beca ]._fbc +_fd .FromEMU (_gdcg );_cfab :=_cef ._gcbg [_gcbf ]._beee +_fd .FromEMU (_bad );_geg :=float64 (_dcgf ._bda ._aebg );_bbcb :=_cef ._gcbg [_dag ]._beee +_fd .FromEMU (_geeec );
_abfa :=_def -_cgce ;_facf :=_bbcb +_geg -_cfab ;_ebg :=_cef .imageFromAnchor (_efad ,_abfa ,_facf );_dcgf ._ede =append (_dcgf ._ede ,_cef .getImage (_ebg ,_facf ,_abfa ,_cgce ,_cfab ,0,_geg -_cfab ,_bf .ImgPart_t ));_feac ._ede =append (_feac ._ede ,_cef .getImage (_ebg ,_facf ,_abfa ,_cgce ,0,0,_geg -_cfab ,_bf .ImgPart_b ));
}else {_feeb :=_cef ._dfdg [_cfe ]._fbc +_fd .FromEMU (_dbfd );_fafg :=_cef ._dfdg [_beca ]._fbc +_fd .FromEMU (_gdcg );_effe :=_cef ._gcbg [_gcbf ]._beee +_fd .FromEMU (_bad );_dcb :=_cef ._gcbg [_dag ]._beee +_fd .FromEMU (_geeec );_dce :=_fafg -_feeb ;
_ddd :=_dcb -_effe ;_bfee :=_cef .imageFromAnchor (_efad ,_dce ,_ddd );_dcgf ._ede =append (_dcgf ._ede ,_cef .getImage (_bfee ,_ddd ,_dce ,_feeb ,_effe ,0,0,_bf .ImgPart_whole ));};};};var _cg =_ecfa (1);func (_aage *convertContext )alignSymbolsHorizontally (_gdad *cell ,_cfed _ef .ST_HorizontalAlignment ){if _cfed ==_ef .ST_HorizontalAlignmentUnset {switch _gdad ._gca {case _ef .ST_CellTypeB :_cfed =_ef .ST_HorizontalAlignmentCenter ;
case _ef .ST_CellTypeN :_cfed =_ef .ST_HorizontalAlignmentRight ;default:_cfed =_ef .ST_HorizontalAlignmentLeft ;};};var _eaed float64 ;for _ ,_defc :=range _gdad ._agac {switch _cfed {case _ef .ST_HorizontalAlignmentLeft :_eaed =_edg ;case _ef .ST_HorizontalAlignmentRight :_ccd :=_eef (_defc ._abbc );
_eaed =_gdad ._gcca -_edg -_ccd ;case _ef .ST_HorizontalAlignmentCenter :_cde :=_eef (_defc ._abbc );_eaed =(_gdad ._gcca -_cde )/2;};for _ ,_bef :=range _defc ._abbc {_bef ._debg +=_eaed ;};};};var _gc =3.025/_ecfa (1);func (_ffc *convertContext )drawSheet (){for _gef ,_bbdd :=range _ffc ._cca {_fdb :=len (_bbdd ._cceg );
if _gef ==len (_ffc ._cca )-1{for _age :=len (_bbdd ._cceg )-1;_age >=0;_age --{if !_bbdd ._cceg [_age ]._gbc {_fdb =_age ;};};};_bdc :=_bbdd ._cceg [:_fdb ];for _ ,_faaa :=range _bdc {_ffc ._ddaf .NewPage ();_ffc .drawPage (_faaa );};};};func (_aab *convertContext )imageFromAnchor (_efff *anchor ,_bca ,_abe float64 )_fc .Image {if _efff ._baec !=nil {return _efff ._baec ;
};if _efff ._fgbe !=nil {_ddfc ,_dbdd :=_bf .MakeImageFromChartSpace (_efff ._fgbe ,_bca ,_abe ,_aab ._accd ,_aab ._ddee );if _dbdd !=nil {_c .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_dbdd );
return nil ;};return _ddfc ;};return nil ;};const _ge =0.25;type rowInfo struct{_beee float64 ;_cebc bool ;_dgbbd float64 ;_fdbb *style ;_ecd []*cell ;_fgd float64 ;};const _ga =1.5;func (_fagf *convertContext )getStyleFromCell (_bceg _g .Cell ,_gac ,_bdfe ,_eac *style )*style {if _eac !=nil {_gafe (_eac ,_gac );
_gafe (_eac ,_bdfe );return _eac ;};_cafc :=_bceg .X ();_caa :=_fagf .getStyle (_cafc .SAttr );_gafe (_caa ,_gac );_gafe (_caa ,_bdfe );return _caa ;};func _ecff (_cafa *bool )bool {return _cafa !=nil &&*_cafa };func (_feed *convertContext )combineCellStyleWithRPrElt (_gdf *style ,_aade *_ef .CT_RPrElt )*style {_aggf :=*_gdf ;
_bcfe :=_feed .getStyleFromRPrElt (_aade );if _bcfe ==nil {return &_aggf ;};if _bcfe ._fgac !=nil {_aggf ._fgac =_bcfe ._fgac ;};if _bcfe ._ddfg !=nil {_aggf ._ddfg =_bcfe ._ddfg ;};if _bcfe ._cbcd !=nil {_aggf ._cbcd =_bcfe ._cbcd ;};if _bcfe ._acec !=nil {_aggf ._acec =_bcfe ._acec ;
};if _bcfe ._ddc !=nil {_aggf ._ddc =_bcfe ._ddc ;};if _bcfe ._eecc !=nil {_aggf ._eecc =_bcfe ._eecc ;};if _bcfe ._bfbd !=nil {_aggf ._bfbd =_bcfe ._bfbd ;};if _bcfe ._eba !=nil {_aggf ._eba =_bcfe ._eba ;};return &_aggf ;};func (_acde *convertContext )makeTextStyleFromCellStyle (_dae *style )*_be .TextStyle {_ecge :=_acde ._ddaf .NewTextStyle ();
if _dae ==nil {_ecge .FontSize =_bf .DefaultFontSize ;_ecge .Font =_bf .AssignStdFontByName (_ecge ,_bf .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_ecge ;};if _ecff (_dae ._eecc ){_ecge .Underline =true ;_ecge .UnderlineStyle =_be .TextDecorationLineStyle {Offset :0.5,Thickness :_ecfa (1/32)};
};var _cffd FontStyle ;if _ecff (_dae ._acec )&&_ecff (_dae ._ddc ){_cffd =FontStyle_BoldItalic ;}else if _ecff (_dae ._acec ){_cffd =FontStyle_Bold ;}else if _ecff (_dae ._ddc ){_cffd =FontStyle_Italic ;}else {_cffd =FontStyle_Regular ;};_fcdc :="\u0064e\u0066\u0061\u0075\u006c\u0074";
if _dae ._cbcd !=nil {_fcdc =*_dae ._cbcd ;};if _aca ,_daae :=_bf .StdFontsMap [_fcdc ];_daae {_ecge .Font =_bf .AssignStdFontByName (_ecge ,_aca [_cffd ]);}else if _dedb :=_bf .GetRegisteredFont (_fcdc ,_cffd );_dedb !=nil {_ecge .Font =_dedb ;}else {_c .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_fcdc ,_cffd );
_ecge .Font =_bf .AssignStdFontByName (_ecge ,_bf .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_cffd ]);};if _dae ._ddfg !=nil {_ecge .FontSize =_d .Round (*_dae ._ddfg *_acde ._agec );};if _dae ._fgac !=nil {_ecge .Color =_be .ColorRGBFromHex (*_dae ._fgac );
};if _dae ._bfbd !=nil &&*_dae ._bfbd {_ecge .FontSize *=_eec ;}else if _dae ._eba !=nil &&*_dae ._eba {_ecge .FontSize *=_eec ;};return &_ecge ;};type pagespan struct{_gegf float64 ;_cceg []*page ;_fggg int ;_cedc int ;};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_g .Sheet )*_be .Creator {return ConvertToPdfWithOptions (s ,nil )};type rowspan struct{_aebg float64 ;_ega int ;_cbg int ;};var _gcb =_ecfa (0.0625);func (_afa *convertContext )getSymbolsFromString (_geed string ,_eaeg *style )[]*symbol {_fbea :=[]*symbol {};
_ecb :=_afa .makeTextStyleFromCellStyle (_eaeg );for _ ,_bbfg :=range _geed {_fbea =append (_fbea ,&symbol {_bagd :string (_bbfg ),_fcac :_ecb });};return _fbea ;};func (_eae *convertContext )addRowToPage (_dddg []*cell ,_egg int ){_gagc :=0.0;_add :=_eae ._ceb ;
for _ ,_bdd :=range _dddg {if len (_bdd ._agac )!=0{_bdd ._acg =_gagc ;_gagc =_bdd ._aeag +_bdd ._gcca ;};};for _ggb :=len (_dddg )-1;_ggb >=0;_ggb --{_abb :=_dddg [_ggb ];if len (_abb ._agac )!=0{_abb ._bcbd =_add ;_add =_abb ._aeag ;};};_eae ._eagd ._cfef =append (_eae ._eagd ._cfef ,&pageRow {_fcg :_egg ,_fba :_dddg });
};func (_fdca *convertContext )getContentFromCell (_ffgd *_g .Sheet ,_cdf _g .Cell ,_dgcb *style ,_bce float64 ,_gebd ,_fad bool )([]*line ,_ef .ST_CellType ){if _fad {return []*line {},_ef .ST_CellTypeS ;};_cdfg :=_cdf .X ();var _eea []*symbol ;switch _cdfg .TAttr {case _ef .ST_CellTypeS :_ddb :=_cdfg .V ;
if _ddb !=nil {_bab ,_geda :=_b .Atoi (*_ddb );if _geda ==nil {_acdd :=_fdca ._ddee .SharedStrings .X ().Si [_bab ];if _acdd .T !=nil {_eea =_fdca .getSymbolsFromString (*_acdd .T ,_dgcb );}else if _acdd .R !=nil {_eea =_fdca .getSymbolsFromR (_acdd .R ,_dgcb );
};};};case _ef .ST_CellTypeB :_bdgb :=_cdfg .V ;if _bdgb !=nil {if *_bdgb =="\u0030"{_eea =_fdca .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_dgcb );}else {_eea =_fdca .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_dgcb );};};case _ef .ST_CellTypeStr :if _cdfg .F !=nil {_bcf :=_a .NewEvaluator ();
_gcfc :=_ffgd .FormulaContext ().Cell (_cdf .Reference (),_bcf );_eea =_fdca .getSymbolsFromString (_gcfc .Value (),_dgcb );};default:_eea =_fdca .getSymbolsFromString (_cdf .GetFormattedValue (),_dgcb );};_bee :=0.0;_adb :=0.0;var _daa []*line ;var _cbc bool ;
if _dgcb !=nil {if _dgcb ._bfbd !=nil {if *_dgcb ._bfbd {_cbc =true ;};};if _dgcb ._eba !=nil {if *_dgcb ._eba {_cbc =true ;};};};if _gebd {_daa =[]*line {};_cgcd :=_bce -2*_edg ;_afe :=[]*symbol {};for _ ,_dad :=range _eea {_ffgb (_dad );if _bee +_dad ._fbdg >=_cgcd {_eegd :=_dgdg (_afe );
if _cbc {_eegd /=_eec ;};_daa =append (_daa ,&line {_efca :_adb ,_abbc :_afe ,_cfag :_eegd });_afe =[]*symbol {_dad };_bee =_dad ._fbdg ;_adb +=_eegd ;}else {_dad ._debg =_bee ;_bee +=_dad ._fbdg ;_afe =append (_afe ,_dad );};};_ade :=_dgdg (_afe );if _cbc {_ade /=_eec ;
};if len (_afe )> 0{_daa =append (_daa ,&line {_efca :_adb ,_abbc :_afe ,_cfag :_ade });};}else {for _ ,_egbe :=range _eea {_ffgb (_egbe );_egbe ._debg =_bee ;_bee +=_egbe ._fbdg ;};if len (_eea )> 0{_daa =[]*line {&line {_abbc :_eea ,_cfag :_dgdg (_eea )}};
};};_cff :=_cdfg .TAttr ;if _cff ==_ef .ST_CellTypeUnset {_cff =_ef .ST_CellTypeN ;};return _daa ,_cff ;};func _ecfa (_fcba float64 )float64 {return _fcba *_fd .Millimeter };type mergedCell struct{_aef uint32 ;_fafb uint32 ;_bfbfe uint32 ;_gbed uint32 ;
_bac float64 ;_fgc float64 ;};type page struct{_cfef []*pageRow ;_gbc bool ;_ede []*_be .Image ;_ded *pagespan ;_bda *rowspan ;};type anchor struct{_baec _fc .Image ;_fgbe *_ed .ChartSpace ;_bddd int ;_cafe int64 ;_gdee int ;_ccgd int64 ;_ddff int ;_fbce int64 ;
_dee int ;_gceb int64 ;};

// ConvertToPdfWithOptions convert a sheet to PDF with given options.
func ConvertToPdfWithOptions (s *_g .Sheet ,opts *Options )*_be .Creator {_cgc :=s .X ();if _cgc ==nil {return nil ;};var _bd _be .PageSize ;_fdd :=true ;_ag :=false ;if _cgc .SheetPr !=nil &&_cgc .SheetPr .PageSetUpPr !=nil &&_cgc .SheetPr .PageSetUpPr .FitToPageAttr !=nil &&*_cgc .SheetPr .PageSetUpPr .FitToPageAttr {_ag =true ;
};if _ab :=_cgc .PageSetup ;_ab !=nil {_fdd =_ab .OrientationAttr ==_ef .ST_OrientationLandscape ;if _gg :=_ab .PaperSizeAttr ;_gg !=nil {_bd =_fbec [*_gg ];};};if (_bd ==_be .PageSize {}){_bd =_bf .GetDefaultPageSize ();if opts !=nil &&opts .DefaultPageSize !=_bf .DefaultPageSize {_bd =_bf .GetPageDimensions (opts .DefaultPageSize );
};};if _fdd {_bd [0],_bd [1]=_bd [1],_bd [0];};_ac :=_be .New ();_ac .SetPageSize (_bd );var _ea ,_aa ,_ce ,_db float64 ;if _gb :=_cgc .PageMargins ;_gb !=nil {_ce =_gb .LeftAttr ;_db =_gb .RightAttr ;_ea =_gb .TopAttr ;_aa =_gb .BottomAttr ;};if _ce < _ge {_ce =_ge ;
};if _db < _ge {_db =_ge ;};if _ea < _cc {_ea =_cc ;};if _aa < _cc {_aa =_cc ;};_ea *=_fd .Inch ;_aa *=_fd .Inch ;_ce *=_fd .Inch ;_db *=_fd .Inch ;_ac .SetPageMargins (_ce ,_db ,_ea ,_aa );_df :=s .Workbook ();var _ba *_fe .Theme ;if len (_df .Themes ())> 0{_ba =_df .Themes ()[0];
};var _ca ,_ceg ,_dd ,_caf int ;for _ ,_ae :=range _df .DefinedNames (){if _ae .Name ()=="\u005f\u0078l\u006e\u006d\u002eP\u0072\u0069\u006e\u0074\u005f\u0041\u0072\u0065\u0061"{_cfc ,_aad ,_bbf ,_eb :=_bf .ParseExcelRange (_ae .Content ());if _eb ==nil &&s .Name ()==_cfc {_ca =int (_aad .ColumnIdx );
_ceg =int (_bbf .ColumnIdx );_dd =int (_aad .RowIdx );_caf =int (_bbf .RowIdx );};};};_bed :=[]_g .Table {};if _cgc .TableParts !=nil &&_cgc .TableParts .TablePart !=nil {_fdf :=0;_gcc :=s .Workbook ().Tables ();_dg .Slice (_gcc [:],func (_agc ,_acd int )bool {return _gcc [_agc ].X ().IdAttr < _gcc [_acd ].X ().IdAttr });
for _ ,_fec :=range s .Workbook ().Sheets (){if _fec .Name ()==s .Name (){break ;}else {if _fec .X ().TableParts !=nil &&_fec .X ().TableParts .TablePart !=nil {_fdf +=len (_fec .X ().TableParts .TablePart );};};};if len (_gcc )>=_fdf +len (_cgc .TableParts .TablePart ){_bed =append (_bed ,_gcc [_fdf :_fdf +len (_cgc .TableParts .TablePart )]...);
};};_fa :=&convertContext {_ddaf :_ac ,_fcb :s ,_ddee :s .Workbook (),_accd :_ba ,_bde :&s .Workbook ().StyleSheet ,_aedd :_ea ,_ccea :_ce ,_bggb :_bd [1]-_aa -_ea ,_ceb :_bd [0]-_db -_ce ,_gcfcd :_ca ,_fcbd :_ceg ,_cgdc :_dd ,_fgbc :_caf ,_cddc :_ag ,_dagd :_bed };
_fa .makeAnchors ();_fa .determineMaxIndexes ();if _fa ._egff ==0&&_fa ._fcd ==0{_ac .NewPage ();return _ac ;};_fa .makeCols ();_fa .makeRows ();_fa .makeMergedCells ();_fa .makeCells ();_fa .makePagespans ();_fa .makeRowspans ();_fa .makePages ();_fa .fillPages ();
_fa .distributeAnchors ();_fa .drawSheet ();return _ac ;};