//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_a "github.com/unidoc/unioffice/common/logger";_ed "github.com/unidoc/unioffice/common/tempstorage";_ag "github.com/unidoc/unioffice/internal/convertutils";_ga "github.com/unidoc/unioffice/measurement";_cb "github.com/unidoc/unioffice/schema/soo/dml";_g "github.com/unidoc/unioffice/schema/soo/dml/chart";_d "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_cf "github.com/unidoc/unioffice/schema/soo/sml";_ae "github.com/unidoc/unioffice/spreadsheet";_dg "github.com/unidoc/unioffice/spreadsheet/reference";_e "github.com/unidoc/unipdf/v3/creator";_fg "github.com/unidoc/unipdf/v3/model";_cg "image";_f "strconv";);func (_afcb *convertContext )alignSymbolsHorizontally (_cbd *cell ,_bbg _cf .ST_HorizontalAlignment ){if _bbg ==_cf .ST_HorizontalAlignmentUnset {switch _cbd ._fdbg {case _cf .ST_CellTypeB :_bbg =_cf .ST_HorizontalAlignmentCenter ;case _cf .ST_CellTypeN :_bbg =_cf .ST_HorizontalAlignmentRight ;default:_bbg =_cf .ST_HorizontalAlignmentLeft ;};};var _gdb float64 ;for _ ,_gecc :=range _cbd ._dbc {switch _bbg {case _cf .ST_HorizontalAlignmentLeft :_gdb =_b ;case _cf .ST_HorizontalAlignmentRight :_fgcb :=_bcb (_gecc ._dcadd );_gdb =_cbd ._eafaa -_b -_fgcb ;case _cf .ST_HorizontalAlignmentCenter :_gbg :=_bcb (_gecc ._dcadd );_gdb =(_cbd ._eafaa -_gbg )/2;};for _ ,_faga :=range _gecc ._dcadd {_faga ._bed +=_gdb ;};};};func (_ceb *convertContext )makeCols (){_ab :=_ceb ._fege ;_cda :=_ab .X ();_bbf :=[]*colInfo {};_agc :=[]colWidthRange {};if _bgea :=_cda .Cols ;len (_bgea )> 0{for _ ,_gb :=range _bgea [0].Col {_gg :=65.0;if _cbc :=_gb .WidthAttr ;_cbc !=nil {if *_cbc > 0.83{*_cbc -=0.83;};if *_cbc <=1{_gg =*_cbc *11;}else {_gg =5+*_cbc *6;};};_dcb :=int (_gb .MinAttr -1);_edg :=int (_gb .MaxAttr -1);_agc =append (_agc ,colWidthRange {_acgd :_dcb ,_aece :_edg ,_cbcf :_gg ,_aaa :_ceb .getStyle (_gb .StyleAttr )});};};_fb :=0;for _edgf :=0;_edgf <=_ceb ._eff ;_edgf ++{var _gcd float64 ;var _ade *style ;if _fb >=len (_agc ){_gcd =65;}else {_cbg :=_agc [_fb ];if _edgf >=_cbg ._acgd &&_edgf <=_cbg ._aece {_gcd =_cbg ._cbcf ;_ade =_cbg ._aaa ;if _edgf ==_cbg ._aece {_fb ++;};}else {_gcd =65;};};_bbf =append (_bbf ,&colInfo {_fage :_gcd ,_fab :_ade });};_ceb ._dbfc =_bbf ;};func (_dfbf *convertContext )imageFromAnchor (_dedc *anchor ,_cca ,_fdcc float64 )_cg .Image {if _dedc ._aedg !=nil {return _dedc ._aedg ;};if _dedc ._agaf !=nil {_fdd ,_abed :=_ag .MakeImageFromChartSpace (_dedc ._agaf ,_cca ,_fdcc ,_dfbf ._edge );if _abed !=nil {_a .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_abed );return nil ;};return _fdd ;};return nil ;};func (_dcaa *convertContext )combineCellStyleWithRPrElt (_egf *style ,_acdb *_cf .CT_RPrElt )*style {_adeg :=*_egf ;_fgb :=_dcaa .getStyleFromRPrElt (_acdb );if _fgb ==nil {return &_adeg ;};if _fgb ._dbe !=nil {_adeg ._dbe =_fgb ._dbe ;};if _fgb ._fddg !=nil {_adeg ._fddg =_fgb ._fddg ;};if _fgb ._adff !=nil {_adeg ._adff =_fgb ._adff ;};if _fgb ._gbdf !=nil {_adeg ._gbdf =_fgb ._gbdf ;};if _fgb ._fgf !=nil {_adeg ._fgf =_fgb ._fgf ;};if _fgb ._aec !=nil {_adeg ._aec =_fgb ._aec ;};if _fgb ._bggd !=nil {_adeg ._bggd =_fgb ._bggd ;};if _fgb ._fgad !=nil {_adeg ._fgad =_fgb ._fgad ;};return &_adeg ;};func (_gcaf *convertContext )getSymbolsFromString (_ggg string ,_afd *style )[]*symbol {_bag :=[]*symbol {};_ead :=_gcaf .makeTextStyleFromCellStyle (_afd );for _ ,_gde :=range _ggg {_bag =append (_bag ,&symbol {_gcad :string (_gde ),_fcge :_ead });};return _bag ;};type mergedCell struct{_ffbc uint32 ;_gceg uint32 ;_bgf uint32 ;_eacc uint32 ;_baa float64 ;_daba float64 ;};var _cgda =3.025/_dgf (1);var _dgdc =map[uint32 ]_e .PageSize {1:_e .PageSize {8.5*_ga .Inch ,11*_ga .Inch },2:_e .PageSize {8.5*_ga .Inch ,11*_ga .Inch },3:_e .PageSize {11*_ga .Inch ,17*_ga .Inch },4:_e .PageSize {17*_ga .Inch ,11*_ga .Inch },5:_e .PageSize {8.5*_ga .Inch ,14*_ga .Inch },6:_e .PageSize {5.5*_ga .Inch ,8.5*_ga .Inch },7:_e .PageSize {7.5*_ga .Inch ,10*_ga .Inch },8:_e .PageSize {_dgf (297),_dgf (420)},9:_e .PageSize {_dgf (210),_dgf (297)},10:_e .PageSize {_dgf (210),_dgf (297)},11:_e .PageSize {_dgf (148),_dgf (210)},70:_e .PageSize {_dgf (105),_dgf (148)},12:_e .PageSize {_dgf (250),_dgf (354)},13:_e .PageSize {_dgf (182),_dgf (257)},14:_e .PageSize {8.5*_ga .Inch ,13*_ga .Inch },20:_e .PageSize {4.125*_ga .Inch ,9.5*_ga .Inch },27:_e .PageSize {_dgf (110),_dgf (220)},28:_e .PageSize {_dgf (162),_dgf (229)},34:_e .PageSize {_dgf (250),_dgf (176)},29:_e .PageSize {_dgf (324),_dgf (458)},30:_e .PageSize {_dgf (229),_dgf (324)},31:_e .PageSize {_dgf (114),_dgf (162)},37:_e .PageSize {3.88*_ga .Inch ,7.5*_ga .Inch },43:_e .PageSize {_dgf (100),_dgf (148)},69:_e .PageSize {_dgf (200),_dgf (148)}};func _dgb (_adbc *symbol ){_eec :=_e .New ();_dcgg :=_eec .NewStyledParagraph ();_dcgg .SetMargins (0,0,0,0);_cfeg :=_dcgg .Append (_adbc ._gcad );if _adbc ._fcge !=nil {_cfeg .Style =*_adbc ._fcge ;};_adbc ._gcea =_dcgg .Height ();if _adbc ._bcbaa ==0{_adbc ._bcbaa =_dcgg .Width ();};};func (_cbbc *convertContext )drawSheet (){for _accf ,_deg :=range _cbbc ._egb {_cbf :=len (_deg ._acae );if _accf ==len (_cbbc ._egb )-1{for _dea :=len (_deg ._acae )-1;_dea >=0;_dea --{if !_deg ._acae [_dea ]._faf {_cbf =_dea ;};};};_gbfg :=_deg ._acae [:_cbf ];for _ ,_dbb :=range _gbfg {_cbbc ._gdbe .NewPage ();_cbbc .drawPage (_dbb );};};};const _cgd =0.64;func (_bef *convertContext )makeAnchors (){_dff ,_gab :=_bef ._fege .GetDrawing ();if _dff !=nil {for _ ,_cfa :=range _dff .EG_Anchor {_ad :=&anchor {};if _fdb :=_cfa .TwoCellAnchor ;_fdb !=nil {_ce ,_bb :=_fdb .From ,_fdb .To ;if _ce ==nil ||_bb ==nil {return ;};_ad ._agff =int (_ce .Row );_ad ._cbea =_ag .FromSTCoordinate (_ce .RowOff );_ad ._cge =int (_ce .Col );_ad ._eee =_ag .FromSTCoordinate (_ce .ColOff );_ad ._cdb =int (_bb .Row );_ad ._cbfg =_ag .FromSTCoordinate (_bb .RowOff );_ad ._effc =int (_bb .Col );_ad ._gdgd =_ag .FromSTCoordinate (_bb .ColOff );if _dd :=_fdb .Choice ;_dd !=nil {if _dc :=_dd .Pic ;_dc !=nil {if _gc :=_dc .BlipFill ;_gc !=nil {if _gcb :=_gc .Blip ;_gcb !=nil {if _aa :=_gcb .EmbedAttr ;_aa !=nil {for _ ,_bge :=range _gab .X ().Relationship {if _bge .IdAttr ==*_aa {for _ ,_ege :=range _bef ._gbff .Images {if _ege .Target ()==_bge .TargetAttr {_fca ,_gcf :=_ed .Open (_ege .Path ());if _gcf !=nil {_a .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_gcf );continue ;};_dbd ,_ ,_gcf :=_cg .Decode (_fca );if _gcf !=nil {_a .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_gcf );continue ;};_ad ._aedg =_dbd ;};};};};};};};}else if _aab :=_dd .GraphicFrame ;_aab !=nil {if _eaf :=_aab .Graphic ;_eaf !=nil {if _edad :=_eaf .GraphicData ;_edad !=nil {for _ ,_cc :=range _edad .Any {if _gad ,_fdbd :=_cc .(*_g .Chart );_fdbd {for _ ,_bgec :=range _gab .X ().Relationship {if _bgec .IdAttr ==_gad .IdAttr {_edade :=_bef ._gbff .GetChartByTargetId (_bgec .TargetAttr );if _edade !=nil {_ad ._agaf =_edade ;};};};};};};};};};};if _ad ._aedg !=nil ||_ad ._agaf !=nil {_bef ._bbcb =append (_bef ._bbcb ,_ad );};};};};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _ag .RegisterFontsFromDirectory (dirName )};func (_afc *convertContext )makePagespans (){_afc ._egb =[]*pagespan {};_cdf :=0.0;_cga :=0;for _abe ,_gdg :=range _afc ._dbfc {_abec :=_gdg ._fage ;if _cdf +_abec <=_afc ._faaa {_gdg ._gccb =_cdf ;_cdf +=_abec ;}else {_gdg ._gccb =0;_afc ._egb =append (_afc ._egb ,&pagespan {_cbff :_cdf ,_acdf :_cga ,_dae :_abe });_cdf =_abec ;_cga =_abe ;};};_afc ._egb =append (_afc ._egb ,&pagespan {_cbff :_cdf ,_acdf :_cga ,_dae :len (_afc ._dbfc )});};func (_gfaa *convertContext )getColorFromTheme (_cefc uint32 )string {_baeg :=_gfaa ._gbff .Themes ();if len (_baeg )!=0{_fcgdg :=_baeg [0];if _gabd :=_fcgdg .ThemeElements ;_gabd !=nil {if _fcdc :=_gabd .ClrScheme ;_fcdc !=nil {switch _cefc {case 0:return _ag .GetColorStringFromDmlColor (_fcdc .Lt1 );case 1:return _ag .GetColorStringFromDmlColor (_fcdc .Dk1 );case 2:return _ag .GetColorStringFromDmlColor (_fcdc .Lt2 );case 3:return _ag .GetColorStringFromDmlColor (_fcdc .Dk2 );case 4:return _ag .GetColorStringFromDmlColor (_fcdc .Accent1 );case 5:return _ag .GetColorStringFromDmlColor (_fcdc .Accent2 );case 6:return _ag .GetColorStringFromDmlColor (_fcdc .Accent3 );case 7:return _ag .GetColorStringFromDmlColor (_fcdc .Accent4 );case 8:return _ag .GetColorStringFromDmlColor (_fcdc .Accent5 );case 9:return _ag .GetColorStringFromDmlColor (_fcdc .Accent6 );};};};};return "";};func (_ddec *convertContext )getBorder (_ega *_cf .CT_BorderPr )*border {_edbe :=&border {};switch _ega .StyleAttr {case _cf .ST_BorderStyleThin :_edbe ._aaebf =_df ;case _cf .ST_BorderStyleMedium :_edbe ._aaebf =_df *2;case _cf .ST_BorderStyleThick :_edbe ._aaebf =_df *4;};if _edbe ._aaebf ==0.0{return nil ;};if _eeee :=_ega .Color ;_eeee !=nil {_baae :=_ddec .getColorStringFromSmlColor (_eeee );if _baae !=nil {_edbe ._dede =_e .ColorRGBFromHex (*_baae );}else {_edbe ._dede =_e .ColorBlack ;};};return _edbe ;};type line struct{_dgab float64 ;_dcadd []*symbol ;_bfc float64 ;};func (_ffe *convertContext )getStyle (_efd *uint32 )*style {_geee :=&style {};_bbfca :=false ;if _efd !=nil {_fdcg :=_ffe ._bda .GetCellStyle (*_efd );_ccb :=_fdcg .GetFont ();for _ ,_bdaf :=range _ccb .Name {if _bdaf !=nil {_geee ._adff =&_bdaf .ValAttr ;_bbfca =true ;break ;};};for _ ,_dfdb :=range _ccb .B {if _dfdb !=nil {_daf :=_dfdb .ValAttr ==nil ||*_dfdb .ValAttr ;_geee ._gbdf =&_daf ;_bbfca =true ;break ;};};for _ ,_faff :=range _ccb .I {if _faff !=nil {_bgcd :=_faff .ValAttr ==nil ||*_faff .ValAttr ;_geee ._fgf =&_bgcd ;_bbfca =true ;break ;};};for _ ,_aada :=range _ccb .U {if _aada !=nil {_fbcd :=_aada .ValAttr ==_cf .ST_UnderlineValuesSingle ||_aada .ValAttr ==_cf .ST_UnderlineValuesUnset ;_geee ._aec =&_fbcd ;_bbfca =true ;break ;};};for _ ,_cdc :=range _ccb .Sz {if _cdc !=nil {_eafbc :=_cdc .ValAttr /12*_ag .DefaultFontSize ;_geee ._fddg =&_eafbc ;_bbfca =true ;break ;};};for _ ,_cccf :=range _ccb .VertAlign {if _cccf !=nil {_caeb :=_cccf .ValAttr ==_d .ST_VerticalAlignRunSuperscript ;_geee ._bggd =&_caeb ;_fbdd :=_cccf .ValAttr ==_d .ST_VerticalAlignRunSubscript ;_geee ._fgad =&_fbdd ;_bbfca =true ;break ;};};for _ ,_edaded :=range _ccb .Color {if _edaded !=nil {_geee ._dbe =_ffe .getColorStringFromSmlColor (_edaded );_bbfca =true ;break ;};};_aeg :=_fdcg .GetBorder ();if _aeg .Top !=nil {_geee ._ccc =_ffe .getBorder (_aeg .Top );_bbfca =true ;};if _aeg .Bottom !=nil {_geee ._gfb =_ffe .getBorder (_aeg .Bottom );_bbfca =true ;};if _aeg .Left !=nil {_geee ._cdg =_ffe .getBorder (_aeg .Left );_bbfca =true ;};if _aeg .Right !=nil {_geee ._aaeb =_ffe .getBorder (_aeg .Right );_bbfca =true ;};if _fdcg .Wrapped (){_geee ._dead =true ;_bbfca =true ;};if _ffc :=_fdcg .GetVerticalAlignment ();_ffc !=_cf .ST_VerticalAlignmentUnset {_geee ._gadc =_ffc ;_bbfca =true ;};if _ffg :=_fdcg .GetHorizontalAlignment ();_ffg !=_cf .ST_HorizontalAlignmentUnset {_geee ._cded =_ffg ;_bbfca =true ;};};if _bbfca {return _geee ;};return nil ;};func (_dcbf *convertContext )getSymbolsFromR (_gbe []*_cf .CT_RElt ,_acca *style )[]*symbol {_feg :=[]*symbol {};for _ ,_dba :=range _gbe {_ddcg :=_dcbf .combineCellStyleWithRPrElt (_acca ,_dba .RPr );for _ ,_acgb :=range _dba .T {_feg =append (_feg ,&symbol {_gcad :string (_acgb ),_fcge :_dcbf .makeTextStyleFromCellStyle (_ddcg )});};};return _feg ;};func (_cabc *convertContext )alignSymbolsVertically (_afa *cell ,_fcae _cf .ST_VerticalAlignment ){var _ebc float64 ;switch _fcae {case _cf .ST_VerticalAlignmentTop :_ebc =_eg ;if _afa ._aeag {_ebc -=_bf ;}else if _afa ._bbe {_ebc +=4*_bf ;};for _ ,_gfe :=range _afa ._dbc {_ebc +=_gfe ._bfc ;_gfe ._dgab =_ebc ;_ebc +=_bc ;};case _cf .ST_VerticalAlignmentCenter :_gee :=0.0;for _ ,_fcd :=range _afa ._dbc {_gee +=_fcd ._bfc +_dgf (1);};_ebc =0.5*(_afa ._agfc -_gee );if _afa ._aeag {_ebc -=2*_bf ;}else if _afa ._bbe {_ebc +=2*_bf ;};for _ ,_ddca :=range _afa ._dbc {_ebc +=_ddca ._bfc +0.5*_bc ;_ddca ._dgab =_ebc ;_ebc +=0.5*_bc ;};default:_ebc =_afa ._agfc -_eg ;if _afa ._aeag {_ebc -=4*_bf ;}else if _afa ._bbe {_ebc +=_bf ;};for _cfbb :=len (_afa ._dbc )-1;_cfbb >=0;_cfbb --{_afa ._dbc [_cfbb ]._dgab =_ebc ;_ebc -=_afa ._dbc [_cfbb ]._bfc ;_ebc -=_bc ;};};};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_ag .FontStyle ;

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_fg .PdfFont ){_ag .RegisterFont (name ,style ,font );};func _bcb (_bcba []*symbol )float64 {_eca :=0.0;for _ ,_ffd :=range _bcba {_eca +=_ffd ._bcbaa ;};return _eca ;};func (_bfga *convertContext )addRowToPage (_bfb []*cell ,_fcbd int ){_fce :=0.0;_gda :=_bfga ._faaa ;for _ ,_aee :=range _bfb {if len (_aee ._dbc )!=0{_aee ._deaa =_fce ;_fce =_aee ._adgf +_aee ._eafaa ;};};for _ebf :=len (_bfb )-1;_ebf >=0;_ebf --{_aef :=_bfb [_ebf ];if len (_aef ._dbc )!=0{_aef ._fbg =_gda ;_gda =_aef ._adgf ;};};_bfga ._eea ._fagg =append (_bfga ._eea ._fagg ,&pageRow {_dega :_fcbd ,_bbfc :_bfb });};type anchor struct{_aedg _cg .Image ;_agaf *_g .ChartSpace ;_agff int ;_cbea int64 ;_cge int ;_eee int64 ;_cdb int ;_cbfg int64 ;_effc int ;_gdgd int64 ;};type rowspan struct{_cafae float64 ;_faea int ;_gdda int ;};var _bc =_dgf (1);func (_bd *convertContext )makeMergedCells (){_caf :=[]*mergedCell {};for _ ,_edb :=range _bd ._fege .MergedCells (){_de ,_cde ,_eed :=_dg .ParseRangeReference (_edb .Reference ());if _eed !=nil {_a .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_eed );continue ;};_aca :=mergedCell {_ffbc :_de .RowIdx ,_gceg :_de .ColumnIdx ,_bgf :_cde .RowIdx ,_eacc :_cde .ColumnIdx };for _fdg :=_aca ._gceg -1;_fdg < _aca ._eacc ;_fdg ++{_aca ._baa +=_bd ._dbfc [_fdg ]._fage ;};for _bcc :=_aca ._ffbc -1;_bcc < _aca ._bgf ;_bcc ++{_aca ._daba +=_bd ._adf [_bcc ]._ddeg ;};_caf =append (_caf ,&_aca );};_bd ._agcb =_caf ;};const _b =3;func (_dfc *convertContext )getStyleFromCell (_cefe _ae .Cell ,_adfe ,_gbc *style )*style {_dcab :=_cefe .X ();_affg :=_dfc .getStyle (_dcab .SAttr );_beed (_affg ,_adfe );_beed (_affg ,_gbc );return _affg ;};type cell struct{_fdbg _cf .ST_CellType ;_eafa int ;_adgf float64 ;_dbc []*line ;_eafaa float64 ;_deeg float64 ;_agfc float64 ;_deaa float64 ;_fbg float64 ;_abcb *_e .TextStyle ;_fcbe *border ;_ddfc *border ;_efa *border ;_dce *border ;_aeag bool ;_bbe bool ;};type page struct{_fagg []*pageRow ;_faf bool ;_cbdg []*_e .Image ;_dgc *pagespan ;_cfgb *rowspan ;};type convertContext struct{_gdbe *_e .Creator ;_gbff *_ae .Workbook ;_edge *_cb .Theme ;_fege *_ae .Sheet ;_bda *_ae .StyleSheet ;_add int ;_eff int ;_egb []*pagespan ;_eea *page ;_dbfc []*colInfo ;_adf []*rowInfo ;_ebed []*rowspan ;_fcec float64 ;_ada float64 ;_acb float64 ;_faaa float64 ;_agcb []*mergedCell ;_bbcb []*anchor ;};func (_fagd *convertContext )getColorStringFromSmlColor (_dgdg *_cf .CT_Color )*string {var _eggg string ;if _dgdg .RgbAttr !=nil {_eggg =*_dgdg .RgbAttr ;}else if _dgdg .IndexedAttr !=nil &&*_dgdg .IndexedAttr < 64{_eggg =_adg [*_dgdg .IndexedAttr ];}else if _dgdg .ThemeAttr !=nil {_eggf :=*_dgdg .ThemeAttr ;_eggg =_fagd .getColorFromTheme (_eggf );};if _eggg ==""{return nil ;};if len (_eggg )> 6{_eggg =_eggg [(len (_eggg )-6):];};if _dgdg .TintAttr !=nil {_ffef :=*_dgdg .TintAttr ;_eggg =_ag .AdjustColorByTint (_eggg ,_ffef );};_eggg ="\u0023"+_eggg ;return &_eggg ;};func (_ddfe *convertContext )makeTextStyleFromCellStyle (_ecfe *style )*_e .TextStyle {_bfd :=_ddfe ._gdbe .NewTextStyle ();if _ecfe ==nil {_bfd .FontSize =_ag .DefaultFontSize ;_bfd .Font =_ag .AssignStdFontByName (_bfd ,_ag .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_bfd ;};if _fbac (_ecfe ._aec ){_bfd .Underline =true ;_bfd .UnderlineStyle =_e .TextDecorationLineStyle {Offset :0.5,Thickness :_dgf (1/32)};};var _fcac FontStyle ;if _fbac (_ecfe ._gbdf )&&_fbac (_ecfe ._fgf ){_fcac =FontStyle_BoldItalic ;}else if _fbac (_ecfe ._gbdf ){_fcac =FontStyle_Bold ;}else if _fbac (_ecfe ._fgf ){_fcac =FontStyle_Italic ;}else {_fcac =FontStyle_Regular ;};_age :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _ecfe ._adff !=nil {_age =*_ecfe ._adff ;};if _cbdc ,_gecf :=_ag .StdFontsMap [_age ];_gecf {_bfd .Font =_ag .AssignStdFontByName (_bfd ,_cbdc [_fcac ]);}else if _acaf :=_ag .GetRegisteredFont (_age ,_fcac );_acaf !=nil {_bfd .Font =_acaf ;}else {_a .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_age ,_fcac );_bfd .Font =_ag .AssignStdFontByName (_bfd ,_ag .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_fcac ]);};if _ecfe ._fddg !=nil {_bfd .FontSize =*_ecfe ._fddg ;};if _ecfe ._dbe !=nil {_bfd .Color =_e .ColorRGBFromHex (*_ecfe ._dbe );};if _ecfe ._bggd !=nil &&*_ecfe ._bggd {_bfd .FontSize *=_cgd ;}else if _ecfe ._fgad !=nil &&*_ecfe ._fgad {_bfd .FontSize *=_cgd ;};return &_bfd ;};type style struct{_dbe *string ;_fddg *float64 ;_adff *string ;_gbdf *bool ;_fgf *bool ;_aec *bool ;_bggd *bool ;_fgad *bool ;_ccc *border ;_gfb *border ;_cdg *border ;_aaeb *border ;_dead bool ;_gadc _cf .ST_VerticalAlignment ;_cded _cf .ST_HorizontalAlignment ;};func (_gga *convertContext )makeCells (){_ec :=_gga ._fege ;_fcb :=_ec .Rows ();_bbc :=0;for _ ,_adc :=range _gga ._adf {_adc ._ffde =[]*cell {};_dee :=0.0;_cggd :=_adc ._bbaf ;if _adc ._bae {_ff :=_fcb [_bbc ];_bbc ++;_eaa :=_adc ._ddeg ;for _ ,_bec :=range _ff .Cells (){_cef ,_bdd :=_dg .ParseCellReference (_bec .Reference ());if _bdd !=nil {_a .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_bdd );continue ;};_fcg :=_gga ._dbfc [_cef .ColumnIdx ];_gd :=_fcg ._fage ;_feb :=_gd ;_eafb :=_fcg ._fab ;var _fbd ,_gbb ,_cdee ,_afe bool ;for _ ,_bba :=range _gga ._agcb {if _cef .RowIdx >=_bba ._ffbc &&_cef .RowIdx <=_bba ._bgf &&_cef .ColumnIdx >=_bba ._gceg &&_cef .ColumnIdx <=_bba ._eacc {if _cef .ColumnIdx ==_bba ._gceg &&_cef .RowIdx ==_bba ._ffbc {_gd =_bba ._baa ;_eaa =_bba ._daba ;};_fbd =_cef .RowIdx !=_bba ._ffbc ;_gbb =_cef .RowIdx !=_bba ._bgf ;_cdee =_cef .ColumnIdx !=_bba ._gceg ;_afe =_cef .ColumnIdx !=_bba ._eacc ;};};_cdd :=_gga .getStyleFromCell (_bec ,_cggd ,_eafb );var _egc ,_bdg ,_ddf bool ;var _cebb ,_bdc ,_ge ,_fbc *border ;var _fdf _cf .ST_VerticalAlignment ;var _abgc _cf .ST_HorizontalAlignment ;if _cdd !=nil {if !_fbd {_cebb =_cdd ._ccc ;};if !_gbb {_bdc =_cdd ._gfb ;};if !_cdee {_ge =_cdd ._cdg ;};if !_afe {_fbc =_cdd ._aaeb ;};if _bdc !=nil &&_bdc ._aaebf > _dee {_dee =_bdc ._aaebf ;};_fdf =_cdd ._gadc ;_abgc =_cdd ._cded ;if _cdd ._bggd !=nil {_egc =*_cdd ._bggd ;};if _cdd ._fgad !=nil {_bdg =*_cdd ._fgad ;};_ddf =_cdd ._dead ;};_aed ,_dbf :=_gga .getContentFromCell (_bec ,_cdd ,_gd ,_ddf );_cec :=&cell {_fdbg :_dbf ,_eafaa :_gd ,_deeg :_feb ,_agfc :_eaa ,_dbc :_aed ,_fcbe :_cebb ,_ddfc :_bdc ,_efa :_ge ,_dce :_fbc ,_aeag :_egc ,_bbe :_bdg };_gga .alignSymbolsHorizontally (_cec ,_abgc );_gga .alignSymbolsVertically (_cec ,_fdf );_adc ._ffde =append (_adc ._ffde ,_cec );};};_adc ._ecad =_dee ;};};func (_edd *convertContext )makeRowspans (){var _acd float64 ;_gge :=0;for _dda ,_cafa :=range _edd ._adf {_gac :=_cafa ._ddeg +_cafa ._ecad ;if _acd +_gac <=_edd ._acb {_cafa ._fef =_acd ;_acd +=_gac ;}else {_edd ._ebed =append (_edd ._ebed ,&rowspan {_cafae :_acd ,_faea :_gge ,_gdda :_dda });_gge =_dda ;_cafa ._fef =0;_acd =_gac ;};};_edd ._ebed =append (_edd ._ebed ,&rowspan {_cafae :_acd ,_faea :_gge ,_gdda :len (_edd ._adf )});};func _beed (_afg ,_deab *style ){if _deab ==nil {return ;};if _afg ==nil {_afg =_deab ;return ;};if _afg ._adff ==nil {_afg ._adff =_deab ._adff ;};if _afg ._dbe ==nil {_afg ._dbe =_deab ._dbe ;};if _afg ._fddg ==nil {_afg ._fddg =_deab ._fddg ;};if _afg ._gbdf ==nil {_afg ._gbdf =_deab ._gbdf ;};if _afg ._fgf ==nil {_afg ._fgf =_deab ._fgf ;};if _afg ._aec ==nil {_afg ._aec =_deab ._aec ;};if _afg ._bggd ==nil {_afg ._bggd =_deab ._bggd ;};if _afg ._fgad ==nil {_afg ._fgad =_deab ._fgad ;};if _afg ._ccc ==nil {_afg ._ccc =_deab ._ccc ;};if _afg ._gfb ==nil {_afg ._gfb =_deab ._gfb ;};if _afg ._cdg ==nil {_afg ._cdg =_deab ._cdg ;};if _afg ._aaeb ==nil {_afg ._aaeb =_deab ._aaeb ;};if _afg ._gadc ==_cf .ST_VerticalAlignmentUnset {_afg ._gadc =_deab ._gadc ;};if _afg ._cded ==_cf .ST_HorizontalAlignmentUnset {_afg ._cded =_deab ._cded ;};};type border struct{_aaebf float64 ;_dede _e .Color ;};func (_ef *convertContext )makeRows (){_gcc :=[]*rowInfo {};_ede :=_ef ._fege .Rows ();_bee :=0;for _ ,_cfaf :=range _ede {_bee ++;_cfda :=int (_cfaf .RowNumber ());if _cfda > _bee {for _ggf :=_bee ;_ggf < _cfda ;_ggf ++{_gcc =append (_gcc ,&rowInfo {_ddeg :16/_cgda });};_bee =_cfda ;};var _eac float64 ;if _cfaf .X ().HtAttr ==nil {_eac =16;}else {_eac =*_cfaf .X ().HtAttr ;};_gcc =append (_gcc ,&rowInfo {_ddeg :_eac /_cgda ,_bae :true ,_bbaf :_ef .getStyle (_cfaf .X ().SAttr )});};for _cgg :=len (_gcc );_cgg < _ef ._add ;_cgg ++{_gcc =append (_gcc ,&rowInfo {_ddeg :16/_cgda });};_ef ._adf =_gcc ;};func (_dbdf *convertContext )getStyleFromRPrElt (_adaa *_cf .CT_RPrElt )*style {if _adaa ==nil {return nil ;};_bfec :=&style {};_bfec ._adff =&_adaa .RFont .ValAttr ;if _fgg :=_adaa .B ;_fgg !=nil {_fggc :=_fgg .ValAttr ==nil ||*_fgg .ValAttr ;_bfec ._gbdf =&_fggc ;};if _eab :=_adaa .I ;_eab !=nil {_aaaf :=_eab .ValAttr ==nil ||*_eab .ValAttr ;_bfec ._fgf =&_aaaf ;};if _ggb :=_adaa .U ;_ggb !=nil {_bbdc :=_ggb .ValAttr ==_cf .ST_UnderlineValuesSingle ||_ggb .ValAttr ==_cf .ST_UnderlineValuesUnset ;_bfec ._aec =&_bbdc ;};if _ffbad :=_adaa .VertAlign ;_ffbad !=nil {_eagg :=_ffbad .ValAttr ==_d .ST_VerticalAlignRunSuperscript ;_bfec ._bggd =&_eagg ;_eage :=_ffbad .ValAttr ==_d .ST_VerticalAlignRunSubscript ;_bfec ._fgad =&_eage ;};if _ceeg :=_adaa .Sz ;_ceeg !=nil {_dcga :=_ceeg .ValAttr /12*_ag .DefaultFontSize ;_bfec ._fddg =&_dcga ;};if _cffg :=_adaa .Color ;_cffg !=nil {_bfec ._dbe =_dbdf .getColorStringFromSmlColor (_cffg );};return _bfec ;};type pageRow struct{_dega int ;_bbfc []*cell ;};type symbol struct{_gcad string ;_bed float64 ;_gcea float64 ;_bcbaa float64 ;_fcge *_e .TextStyle ;_fbfb string ;};const _bf =1.5;type colWidthRange struct{_acgd int ;_aece int ;_cbcf float64 ;_aaa *style ;};type pagespan struct{_cbff float64 ;_acae []*page ;_acdf int ;_dae int ;};func (_dde *convertContext )fillPages (){for _agce ,_gfd :=range _dde ._ebed {_ccg :=_dde ._adf [_gfd ._faea :_gfd ._gdda ];for _acaa ,_gfde :=range _ccg {_gce :=0;_cfc :=0.0;_bfg :=[]*cell {};if _gfde ._bae {for _ ,_ecb :=range _gfde ._ffde {_fcgd :=_dde ._egb [_gce ];_dde ._eea =_fcgd ._acae [_agce ];_dde ._eea ._faf =true ;_becd :=_ecb ._deeg ;if _cfc +_becd > _fcgd ._cbff {_dde .addRowToPage (_bfg ,_acaa );_bfg =[]*cell {_ecb };_cfc =_becd ;_gce ++;}else {_ecb ._adgf =_cfc ;_bfg =append (_bfg ,_ecb );_cfc +=_becd ;};};if len (_bfg )> 0{_abc :=_dde ._egb [_gce ];_dde ._eea =_abc ._acae [_agce ];_dde ._eea ._faf =true ;_dde .addRowToPage (_bfg ,_acaa );};};};};};const _eg =2;func (_dgd *convertContext )getImage (_ffba _cg .Image ,_aafg ,_bcd ,_afea ,_fddd ,_edac ,_abb float64 ,_beca _ag .ImgPart )*_e .Image {_fddd +=_dgd ._fcec ;_afea +=_dgd ._ada ;_ddcc ,_badf :=_ag .GetImage (_dgd ._gdbe ,_ffba ,_aafg ,_bcd ,_afea ,_fddd ,_edac ,_abb ,_beca );if _badf !=nil {_a .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_badf );return nil ;};return _ddcc ;};func (_egg *convertContext )getContentFromCell (_dfdg _ae .Cell ,_gdc *style ,_fgc float64 ,_gbfgc bool )([]*line ,_cf .ST_CellType ){_gag :=_dfdg .X ();var _bcea []*symbol ;switch _gag .TAttr {case _cf .ST_CellTypeS :_dfa :=_gag .V ;if _dfa !=nil {_fagf ,_fde :=_f .Atoi (*_dfa );if _fde ==nil {_geb :=_egg ._gbff .SharedStrings .X ().Si [_fagf ];if _geb .T !=nil {_bcea =_egg .getSymbolsFromString (*_geb .T ,_gdc );}else if _geb .R !=nil {_bcea =_egg .getSymbolsFromR (_geb .R ,_gdc );};};};case _cf .ST_CellTypeB :_fba :=_gag .V ;if _fba !=nil {if *_fba =="\u0030"{_bcea =_egg .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_gdc );}else {_bcea =_egg .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_gdc );};};default:_bcea =_egg .getSymbolsFromString (_dfdg .GetFormattedValue (),_gdc );};_dcg :=0.0;_cgdb :=0.0;var _bgd []*line ;var _eccb bool ;if _gdc !=nil {if _gdc ._bggd !=nil {if *_gdc ._bggd {_eccb =true ;};};if _gdc ._fgad !=nil {if *_gdc ._fgad {_eccb =true ;};};};if _gbfgc {_bgd =[]*line {};_faaf :=_fgc -2*_b ;_gef :=[]*symbol {};for _ ,_bgc :=range _bcea {_dgb (_bgc );if _dcg +_bgc ._bcbaa >=_faaf {_dbg :=_gdag (_gef );if _eccb {_dbg /=_cgd ;};_bgd =append (_bgd ,&line {_dgab :_cgdb ,_dcadd :_gef ,_bfc :_dbg });_gef =[]*symbol {_bgc };_dcg =_bgc ._bcbaa ;_cgdb +=_dbg ;}else {_bgc ._bed =_dcg ;_dcg +=_bgc ._bcbaa ;_gef =append (_gef ,_bgc );};};_abaf :=_gdag (_gef );if _eccb {_abaf /=_cgd ;};if len (_gef )> 0{_bgd =append (_bgd ,&line {_dgab :_cgdb ,_dcadd :_gef ,_bfc :_abaf });};}else {for _ ,_gca :=range _bcea {_dgb (_gca );_gca ._bed =_dcg ;_dcg +=_gca ._bcbaa ;};if len (_bcea )> 0{_bgd =[]*line {&line {_dcadd :_bcea ,_bfc :_gdag (_bcea )}};};};_dfbb :=_gag .TAttr ;if _dfbb ==_cf .ST_CellTypeUnset {_dfbb =_cf .ST_CellTypeN ;};return _bgd ,_dfbb ;};type rowInfo struct{_fef float64 ;_bae bool ;_ddeg float64 ;_bbaf *style ;_ffde []*cell ;_ecad float64 ;};func (_cff *convertContext )makePages (){for _ ,_gbf :=range _cff ._egb {for _ ,_fed :=range _cff ._ebed {_gbf ._acae =append (_gbf ._acae ,&page {_fagg :[]*pageRow {},_dgc :_gbf ,_cfgb :_fed });};};};func _fbac (_ebca *bool )bool {return _ebca !=nil &&*_ebca };var _adg =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};var _df =_dgf (0.0625);func _dgf (_gcbg float64 )float64 {return _gcbg *_ga .Millimeter };func _gdag (_abae []*symbol )float64 {_ffae :=0.0;for _ ,_cdac :=range _abae {if _cdac ._gcea > _ffae {_ffae =_cdac ._gcea ;};};return _ffae ;};type colInfo struct{_gccb float64 ;_fage float64 ;_fab *style ;};func (_fdc *convertContext )drawPage (_bbd *page ){_aaf :=_fdc ._fcec ;_cgaa :=_fdc ._ada ;for _ ,_dfd :=range _bbd ._fagg {_cbga :=_fdc ._adf [_dfd ._dega ];for _ ,_cab :=range _dfd ._bbfc {_gec :=_cab ._deaa < _cab ._adgf ;_ffa :=_cab ._fbg > _cab ._adgf +_cab ._eafaa ;var _dabd ,_cbe bool ;for _ ,_afb :=range _cab ._dbc {for _ ,_fae :=range _afb ._dcadd {if _gec &&!_dabd {_dabd =_fae ._bed < 0;};if _ffa &&!_cbe {_cbe =_cab ._eafaa < _fae ._bed +_fae ._bcbaa ;};if _cab ._adgf +_fae ._bed >=_cab ._deaa &&_cab ._adgf +_fae ._bed +_fae ._bcbaa <=_cab ._fbg {_ebe :=_fdc ._gdbe .NewStyledParagraph ();_bff :=_cgaa +_cab ._adgf +_fae ._bed ;_bad :=_aaf +_cbga ._fef +_afb ._dgab -_fae ._gcea -_dgf (0.5);_ebe .SetPos (_bff ,_bad );var _acdg *_e .TextChunk ;if _fae ._fbfb !=""{_acdg =_ebe .AddExternalLink (_fae ._gcad ,_fae ._fbfb );}else {_acdg =_ebe .Append (_fae ._gcad );};if _fae ._fcge !=nil {_acdg .Style =*_fae ._fcge ;};_fdc ._gdbe .Draw (_ebe );};};};var _cfb ,_fdfa ,_faag ,_cfe ,_gcce ,_fga float64 ;var _fdga ,_edadd ,_agcf ,_dag _e .Color ;if _cffd :=_cab ._fcbe ;_cffd !=nil {_cfb =_cffd ._aaebf ;_fdga =_cffd ._dede ;};if _gaa :=_cab ._ddfc ;_gaa !=nil {_fdfa =_gaa ._aaebf ;_edadd =_gaa ._dede ;};if _dcd :=_cab ._efa ;_dcd !=nil {_faag =_dcd ._aaebf ;_gcce =_faag /2;_agcf =_dcd ._dede ;};if _cfg :=_cab ._dce ;_cfg !=nil {_cfe =_cfg ._aaebf ;_fga =_cfe /2;_dag =_cfg ._dede ;};var _ddc float64 ;if _dfd ._dega > 1{_ddc =_fdc ._adf [_dfd ._dega -1]._ecad ;};_debb :=_aaf +_cbga ._fef -0.5*(_ddc -_cfb );_abef :=_aaf +_cbga ._fef +_cbga ._ddeg +0.5*(_cbga ._ecad +_fdfa );_ecbc :=_cgaa +_cab ._adgf ;_ecbg :=_ecbc +_cab ._deeg ;_ag .DrawLine (_fdc ._gdbe ,_ecbc ,_debb ,_ecbg ,_debb ,_cfb ,_fdga );_ag .DrawLine (_fdc ._gdbe ,_ecbc ,_abef ,_ecbg ,_abef ,_fdfa ,_edadd );if !_dabd {_ag .DrawLine (_fdc ._gdbe ,_ecbc -_gcce ,_debb ,_ecbc -_gcce ,_abef ,_faag ,_agcf );};if !_cbe {_ag .DrawLine (_fdc ._gdbe ,_ecbg -_fga ,_debb ,_ecbg -_fga ,_abef ,_cfe ,_dag );};};};for _ ,_efc :=range _bbd ._cbdg {if _efc !=nil {_fdc ._gdbe .Draw (_efc );};};};const _gf =0.25;

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_ae .Sheet )*_e .Creator {_gaf :=s .X ();if _gaf ==nil {return nil ;};var _fe _e .PageSize ;var _ee bool ;if _aga :=_gaf .PageSetup ;_aga !=nil {if _bg :=_aga .PaperSizeAttr ;_bg !=nil {_fe =_dgdc [*_bg ];};_ee =_aga .OrientationAttr ==_cf .ST_OrientationLandscape ;};if (_fe ==_e .PageSize {}){_fe =_dgdc [1];};if _ee {_fe [0],_fe [1]=_fe [1],_fe [0];};_ea :=_e .New ();_ea .SetPageSize (_fe );var _eef ,_ac ,_be ,_eda float64 ;if _fd :=_gaf .PageMargins ;_fd !=nil {_be =_fd .LeftAttr ;_eda =_fd .RightAttr ;_eef =_fd .TopAttr ;_ac =_fd .BottomAttr ;};if _be < 0.25{_be =0.25;};if _eda < 0.25{_eda =0.25;};_eef *=_ga .Inch ;_ac *=_ga .Inch ;_be *=_ga .Inch ;_eda *=_ga .Inch ;_ea .SetPageMargins (_be ,_eda ,_eef ,_ac );_fc :=s .Workbook ();var _ca *_cb .Theme ;if len (_fc .Themes ())> 0{_ca =_fc .Themes ()[0];};_cd :=&convertContext {_gdbe :_ea ,_fege :s ,_gbff :s .Workbook (),_edge :_ca ,_bda :&s .Workbook ().StyleSheet ,_fcec :_eef ,_ada :_be ,_acb :_fe [1]-_ac -_eef ,_faaa :_fe [0]-_eda -_be };_cd .makeAnchors ();_cd .determineMaxIndexes ();if _cd ._add ==0&&_cd ._eff ==0{_ea .NewPage ();return _ea ;};_cd .makeCols ();_cd .makeRows ();_cd .makeMergedCells ();_cd .makeCells ();_cd .makePagespans ();_cd .makeRowspans ();_cd .makePages ();_cd .fillPages ();_cd .distributeAnchors ();_cd .drawSheet ();return _ea ;};func (_cfd *convertContext )determineMaxIndexes (){var _af ,_cfaa int ;_af =int (_cfd ._fege .MaxColumnIdx ());_edab :=_cfd ._fege .Rows ();if len (_edab )> 0{_cfaa =int (_edab [len (_edab )-1].RowNumber ());};for _ ,_aae :=range _cfd ._bbcb {if _aae ._cdb >=_cfaa {_cfaa =_aae ._cdb +1;};if _aae ._effc >=_af {_af =_aae ._effc +1;};};_cfd ._add =_cfaa ;_cfd ._eff =_af ;};func (_fee *convertContext )distributeAnchors (){for _ ,_ddb :=range _fee ._bbcb {_ggfc ,_bgg :=_ddb ._agff ,_ddb ._cbea ;_adb ,_agf :=_ddb ._cge ,_ddb ._eee ;_fbdb ,_acg :=_ddb ._cdb ,_ddb ._cbfg ;_acc ,_cdae :=_ddb ._effc ,_ddb ._gdgd ;var _ecf ,_fa ,_gbd ,_aff *page ;for _ ,_def :=range _fee ._egb {for _ ,_ba :=range _def ._acae {if _ggfc >=_ba ._cfgb ._faea &&_ggfc < _ba ._cfgb ._gdda {if _adb >=_ba ._dgc ._acdf &&_adb < _ba ._dgc ._dae {_ba ._faf =true ;_ecf =_ba ;};if _acc >=_ba ._dgc ._acdf &&_acc < _ba ._dgc ._dae {_ba ._faf =true ;_fa =_ba ;};};if _fbdb >=_ba ._cfgb ._faea &&_fbdb < _ba ._cfgb ._gdda {if _adb >=_ba ._dgc ._acdf &&_adb < _ba ._dgc ._dae {_ba ._faf =true ;_aff =_ba ;};if _acc >=_ba ._dgc ._acdf &&_acc < _ba ._dgc ._dae {_ba ._faf =true ;_gbd =_ba ;};};};};_acf :=_ecf !=_fa ;_edc :=_ecf !=_aff ;if _acf &&_edc {_eae :=_fee ._dbfc [_adb ]._gccb +_ga .FromEMU (_agf );_acgg :=_ecf ._dgc ._cbff ;_dga :=_fee ._dbfc [_acc ]._gccb +_ga .FromEMU (_cdae );_cgb :=_fee ._adf [_ggfc ]._fef +_ga .FromEMU (_bgg );_bac :=float64 (_ecf ._cfgb ._cafae );_eaed :=_fee ._adf [_fbdb ]._fef +_ga .FromEMU (_acg );_edf :=_dga +_acgg -_eae ;_bce :=_eaed +_bac -_cgb ;_cafd :=_fee .imageFromAnchor (_ddb ,_edf ,_bce );_ecf ._cbdg =append (_ecf ._cbdg ,_fee .getImage (_cafd ,_bce ,_edf ,_eae ,_cgb ,_acgg -_eae ,_bac -_cgb ,_ag .ImgPart_lt ));_fa ._cbdg =append (_fa ._cbdg ,_fee .getImage (_cafd ,_bce ,_edf ,0,_cgb ,_acgg -_eae ,_bac -_cgb ,_ag .ImgPart_rt ));_aff ._cbdg =append (_aff ._cbdg ,_fee .getImage (_cafd ,_bce ,_edf ,_eae ,0,_acgg -_eae ,_bac -_cgb ,_ag .ImgPart_lb ));_gbd ._cbdg =append (_gbd ._cbdg ,_fee .getImage (_cafd ,_bce ,_edf ,0,0,_acgg -_eae ,_bac -_cgb ,_ag .ImgPart_rb ));}else if _acf {_edcb :=_fee ._adf [_ggfc ]._fef +_ga .FromEMU (_bgg );_ddab :=_fee ._adf [_fbdb ]._fef +_ga .FromEMU (_acg );_ffb :=_fee ._dbfc [_adb ]._gccb +_ga .FromEMU (_agf );_ecc :=_ecf ._dgc ._cbff ;_eb :=_fee ._dbfc [_acc ]._gccb +_ga .FromEMU (_cdae );_agd :=_eb +_ecc -_ffb ;_dcf :=_ddab -_edcb ;_faa :=_fee .imageFromAnchor (_ddb ,_agd ,_dcf );_ecf ._cbdg =append (_ecf ._cbdg ,_fee .getImage (_faa ,_dcf ,_agd ,_ffb ,_edcb ,_ecc -_ffb ,0,_ag .ImgPart_l ));_fa ._cbdg =append (_fa ._cbdg ,_fee .getImage (_faa ,_dcf ,_agd ,0,_edcb ,_ecc -_ffb ,0,_ag .ImgPart_r ));}else if _edc {_ddaba :=_fee ._dbfc [_adb ]._gccb +_ga .FromEMU (_agf );_deb :=_fee ._dbfc [_acc ]._gccb +_ga .FromEMU (_cdae );_fag :=_fee ._adf [_ggfc ]._fef +_ga .FromEMU (_bgg );_fdgf :=float64 (_ecf ._cfgb ._cafae );_edda :=_fee ._adf [_fbdb ]._fef +_ga .FromEMU (_acg );_eaad :=_deb -_ddaba ;_efb :=_edda +_fdgf -_fag ;_gdd :=_fee .imageFromAnchor (_ddb ,_eaad ,_efb );_ecf ._cbdg =append (_ecf ._cbdg ,_fee .getImage (_gdd ,_efb ,_eaad ,_ddaba ,_fag ,0,_fdgf -_fag ,_ag .ImgPart_t ));_aff ._cbdg =append (_aff ._cbdg ,_fee .getImage (_gdd ,_efb ,_eaad ,_ddaba ,0,0,_fdgf -_fag ,_ag .ImgPart_b ));}else {_da :=_fee ._dbfc [_adb ]._gccb +_ga .FromEMU (_agf );_ggee :=_fee ._dbfc [_acc ]._gccb +_ga .FromEMU (_cdae );_aba :=_fee ._adf [_ggfc ]._fef +_ga .FromEMU (_bgg );_dab :=_fee ._adf [_fbdb ]._fef +_ga .FromEMU (_acg );_fgd :=_ggee -_da ;_bdce :=_dab -_aba ;_dca :=_fee .imageFromAnchor (_ddb ,_fgd ,_bdce );_ecf ._cbdg =append (_ecf ._cbdg ,_fee .getImage (_dca ,_bdce ,_fgd ,_da ,_aba ,0,0,_ag .ImgPart_whole ));};};};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);