//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_a "bytes";_eb "errors";_g "fmt";_d "github.com/unidoc/unioffice/common/logger";_fd "github.com/unidoc/unioffice/document";_ed "github.com/unidoc/unioffice/measurement";_ef "github.com/unidoc/unioffice/schema/soo/dml";_cbf "github.com/unidoc/unioffice/schema/soo/dml/chart";
_fde "github.com/unidoc/unioffice/spreadsheet";_cc "github.com/unidoc/unioffice/spreadsheet/format";_ba "github.com/unidoc/unioffice/spreadsheet/formula";_bb "github.com/unidoc/unioffice/spreadsheet/reference";_bf "github.com/unidoc/unipdf/v3/creator";
_ebd "github.com/unidoc/unipdf/v3/model";_ge "github.com/unidoc/unipdf/v3/render";_cb "github.com/unidoc/unitype";_c "image";_bcf "math";_bc "os";_e "regexp";_gd "sort";_ff "strconv";_ea "strings";_be "sync";_f "unicode";);func (_bgf *creatorContext )drawRectangleWithProps (_eefcd *_ef .CT_ShapeProperties ,_bgagd ,_cbge ,_dfg ,_acbd float64 ,_dded bool ){_afaf :=_bgf ._cgfc .NewRectangle (_bgagd ,_cbge ,_dfg ,_acbd );
if _eefcd ==nil {if _dded {_afaf .SetBorderWidth (_bag );}else {return ;};}else {_eefba :=_bgf .getPdfColorFromSolidFill (_eefcd .SolidFill );if _eefba !=nil {_afaf .SetFillColor (_eefba );};if _acgb :=_eefcd .Ln ;_acgb !=nil {if _dgea :=_acgb .WAttr ;
_dgea !=nil {_gec :=_ed .FromEMU (int64 (*_dgea ));_afaf .SetBorderWidth (_gec );if _cgd :=_acgb .SolidFill ;_cgd !=nil {_cae :=_bgf .getPdfColorFromSolidFill (_cgd );if _cae !=nil {_afaf .SetBorderColor (_cae );};};}else {_afaf .SetBorderWidth (0);};};
};_bgf ._cgfc .Draw (_afaf );};var _efc =_cff (0.5);var _cbb =_cff (1.5);func (_gda *creatorContext )drawTitle (_fead string ,_ebae ,_bda float64 ){_bde :=_gda ._eaeg ;_aaga :=_gda ._cgfc .NewStyledParagraph ();_fbe :=_aaga .SetText (_fead );_eef ,_aeb :=_ebd .NewStandard14Font (_ebd .HelveticaName );
if _aeb ==nil {_cgbg :=_gda ._cgfc .NewTextStyle ();_cgbg .Font =_eef ;_cgbg .FontSize =14;_cgbg .TextRise =0.4;_fbe .Style =_cgbg ;_aaga .SetPos (_ebae -_aaga .Width ()*_bde /2,_bda );_gda ._cgfc .Draw (_aaga );};};var _cgfd =_cff (1);func (_aaec *Rectangle )Translate (x ,y float64 ){_aaec .Left +=x ;
_aaec .Right +=x ;_aaec .Top +=y ;_aaec .Bottom +=y ;};func GetRegisteredFont (name string ,style FontStyle )*_ebd .PdfFont {_afed ._dfdd .Lock ();defer _afed ._dfdd .Unlock ();if _aebf ,_cdgb :=_afed ._bbbc [name ];_cdgb {if _ffad ,_bbc :=_aebf [style ];
_bbc {return _ffad ;};};return nil ;};func _baf (_gacc *_cbf .ChartSpace ,_eba ,_gbf float64 ,_agf *_ef .Theme ,_fdeg bool ,_abff *_fde .Workbook )(*_bf .Creator ,error ){_ece :=1.0;if _fdeg {_ece =8.0;};_fdcd :=&Rectangle {};_dbae :=&Rectangle {Top :_fdcd .Top ,Bottom :_gbf -_fdcd .Bottom ,Left :_fdcd .Left ,Right :_eba -_fdcd .Right };
_ccb :=MakeTempCreator (_eba *_ece +1,_gbf *_ece +1);_gbd :=&creatorContext {_cgfc :_ccb ,_dcda :_agf ,_eaeg :_ece };var _gbfb bool ;if _aabd :=_gacc .Chart ;_aabd !=nil {_fdega :=_aabd .PlotArea ;if _fdega ==nil {return nil ,_eb .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");
};_dee :=0.0;if _aabd .AutoTitleDeleted !=nil &&_aabd .AutoTitleDeleted .ValAttr !=nil &&!*_aabd .AutoTitleDeleted .ValAttr {_dce :="C\u0068\u0061\u0072\u0074\u0020\u0054\u0069\u0074\u006c\u0065";if _aabd .Title !=nil &&_aabd .Title .Overlay !=nil &&_aabd .Title .Overlay .ValAttr !=nil &&!*_aabd .Title .Overlay .ValAttr {_dee =_cff (10);
};if _aabd .Title !=nil &&_aabd .Title .Tx !=nil &&_aabd .Title .Tx .Choice !=nil &&_aabd .Title .Tx .Choice .Rich !=nil {if len (_aabd .Title .Tx .Choice .Rich .P )> 0{if len (_aabd .Title .Tx .Choice .Rich .P [0].EG_TextRun )> 0{_dce =_aabd .Title .Tx .Choice .Rich .P [0].EG_TextRun [0].R .T ;
};};};_gbd .drawTitle (_dce ,_dbae .Left +_dbae .Right /2,_cff (5));};_cdb :=&Rectangle {Top :_cff (10)+_dee ,Bottom :_dbae .Bottom -_cff (15),Left :_cff (10),Right :_dbae .Right -_cff (10)};var _agc *Rectangle ;_dgb :=_aabd .Legend ;if _dgb !=nil {_fbd :=_dgb .Overlay !=nil &&_dgb .Overlay .ValAttr !=nil &&*_dgb .Overlay .ValAttr ;
if _bfg :=_dgb .LegendPos ;_bfg !=nil {switch _bfg .ValAttr {case _cbf .ST_LegendPosTr :if !_fbd {_cdb =&Rectangle {Top :_cff (25)+_dee ,Bottom :_dbae .Bottom -_cff (10),Left :_cff (10),Right :_dbae .Right -_cff (25)};};_agc =&Rectangle {Top :_cff (2.5)+_dee ,Bottom :_cff (22.5),Left :_dbae .Right -_cff (22.5),Right :_dbae .Right -_cff (2.5)};
case _cbf .ST_LegendPosT :_agc =&Rectangle {Top :_cff (2.5)+_dee ,Bottom :_cff (7.5),Left :(_dbae .Right -_dbae .Left )*0.25,Right :(_dbae .Right -_dbae .Left )*0.75};if !_fbd {_cdb =&Rectangle {Top :_cff (12.5)+_dee ,Bottom :_dbae .Bottom -_cff (15),Left :_cff (10),Right :_dbae .Right -_cff (5)};
};_gbfb =true ;case _cbf .ST_LegendPosB :_agc =&Rectangle {Top :_dbae .Bottom -_cff (7.5)+_dee ,Bottom :_dbae .Bottom -_cff (2.5),Left :(_dbae .Right -_dbae .Left )*0.25,Right :(_dbae .Right -_dbae .Left )*0.75};if !_fbd {_cdb =&Rectangle {Top :_cff (5)+_dee ,Bottom :_dbae .Bottom -_cff (15),Left :_cff (10),Right :_dbae .Right -_cff (5)};
};_gbfb =true ;case _cbf .ST_LegendPosR :_agc =&Rectangle {Top :(_dbae .Bottom -_dbae .Top )/2-_cff (10)+_dee ,Bottom :(_dbae .Bottom -_dbae .Top )/2+_cff (10),Left :_dbae .Right -_cff (22.5),Right :_dbae .Right -_cff (2.5)};if !_fbd {_cdb =&Rectangle {Top :_cff (5)+_dee ,Bottom :_dbae .Bottom -_cff (12.5),Left :_cff (10),Right :_dbae .Right -_cff (25)};
};case _cbf .ST_LegendPosL :_agc =&Rectangle {Top :(_dbae .Bottom -_dbae .Top )/2-_cff (10)+_dee ,Bottom :(_dbae .Bottom -_dbae .Top )/2+_cff (10),Left :_cff (2.5),Right :_cff (22.5)};if !_fbd {_cdb =&Rectangle {Top :_cff (5)+_dee ,Bottom :_dbae .Bottom -_cff (12.5),Left :_cff (30),Right :_dbae .Right -_cff (5)};
};default:_agc =&Rectangle {Top :(_dbae .Bottom -_dbae .Top )/2-_cff (10)+_dee ,Bottom :(_dbae .Bottom -_dbae .Top )/2+_cff (10),Left :_dbae .Right -_cff (25),Right :_dbae .Right -_cff (5)};if !_fbd {_cdb =&Rectangle {Top :_cff (5)+_dee ,Bottom :_dbae .Bottom -_cff (12.5),Left :_cff (100),Right :_dbae .Right -_cff (25)};
};};};};_cdb .scale (_ece );_gbd .drawBorderWithProps (_fdega .SpPr ,_cdb ,_bag );_cbda :=[]*legendItem {};var _bca error ;_efdf :=_fdega .CChoice ;for _ ,_cbbb :=range _fdega .Choice {if _ceed :=_cbbb .BarChart ;_ceed !=nil {_cbda ,_bca =_gbd .drawBarChart (_ceed ,_cdb ,_efdf ,_abff );
if _bca !=nil {return nil ,_bca ;};};};if _dgb !=nil {_agc .scale (_ece );_gbd .drawBorderWithProps (_dgb .SpPr ,_agc ,_bag );if len (_cbda )!=0{_gbd .drawLegend (_agc ,_cbda ,_gbfb );};};};_dbae .scale (_ece );_gbd .drawBorderWithProps (_gacc .SpPr ,_dbae ,_bag );
return _ccb ,nil ;};func AdjustColorByTint (colorStr string ,tint float64 )string {var _feg ,_eefbd ,_efe uint8 ;_gbgb ,_ :=_g .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_feg ,&_eefbd ,&_efe );if _gbgb !=3{return "";
};return _bdeb (_feg ,tint )+_bdeb (_eefbd ,tint )+_bdeb (_efe ,tint );};const _adg =6.0;func DrawRectangle (c *_bf .Creator ,r *Rectangle ,w float64 ,color _bf .Color ){if color ==nil {return ;};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );
DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};var _ggfc =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };
func AssignStdFontByName (style _bf .TextStyle ,fontName string )*_ebd .PdfFont {_gbae :=_ebd .StdFontName (fontName );return _ebd .NewStandard14FontMustCompile (_gbae );};func MakeBlockFromCreator (c *_bf .Creator )(*_bf .Block ,error ){_adec ,_deedd :=GetPageFromCreator (c );
if _deedd !=nil {return nil ,_deedd ;};_edef ,_deedd :=_bf .NewBlockFromPage (_adec );if _deedd !=nil {return nil ,_deedd ;};return _edef ,nil ;};type legendItem struct{_fcdf string ;_aed *_ef .CT_ShapeProperties ;};func (_ffe *creatorContext )addCatValue (_dcbc string ,_ebgd map[string ]serCategory ,_dbb []string ,_cdd int ,_cbfa ,_bgb *float64 ,_aab string ,_agd *_ef .CT_ShapeProperties ){_bac ,_add :=_ff .ParseFloat (_dcbc ,64);
if _add !=nil {_bac =0;_d .Log .Debug ("\u0070a\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_add );};if _bac > *_bgb {*_bgb =_bac ;};if _bac < *_cbfa {*_cbfa =_bac ;};_bce :=_ebgd [_dbb [_cdd ]];_bce ._gbb =append (_bce ._gbb ,serValue {_aga :_aab ,_dbd :_bac ,_gfga :_agd });
_ebgd [_dbb [_cdd ]]=_bce ;};func GetDataFromXfrm (xfrm *_ef .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _fage ,_fdefa ,_bgba ,_aeeb float64 ;if _becg :=xfrm .Off ;_becg !=nil {_fage =_ed .FromEMU (FromSTCoordinate (_becg .XAttr ));_fdefa =_ed .FromEMU (FromSTCoordinate (_becg .YAttr ));
};if _cgg :=xfrm .Ext ;_cgg !=nil {_bgba =_ed .FromEMU (_cgg .CxAttr );_aeeb =_ed .FromEMU (_cgg .CyAttr );};return _fage ,_fdefa ,_bgba ,_aeeb ;};func _dbac (_ebde _ef .ST_SchemeColorVal ,_abc *_ef .Theme )string {if _gea :=_abc .ThemeElements ;_gea !=nil {if _cceg :=_gea .ClrScheme ;
_cceg !=nil {switch _ebde {case _ef .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_cceg .Lt1 );case _ef .ST_SchemeColorValDk1 ,_ef .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_cceg .Dk1 );case _ef .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_cceg .Lt2 );
case _ef .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_cceg .Dk2 );case _ef .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_cceg .Accent1 );case _ef .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_cceg .Accent2 );
case _ef .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_cceg .Accent3 );case _ef .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_cceg .Accent4 );case _ef .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_cceg .Accent5 );
case _ef .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_cceg .Accent6 );};};};return "";};func CropImageByRect (sourceImg _c .Image ,rect _c .Rectangle )_c .Image {_fcbc ,_geag ,_eabb ,_fbba :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;
_dgca :=_c .NewNRGBA (_c .Rect (0,0,_eabb -_fcbc ,_fbba -_geag ));for _fgff :=_fcbc ;_fgff < _eabb ;_fgff ++{for _dedd :=_geag ;_dedd < _fbba ;_dedd ++{_dgca .Set (_fgff -_fcbc ,_dedd -_geag ,sourceImg .At (_fgff ,_dedd ));};};return _dgca ;};type serValue struct{_aga string ;
_dbd float64 ;_gfga *_ef .CT_ShapeProperties ;};func _cacf (_bbb _ef .ST_SchemeColorVal ,_bccf *_ef .Theme )string {if _cec :=_bccf .ThemeElements ;_cec !=nil {if _cdda :=_cec .ClrScheme ;_cdda !=nil {switch _bbb {case _ef .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_cdda .Lt1 );
case _ef .ST_SchemeColorValDk1 ,_ef .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_cdda .Dk1 );case _ef .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_cdda .Lt2 );case _ef .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_cdda .Dk2 );
case _ef .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_cdda .Accent1 );case _ef .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_cdda .Accent2 );case _ef .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_cdda .Accent3 );
case _ef .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_cdda .Accent4 );case _ef .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_cdda .Accent5 );case _ef .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_cdda .Accent6 );
};};};return "";};func ParseExcelRange (s string )(string ,_bb .CellReference ,_bb .CellReference ,error ){_afee :=_ea .FieldsFunc (s ,func (_acf rune )bool {return _acf ==':'||_acf =='!'});if len (_afee )==3{_dfcf ,_eefcdf :=_bb .ParseCellReference (_afee [1]);
if _eefcdf !=nil {return "",_bb .CellReference {},_bb .CellReference {},_eefcdf ;};_age ,_eefcdf :=_bb .ParseCellReference (_afee [2]);if _eefcdf !=nil {return "",_bb .CellReference {},_bb .CellReference {},_eefcdf ;};return _afee [0],_dfcf ,_age ,nil ;
};return "",_bb .CellReference {},_bb .CellReference {},_eb .New ("\u0065r\u0072\u006f\u0072\u0020p\u0061\u0072\u0073\u0069\u006eg\u0020e\u0078c\u0065\u006c\u0020\u0072\u0061\u006e\u0067e");};func _cac (_ddce *_cbf .CT_CatAx )(uint32 ,_cbf .ST_AxPos ,_cbf .ST_TickMark ,_cbf .ST_TickLblPos ,*_cbf .CT_ChartLines ,uint32 ,*_ef .CT_ShapeProperties ,error ){var _aca ,_dfda uint32 ;
var _agaa _cbf .ST_AxPos ;var _eafb _cbf .ST_TickMark ;var _bgd *_cbf .CT_ChartLines ;var _bga _cbf .ST_TickLblPos ;if _ddce .AxId ==nil {return _aca ,_agaa ,_eafb ,_bga ,_bgd ,_dfda ,_ddce .SpPr ,_eb .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_aca =_ddce .AxId .ValAttr ;};if _ddce .AxPos ==nil {return _aca ,_agaa ,_eafb ,_bga ,_bgd ,_dfda ,_ddce .SpPr ,_eb .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_agaa =_ddce .AxPos .ValAttr ;
};if _ddce .MajorTickMark !=nil {_eafb =_ddce .MajorTickMark .ValAttr ;};if _ddce .TickLblPos !=nil {_bga =_ddce .TickLblPos .ValAttr ;};if _ddce .CrossAx ==nil {return _aca ,_agaa ,_eafb ,_bga ,_bgd ,_dfda ,_ddce .SpPr ,_eb .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_dfda =_ddce .CrossAx .ValAttr ;};_bgd =_ddce .MajorGridlines ;return _aca ,_agaa ,_eafb ,_bga ,_bgd ,_dfda ,_ddce .SpPr ,nil ;};var _cbg =_cff (7.5);func _eab (_dage *_cbf .CT_DateAx )(uint32 ,_cbf .ST_AxPos ,_cbf .ST_TickMark ,_cbf .ST_TickLblPos ,*_cbf .CT_ChartLines ,uint32 ,*_ef .CT_ShapeProperties ,error ){var _cba ,_ffgg uint32 ;
var _fbb _cbf .ST_AxPos ;var _gccc _cbf .ST_TickMark ;var _ggd *_cbf .CT_ChartLines ;var _bgad _cbf .ST_TickLblPos ;if _dage .AxId ==nil {return _cba ,_fbb ,_gccc ,_bgad ,_ggd ,_ffgg ,_dage .SpPr ,_eb .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_cba =_dage .AxId .ValAttr ;};if _dage .AxPos ==nil {return _cba ,_fbb ,_gccc ,_bgad ,_ggd ,_ffgg ,_dage .SpPr ,_eb .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_fbb =_dage .AxPos .ValAttr ;
};if _dage .MajorTickMark !=nil {_gccc =_dage .MajorTickMark .ValAttr ;};if _dage .TickLblPos !=nil {_bgad =_dage .TickLblPos .ValAttr ;};if _dage .CrossAx ==nil {return _cba ,_fbb ,_gccc ,_bgad ,_ggd ,_ffgg ,_dage .SpPr ,_eb .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_ffgg =_dage .CrossAx .ValAttr ;};_ggd =_dage .MajorGridlines ;return _cba ,_fbb ,_gccc ,_bgad ,_ggd ,_ffgg ,_dage .SpPr ,nil ;};func _ffeb (_eadg *_cbf .CT_SerAx )(uint32 ,_cbf .ST_AxPos ,_cbf .ST_TickMark ,_cbf .ST_TickLblPos ,*_cbf .CT_ChartLines ,uint32 ,*_ef .CT_ShapeProperties ,error ){var _bdd ,_ffag uint32 ;
var _ddfe _cbf .ST_AxPos ;var _eff _cbf .ST_TickMark ;var _fbcc *_cbf .CT_ChartLines ;var _eagg _cbf .ST_TickLblPos ;if _eadg .AxId ==nil {return _bdd ,_ddfe ,_eff ,_eagg ,_fbcc ,_ffag ,_eadg .SpPr ,_eb .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_bdd =_eadg .AxId .ValAttr ;};if _eadg .AxPos ==nil {return _bdd ,_ddfe ,_eff ,_eagg ,_fbcc ,_ffag ,_eadg .SpPr ,_eb .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_ddfe =_eadg .AxPos .ValAttr ;
};if _eadg .MajorTickMark !=nil {_eff =_eadg .MajorTickMark .ValAttr ;};if _eadg .TickLblPos !=nil {_eagg =_eadg .TickLblPos .ValAttr ;};if _eadg .CrossAx ==nil {return _bdd ,_ddfe ,_eff ,_eagg ,_fbcc ,_ffag ,_eadg .SpPr ,_eb .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_ffag =_eadg .CrossAx .ValAttr ;};_fbcc =_eadg .MajorGridlines ;return _bdd ,_ddfe ,_eff ,_eagg ,_fbcc ,_ffag ,_eadg .SpPr ,nil ;};func _afcbd (_fbbf ,_bffb ,_gdc float64 )float64 {if _fbbf *6< 1{return _gdc +(_bffb -_gdc )*6*_fbbf ;}else if _fbbf *2< 1{return _bffb ;
}else if _fbbf *3< 2{return _gdc +(_bffb -_gdc )*(2.0/3.0-_fbbf )*6;}else {return _gdc ;};};var _afed =fontsMap {_dfdd :&_be .Mutex {},_bbbc :map[string ]map[FontStyle ]*_ebd .PdfFont {}};type serCategory struct{_fcc string ;_gbb []serValue ;};func RegisterFont (name string ,style FontStyle ,font *_ebd .PdfFont ){_afed ._dfdd .Lock ();
if _afed ._bbbc [name ]==nil {_afed ._bbbc [name ]=map[FontStyle ]*_ebd .PdfFont {};};_afed ._bbbc [name ][style ]=font ;_afed ._dfdd .Unlock ();};func FromSTCoordinate32 (st _ef .ST_Coordinate32 )int64 {if _cgeb :=st .ST_Coordinate32Unqualified ;_cgeb !=nil {return int64 (*_cgeb );
};return 0;};func (_gbbb FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_gbbb )];
};var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};
func RegisterEmbeddedFonts (d *_fd .Document )error {_cfg :=d .FontTable ();if _cfg ==nil {return nil ;};for _ ,_acag :=range _cfg .Font {if _acag .EmbedRegular !=nil {return _ada (d ,_acag .NameAttr ,_acag .EmbedRegular .IdAttr ,_acag .EmbedRegular .FontKeyAttr );
};if _acag .EmbedBold !=nil {return _ada (d ,_acag .NameAttr ,_acag .EmbedBold .IdAttr ,_acag .EmbedBold .FontKeyAttr );};if _acag .EmbedItalic !=nil {return _ada (d ,_acag .NameAttr ,_acag .EmbedItalic .IdAttr ,_acag .EmbedItalic .FontKeyAttr );};if _acag .EmbedBoldItalic !=nil {return _ada (d ,_acag .NameAttr ,_acag .EmbedBoldItalic .IdAttr ,_acag .EmbedBoldItalic .FontKeyAttr );
};};return nil ;};func _bcfd (_gfca string )([]byte ,error ){_fag :=_e .MustCompile ("\u005b\u005e\u0061\u002d\u007a\u0041\u002d\u005a\u0030\u002d\u0039\u005d\u002b");_gfca =_fag .ReplaceAllString (_gfca ,"");_cecf :=[]rune (_gfca );_agfb :=[]byte {};for _gaff :=len (_cecf )-2;
_gaff >=0;_gaff -=2{_adaa ,_abbd :=_ff .ParseUint (string (_cecf [_gaff ])+string (_cecf [_gaff +1]),16,8);if _abbd !=nil {return nil ,_abbd ;};_agfb =append (_agfb ,byte (_adaa ));};return _agfb ,nil ;};type barSerByOrder []*_cbf .CT_BarSer ;func (_dbfg *creatorContext )drawBorderWithProps (_beeb *_ef .CT_ShapeProperties ,_cedb *Rectangle ,_cgab float64 ){if _cedb !=nil &&_beeb !=nil &&_beeb .Ln !=nil &&_beeb .Ln .SolidFill !=nil {_cacfd :=_dbfg .getPdfColorFromSolidFill (_beeb .Ln .SolidFill );
DrawRectangle (_dbfg ._cgfc ,_cedb ,_cgab ,_cacfd );};};func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _edee ,_bgag ,_cdag uint8 ;_effa ,_ :=_g .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_edee ,&_bgag ,&_cdag );
if _effa !=3{return "";};_efeg ,_dcd ,_abd :=_dbe (_edee ,_bgag ,_cdag );_abd =lum *_abd ;_edee ,_bgag ,_cdag =_afcb (_efeg ,_dcd ,_abd );return _g .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_edee ,_bgag ,_cdag );};
func ClearRegisteredFonts (){_afed ._dfdd .Lock ();_afed ._bbbc =map[string ]map[FontStyle ]*_ebd .PdfFont {};_afed ._dfdd .Unlock ();};type creatorContext struct{_cgfc *_bf .Creator ;_dcda *_ef .Theme ;_eaeg float64 ;};func (_dde *creatorContext )drawAxes (_cbba *_cbf .CT_PlotAreaChoice1 ,_dfc ,_ddf ,_bee float64 ,_bad []string ,_cddg *Rectangle ,_deda bool )error {_fcg :=_dde ._cgfc ;
_bgbbe :=_dde ._eaeg ;if _cbba ==nil {return _eb .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};if len (_cbba .ValAx )==0||(len (_cbba .CatAx )==0&&len (_cbba .DateAx )==0&&len (_cbba .SerAx )==0){return _eb .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");
};var _dfab ,_adc ,_gag ,_efg uint32 ;var _ceea ,_adb _cbf .ST_AxPos ;var _fcgf ,_gceb _cbf .ST_TickMark ;var _eged ,_fad *_cbf .CT_ChartLines ;var _fgagg ,_ccc _cbf .ST_TickLblPos ;var _dge ,_ddc *_ef .CT_ShapeProperties ;var _gae error ;_eda :=_cddg .Right -_cddg .Left ;
_cgbe :=_cddg .Bottom -_cddg .Top ;if len (_cbba .ValAx )> 0{_adc ,_adb ,_gceb ,_ccc ,_fad ,_efg ,_ddc ,_gae =_bebb (_cbba .ValAx [0]);};if _adb !=_cbf .ST_AxPosL &&_adb !=_cbf .ST_AxPosB {return _eb .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};_eefb :=_ddf -_dfc ;_bdfd :=int (_eefb /_bee )+1;var _faa ,_egda float64 ;switch _gceb {case _cbf .ST_TickMarkIn :_faa ,_egda =_cgfd ,0;case _cbf .ST_TickMarkOut :_faa ,_egda =0,_cgfd ;case _cbf .ST_TickMarkCross :_faa ,_egda =_cgfd ,_cgfd ;};_faa =_faa *_bgbbe ;
_egda =_egda *_bgbbe ;var _agac *_ef .CT_ShapeProperties ;if _fad !=nil {_agac =_fad .SpPr ;};_ggc ,_gbaa :=_fgagg !=_cbf .ST_TickLblPosNone ,_ccc !=_cbf .ST_TickLblPosNone ;_aef :=_dfc ;if len (_cbba .CatAx )> 0{_dfab ,_ceea ,_fcgf ,_fgagg ,_eged ,_gag ,_dge ,_gae =_cac (_cbba .CatAx [0]);
}else if len (_cbba .DateAx )> 0{_dfab ,_ceea ,_fcgf ,_fgagg ,_eged ,_gag ,_dge ,_gae =_eab (_cbba .DateAx [0]);}else if len (_cbba .SerAx )> 0{_dfab ,_ceea ,_fcgf ,_fgagg ,_eged ,_gag ,_dge ,_gae =_ffeb (_cbba .SerAx [0]);};if _gae !=nil {return _gae ;
};if _ceea !=_cbf .ST_AxPosL &&_ceea !=_cbf .ST_AxPosB {return _eb .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};if _dfab !=_efg ||_adc !=_gag {return _eb .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_dbbc :=len (_bad )+1;var _gcd ,_dbaf float64 ;switch _fcgf {case _cbf .ST_TickMarkIn :_gcd ,_dbaf =_cgfd ,0;
case _cbf .ST_TickMarkOut :_gcd ,_dbaf =0,_cgfd ;case _cbf .ST_TickMarkCross :_gcd ,_dbaf =_cgfd ,_cgfd ;};_gcd =_gcd *_bgbbe ;_dbaf =_dbaf *_bgbbe ;var _adgg *_ef .CT_ShapeProperties ;if _eged !=nil {_adgg =_eged .SpPr ;};if _deda {_ecfa :=_cgbe /float64 (len (_bad ));
_ddg :=_cddg .Left -_dfc *_eda /_eefb ;_cfc :=_ddg -_cbg *_bgbbe ;if _ggc {var _agbe float64 ;for _faab :=0;_faab < _dbbc ;_faab ++{_gedb :=_cddg .Bottom -float64 (_faab )*_ecfa ;if _faab < _dbbc -1{_gagf :=_fcg .NewParagraph (_bad [_faab ]);_gagf .SetFontSize (_adg *_bgbbe );
_gagf .SetPos (_cfc ,_gedb -_ecfa /2-_fgag *_bgbbe );_fcg .Draw (_gagf );_aff :=(_gagf .Width ()/1000-_cbg )*_bgbbe ;if _aff > 0&&_aff > _agbe {_agbe =_aff ;};};};if _agbe > 0{_cddg .Left +=_agbe +_adf ;_ddg =_cddg .Left -_dfc *_eda /_eefb ;_eda =_cddg .Right -_cddg .Left ;
};};_gacg :=_ddg -_dbaf ;_ecef :=_ddg +_gcd ;_fge :=_cddg .Left ;_gef :=_cddg .Right ;for _ecac :=0;_ecac < _dbbc ;_ecac ++{_dffc :=_cddg .Bottom -float64 (_ecac )*_ecfa ;_dde .drawLineWithProps (_dge ,_gacg ,_dffc ,_ecef ,_dffc ,true );_dde .drawLineWithProps (_adgg ,_fge ,_dffc ,_gef ,_dffc ,true );
};_fda :=_eda /_eefb ;_cdc :=_cddg .Bottom -_faa ;_beb :=_cddg .Bottom +_egda ;_gcce :=_cddg .Top ;_gafa :=_cddg .Bottom ;for _dbdd :=0;_dbdd < _bdfd ;_dbdd ++{_bdc :=_cddg .Left +(_aef -_dfc )*_fda ;_dde .drawLineWithProps (_ddc ,_bdc ,_cdc ,_bdc ,_beb ,true );
_dde .drawLineWithProps (_agac ,_bdc ,_gcce ,_bdc ,_gafa ,true );if _gbaa {_bbd :=_fcg .NewParagraph (_ff .FormatFloat (_aef ,'g',-1,64));_bbd .SetFontSize (_adg *_bgbbe );_bbd .SetPos (_bdc -_efc *_bgbbe ,_gafa +_afa *_bgbbe );_fcg .Draw (_bbd );};_aef +=_bee ;
};}else {_egdf :=_cgbe /_eefb ;_aaf :=_cddg .Left ;if _gbaa {var _abgg float64 ;for _cdae :=0;_cdae < _bdfd ;_cdae ++{_eed :=_cddg .Bottom -(_aef -_dfc )*_egdf ;_dea :=_fcg .NewParagraph (_ff .FormatFloat (_aef ,'g',-1,64));_dea .SetFontSize (_adg *_bgbbe );
_dea .SetPos (_aaf -_cbg *_bgbbe ,_eed -_fgag *_bgbbe );_fcg .Draw (_dea );_cef :=(_dea .Width ()/1000-_cbg )*_bgbbe ;if _cef > 0&&_cef > _abgg {_abgg =_cef ;};_aef +=_bee ;};if _abgg > 0{_cddg .Left +=_abgg +_adf ;_eda =_cddg .Right -_cddg .Left ;};};
_aef =_dfc ;_afbc :=_cddg .Left -_egda ;_adca :=_cddg .Left +_faa ;_aaf =_cddg .Left ;_bfb :=_cddg .Right ;for _fbf :=0;_fbf < _bdfd ;_fbf ++{_efb :=_cddg .Bottom -(_aef -_dfc )*_egdf ;_dde .drawLineWithProps (_ddc ,_afbc ,_efb ,_adca ,_efb ,true );_dde .drawLineWithProps (_agac ,_aaf ,_efb ,_bfb ,_efb ,true );
_aef +=_bee ;};_eee :=_eda /float64 (len (_bad ));_aad :=_cddg .Bottom +_dfc *_cgbe /_eefb ;_badc :=_aad -_gcd ;_def :=_aad +_dbaf ;_cefd :=_cddg .Top ;_eec :=_cddg .Bottom ;_fbcd :=_aad +_afa *_bgbbe ;for _ecd :=0;_ecd < _dbbc ;_ecd ++{_cce :=_cddg .Left +float64 (_ecd )*_eee ;
_dde .drawLineWithProps (_dge ,_cce ,_badc ,_cce ,_def ,true );_dde .drawLineWithProps (_adgg ,_cce ,_cefd ,_cce ,_eec ,true );if _ggc &&_ecd < _dbbc -1{_eccg :=_fcg .NewParagraph (_bad [_ecd ]);_eccg .SetFontSize (_adg *_bgbbe );_eccg .SetPos (_cce +_gff *_bgbbe ,_fbcd );
_fcg .Draw (_eccg );};};};return nil ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);type ImgPart byte ;func _bacb (_eefe uint8 ,_cedg float64 )string {_abgd :=float64 (_eefe );
return _g .Sprintf ("\u0025\u0030\u0032\u0078",int (_abgd *_cedg ));};func (_ggcd *Rectangle )scale (_cfd float64 ){_ggcd .Top *=_cfd ;_ggcd .Bottom *=_cfd ;_ggcd .Left *=_cfd ;_ggcd .Right *=_cfd ;};var DefaultFontSize =12.0;func (_cga barSerByOrder )Swap (i ,j int ){_cga [i ],_cga [j ]=_cga [j ],_cga [i ]};
func (_fce *creatorContext )addCatName (_dcbe string ,_aag map[string ]serCategory ,_dff *[]string ){if _ ,_abg :=_aag [_dcbe ];!_abg {_aag [_dcbe ]=serCategory {_fcc :_dcbe ,_gbb :[]serValue {}};*_dff =append (*_dff ,_dcbe );};};var _gff =_cff (5);const (BorderPositionTop BorderPosition =0;
BorderPositionLeft BorderPosition =1;BorderPositionBottom BorderPosition =2;BorderPositionRight BorderPosition =3;);type Rectangle struct{Top float64 ;Bottom float64 ;Left float64 ;Right float64 ;};func Lighten (clr float64 )float64 {return 0.6+0.4*clr };
func _bgaa (_gafe string )error {if !_ea .HasSuffix (_gafe ,"\u002e\u0074\u0074\u0066"){_d .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return _g .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_agbd ,_gfgc :=_cb .ParseFile (_gafe );if _gfgc !=nil {_d .Log .Debug ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020T\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_gfgc );return _gfgc ;};_bgge ,_gfgc :=_ebd .NewCompositePdfFontFromTTFFile (_gafe );
if _gfgc !=nil {return _gfgc ;};_eada :=_agbd .GetNameRecords ();for _ ,_dfca :=range _eada {_fdge :=_dfca [1];if _fdge ==""{continue ;};_cfae :=make ([]byte ,0);for _aedb :=0;_aedb < len (_fdge );_aedb ++{if _fdge [_aedb ]==39||_fdge [_aedb ]==92{continue ;
};_eagd :=4;if _aedb +_eagd < len (_fdge ){if _fdge [_aedb :_aedb +_eagd ]=="\u0000"{_aedb =_aedb +_eagd +1;continue ;};};_cfae =append (_cfae ,_fdge [_aedb ]);};_fdge =_ea .Replace (string (_cfae ),"\u0078\u0030\u0030","",-1);_bed :=_dfca [2];if _bed ==""{return _g .Errorf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_gafe );
};_cfae =make ([]byte ,0);for _cecef :=0;_cecef < len (_bed );_cecef ++{if _bed [_cecef ]==39||_bed [_cecef ]==92{continue ;};_edf :=4;if _cecef +_edf < len (_bed ){if _bed [_cecef :_cecef +_edf ]=="\u0000"{_cecef =_cecef +_edf +1;continue ;};};_cfae =append (_cfae ,_bed [_cecef ]);
};_bed =_ea .Replace (string (_cfae ),"\u0078\u0030\u0030","",-1);RegisterFont (_fdge ,_ggfc [_bed ],_bgge );};return nil ;};const (ImgPart_whole ImgPart =0;ImgPart_t ImgPart =1;ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;
ImgPart_rt ImgPart =6;ImgPart_lb ImgPart =7;ImgPart_rb ImgPart =8;);func MakeTempCreator (width ,height float64 )*_bf .Creator {_agfd :=_bf .New ();_agfd .SetPageSize (_bf .PageSize {width ,height });_agfd .SetPageMargins (0,0,0,0);return _agfd ;};func _ada (_cfa *_fd .Document ,_cece ,_gee ,_accd string )error {_dfb ,_ffage :=_cfa .GetFontBytesByRelId (_gee );
if _ffage !=nil {return _ffage ;};_deed ,_ffage :=_bcfd (_accd );if _ffage !=nil {return _ffage ;};for _aae :=0;_aae < 32;_aae ++{_acd :=_aae %len (_deed );_dfb [_aae ]=_dfb [_aae ]^_deed [_acd ];};_aee :=_cfa .TmpPath +"\u002f"+_cece +"\u002e\u0074\u0074\u0066";
_ffage =_bc .WriteFile (_aee ,_dfb ,0644);if _ffage !=nil {return _ffage ;};_bgaa (_aee );return nil ;};func (_afe barSerByOrder )Less (i ,j int )bool {return _afe [i ].Order .ValAttr < _afe [j ].Order .ValAttr };func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_ed .Twips *10+0.5))/10;
};func (_aadf *creatorContext )getPdfColorFromSolidFill (_bbe *_ef .CT_SolidColorFillProperties )_bf .Color {if _bbe ==nil {return nil ;};_cfda :="";if _gcgf :=_bbe .SrgbClr ;_gcgf !=nil {_cfda =_gcgf .ValAttr ;}else if _cgeg :=_bbe .SchemeClr ;_cgeg !=nil {_cfda =_dbac (_cgeg .ValAttr ,_aadf ._dcda );
};if _cfda ==""{return nil ;};return _bf .ColorRGBFromHex ("\u0023"+_cfda );};func _bebb (_dedf *_cbf .CT_ValAx )(uint32 ,_cbf .ST_AxPos ,_cbf .ST_TickMark ,_cbf .ST_TickLblPos ,*_cbf .CT_ChartLines ,uint32 ,*_ef .CT_ShapeProperties ,error ){var _gcb ,_fgd uint32 ;
var _bbac _cbf .ST_AxPos ;var _cge _cbf .ST_TickMark ;var _addc *_cbf .CT_ChartLines ;var _ede _cbf .ST_TickLblPos ;if _dedf .AxId ==nil {return _gcb ,_bbac ,_cge ,_ede ,_addc ,_fgd ,_dedf .SpPr ,_eb .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_gcb =_dedf .AxId .ValAttr ;};if _dedf .AxPos ==nil {return _gcb ,_bbac ,_cge ,_ede ,_addc ,_fgd ,_dedf .SpPr ,_eb .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_bbac =_dedf .AxPos .ValAttr ;
};if _dedf .MajorTickMark !=nil {_cge =_dedf .MajorTickMark .ValAttr ;};if _dedf .TickLblPos !=nil {_ede =_dedf .TickLblPos .ValAttr ;};if _dedf .CrossAx ==nil {return _gcb ,_bbac ,_cge ,_ede ,_addc ,_fgd ,_dedf .SpPr ,_eb .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_fgd =_dedf .CrossAx .ValAttr ;};_addc =_dedf .MajorGridlines ;return _gcb ,_bbac ,_cge ,_ede ,_addc ,_fgd ,_dedf .SpPr ,nil ;};func FromSTCoordinate (st _ef .ST_Coordinate )int64 {if _fgdc :=st .ST_CoordinateUnqualified ;_fgdc !=nil {return *_fgdc ;
};return 0;};func MakeImageFromChartSpace (cs *_cbf .ChartSpace ,width ,height float64 ,theme *_ef .Theme ,workbook *_fde .Workbook )(_c .Image ,error ){_fa ,_gac :=_baf (cs ,width ,height ,theme ,true ,workbook );if _gac !=nil {return nil ,_gac ;};_eeb ,_gac :=GetPageFromCreator (_fa );
if _gac !=nil {return nil ,_gac ;};return _ge .NewImageDevice ().Render (_eeb );};func TwipsFromPoints (points float64 )float64 {return points /_ed .Twips };func MakeTempCreatorMaxHeight (width float64 )*_bf .Creator {return MakeTempCreator (width ,_bcf .MaxFloat64 );
};var _bag =_cff (0.125);func DrawLine (c *_bf .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _bf .Color ){if color ==nil {return ;};_dceef :=c .NewLine (x0 ,y0 ,x1 ,y1 );_dceef .SetLineWidth (width );_dceef .SetColor (color );c .Draw (_dceef );};type BorderPosition byte ;
func AdjustColorByShade (colorStr string ,shade float64 )string {var _gdag ,_fcee ,_gfc uint8 ;_gacb ,_ :=_g .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_gdag ,&_fcee ,&_gfc );if _gacb !=3{return "";};return _bacb (_gdag ,shade )+_bacb (_fcee ,shade )+_bacb (_gfc ,shade );
};func IsNoSpaceLanguage (symbol string )bool {for _ ,_begb :=range symbol {if _f .Is (_f .Han ,_begb ){return true ;};};return false ;};type FontStyle byte ;func MakeBlockFromChartSpace (cs *_cbf .ChartSpace ,width ,height float64 ,theme *_ef .Theme )(*_bf .Block ,error ){_fcdfg ,_fdgde :=_baf (cs ,width ,height ,theme ,false ,nil );
if _fdgde !=nil {return nil ,_fdgde ;};_acc ,_fdgde :=GetPageFromCreator (_fcdfg );if _fdgde !=nil {return nil ,_fdgde ;};_fcfg ,_fdgde :=_bf .NewBlockFromPage (_acc );if _fdgde !=nil {return nil ,_fdgde ;};return _fcfg ,nil ;};var _fgag =_cff (1.5);func _bdeb (_ceb uint8 ,_ecda float64 )string {_aaa :=float64 (_ceb );
var _bbag float64 ;if _ecda < 0{_bbag =_aaa *(1+_ecda );}else {_bbag =_aaa +(255-_aaa )*_ecda ;};return _g .Sprintf ("\u0025\u0030\u0032\u0078",int (_bbag ));};func RegisterFontsFromDirectory (dirName string )error {_fged ,_eage :=_bc .Open (dirName );
if _eage !=nil {return _eage ;};defer _fged .Close ();_cbe ,_eage :=_fged .Readdirnames (0);if _eage !=nil {return _eage ;};for _ ,_bae :=range _cbe {if _ea .HasSuffix (_bae ,"\u002e\u0074\u0074\u0066"){_dcad :=dirName +"\u002f"+_bae ;_cdcdd :=_bgaa (_dcad );
if _cdcdd !=nil {_d .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_cdcdd );
continue ;};};};return nil ;};func (_bba *creatorContext )drawLegend (_cfb *Rectangle ,_dcbg []*legendItem ,_ffaa bool ){_ecf :=_bba ._eaeg ;_gbc :=_cff (2.5)*_ecf ;_adda :=_cbb *_ecf ;_ege :=(_gbc -_adda )/2;_gdf :=float64 (len (_dcbg ));if _ffaa {_dbg :=&Rectangle {Top :_cfb .Top +_cff (1)*_ecf ,Bottom :_cfb .Bottom -_cff (1)*_ecf ,Left :_cfb .Left +_cff (2.5)*_ecf ,Right :_cfb .Right -_cff (2.5)*_ecf };
var _bge float64 ;if _gdf > 1{_bge =(_dbg .Right -_dbg .Left )/_gdf ;};_egd :=_dbg .Left ;_ecgc :=_dbg .Top ;for _ ,_dcee :=range _dcbg {if _dceb :=_dcee ._aed ;_dceb !=nil {_bba .drawRectangleWithProps (_dceb ,_egd ,_ecgc +_ege ,_adda ,_adda ,false );
_bgbb :=_egd +_adda *2;_cedc :=_bba ._cgfc .NewStyledParagraph ();_cedc .SetPos (_bgbb ,_ecgc );_fbef :=_cedc .Append (_dcee ._fcdf );_becc ,_fbc :=_ebd .NewStandard14Font (_ebd .HelveticaName );if _fbc ==nil {_dbc :=_bba ._cgfc .NewTextStyle ();_dbc .Font =_becc ;
_dbc .FontSize =_gbc ;_dbc .TextRise =0.4;_fbef .Style =_dbc ;_bba ._cgfc .Draw (_cedc );};};_egd +=_bge ;};}else {_efa :=&Rectangle {Top :_cfb .Top +_cff (2.5)*_ecf ,Bottom :_cfb .Bottom -_cff (2.5)*_ecf ,Left :_cfb .Left +_cff (2.5)*_ecf ,Right :_cfb .Right -_cff (2.5)*_ecf };
var _fec float64 ;if _gdf > 1{_fec =(_efa .Bottom -_efa .Top -_gbc )/(_gdf -1);if _fec < _gbc {_fec =_gbc ;};};_dfa :=_efa .Top ;_aba :=_efa .Left ;_bff :=_aba +_adda *2;for _ ,_dbgg :=range _dcbg {if _agbb :=_dbgg ._aed ;_agbb !=nil {_bba .drawRectangleWithProps (_agbb ,_aba ,_dfa +_ege ,_adda ,_adda ,false );
_bacc :=_bba ._cgfc .NewStyledParagraph ();_bacc .SetPos (_bff ,_dfa );_bacc .SetWidth (_efa .Right -_efa .Left );_eca :=_bacc .Append (_dbgg ._fcdf );_ebf ,_gbg :=_ebd .NewStandard14Font (_ebd .HelveticaName );if _gbg ==nil {_fgg :=_bba ._cgfc .NewTextStyle ();
_fgg .Font =_ebf ;_fgg .FontSize =_gbc ;_fgg .TextRise =0.4;_eca .Style =_fgg ;_bba ._cgfc .Draw (_bacc );};};_dfa +=_fec ;};};};func GetPageFromCreator (c *_bf .Creator )(*_ebd .PdfPage ,error ){_gcea :=_a .NewBuffer ([]byte {});_bedf :=c .Write (_gcea );
if _bedf !=nil {return nil ,_bedf ;};_ggda :=_a .NewReader (_gcea .Bytes ());_fdf ,_bedf :=_ebd .NewPdfReader (_ggda );if _bedf !=nil {return nil ,_bedf ;};return _fdf .GetPage (1);};var _adf =_cff (2);func (_ebbf *creatorContext )drawLineWithProps (_bbbd *_ef .CT_ShapeProperties ,_dcce ,_cadd ,_gbfa ,_gded float64 ,_aedd bool ){if _bbbd !=nil {if _eccd :=_bbbd .Ln ;
_eccd !=nil {_ebec :=_ebbf .getPdfColorFromSolidFill (_eccd .SolidFill );if _ebec ==nil &&_aedd {_ebec =_bf .ColorBlack ;};if _ebec !=nil {var _ccec float64 ;if _aabg :=_eccd .WAttr ;_aabg !=nil {_ccec =_ed .FromEMU (int64 (*_aabg ));}else {_ccec =_bag ;
};DrawLine (_ebbf ._cgfc ,_dcce ,_cadd ,_gbfa ,_gded ,_ccec ,_ebec );};};};};type fontsMap struct{_dfdd *_be .Mutex ;_bbbc map[string ]map[FontStyle ]*_ebd .PdfFont ;};func AdjustColor (colorStr string ,EG_ColorTransform []*_ef .EG_ColorTransform )string {for _ ,_feag :=range EG_ColorTransform {if _gfd :=_feag .Tint ;
_gfd !=nil {if _fdbg :=_gfd .ValAttr .ST_PositiveFixedPercentageDecimal ;_fdbg !=nil {colorStr =AdjustColorByTint (colorStr ,float64 (*_fdbg )/100000);};};if _bbg :=_feag .Shade ;_bbg !=nil {if _dcac :=_bbg .ValAttr .ST_PositiveFixedPercentageDecimal ;
_dcac !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_dcac )/100000);};};if _gafc :=_feag .LumMod ;_gafc !=nil {if _dcaca :=_gafc .ValAttr .ST_PercentageDecimal ;_dcaca !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_dcaca )/100000);
};};};return colorStr ;};func (_af *creatorContext )drawBarChart (_ab *_cbf .CT_BarChart ,_ccf *Rectangle ,_gc *_cbf .CT_PlotAreaChoice1 ,_fg *_fde .Workbook )([]*legendItem ,error ){var _ged bool ;if _cd :=_ab .BarDir ;_cd !=nil {_ged =_cd .ValAttr ==_cbf .ST_BarDirBar ;
};_de :=_ab .Ser ;_gd .Sort (barSerByOrder (_de ));_da :=map[string ]serCategory {};_afb :=[]string {};_gf :=[]*legendItem {};_ca :=_bcf .Inf (1);_gb :=_bcf .Inf (-1);for _ ,_fb :=range _de {var _fc string ;if _fga :=_fb .Tx ;_fga !=nil {if _bd :=_fga .Choice ;
_bd !=nil {if _bd .V !=nil {_fc =*_bd .V ;}else if _abb :=_bd .StrRef ;_abb !=nil {if _afc :=_abb .StrCache ;_afc !=nil {for _ ,_bfc :=range _afc .Pt {_fc =_bfc .V ;};};};};};if _ac :=_fb .Cat ;_ac !=nil {if _ce :=_ac .Choice ;_ce !=nil {if _eaf :=_ce .StrRef ;
_eaf !=nil {if _fe :=_eaf .F ;_fe !=""&&_fg !=nil {_fdb ,_ec ,_ga ,_ebe :=ParseExcelRange (_fe );if _ebe ==nil {for _ ,_gfe :=range _fg .Sheets (){if _gfe .Name ()==_ea .Trim (_fdb ,"\u0027"){_cdg :=_ec .String ();for _ead :=_ec .RowIdx ;_ead <=_ga .RowIdx ;
_ead +=1{_dc :=_ea .ReplaceAll (_cdg ,_g .Sprint (_ec .RowIdx ),_g .Sprint (_ead ));_af .addCatName (_gfe .Cell (_dc ).GetString (),_da ,&_afb );};break ;};};};};if _cg :=_eaf .StrCache ;_cg !=nil {for _ ,_bdf :=range _cg .Pt {_af .addCatName (_bdf .V ,_da ,&_afb );
};};}else if _dd :=_ce .NumRef ;_dd !=nil {if _dag :=_dd .NumCache ;_dag !=nil {var _ag string ;if _dag .FormatCode !=nil {_ag =*_dag .FormatCode ;};for _ ,_eag :=range _dag .Pt {var _edg string ;if _eag .FormatCodeAttr ==nil {_edg =_ag ;}else {_edg =*_eag .FormatCodeAttr ;
};var _cgb string ;_db ,_ceg :=_ff .ParseFloat (_eag .V ,64);if _ceg !=nil {_cgb =_eag .V ;}else {_cgb =_cc .Number (_db ,_edg );};_af .addCatName (_cgb ,_da ,&_afb );};};};};};if _cda :=_fb .Val ;_cda !=nil {if _gdg :=_cda .Choice ;_gdg !=nil {if _gce :=_gdg .NumRef ;
_gce !=nil {if _ebg :=_gce .F ;_ebg !=""&&_fg !=nil {_ad ,_gaf ,_ffg ,_cf :=ParseExcelRange (_ebg );if _cf ==nil {for _ ,_ced :=range _fg .Sheets (){if _ced .Name ()==_ea .Trim (_ad ,"\u0027"){_gfea :=_gaf .String ();for _dec :=_gaf .RowIdx ;_dec <=_ffg .RowIdx ;
_dec +=1{_bg :=_ea .ReplaceAll (_gfea ,_g .Sprint (_gaf .RowIdx ),_g .Sprint (_dec ));if _ced .FormulaContext ().HasFormula (_bg ){_caf :=_ba .NewEvaluator ();_dae :=_ced .FormulaContext ().Cell (_bg ,_caf );_ffa :=_dae .Value ();_af .addCatValue (_ffa ,_da ,_afb ,(int )(_dec -_gaf .RowIdx ),&_ca ,&_gb ,_fc ,_fb .SpPr );
}else {_cfe :=_ced .Cell (_bg ).GetString ();_af .addCatValue (_cfe ,_da ,_afb ,(int )(_dec -_gaf .RowIdx ),&_ca ,&_gb ,_fc ,_fb .SpPr );};};break ;};};};};if _ffb :=_gce .NumCache ;_ffb !=nil {for _gg ,_aa :=range _ffb .Pt {_af .addCatValue (_aa .V ,_da ,_afb ,_gg ,&_ca ,&_gb ,_fc ,_fb .SpPr );
};};};};};_gf =append (_gf ,&legendItem {_fcdf :_fc ,_aed :_fb .SpPr });};var _fdc float64 ;var _bdb ,_gcg float64 ;if _gb ==0&&_ca ==0{_fdc =0.2;_gcg =0;_bdb =1;}else {var _fdgd float64 ;if _fcf :=_bcf .Abs (_ca );_gb < _fcf {_fdgd =_fcf ;}else {_fdgd =_gb ;
};_bcd :=_bcf .Pow (10,_bcf .Floor (_bcf .Log10 (_fdgd )));_ae :=_fdgd /_bcd ;if _ae < 4.29{_fdc =0.5;}else if _ae >=4.29&&_ae < 8.58{_fdc =1;}else {_fdc =2;};_fdc *=_bcd ;if _gb <=0{_bdb =0;}else {_bdb =(_bcf .Ceil (_gb /_fdc )+1)*_fdc ;};if _ca >=0{_gcg =0;
}else {_gcg =(_bcf .Floor (_ca /_fdc )-1)*_fdc ;};};_cad :=_af .drawAxes (_gc ,_gcg ,_bdb ,_fdc ,_afb ,_ccf ,_ged );if _cad !=nil {return nil ,_cad ;};_fcd :=0.0;if _ab .GapWidth !=nil {if _fgb :=_ab .GapWidth .ValAttr ;_fgb !=nil {if _fcde :=_fgb .ST_GapAmountUShort ;
_fcde !=nil {_fcd =float64 (*_fcde )/100.0;};};};_bfcb :=_ccf .Right -_ccf .Left ;_ecg :=_ccf .Bottom -_ccf .Top ;_ggf :=float64 (len (_afb ));if _ged {_dcb :=_bdb /(_bdb -_gcg )*_bfcb ;_fcb :=-_gcg /(_bdb -_gcg )*_bfcb ;_fea :=_ccf .Left +_fcb ;_cbd :=_ecg /_ggf ;
for _dadd ,_gaa :=range _afb {_gfg :=_da [_gaa ];_acb :=float64 (len (_gfg ._gbb ))+_fcd ;_abf :=_cbd /_acb ;_dgc :=_abf *_fcd ;_eeg :=_ccf .Bottom -float64 (_dadd )*_cbd -_dgc /2-_abf ;for _ ,_dca :=range _gfg ._gbb {if _dca ._dbd ==0{continue ;};var _bcc ,_gca float64 ;
if _dca ._dbd > 0{_gca =_dca ._dbd /_bdb *_dcb ;_af .drawRectangleWithProps (_dca ._gfga ,_fea ,_eeg ,_gca ,_abf ,false );}else {_gca =_dca ._dbd /_gcg *_fcb ;_bcc =_fea -_gca ;_af .drawRectangleWithProps (_dca ._gfga ,_bcc ,_eeg ,_gca ,_abf ,false );};
_eeg -=_abf ;};};}else {_efd :=_bdb /(_bdb -_gcg )*_ecg ;_bec :=-_gcg /(_bdb -_gcg )*_ecg ;_geda :=_ccf .Top +_efd ;_ded :=_bfcb /_ggf ;for _bdbf ,_cab :=range _afb {_cde :=_da [_cab ];_cee :=float64 (len (_cde ._gbb ))+_fcd ;_dba :=_ded /_cee ;_agb :=_dba *_fcd ;
_gge :=_ccf .Left +float64 (_bdbf )*_ded +_agb /2;for _ ,_cgf :=range _cde ._gbb {var _df ,_bgg float64 ;if _cgf ._dbd > 0{_bgg =_cgf ._dbd /_bdb *_efd ;_df =_geda -_bgg ;_af .drawRectangleWithProps (_cgf ._gfga ,_gge ,_df ,_dba ,_bgg ,false );}else {_bgg =_cgf ._dbd /_gcg *_bec ;
_af .drawRectangleWithProps (_cgf ._gfga ,_gge ,_geda ,_dba ,_bgg ,false );};_gge +=_dba ;};};};return _gf ,nil ;};func GetOpacityFromColorTransform (trs []*_ef .EG_ColorTransform )float64 {for _ ,_fgac :=range trs {if _fgac !=nil {if _dgg :=_fgac .Alpha ;
_dgg !=nil {if _abbg :=_dgg .ValAttr .ST_PositiveFixedPercentageDecimal ;_abbg !=nil {return float64 (*_abbg )/100000;};};};};return 1.0;};func _afcb (_eadf ,_acg ,_bfe float64 )(uint8 ,uint8 ,uint8 ){var _fggf float64 ;if _bfe < 0.5{_fggf =_bfe *(1+_acg );
}else {_fggf =_bfe +_acg -_bfe *_acg ;};_aefa :=_bfe *2-_fggf ;_eadf /=360.0;_aage :=_fgf (_eadf +1.0/3.0);_beg :=_fgf (_eadf );_bfa :=_fgf (_eadf -1.0/3.0);_aebb :=_afcbd (_aage ,_fggf ,_aefa );_aea :=_afcbd (_beg ,_fggf ,_aefa );_bded :=_afcbd (_bfa ,_fggf ,_aefa );
return uint8 (255*_aebb ),uint8 (255*_aea ),uint8 (255*_bded );};func (_ade barSerByOrder )Len ()int {return len (_ade )};func FromSTPercentage (st *_ef .ST_Percentage )float64 {if _daf :=st .ST_PercentageDecimal ;_daf !=nil {return float64 (*_daf )/100000;
};return 0;};var _afa =_cff (1.5);func _cff (_bccfb float64 )float64 {return _bccfb *_ed .Millimeter };func GetImage (c *_bf .Creator ,goImg _c .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_bf .Image ,error ){if goImg ==nil {return nil ,nil ;
};_cadb :=goImg .Bounds ().Size ();_cfaa :=_cadb .X ;_fdef :=_cadb .Y ;if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_cfaa );};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_fdef );};var _afae _c .Rectangle ;switch part {case ImgPart_t :_afae =_c .Rect (0,0,_cfaa ,int (dividerY ));
case ImgPart_b :_afae =_c .Rect (0,int (dividerY ),_cfaa ,_fdef );case ImgPart_l :_afae =_c .Rect (0,0,int (dividerX ),_fdef );case ImgPart_r :_afae =_c .Rect (int (dividerX ),0,_cfaa ,_fdef );case ImgPart_lt :_afae =_c .Rect (0,0,int (dividerX ),int (dividerY ));
case ImgPart_rt :_afae =_c .Rect (int (dividerX ),0,_cfaa ,int (dividerY ));case ImgPart_lb :_afae =_c .Rect (0,int (dividerY ),int (dividerX ),_fdef );case ImgPart_rb :_afae =_c .Rect (int (dividerX ),int (dividerY ),_cfaa ,_fdef );default:_afae =_c .Rect (0,0,_cfaa ,_fdef );
};_baccg :=CropImageByRect (goImg ,_afae );_bfd ,_gbe :=c .NewImageFromGoImage (_baccg );if _gbe !=nil {return nil ,_gbe ;};_bfd .Scale (imgWidth /float64 (_cfaa ),imgHeight /float64 (_fdef ));_bfd .SetPos (left ,top );return _bfd ,nil ;};func GetColorStringFromDmlColor (dmlColor *_ef .CT_Color )string {var _dbf string ;
if _cag :=dmlColor .SrgbClr ;_cag !=nil {_dbf =_cag .ValAttr ;}else if _fca :=dmlColor .SysClr ;_fca !=nil {return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _dbf ;};func RegisterFontsFromFiles (files []string )error {for _ ,_cccd :=range files {if _ea .HasSuffix (_cccd ,"\u002e\u0074\u0074\u0066"){_cgc :=_bgaa (_cccd );
if _cgc !=nil {_d .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_cgc );
continue ;};};};return nil ;};func _fgf (_gdb float64 )float64 {if _gdb < 0{_gdb +=float64 (-int (_gdb )+1);}else if _gdb > 1{_gdb -=float64 (int (_gdb ));};return _gdb ;};func _dbe (_bgec ,_eefc ,_ccee uint8 )(float64 ,float64 ,float64 ){_dedb ,_ebb ,_cfcc :=float64 (_bgec )/255,float64 (_eefc )/255,float64 (_ccee )/255;
_dcc :=_dedb ;if _ebb < _dcc {_dcc =_ebb ;};if _cfcc < _dcc {_dcc =_cfcc ;};var _ecdc ,_abcg bool ;_fgc :=_dedb ;if _ebb > _fgc {_fgc =_ebb ;_ecdc =true ;};if _cfcc > _fgc {_fgc =_cfcc ;_ecdc =false ;_abcg =true ;};_gde :=(_dcc +_fgc )/2;var _gbga float64 ;
if _dcc !=_fgc {if _gde <=0.5{_gbga =(_fgc -_dcc )/(_fgc +_dcc );}else {_gbga =(_fgc -_dcc )/(2.0-_fgc -_dcc );};};var _dbeb float64 ;if _dcc !=_fgc {if _ecdc {_dbeb =2.0+(_cfcc -_dedb )/(_fgc -_dcc );}else if _abcg {_dbeb =4.0+(_dedb -_ebb )/(_fgc -_dcc );
}else {_dbeb =(_ebb -_cfcc )/(_fgc -_dcc );};_dbeb *=60;if _dbeb < 0{_dbeb +=360;};};return _dbeb ,_gbga ,_gde ;};func GetGroupOffsetFromXfrm (xfrm *_ef .CT_GroupTransform2D )(float64 ,float64 ){var _dac ,_dcaa float64 ;if xfrm .Off !=nil &&xfrm .ChOff !=nil {_dac =_ed .FromEMU (FromSTCoordinate (xfrm .Off .XAttr ))-_ed .FromEMU (FromSTCoordinate (xfrm .ChOff .XAttr ));
_dcaa =_ed .FromEMU (FromSTCoordinate (xfrm .Off .YAttr ))-_ed .FromEMU (FromSTCoordinate (xfrm .ChOff .YAttr ));};return _dac ,_dcaa ;};