//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_b "bytes";_ec "errors";_e "fmt";_d "github.com/unidoc/unichart";_ece "github.com/unidoc/unichart/dataset";_cg "github.com/unidoc/unichart/render";_ab "github.com/unidoc/unioffice/common/logger";_bab "github.com/unidoc/unioffice/document";
_ed "github.com/unidoc/unioffice/measurement";_ad "github.com/unidoc/unioffice/schema/soo/dml";_efc "github.com/unidoc/unioffice/schema/soo/dml/chart";_ac "github.com/unidoc/unioffice/spreadsheet";_da "github.com/unidoc/unioffice/spreadsheet/format";_ge "github.com/unidoc/unioffice/spreadsheet/formula";
_dbb "github.com/unidoc/unioffice/spreadsheet/reference";_dc "github.com/unidoc/unipdf/v3/core";_db "github.com/unidoc/unipdf/v3/creator";_fb "github.com/unidoc/unipdf/v3/model";_ef "github.com/unidoc/unipdf/v3/render";_baf "github.com/unidoc/unitype";
_gb "image";_a "math";_bb "os";_ga "regexp";_bf "sort";_gab "strconv";_f "strings";_g "sync";_ba "unicode";);const _dgf =6.0;type FontStyle byte ;func _cbf (_deae *_efc .CT_SerAx )(uint32 ,_efc .ST_AxPos ,_efc .ST_TickMark ,_efc .ST_TickLblPos ,*_efc .CT_ChartLines ,uint32 ,*_ad .CT_ShapeProperties ,error ){var _gdgd ,_aged uint32 ;
var _fda _efc .ST_AxPos ;var _fge _efc .ST_TickMark ;var _ecab *_efc .CT_ChartLines ;var _ccd _efc .ST_TickLblPos ;if _deae .AxId ==nil {return _gdgd ,_fda ,_fge ,_ccd ,_ecab ,_aged ,_deae .SpPr ,_ec .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_gdgd =_deae .AxId .ValAttr ;};if _deae .AxPos ==nil {return _gdgd ,_fda ,_fge ,_ccd ,_ecab ,_aged ,_deae .SpPr ,_ec .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_fda =_deae .AxPos .ValAttr ;
};if _deae .MajorTickMark !=nil {_fge =_deae .MajorTickMark .ValAttr ;};if _deae .TickLblPos !=nil {_ccd =_deae .TickLblPos .ValAttr ;};if _deae .CrossAx ==nil {return _gdgd ,_fda ,_fge ,_ccd ,_ecab ,_aged ,_deae .SpPr ,_ec .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_aged =_deae .CrossAx .ValAttr ;};_ecab =_deae .MajorGridlines ;return _gdgd ,_fda ,_fge ,_ccd ,_ecab ,_aged ,_deae .SpPr ,nil ;};func GetOpacityFromColorTransform (trs []*_ad .EG_ColorTransform )float64 {for _ ,_ceb :=range trs {if _ceb !=nil {if _fac :=_ceb .Alpha ;
_fac !=nil {if _cfd :=_fac .ValAttr .ST_PositiveFixedPercentageDecimal ;_cfd !=nil {return float64 (*_cfd )/100000;};};};};return 1.0;};func (_gdf barSerByOrder )Swap (i ,j int ){_gdf [i ],_gdf [j ]=_gdf [j ],_gdf [i ]};func RegisterFontsFromDirectory (dirName string )error {_abd ,_dceb :=_bb .Open (dirName );
if _dceb !=nil {return _dceb ;};defer _abd .Close ();_ffc ,_dceb :=_abd .Readdirnames (0);if _dceb !=nil {return _dceb ;};for _ ,_bfaed :=range _ffc {if _f .HasSuffix (_bfaed ,"\u002e\u0074\u0074\u0066"){_ecdfa :=dirName +"\u002f"+_bfaed ;_ddc :=_cbec (_ecdfa );
if _ddc !=nil {_ab .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_ddc );
continue ;};};};return nil ;};var _gcg =_geab (0.125);func (_bgg *creatorContext )drawLegend (_ebf *Rectangle ,_baef []*legendItem ,_gfc bool ){_gdbg :=_bgg ._bggb ;_fcd :=_geab (2.5)*_gdbg ;_fbd :=_age *_gdbg ;_gfg :=(_fcd -_fbd )/2;_bbb :=float64 (len (_baef ));
if _gfc {_fab :=&Rectangle {Top :_ebf .Top +_geab (1)*_gdbg ,Bottom :_ebf .Bottom -_geab (1)*_gdbg ,Left :_ebf .Left +_geab (2.5)*_gdbg ,Right :_ebf .Right -_geab (2.5)*_gdbg };var _bfd float64 ;if _bbb > 1{_bfd =(_fab .Right -_fab .Left )/_bbb ;};_gba :=_fab .Left ;
_bda :=_fab .Top ;for _ ,_fbc :=range _baef {if _dgb :=_fbc ._gca ;_dgb !=nil {_bgg .drawRectangleWithProps (_dgb ,_gba ,_bda +_gfg ,_fbd ,_fbd ,false );_gfff :=_gba +_fbd *2;_aab :=_bgg ._ddb .NewStyledParagraph ();_aab .SetPos (_gfff ,_bda );_bgf :=_aab .Append (_fbc ._gbed );
_bee ,_bed :=_fb .NewStandard14Font (_fb .HelveticaName );if _bed ==nil {_dgba :=_bgg ._ddb .NewTextStyle ();_dgba .Font =_bee ;_dgba .FontSize =_fcd ;_dgba .TextRise =0.4;_bgf .Style =_dgba ;_bgg ._ddb .Draw (_aab );};};_gba +=_bfd ;};}else {_agbb :=&Rectangle {Top :_ebf .Top +_geab (2.5)*_gdbg ,Bottom :_ebf .Bottom -_geab (2.5)*_gdbg ,Left :_ebf .Left +_geab (2.5)*_gdbg ,Right :_ebf .Right -_geab (2.5)*_gdbg };
var _ffef float64 ;if _bbb > 1{_ffef =(_agbb .Bottom -_agbb .Top -_fcd )/(_bbb -1);if _ffef < _fcd {_ffef =_fcd ;};};_gfb :=_agbb .Top ;_aea :=_agbb .Left ;_bde :=_aea +_fbd *2;for _ ,_cde :=range _baef {if _adee :=_cde ._gca ;_adee !=nil {_bgg .drawRectangleWithProps (_adee ,_aea ,_gfb +_gfg ,_fbd ,_fbd ,false );
_bfgc :=_bgg ._ddb .NewStyledParagraph ();_bfgc .SetPos (_bde ,_gfb );_bfgc .SetWidth (_agbb .Right -_agbb .Left );_cge :=_bfgc .Append (_cde ._gbed );_bedc ,_edbg :=_fb .NewStandard14Font (_fb .HelveticaName );if _edbg ==nil {_ecde :=_bgg ._ddb .NewTextStyle ();
_ecde .Font =_bedc ;_ecde .FontSize =_fcd ;_ecde .TextRise =0.4;_cge .Style =_ecde ;_bgg ._ddb .Draw (_bfgc );};};_gfb +=_ffef ;};};};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;
);func DrawLine (c *_db .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _db .Color ){if color ==nil {return ;};_gbabf :=c .NewLine (x0 ,y0 ,x1 ,y1 );_gbabf .SetLineWidth (width );_gbabf .SetColor (color );c .Draw (_gbabf );};func CropImageByRect (sourceImg _gb .Image ,rect _gb .Rectangle )_gb .Image {_bdedc ,_feced ,_ged ,_bdad :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;
_cffa :=_gb .NewNRGBA (_gb .Rect (0,0,_ged -_bdedc ,_bdad -_feced ));for _gdc :=_bdedc ;_gdc < _ged ;_gdc ++{for _dbff :=_feced ;_dbff < _bdad ;_dbff ++{_cffa .Set (_gdc -_bdedc ,_dbff -_feced ,sourceImg .At (_gdc ,_dbff ));};};return _cffa ;};var _age =_geab (1.5);
func _fad (_fccb *_efc .CT_CatAx )(uint32 ,_efc .ST_AxPos ,_efc .ST_TickMark ,_efc .ST_TickLblPos ,*_efc .CT_ChartLines ,uint32 ,*_ad .CT_ShapeProperties ,error ){var _gbab ,_bbfa uint32 ;var _afce _efc .ST_AxPos ;var _bcde _efc .ST_TickMark ;var _beed *_efc .CT_ChartLines ;
var _ddd _efc .ST_TickLblPos ;if _fccb .AxId ==nil {return _gbab ,_afce ,_bcde ,_ddd ,_beed ,_bbfa ,_fccb .SpPr ,_ec .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_gbab =_fccb .AxId .ValAttr ;};if _fccb .AxPos ==nil {return _gbab ,_afce ,_bcde ,_ddd ,_beed ,_bbfa ,_fccb .SpPr ,_ec .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");
}else {_afce =_fccb .AxPos .ValAttr ;};if _fccb .MajorTickMark !=nil {_bcde =_fccb .MajorTickMark .ValAttr ;};if _fccb .TickLblPos !=nil {_ddd =_fccb .TickLblPos .ValAttr ;};if _fccb .CrossAx ==nil {return _gbab ,_afce ,_bcde ,_ddd ,_beed ,_bbfa ,_fccb .SpPr ,_ec .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_bbfa =_fccb .CrossAx .ValAttr ;};_beed =_fccb .MajorGridlines ;return _gbab ,_afce ,_bcde ,_ddd ,_beed ,_bbfa ,_fccb .SpPr ,nil ;};func RegisterFont (name string ,style FontStyle ,font *_fb .PdfFont ){_dafe ._dbc .Lock ();if _dafe ._cfb [name ]==nil {_dafe ._cfb [name ]=map[FontStyle ]*_fb .PdfFont {};
};_dafe ._cfb [name ][style ]=font ;_dafe ._dbc .Unlock ();};func (_gdffd FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_gdffd )];
};func AdjustColorByTint (colorStr string ,tint float64 )string {var _bagf ,_fddf ,_gee uint8 ;_adfc ,_ :=_e .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_bagf ,&_fddf ,&_gee );if _adfc !=3{return "";};return _dfe (_bagf ,tint )+_dfe (_fddf ,tint )+_dfe (_gee ,tint );
};func _fff (_beec _ad .ST_SchemeColorVal ,_begf *_ad .Theme )string {if _gcef :=_begf .ThemeElements ;_gcef !=nil {if _begc :=_gcef .ClrScheme ;_begc !=nil {switch _beec {case _ad .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_begc .Lt1 );
case _ad .ST_SchemeColorValDk1 ,_ad .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_begc .Dk1 );case _ad .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_begc .Lt2 );case _ad .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_begc .Dk2 );
case _ad .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_begc .Accent1 );case _ad .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_begc .Accent2 );case _ad .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_begc .Accent3 );
case _ad .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_begc .Accent4 );case _ad .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_begc .Accent5 );case _ad .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_begc .Accent6 );
};};};return "";};func (_daf *creatorContext )addCatName (_aeb string ,_fea map[string ]serCategory ,_aad *[]string ){if _ ,_bbd :=_fea [_aeb ];!_bbd {_fea [_aeb ]=serCategory {_fee :_aeb ,_cgcc :[]serValue {}};*_aad =append (*_aad ,_aeb );};};func _bgfe (_bgdc _ad .ST_SchemeColorVal ,_eaf *_ad .Theme )string {if _bea :=_eaf .ThemeElements ;
_bea !=nil {if _fggb :=_bea .ClrScheme ;_fggb !=nil {switch _bgdc {case _ad .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_fggb .Lt1 );case _ad .ST_SchemeColorValDk1 ,_ad .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_fggb .Dk1 );
case _ad .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_fggb .Lt2 );case _ad .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_fggb .Dk2 );case _ad .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_fggb .Accent1 );case _ad .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_fggb .Accent2 );
case _ad .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_fggb .Accent3 );case _ad .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_fggb .Accent4 );case _ad .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_fggb .Accent5 );
case _ad .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_fggb .Accent6 );};};};return "";};const (BorderPositionTop BorderPosition =0;BorderPositionLeft BorderPosition =1;BorderPositionBottom BorderPosition =2;BorderPositionRight BorderPosition =3;
);var _dfbdc =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };
func FromSTCoordinate (st _ad .ST_Coordinate )int64 {if _daef :=st .ST_CoordinateUnqualified ;_daef !=nil {return *_daef ;};return 0;};func AdjustColorByShade (colorStr string ,shade float64 )string {var _adgc ,_gfe ,_bfb uint8 ;_fgge ,_ :=_e .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_adgc ,&_gfe ,&_bfb );
if _fgge !=3{return "";};return _feae (_adgc ,shade )+_feae (_gfe ,shade )+_feae (_bfb ,shade );};var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};
func _dff (_ccf *_efc .CT_DateAx )(uint32 ,_efc .ST_AxPos ,_efc .ST_TickMark ,_efc .ST_TickLblPos ,*_efc .CT_ChartLines ,uint32 ,*_ad .CT_ShapeProperties ,error ){var _dfb ,_bace uint32 ;var _dfbg _efc .ST_AxPos ;var _cbgf _efc .ST_TickMark ;var _edec *_efc .CT_ChartLines ;
var _aaa _efc .ST_TickLblPos ;if _ccf .AxId ==nil {return _dfb ,_dfbg ,_cbgf ,_aaa ,_edec ,_bace ,_ccf .SpPr ,_ec .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_dfb =_ccf .AxId .ValAttr ;};if _ccf .AxPos ==nil {return _dfb ,_dfbg ,_cbgf ,_aaa ,_edec ,_bace ,_ccf .SpPr ,_ec .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");
}else {_dfbg =_ccf .AxPos .ValAttr ;};if _ccf .MajorTickMark !=nil {_cbgf =_ccf .MajorTickMark .ValAttr ;};if _ccf .TickLblPos !=nil {_aaa =_ccf .TickLblPos .ValAttr ;};if _ccf .CrossAx ==nil {return _dfb ,_dfbg ,_cbgf ,_aaa ,_edec ,_bace ,_ccf .SpPr ,_ec .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_bace =_ccf .CrossAx .ValAttr ;};_edec =_ccf .MajorGridlines ;return _dfb ,_dfbg ,_cbgf ,_aaa ,_edec ,_bace ,_ccf .SpPr ,nil ;};func (_eeaa *creatorContext )drawPieChart (_dcgg *_efc .CT_PieChart ,_ccdf *Rectangle ,_ceba *_ac .Workbook ,_ecdc float64 )([]*legendItem ,error ){_bcec :=[]*legendItem {};
_gddc :=map[string ]serCategory {};_cff :=[]string {};_bgb :=_a .Inf (1);_caef :=_a .Inf (-1);_baa :=_dcgg .Ser ;for _ ,_aca :=range _baa {var _fggc string ;if _bcac :=_aca .Tx ;_bcac !=nil {if _edeg :=_bcac .Choice ;_edeg !=nil {if _edeg .V !=nil {_fggc =*_edeg .V ;
}else if _bfff :=_edeg .StrRef ;_bfff !=nil {if _cbgg :=_bfff .StrCache ;_cbgg !=nil {for _ ,_faef :=range _cbgg .Pt {_fggc =_faef .V ;};};};};};if _cbef :=_aca .Cat ;_cbef !=nil {if _bgcd :=_cbef .Choice ;_bgcd !=nil {if _cdcd :=_bgcd .StrRef ;_cdcd !=nil {if _cba :=_cdcd .F ;
_cba !=""&&_ceba !=nil {_gffa ,_ebae ,_eec ,_fcdd :=ParseExcelRange (_cba );if _fcdd ==nil {for _ ,_bgea :=range _ceba .Sheets (){if _bgea .Name ()==_f .Trim (_gffa ,"\u0027"){_ggee :=_ebae .String ();for _bdeb :=_ebae .RowIdx ;_bdeb <=_eec .RowIdx ;_bdeb +=1{_dbe :=_f .ReplaceAll (_ggee ,_e .Sprint (_ebae .RowIdx ),_e .Sprint (_bdeb ));
_eeaa .addCatName (_bgea .Cell (_dbe ).GetString (),_gddc ,&_cff );};break ;};};};};if _affg :=_cdcd .StrCache ;_affg !=nil {for _ ,_fdbb :=range _affg .Pt {_eeaa .addCatName (_fdbb .V ,_gddc ,&_cff );};};}else if _dcbd :=_bgcd .NumRef ;_dcbd !=nil {if _ebff :=_dcbd .NumCache ;
_ebff !=nil {var _ecfc string ;if _ebff .FormatCode !=nil {_ecfc =*_ebff .FormatCode ;};for _ ,_geb :=range _ebff .Pt {var _bcgf string ;if _geb .FormatCodeAttr ==nil {_bcgf =_ecfc ;}else {_bcgf =*_geb .FormatCodeAttr ;};var _faa string ;_deac ,_dbbc :=_gab .ParseFloat (_geb .V ,64);
if _dbbc !=nil {_faa =_geb .V ;}else {_faa =_da .Number (_deac ,_bcgf );};_eeaa .addCatName (_faa ,_gddc ,&_cff );};};};};};if _abc :=_aca .Val ;_abc !=nil {if _ggbf :=_abc .Choice ;_ggbf !=nil {if _edbc :=_ggbf .NumRef ;_edbc !=nil {if _fcba :=_edbc .F ;
_fcba !=""&&_ceba !=nil {_dffg ,_degg ,_gdeg ,_gcce :=ParseExcelRange (_fcba );if _gcce ==nil {for _ ,_cagf :=range _ceba .Sheets (){if _cagf .Name ()==_f .Trim (_dffg ,"\u0027"){_dfa :=_degg .String ();for _gaa :=_degg .RowIdx ;_gaa <=_gdeg .RowIdx ;_gaa +=1{_befd :=_f .ReplaceAll (_dfa ,_e .Sprint (_degg .RowIdx ),_e .Sprint (_gaa ));
if _cagf .FormulaContext ().HasFormula (_befd ){_deaf :=_ge .NewEvaluator ();_fga :=_cagf .FormulaContext ().Cell (_befd ,_deaf );_cbece :=_fga .Value ();_eeaa .addCatValue (_cbece ,_gddc ,_cff ,(int )(_gaa -_degg .RowIdx ),&_bgb ,&_caef ,_fggc ,_aca .SpPr );
}else {_agg :=_cagf .Cell (_befd ).GetString ();_eeaa .addCatValue (_agg ,_gddc ,_cff ,(int )(_gaa -_degg .RowIdx ),&_bgb ,&_caef ,_fggc ,_aca .SpPr );};};break ;};};};};if _ffdf :=_edbc .NumCache ;_ffdf !=nil {for _baad ,_ffcb :=range _ffdf .Pt {_eeaa .addCatValue (_ffcb .V ,_gddc ,_cff ,_baad ,&_bgb ,&_caef ,_fggc ,_aca .SpPr );
};};};};};};_bafd :=&_d .PieChart {Values :[]_ece .Value {}};for _ ,_gdfd :=range _cff {_dafg :=_gddc [_gdfd ];if len (_dafg ._cgcc )> 0{_bafd .Values =append (_bafd .Values ,_ece .Value {Value :_dafg ._cgcc [0]._ggb ,Label :_gdfd ,Style :_cg .Style {FontSize :12*_ecdc }});
};};_bafd .SetHeight (int (_ccdf .Top -_ccdf .Bottom ));_bafd .SetWidth (int (_ccdf .Right -_ccdf .Left ));_acae :=_eeaa ._ddb ;_bafa :=_db .NewChart (_bafd );_bafa .SetPos (_ccdf .Left ,_ccdf .Top );_agag :=_acae .Draw (_bafa );if _agag !=nil {return nil ,_agag ;
};return _bcec ,nil ;};func _feae (_ggf uint8 ,_facd float64 )string {_cgb :=float64 (_ggf );return _e .Sprintf ("\u0025\u0030\u0032\u0078",int (_cgb *_facd ));};func GetRegisteredFont (name string ,style FontStyle )*_fb .PdfFont {_dafe ._dbc .Lock ();
defer _dafe ._dbc .Unlock ();if _gfba ,_gcc :=_dafe ._cfb [name ];_gcc {if _adb ,_gbfa :=_gfba [style ];_gbfa {return _adb ;};};return nil ;};func (_fef *creatorContext )drawRectangleWithProps (_acbb *_ad .CT_ShapeProperties ,_afae ,_fcbg ,_bggg ,_deggf float64 ,_adaa bool ){_edaf :=_fef ._ddb .NewRectangle (_afae ,_fcbg ,_bggg ,_deggf );
if _acbb ==nil {if _adaa {_edaf .SetBorderWidth (_gcg );}else {return ;};}else {_adda :=_fef .getPdfColorFromSolidFill (_acbb .SolidFill );if _adda !=nil {_edaf .SetFillColor (_adda );};if _dgfd :=_acbb .Ln ;_dgfd !=nil {if _egab :=_dgfd .WAttr ;_egab !=nil {_efe :=_ed .FromEMU (int64 (*_egab ));
_edaf .SetBorderWidth (_efe );if _cga :=_dgfd .SolidFill ;_cga !=nil {_abge :=_fef .getPdfColorFromSolidFill (_cga );if _abge !=nil {_edaf .SetBorderColor (_abge );};};}else {_edaf .SetBorderWidth (0);};};};_fef ._ddb .Draw (_edaf );};var RtlFontFile *_fb .PdfFont ;
func _adg (_aaac *_efc .CT_ValAx )(uint32 ,_efc .ST_AxPos ,_efc .ST_TickMark ,_efc .ST_TickLblPos ,*_efc .CT_ChartLines ,uint32 ,*_ad .CT_ShapeProperties ,error ){var _efcd ,_fgg uint32 ;var _bfae _efc .ST_AxPos ;var _ffd _efc .ST_TickMark ;var _aabb *_efc .CT_ChartLines ;
var _dcgc _efc .ST_TickLblPos ;if _aaac .AxId ==nil {return _efcd ,_bfae ,_ffd ,_dcgc ,_aabb ,_fgg ,_aaac .SpPr ,_ec .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_efcd =_aaac .AxId .ValAttr ;};if _aaac .AxPos ==nil {return _efcd ,_bfae ,_ffd ,_dcgc ,_aabb ,_fgg ,_aaac .SpPr ,_ec .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");
}else {_bfae =_aaac .AxPos .ValAttr ;};if _aaac .MajorTickMark !=nil {_ffd =_aaac .MajorTickMark .ValAttr ;};if _aaac .TickLblPos !=nil {_dcgc =_aaac .TickLblPos .ValAttr ;};if _aaac .CrossAx ==nil {return _efcd ,_bfae ,_ffd ,_dcgc ,_aabb ,_fgg ,_aaac .SpPr ,_ec .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_fgg =_aaac .CrossAx .ValAttr ;};_aabb =_aaac .MajorGridlines ;return _efcd ,_bfae ,_ffd ,_dcgc ,_aabb ,_fgg ,_aaac .SpPr ,nil ;};func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _accf ,_adc ,_eceg uint8 ;_fbdg ,_ :=_e .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_accf ,&_adc ,&_eceg );
if _fbdg !=3{return "";};_eagf ,_bdee ,_dgdc :=_faeef (_accf ,_adc ,_eceg );_dgdc =lum *_dgdc ;_accf ,_adc ,_eceg =_cag (_eagf ,_bdee ,_dgdc );return _e .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_accf ,_adc ,_eceg );
};func FromSTCoordinate32 (st _ad .ST_Coordinate32 )int64 {if _cgag :=st .ST_Coordinate32Unqualified ;_cgag !=nil {return int64 (*_cgag );};return 0;};func Lighten (clr float64 )float64 {return 0.6+0.4*clr };func GetColorStringFromDmlColor (dmlColor *_ad .CT_Color )string {var _eaa string ;
if _agbg :=dmlColor .SrgbClr ;_agbg !=nil {_eaa =_agbg .ValAttr ;}else if _ccc :=dmlColor .SysClr ;_ccc !=nil {if _ccc .LastClrAttr !=nil {return *_ccc .LastClrAttr ;};return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _eaa ;};type ImgPart byte ;type serValue struct{_bcd string ;
_ggb float64 ;_fdd *_ad .CT_ShapeProperties ;};func FillRectangle (c *_db .Creator ,x ,y ,width ,height float64 ,color _db .Color ){if color ==nil {return ;};_fbge :=c .NewRectangle (x ,y ,width ,height );_fbge .SetFillColor (color );_fbge .SetBorderWidth (0);
c .Draw (_fbge );};func IsNoSpaceLanguage (symbol string )bool {for _ ,_dgdg :=range symbol {if _ba .Is (_ba .Han ,_dgdg ){return true ;};};return false ;};func ClearRegisteredFonts (){_dafe ._dbc .Lock ();_dafe ._cfb =map[string ]map[FontStyle ]*_fb .PdfFont {};
_dafe ._dbc .Unlock ();};type creatorContext struct{_ddb *_db .Creator ;_afe *_ad .Theme ;_bggb float64 ;};func AssignStdFontByName (style _db .TextStyle ,fontName string )*_fb .PdfFont {_eac :=_fb .StdFontName (fontName );return _fb .NewStandard14FontMustCompile (_eac );
};func _ce (_dbge *_efc .ChartSpace ,_gcga ,_abeb float64 ,_bdc *_ad .Theme ,_agd bool ,_fcf *_ac .Workbook )(*_db .Creator ,error ){_dcf :=1.0;if _agd {_dcf =8.0;};_adeg :=&Rectangle {};_cddf :=&Rectangle {Top :_adeg .Top ,Bottom :_abeb -_adeg .Bottom ,Left :_adeg .Left ,Right :_gcga -_adeg .Right };
_ccac :=MakeTempCreator (_gcga *_dcf +1,_abeb *_dcf +1);_beg :=&creatorContext {_ddb :_ccac ,_afe :_bdc ,_bggb :_dcf };var _dde bool ;if _baee :=_dbge .Chart ;_baee !=nil {_befb :=_baee .PlotArea ;if _befb ==nil {return nil ,_ec .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");
};_egc :=0.0;if _baee .AutoTitleDeleted !=nil &&_baee .AutoTitleDeleted .ValAttr !=nil &&!*_baee .AutoTitleDeleted .ValAttr {_gdff :="C\u0068\u0061\u0072\u0074\u0020\u0054\u0069\u0074\u006c\u0065";if _baee .Title !=nil &&_baee .Title .Overlay !=nil &&_baee .Title .Overlay .ValAttr !=nil &&!*_baee .Title .Overlay .ValAttr {_egc =_geab (10);
};if _baee .Title !=nil &&_baee .Title .Tx !=nil &&_baee .Title .Tx .Choice !=nil &&_baee .Title .Tx .Choice .Rich !=nil {if len (_baee .Title .Tx .Choice .Rich .P )> 0{if len (_baee .Title .Tx .Choice .Rich .P [0].EG_TextRun )> 0{_gdff =_baee .Title .Tx .Choice .Rich .P [0].EG_TextRun [0].R .T ;
};};};_beg .drawTitle (_gdff ,_cddf .Left +_cddf .Right /2,_geab (5));};_eag :=&Rectangle {Top :_geab (10)+_egc ,Bottom :_cddf .Bottom -_geab (15),Left :_geab (10),Right :_cddf .Right -_geab (10)};var _gcf *Rectangle ;_cgde :=_baee .Legend ;if _cgde !=nil {_cdfg :=_cgde .Overlay !=nil &&_cgde .Overlay .ValAttr !=nil &&*_cgde .Overlay .ValAttr ;
if _gfaa :=_cgde .LegendPos ;_gfaa !=nil {switch _gfaa .ValAttr {case _efc .ST_LegendPosTr :if !_cdfg {_eag =&Rectangle {Top :_geab (25)+_egc ,Bottom :_cddf .Bottom -_geab (10),Left :_geab (10),Right :_cddf .Right -_geab (25)};};_gcf =&Rectangle {Top :_geab (2.5)+_egc ,Bottom :_geab (22.5),Left :_cddf .Right -_geab (22.5),Right :_cddf .Right -_geab (2.5)};
case _efc .ST_LegendPosT :_gcf =&Rectangle {Top :_geab (2.5)+_egc ,Bottom :_geab (7.5),Left :(_cddf .Right -_cddf .Left )*0.25,Right :(_cddf .Right -_cddf .Left )*0.75};if !_cdfg {_eag =&Rectangle {Top :_geab (12.5)+_egc ,Bottom :_cddf .Bottom -_geab (15),Left :_geab (10),Right :_cddf .Right -_geab (5)};
};_dde =true ;case _efc .ST_LegendPosB :_gcf =&Rectangle {Top :_cddf .Bottom -_geab (7.5)+_egc ,Bottom :_cddf .Bottom -_geab (2.5),Left :(_cddf .Right -_cddf .Left )*0.25,Right :(_cddf .Right -_cddf .Left )*0.75};if !_cdfg {_eag =&Rectangle {Top :_geab (5)+_egc ,Bottom :_cddf .Bottom -_geab (15),Left :_geab (10),Right :_cddf .Right -_geab (5)};
};_dde =true ;case _efc .ST_LegendPosR :_gcf =&Rectangle {Top :(_cddf .Bottom -_cddf .Top )/2-_geab (10)+_egc ,Bottom :(_cddf .Bottom -_cddf .Top )/2+_geab (10),Left :_cddf .Right -_geab (22.5),Right :_cddf .Right -_geab (2.5)};if !_cdfg {_eag =&Rectangle {Top :_geab (5)+_egc ,Bottom :_cddf .Bottom -_geab (12.5),Left :_geab (10),Right :_cddf .Right -_geab (25)};
};case _efc .ST_LegendPosL :_gcf =&Rectangle {Top :(_cddf .Bottom -_cddf .Top )/2-_geab (10)+_egc ,Bottom :(_cddf .Bottom -_cddf .Top )/2+_geab (10),Left :_geab (2.5),Right :_geab (22.5)};if !_cdfg {_eag =&Rectangle {Top :_geab (5)+_egc ,Bottom :_cddf .Bottom -_geab (12.5),Left :_geab (30),Right :_cddf .Right -_geab (5)};
};default:_gcf =&Rectangle {Top :(_cddf .Bottom -_cddf .Top )/2-_geab (10)+_egc ,Bottom :(_cddf .Bottom -_cddf .Top )/2+_geab (10),Left :_cddf .Right -_geab (25),Right :_cddf .Right -_geab (5)};if !_cdfg {_eag =&Rectangle {Top :_geab (5)+_egc ,Bottom :_cddf .Bottom -_geab (12.5),Left :_geab (100),Right :_cddf .Right -_geab (25)};
};};};};_eag .scale (_dcf );_beg .drawBorderWithProps (_befb .SpPr ,_eag ,_gcg );_fdb :=[]*legendItem {};var _eae error ;_ecdf :=_befb .CChoice ;for _ ,_feag :=range _befb .Choice {if _gcfc :=_feag .BarChart ;_gcfc !=nil {_fdb ,_eae =_beg .drawBarChart (_gcfc ,_eag ,_ecdf ,_fcf );
if _eae !=nil {return nil ,_eae ;};};if _afa :=_feag .PieChart ;_afa !=nil {_fdb ,_eae =_beg .drawPieChart (_afa ,_eag ,_fcf ,_dcf );if _eae !=nil {return nil ,_eae ;};};};if _cgde !=nil {_gcf .scale (_dcf );_beg .drawBorderWithProps (_cgde .SpPr ,_gcf ,_gcg );
if len (_fdb )!=0{_beg .drawLegend (_gcf ,_fdb ,_dde );};};};_cddf .scale (_dcf );_beg .drawBorderWithProps (_dbge .SpPr ,_cddf ,_gcg );return _ccac ,nil ;};type serCategory struct{_fee string ;_cgcc []serValue ;};func (_abbf *creatorContext )getPdfColorFromSolidFill (_ecae *_ad .CT_SolidColorFillProperties )_db .Color {if _ecae ==nil {return nil ;
};_fegb :="";if _deaeg :=_ecae .SrgbClr ;_deaeg !=nil {_fegb =_deaeg .ValAttr ;}else if _dfec :=_ecae .SchemeClr ;_dfec !=nil {_fegb =_fff (_dfec .ValAttr ,_abbf ._afe );};if _fegb ==""{return nil ;};return _db .ColorRGBFromHex ("\u0023"+_fegb );};func _dfe (_acbf uint8 ,_eaaa float64 )string {_cfa :=float64 (_acbf );
var _bec float64 ;if _eaaa < 0{_bec =_cfa *(1+_eaaa );}else {_bec =_cfa +(255-_cfa )*_eaaa ;};return _e .Sprintf ("\u0025\u0030\u0032\u0078",int (_bec ));};func _cbec (_gcfa string )error {if !_f .HasSuffix (_gcfa ,"\u002e\u0074\u0074\u0066"){_ab .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return _e .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_bca ,_fbg :=_baf .ParseFile (_gcfa );if _fbg !=nil {_ab .Log .Debug ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020T\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_fbg );return _fbg ;};_affb ,_fbg :=_fb .NewCompositePdfFontFromTTFFile (_gcfa );
if _fbg !=nil {return _fbg ;};_gda :=_bca .GetNameRecords ();for _ ,_gbdag :=range _gda {_ddabf :=_gbdag [1];if _ddabf ==""{continue ;};_ffcf :=make ([]byte ,0);for _ecea :=0;_ecea < len (_ddabf );_ecea ++{if _ddabf [_ecea ]==39||_ddabf [_ecea ]==92{continue ;
};_cdbd :=4;if _ecea +_cdbd < len (_ddabf ){if _ddabf [_ecea :_ecea +_cdbd ]=="\u0000"{_ecea =_ecea +_cdbd +1;continue ;};};_ffcf =append (_ffcf ,_ddabf [_ecea ]);};_ddabf =_f .Replace (string (_ffcf ),"\u0078\u0030\u0030","",-1);_cgea :=_gbdag [2];if _cgea ==""{return _e .Errorf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_gcfa );
};_ffcf =make ([]byte ,0);for _addg :=0;_addg < len (_cgea );_addg ++{if _cgea [_addg ]==39||_cgea [_addg ]==92{continue ;};_dafa :=4;if _addg +_dafa < len (_cgea ){if _cgea [_addg :_addg +_dafa ]=="\u0000"{_addg =_addg +_dafa +1;continue ;};};_ffcf =append (_ffcf ,_cgea [_addg ]);
};_cgea =_f .Replace (string (_ffcf ),"\u0078\u0030\u0030","",-1);RegisterFont (_ddabf ,_dfbdc [_cgea ],_affb );};return nil ;};var _dge =_geab (7.5);func (_gf *creatorContext )drawBarChart (_ace *_efc .CT_BarChart ,_edf *Rectangle ,_bc *_efc .CT_PlotAreaChoice1 ,_bcg *_ac .Workbook )([]*legendItem ,error ){var _dd bool ;
if _ca :=_ace .BarDir ;_ca !=nil {_dd =_ca .ValAttr ==_efc .ST_BarDirBar ;};_ddg :=_ace .Ser ;_bf .Sort (barSerByOrder (_ddg ));_fd :=map[string ]serCategory {};_bce :=[]string {};_dg :=[]*legendItem {};_dab :=_a .Inf (1);_bfa :=_a .Inf (-1);for _ ,_bae :=range _ddg {var _gad string ;
if _be :=_bae .Tx ;_be !=nil {if _gfa :=_be .Choice ;_gfa !=nil {if _gfa .V !=nil {_gad =*_gfa .V ;}else if _abb :=_gfa .StrRef ;_abb !=nil {if _af :=_abb .StrCache ;_af !=nil {for _ ,_cd :=range _af .Pt {_gad =_cd .V ;};};};};};if _bbg :=_bae .Cat ;_bbg !=nil {if _ee :=_bbg .Choice ;
_ee !=nil {if _bg :=_ee .StrRef ;_bg !=nil {if _ag :=_bg .F ;_ag !=""&&_bcg !=nil {_acd ,_bfe ,_bac ,_cf :=ParseExcelRange (_ag );if _cf ==nil {for _ ,_acc :=range _bcg .Sheets (){if _acc .Name ()==_f .Trim (_acd ,"\u0027"){_ff :=_bfe .String ();for _ffe :=_bfe .RowIdx ;
_ffe <=_bac .RowIdx ;_ffe +=1{_fc :=_f .ReplaceAll (_ff ,_e .Sprint (_bfe .RowIdx ),_e .Sprint (_ffe ));_gf .addCatName (_acc .Cell (_fc ).GetString (),_fd ,&_bce );};break ;};};};};if _bag :=_bg .StrCache ;_bag !=nil {for _ ,_dae :=range _bag .Pt {_gf .addCatName (_dae .V ,_fd ,&_bce );
};};}else if _fdg :=_ee .NumRef ;_fdg !=nil {if _fe :=_fdg .NumCache ;_fe !=nil {var _gac string ;if _fe .FormatCode !=nil {_gac =*_fe .FormatCode ;};for _ ,_bbge :=range _fe .Pt {var _gadc string ;if _bbge .FormatCodeAttr ==nil {_gadc =_gac ;}else {_gadc =*_bbge .FormatCodeAttr ;
};var _cca string ;_feg ,_fa :=_gab .ParseFloat (_bbge .V ,64);if _fa !=nil {_cca =_bbge .V ;}else {_cca =_da .Number (_feg ,_gadc );};_gf .addCatName (_cca ,_fd ,&_bce );};};};};};if _gg :=_bae .Val ;_gg !=nil {if _gbc :=_gg .Choice ;_gbc !=nil {if _dbg :=_gbc .NumRef ;
_dbg !=nil {if _dbgf :=_dbg .F ;_dbgf !=""&&_bcg !=nil {_bfaa ,_gea ,_gc ,_add :=ParseExcelRange (_dbgf );if _add ==nil {for _ ,_ade :=range _bcg .Sheets (){if _ade .Name ()==_f .Trim (_bfaa ,"\u0027"){_aa :=_gea .String ();for _cgd :=_gea .RowIdx ;_cgd <=_gc .RowIdx ;
_cgd +=1{_acb :=_f .ReplaceAll (_aa ,_e .Sprint (_gea .RowIdx ),_e .Sprint (_cgd ));if _ade .FormulaContext ().HasFormula (_acb ){_bcb :=_ge .NewEvaluator ();_ead :=_ade .FormulaContext ().Cell (_acb ,_bcb );_babf :=_ead .Value ();_gf .addCatValue (_babf ,_fd ,_bce ,(int )(_cgd -_gea .RowIdx ),&_dab ,&_bfa ,_gad ,_bae .SpPr );
}else {_ccb :=_ade .Cell (_acb ).GetString ();_gf .addCatValue (_ccb ,_fd ,_bce ,(int )(_cgd -_gea .RowIdx ),&_dab ,&_bfa ,_gad ,_bae .SpPr );};};break ;};};};};if _ffg :=_dbg .NumCache ;_ffg !=nil {for _cgc ,_gbg :=range _ffg .Pt {_gf .addCatValue (_gbg .V ,_fd ,_bce ,_cgc ,&_dab ,&_bfa ,_gad ,_bae .SpPr );
};};};};};_dg =append (_dg ,&legendItem {_gbed :_gad ,_gca :_bae .SpPr });};var _eadf float64 ;var _cb ,_bcgd float64 ;if _bfa ==0&&_dab ==0{_eadf =0.2;_bcgd =0;_cb =1;}else {var _de float64 ;if _fde :=_a .Abs (_dab );_bfa < _fde {_de =_fde ;}else {_de =_bfa ;
};_gd :=_a .Pow (10,_a .Floor (_a .Log10 (_de )));_gce :=_de /_gd ;if _gce < 4.29{_eadf =0.5;}else if _gce >=4.29&&_gce < 8.58{_eadf =1;}else {_eadf =2;};_eadf *=_gd ;if _bfa <=0{_cb =0;}else {_cb =(_a .Ceil (_bfa /_eadf )+1)*_eadf ;};if _dab >=0{_bcgd =0;
}else {_bcgd =(_a .Floor (_dab /_eadf )-1)*_eadf ;};};_bbc :=_gf .drawAxes (_bc ,_bcgd ,_cb ,_eadf ,_bce ,_edf ,_dd );if _bbc !=nil {return nil ,_bbc ;};_bfea :=0.0;if _ace .GapWidth !=nil {if _gdb :=_ace .GapWidth .ValAttr ;_gdb !=nil {if _dgd :=_gdb .ST_GapAmountUShort ;
_dgd !=nil {_bfea =float64 (*_dgd )/100.0;};};};_caa :=_edf .Right -_edf .Left ;_gbcd :=_edf .Bottom -_edf .Top ;_edfe :=float64 (len (_bce ));if _dd {_gga :=_cb /(_cb -_bcgd )*_caa ;_ecd :=-_bcgd /(_cb -_bcgd )*_caa ;_bba :=_edf .Left +_ecd ;_agb :=_gbcd /_edfe ;
for _ede ,_gag :=range _bce {_cbe :=_fd [_gag ];_bcf :=float64 (len (_cbe ._cgcc ))+_bfea ;_cdb :=_agb /_bcf ;_aaf :=_cdb *_bfea ;_ecg :=_edf .Bottom -float64 (_ede )*_agb -_aaf /2-_cdb ;for _ ,_cdd :=range _cbe ._cgcc {if _cdd ._ggb ==0{continue ;};var _eb ,_aef float64 ;
if _cdd ._ggb > 0{_aef =_cdd ._ggb /_cb *_gga ;_gf .drawRectangleWithProps (_cdd ._fdd ,_bba ,_ecg ,_aef ,_cdb ,false );}else {_aef =_cdd ._ggb /_bcgd *_ecd ;_eb =_bba -_aef ;_gf .drawRectangleWithProps (_cdd ._fdd ,_eb ,_ecg ,_aef ,_cdb ,false );};_ecg -=_cdb ;
};};}else {_gde :=_cb /(_cb -_bcgd )*_gbcd ;_dcc :=-_bcgd /(_cb -_bcgd )*_gbcd ;_dce :=_edf .Top +_gde ;_bef :=_caa /_edfe ;for _fg ,_bbf :=range _bce {_fec :=_fd [_bbf ];_fcc :=float64 (len (_fec ._cgcc ))+_bfea ;_bd :=_bef /_fcc ;_cdf :=_bd *_bfea ;_bafe :=_edf .Left +float64 (_fg )*_bef +_cdf /2;
for _ ,_cgf :=range _fec ._cgcc {var _gff ,_aefg float64 ;if _cgf ._ggb > 0{_aefg =_cgf ._ggb /_cb *_gde ;_gff =_dce -_aefg ;_gf .drawRectangleWithProps (_cgf ._fdd ,_bafe ,_gff ,_bd ,_aefg ,false );}else {_aefg =_cgf ._ggb /_bcgd *_dcc ;_gf .drawRectangleWithProps (_cgf ._fdd ,_bafe ,_dce ,_bd ,_aefg ,false );
};_bafe +=_bd ;};};};return _dg ,nil ;};var _cac =_geab (5);var _fecb =_geab (2);func _aaacg (_becb ,_cacc ,_fcdfe float64 )float64 {if _becb *6< 1{return _fcdfe +(_cacc -_fcdfe )*6*_becb ;}else if _becb *2< 1{return _cacc ;}else if _becb *3< 2{return _fcdfe +(_cacc -_fcdfe )*(2.0/3.0-_becb )*6;
}else {return _fcdfe ;};};func _geab (_eage float64 )float64 {return _eage *_ed .Millimeter };type legendItem struct{_gbed string ;_gca *_ad .CT_ShapeProperties ;};func (_ddgg barSerByOrder )Less (i ,j int )bool {return _ddgg [i ].Order .ValAttr < _ddgg [j ].Order .ValAttr ;
};type BorderPosition byte ;func RegisterFontsFromFiles (files []string )error {for _ ,_dbf :=range files {if _f .HasSuffix (_dbf ,"\u002e\u0074\u0074\u0066"){_bbde :=_cbec (_dbf );if _bbde !=nil {_ab .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_bbde );
continue ;};};};return nil ;};func (_fca *Rectangle )Translate (x ,y float64 ){_fca .Left +=x ;_fca .Right +=x ;_fca .Top +=y ;_fca .Bottom +=y ;};func _gbda (_eee float64 )float64 {if _eee < 0{_eee +=float64 (-int (_eee )+1);}else if _eee > 1{_eee -=float64 (int (_eee ));
};return _eee ;};func MakeBlockFromChartSpace (cs *_efc .ChartSpace ,width ,height float64 ,theme *_ad .Theme )(*_db .Block ,error ){_dda ,_dbga :=_ce (cs ,width ,height ,theme ,false ,nil );if _dbga !=nil {return nil ,_dbga ;};_gbf ,_dbga :=GetPageFromCreator (_dda );
if _dbga !=nil {return nil ,_dbga ;};_eg ,_dbga :=_db .NewBlockFromPage (_gbf );if _dbga !=nil {return nil ,_dbga ;};return _eg ,nil ;};func (_gbe *creatorContext )addCatValue (_acdb string ,_deb map[string ]serCategory ,_bfg []string ,_abe int ,_fae ,_eeb *float64 ,_ebe string ,_caag *_ad .CT_ShapeProperties ){_fece ,_aebb :=_gab .ParseFloat (_acdb ,64);
if _aebb !=nil {_fece =0;_ab .Log .Debug ("\u0070a\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_aebb );};if _fece > *_eeb {*_eeb =_fece ;};if _fece < *_fae {*_fae =_fece ;};_abeg :=_deb [_bfg [_abe ]];_abeg ._cgcc =append (_abeg ._cgcc ,serValue {_bcd :_ebe ,_ggb :_fece ,_fdd :_caag });
_deb [_bfg [_abe ]]=_abeg ;};var (DefaultFontSize =12.0;DefaultImageEncoder _dc .StreamEncoder ;);func MakeImageFromChartSpace (cs *_efc .ChartSpace ,width ,height float64 ,theme *_ad .Theme ,workbook *_ac .Workbook )(_gb .Image ,error ){_bga ,_edd :=_ce (cs ,width ,height ,theme ,true ,workbook );
if _edd !=nil {return nil ,_edd ;};_gfd ,_edd :=GetPageFromCreator (_bga );if _edd !=nil {return nil ,_edd ;};return _ef .NewImageDevice ().Render (_gfd );};func _ebc (_aga *_bab .Document ,_gcfcf ,_aff ,_bccg string )error {_gbaa ,_fcb :=_aga .GetFontBytesByRelId (_aff );
if _fcb !=nil {return _fcb ;};_abega ,_fcb :=_addb (_bccg );if _fcb !=nil {return _fcb ;};for _gdfe :=0;_gdfe < 32;_gdfe ++{_becg :=_gdfe %len (_abega );_gbaa [_gdfe ]=_gbaa [_gdfe ]^_abega [_becg ];};_dec :=_aga .TmpPath +"\u002f"+_gcfcf +"\u002e\u0074\u0074\u0066";
_fcb =_bb .WriteFile (_dec ,_gbaa ,0644);if _fcb !=nil {return _fcb ;};_cbec (_dec );return nil ;};func (_bgde *creatorContext )drawLineWithProps (_faab *_ad .CT_ShapeProperties ,_cddff ,_ecb ,_cbaf ,_fcbb float64 ,_befdf bool ){if _faab !=nil {if _cea :=_faab .Ln ;
_cea !=nil {_dadf :=_bgde .getPdfColorFromSolidFill (_cea .SolidFill );if _dadf ==nil &&_befdf {_dadf =_db .ColorBlack ;};if _dadf !=nil {var _eeac float64 ;if _aced :=_cea .WAttr ;_aced !=nil {_eeac =_ed .FromEMU (int64 (*_aced ));}else {_eeac =_gcg ;
};DrawLine (_bgde ._ddb ,_cddff ,_ecb ,_cbaf ,_fcbb ,_eeac ,_dadf );};};};};func GetDataFromXfrm (xfrm *_ad .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _bcdg ,_aeda ,_gaed ,_gbba float64 ;if _ffgb :=xfrm .Off ;_ffgb !=nil {_bcdg =_ed .FromEMU (FromSTCoordinate (_ffgb .XAttr ));
_aeda =_ed .FromEMU (FromSTCoordinate (_ffgb .YAttr ));};if _ebde :=xfrm .Ext ;_ebde !=nil {_gaed =_ed .FromEMU (_ebde .CxAttr );_gbba =_ed .FromEMU (_ebde .CyAttr );};return _bcdg ,_aeda ,_gaed ,_gbba ;};func MakeBlockFromCreator (c *_db .Creator )(*_db .Block ,error ){_adbb ,_eagb :=GetPageFromCreator (c );
if _eagb !=nil {return nil ,_eagb ;};_caccg ,_eagb :=_db .NewBlockFromPage (_adbb );if _eagb !=nil {return nil ,_eagb ;};return _caccg ,nil ;};type Rectangle struct{Top float64 ;Bottom float64 ;Left float64 ;Right float64 ;};func DrawRectangle (c *_db .Creator ,r *Rectangle ,w float64 ,color _db .Color ){if color ==nil {return ;
};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};
func ParseExcelRange (s string )(string ,_dbb .CellReference ,_dbb .CellReference ,error ){_cfab :=_f .FieldsFunc (s ,func (_dgbd rune )bool {return _dgbd ==':'||_dgbd =='!'});if len (_cfab )==3{_dcfa ,_fbf :=_dbb .ParseCellReference (_cfab [1]);if _fbf !=nil {return "",_dbb .CellReference {},_dbb .CellReference {},_fbf ;
};_fdef ,_fbf :=_dbb .ParseCellReference (_cfab [2]);if _fbf !=nil {return "",_dbb .CellReference {},_dbb .CellReference {},_fbf ;};return _cfab [0],_dcfa ,_fdef ,nil ;};return "",_dbb .CellReference {},_dbb .CellReference {},_ec .New ("\u0065r\u0072\u006f\u0072\u0020p\u0061\u0072\u0073\u0069\u006eg\u0020e\u0078c\u0065\u006c\u0020\u0072\u0061\u006e\u0067e");
};func RegisterEmbeddedFonts (d *_bab .Document )error {_abda :=d .FontTable ();if _abda ==nil {return nil ;};for _ ,_ddece :=range _abda .Font {if _ddece .EmbedRegular !=nil {return _ebc (d ,_ddece .NameAttr ,_ddece .EmbedRegular .IdAttr ,_ddece .EmbedRegular .FontKeyAttr );
};if _ddece .EmbedBold !=nil {return _ebc (d ,_ddece .NameAttr ,_ddece .EmbedBold .IdAttr ,_ddece .EmbedBold .FontKeyAttr );};if _ddece .EmbedItalic !=nil {return _ebc (d ,_ddece .NameAttr ,_ddece .EmbedItalic .IdAttr ,_ddece .EmbedItalic .FontKeyAttr );
};if _ddece .EmbedBoldItalic !=nil {return _ebc (d ,_ddece .NameAttr ,_ddece .EmbedBoldItalic .IdAttr ,_ddece .EmbedBoldItalic .FontKeyAttr );};};return nil ;};func MakeTempCreator (width ,height float64 )*_db .Creator {_dga :=_db .New ();_dga .SetPageSize (_db .PageSize {width ,height });
_dga .SetPageMargins (0,0,0,0);return _dga ;};const (ImgPart_whole ImgPart =0;ImgPart_t ImgPart =1;ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;ImgPart_rt ImgPart =6;ImgPart_lb ImgPart =7;ImgPart_rb ImgPart =8;);
func (_adf *creatorContext )drawAxes (_gffd *_efc .CT_PlotAreaChoice1 ,_fegd ,_bdg ,_fgd float64 ,_bcc []string ,_aeaa *Rectangle ,_caee bool )error {_bcda :=_adf ._ddb ;_adeec :=_adf ._bggb ;if _gffd ==nil {return _ec .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");
};if len (_gffd .ValAx )==0||(len (_gffd .CatAx )==0&&len (_gffd .DateAx )==0&&len (_gffd .SerAx )==0){return _ec .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");};var _agbbb ,_dgfc ,_beb ,_bdgg uint32 ;var _fgb ,_ada _efc .ST_AxPos ;
var _cad ,_dea _efc .ST_TickMark ;var _gbb ,_deg *_efc .CT_ChartLines ;var _gbd ,_eada _efc .ST_TickLblPos ;var _agbbf ,_accb *_ad .CT_ShapeProperties ;var _bbdf error ;_dgc :=_aeaa .Right -_aeaa .Left ;_eca :=_aeaa .Bottom -_aeaa .Top ;if len (_gffd .ValAx )> 0{_dgfc ,_ada ,_dea ,_eada ,_deg ,_bdgg ,_accb ,_bbdf =_adg (_gffd .ValAx [0]);
};if _ada !=_efc .ST_AxPosL &&_ada !=_efc .ST_AxPosB {return _ec .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};_gae :=_bdg -_fegd ;_cdc :=int (_gae /_fgd )+1;var _eadad ,_ecf float64 ;switch _dea {case _efc .ST_TickMarkIn :_eadad ,_ecf =_dcfg ,0;case _efc .ST_TickMarkOut :_eadad ,_ecf =0,_dcfg ;case _efc .ST_TickMarkCross :_eadad ,_ecf =_dcfg ,_dcfg ;};_eadad =_eadad *_adeec ;
_ecf =_ecf *_adeec ;var _dad *_ad .CT_ShapeProperties ;if _deg !=nil {_dad =_deg .SpPr ;};_ecc ,_fccg :=_gbd !=_efc .ST_TickLblPosNone ,_eada !=_efc .ST_TickLblPosNone ;_edef :=_fegd ;if len (_gffd .CatAx )> 0{_agbbb ,_fgb ,_cad ,_gbd ,_gbb ,_beb ,_agbbf ,_bbdf =_fad (_gffd .CatAx [0]);
}else if len (_gffd .DateAx )> 0{_agbbb ,_fgb ,_cad ,_gbd ,_gbb ,_beb ,_agbbf ,_bbdf =_dff (_gffd .DateAx [0]);}else if len (_gffd .SerAx )> 0{_agbbb ,_fgb ,_cad ,_gbd ,_gbb ,_beb ,_agbbf ,_bbdf =_cbf (_gffd .SerAx [0]);};if _bbdf !=nil {return _bbdf ;
};if _fgb !=_efc .ST_AxPosL &&_fgb !=_efc .ST_AxPosB {return _ec .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};if _agbbb !=_bdgg ||_dgfc !=_beb {return _ec .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_ebb :=len (_bcc )+1;var _ega ,_ddf float64 ;switch _cad {case _efc .ST_TickMarkIn :_ega ,_ddf =_dcfg ,0;
case _efc .ST_TickMarkOut :_ega ,_ddf =0,_dcfg ;case _efc .ST_TickMarkCross :_ega ,_ddf =_dcfg ,_dcfg ;};_ega =_ega *_adeec ;_ddf =_ddf *_adeec ;var _gdef *_ad .CT_ShapeProperties ;if _gbb !=nil {_gdef =_gbb .SpPr ;};if _caee {_dca :=_eca /float64 (len (_bcc ));
_egf :=_aeaa .Left -_fegd *_dgc /_gae ;_gbgc :=_egf -_dge *_adeec ;if _ecc {var _ddab float64 ;for _bded :=0;_bded < _ebb ;_bded ++{_edc :=_aeaa .Bottom -float64 (_bded )*_dca ;if _bded < _ebb -1{_dcg :=_bcda .NewParagraph (_bcc [_bded ]);_dcg .SetFontSize (_dgf *_adeec );
_dcg .SetPos (_gbgc ,_edc -_dca /2-_bcdc *_adeec );_bcda .Draw (_dcg );_bbdd :=(_dcg .Width ()/1000-_dge )*_adeec ;if _bbdd > 0&&_bbdd > _ddab {_ddab =_bbdd ;};};};if _ddab > 0{_aeaa .Left +=_ddab +_fecb ;_egf =_aeaa .Left -_fegd *_dgc /_gae ;_dgc =_aeaa .Right -_aeaa .Left ;
};};_cdfb :=_egf -_ddf ;_dbbf :=_egf +_ega ;_gfae :=_aeaa .Left ;_bgd :=_aeaa .Right ;for _edae :=0;_edae < _ebb ;_edae ++{_ceg :=_aeaa .Bottom -float64 (_edae )*_dca ;_adf .drawLineWithProps (_agbbf ,_cdfb ,_ceg ,_dbbf ,_ceg ,true );_adf .drawLineWithProps (_gdef ,_gfae ,_ceg ,_bgd ,_ceg ,true );
};_bdgd :=_dgc /_gae ;_dcab :=_aeaa .Bottom -_eadad ;_def :=_aeaa .Bottom +_ecf ;_aeaf :=_aeaa .Top ;_ddec :=_aeaa .Bottom ;for _dcd :=0;_dcd < _cdc ;_dcd ++{_abbg :=_aeaa .Left +(_edef -_fegd )*_bdgd ;_adf .drawLineWithProps (_accb ,_abbg ,_dcab ,_abbg ,_def ,true );
_adf .drawLineWithProps (_dad ,_abbg ,_aeaf ,_abbg ,_ddec ,true );if _fccg {_cbg :=_bcda .NewParagraph (_gab .FormatFloat (_edef ,'g',-1,64));_cbg .SetFontSize (_dgf *_adeec );_cbg .SetPos (_abbg -_aac *_adeec ,_ddec +_fcff *_adeec );_bcda .Draw (_cbg );
};_edef +=_fgd ;};}else {_dcb :=_eca /_gae ;_afd :=_aeaa .Left ;if _fccg {var _bge float64 ;for _edbgc :=0;_edbgc < _cdc ;_edbgc ++{_gabg :=_aeaa .Bottom -(_edef -_fegd )*_dcb ;_bddb :=_bcda .NewParagraph (_gab .FormatFloat (_edef ,'g',-1,64));_bddb .SetFontSize (_dgf *_adeec );
_bddb .SetPos (_afd -_dge *_adeec ,_gabg -_bcdc *_adeec );_bcda .Draw (_bddb );_faee :=(_bddb .Width ()/1000-_dge )*_adeec ;if _faee > 0&&_faee > _bge {_bge =_faee ;};_edef +=_fgd ;};if _bge > 0{_aeaa .Left +=_bge +_fecb ;_dgc =_aeaa .Right -_aeaa .Left ;
};};_edef =_fegd ;_geac :=_aeaa .Left -_ecf ;_ddeg :=_aeaa .Left +_eadad ;_afd =_aeaa .Left ;_bfag :=_aeaa .Right ;for _ebd :=0;_ebd < _cdc ;_ebd ++{_fgc :=_aeaa .Bottom -(_edef -_fegd )*_dcb ;_adf .drawLineWithProps (_accb ,_geac ,_fgc ,_ddeg ,_fgc ,true );
_adf .drawLineWithProps (_dad ,_afd ,_fgc ,_bfag ,_fgc ,true );_edef +=_fgd ;};_afc :=_dgc /float64 (len (_bcc ));_aefgb :=_aeaa .Bottom +_fegd *_eca /_gae ;_gge :=_aefgb -_ega ;_bbe :=_aefgb +_ddf ;_fcg :=_aeaa .Top ;_fdgbb :=_aeaa .Bottom ;_gdge :=_aefgb +_fcff *_adeec ;
for _cab :=0;_cab < _ebb ;_cab ++{_edce :=_aeaa .Left +float64 (_cab )*_afc ;_adf .drawLineWithProps (_agbbf ,_edce ,_gge ,_edce ,_bbe ,true );_adf .drawLineWithProps (_gdef ,_edce ,_fcg ,_edce ,_fdgbb ,true );if _ecc &&_cab < _ebb -1{_dgcg :=_bcda .NewParagraph (_bcc [_cab ]);
_dgcg .SetFontSize (_dgf *_adeec );_dgcg .SetPos (_edce +_cac *_adeec ,_gdge );_bcda .Draw (_dgcg );};};};return nil ;};func _faeef (_bcgg ,_dbbb ,_bgc uint8 )(float64 ,float64 ,float64 ){_eef ,_cdg ,_eccf :=float64 (_bcgg )/255,float64 (_dbbb )/255,float64 (_bgc )/255;
_edg :=_eef ;if _cdg < _edg {_edg =_cdg ;};if _eccf < _edg {_edg =_eccf ;};var _aba ,_fdba bool ;_aee :=_eef ;if _cdg > _aee {_aee =_cdg ;_aba =true ;};if _eccf > _aee {_aee =_eccf ;_aba =false ;_fdba =true ;};_bggd :=(_edg +_aee )/2;var _bbff float64 ;
if _edg !=_aee {if _bggd <=0.5{_bbff =(_aee -_edg )/(_aee +_edg );}else {_bbff =(_aee -_edg )/(2.0-_aee -_edg );};};var _abg float64 ;if _edg !=_aee {if _aba {_abg =2.0+(_eccf -_eef )/(_aee -_edg );}else if _fdba {_abg =4.0+(_eef -_cdg )/(_aee -_edg );
}else {_abg =(_cdg -_eccf )/(_aee -_edg );};_abg *=60;if _abg < 0{_abg +=360;};};return _abg ,_bbff ,_bggd ;};func GetGroupOffsetFromXfrm (xfrm *_ad .CT_GroupTransform2D )(float64 ,float64 ){var _ffeg ,_eeab float64 ;if xfrm .Off !=nil &&xfrm .ChOff !=nil {_ffeg =_ed .FromEMU (FromSTCoordinate (xfrm .Off .XAttr ))-_ed .FromEMU (FromSTCoordinate (xfrm .ChOff .XAttr ));
_eeab =_ed .FromEMU (FromSTCoordinate (xfrm .Off .YAttr ))-_ed .FromEMU (FromSTCoordinate (xfrm .ChOff .YAttr ));};return _ffeg ,_eeab ;};func MakeTempCreatorMaxHeight (width float64 )*_db .Creator {return MakeTempCreator (width ,_a .MaxFloat64 );};func _addb (_bad string )([]byte ,error ){_fbb :=_ga .MustCompile ("\u005b\u005e\u0061\u002d\u007a\u0041\u002d\u005a\u0030\u002d\u0039\u005d\u002b");
_bad =_fbb .ReplaceAllString (_bad ,"");_eafa :=[]rune (_bad );_bdf :=[]byte {};for _fcdfeb :=len (_eafa )-2;_fcdfeb >=0;_fcdfeb -=2{_cec ,_eba :=_gab .ParseUint (string (_eafa [_fcdfeb ])+string (_eafa [_fcdfeb +1]),16,8);if _eba !=nil {return nil ,_eba ;
};_bdf =append (_bdf ,byte (_cec ));};return _bdf ,nil ;};func TwipsFromPoints (points float64 )float64 {return points /_ed .Twips };func (_dbfa *Rectangle )scale (_dcdg float64 ){_dbfa .Top *=_dcdg ;_dbfa .Bottom *=_dcdg ;_dbfa .Left *=_dcdg ;_dbfa .Right *=_dcdg ;
};func (_efa barSerByOrder )Len ()int {return len (_efa )};func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_ed .Twips *10+0.5))/10;};var _fcff =_geab (1.5);var _aac =_geab (0.5);func GetPageFromCreator (c *_db .Creator )(*_fb .PdfPage ,error ){_cbaa :=_b .NewBuffer ([]byte {});
_abcb :=c .Write (_cbaa );if _abcb !=nil {return nil ,_abcb ;};_agbbe :=_b .NewReader (_cbaa .Bytes ());_ccec ,_abcb :=_fb .NewPdfReader (_agbbe );if _abcb !=nil {return nil ,_abcb ;};return _ccec .GetPage (1);};func (_ffgd *creatorContext )drawBorderWithProps (_afdg *_ad .CT_ShapeProperties ,_acf *Rectangle ,_dabg float64 ){if _acf !=nil &&_afdg !=nil &&_afdg .Ln !=nil &&_afdg .Ln .SolidFill !=nil {_eed :=_ffgd .getPdfColorFromSolidFill (_afdg .Ln .SolidFill );
DrawRectangle (_ffgd ._ddb ,_acf ,_dabg ,_eed );};};func _cag (_dfbd ,_efag ,_dag float64 )(uint8 ,uint8 ,uint8 ){var _debd float64 ;if _dag < 0.5{_debd =_dag *(1+_efag );}else {_debd =_dag +_efag -_dag *_efag ;};_bceg :=_dag *2-_debd ;_dfbd /=360.0;_dac :=_gbda (_dfbd +1.0/3.0);
_bgce :=_gbda (_dfbd );_dbgg :=_gbda (_dfbd -1.0/3.0);_dgce :=_aaacg (_dac ,_debd ,_bceg );_fcdf :=_aaacg (_bgce ,_debd ,_bceg );_aeeg :=_aaacg (_dbgg ,_debd ,_bceg );return uint8 (255*_dgce ),uint8 (255*_fcdf ),uint8 (255*_aeeg );};func GetImage (c *_db .Creator ,goImg _gb .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_db .Image ,error ){if goImg ==nil {return nil ,nil ;
};_ggbd :=goImg .Bounds ().Size ();_dgfa :=_ggbd .X ;_ceaf :=_ggbd .Y ;if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_dgfa );};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_ceaf );};var _dece _gb .Rectangle ;switch part {case ImgPart_t :_dece =_gb .Rect (0,0,_dgfa ,int (dividerY ));
case ImgPart_b :_dece =_gb .Rect (0,int (dividerY ),_dgfa ,_ceaf );case ImgPart_l :_dece =_gb .Rect (0,0,int (dividerX ),_ceaf );case ImgPart_r :_dece =_gb .Rect (int (dividerX ),0,_dgfa ,_ceaf );case ImgPart_lt :_dece =_gb .Rect (0,0,int (dividerX ),int (dividerY ));
case ImgPart_rt :_dece =_gb .Rect (int (dividerX ),0,_dgfa ,int (dividerY ));case ImgPart_lb :_dece =_gb .Rect (0,int (dividerY ),int (dividerX ),_ceaf );case ImgPart_rb :_dece =_gb .Rect (int (dividerX ),int (dividerY ),_dgfa ,_ceaf );default:_dece =_gb .Rect (0,0,_dgfa ,_ceaf );
};_cbac :=CropImageByRect (goImg ,_dece );_aag ,_gdgb :=c .NewImageFromGoImage (_cbac );if _gdgb !=nil {return nil ,_gdgb ;};_aag .Scale (imgWidth /float64 (_dgfa ),imgHeight /float64 (_ceaf ));_aag .SetPos (left ,top );return _aag ,nil ;};func FromSTPercentage (st *_ad .ST_Percentage )float64 {if _bgfc :=st .ST_PercentageDecimal ;
_bgfc !=nil {return float64 (*_bgfc )/100000;};return 0;};func AdjustColor (colorStr string ,EG_ColorTransform []*_ad .EG_ColorTransform )string {for _ ,_agda :=range EG_ColorTransform {if _bff :=_agda .Tint ;_bff !=nil {if _fccd :=_bff .ValAttr .ST_PositiveFixedPercentageDecimal ;
_fccd !=nil {colorStr =AdjustColorByTint (colorStr ,float64 (*_fccd )/100000);};};if _gbad :=_agda .Shade ;_gbad !=nil {if _cgfe :=_gbad .ValAttr .ST_PositiveFixedPercentageDecimal ;_cgfe !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_cgfe )/100000);
};};if _eaab :=_agda .LumMod ;_eaab !=nil {if _gbbb :=_eaab .ValAttr .ST_PercentageDecimal ;_gbbb !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_gbbb )/100000);};};};return colorStr ;};type fontsMap struct{_dbc *_g .Mutex ;_cfb map[string ]map[FontStyle ]*_fb .PdfFont ;
};type barSerByOrder []*_efc .CT_BarSer ;var _bcdc =_geab (1.5);func (_caf *creatorContext )drawTitle (_cae string ,_gfac ,_gaf float64 ){_fce :=_caf ._bggb ;_aed :=_caf ._ddb .NewStyledParagraph ();_ggaf :=_aed .SetText (_cae );_gdg ,_gdd :=_fb .NewStandard14Font (_fb .HelveticaName );
if _gdd ==nil {_dabc :=_caf ._ddb .NewTextStyle ();_dabc .Font =_gdg ;_dabc .FontSize =14;_dabc .TextRise =0.4;_ggaf .Style =_dabc ;_aed .SetPos (_gfac -_aed .Width ()*_fce /2,_gaf );_caf ._ddb .Draw (_aed );};};func LoadFontFromFile (filename string )(*_fb .PdfFont ,error ){if !_f .HasSuffix (filename ,"\u002e\u0074\u0074\u0066"){_ab .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return nil ,_e .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_fgcg ,_fcef :=_fb .NewCompositePdfFontFromTTFFile (filename );if _fcef !=nil {return nil ,_fcef ;};return _fgcg ,nil ;};var _dafe =fontsMap {_dbc :&_g .Mutex {},_cfb :map[string ]map[FontStyle ]*_fb .PdfFont {}};var _dcfg =_geab (1);