//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_cd "bytes";_ad "errors";_e "fmt";_cg "github.com/unidoc/unichart";_gdb "github.com/unidoc/unichart/dataset";_ae "github.com/unidoc/unichart/render";_gcg "github.com/unidoc/unioffice/v2/common/logger";_df "github.com/unidoc/unioffice/v2/document";
_gc "github.com/unidoc/unioffice/v2/measurement";_agb "github.com/unidoc/unioffice/v2/schema/soo/dml";_da "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_gdd "github.com/unidoc/unioffice/v2/spreadsheet";_gf "github.com/unidoc/unioffice/v2/spreadsheet/format";
_bc "github.com/unidoc/unioffice/v2/spreadsheet/formula";_eb "github.com/unidoc/unioffice/v2/spreadsheet/reference";_db "github.com/unidoc/unipdf/v4/core";_be "github.com/unidoc/unipdf/v4/creator";_fa "github.com/unidoc/unipdf/v4/model";_f "github.com/unidoc/unipdf/v4/render";
_bd "github.com/unidoc/unitype";_b "image";_c "image/color";_gde "math";_ce "os";_gd "regexp";_ge "sort";_geg "strconv";_ag "strings";_g "sync";_a "unicode";);var _cdd =_bfaf (0.5);func _cgde (_bfge ,_cgeg ,_fabc uint8 )(float64 ,float64 ,float64 ){_ddg ,_bcea ,_ede :=float64 (_bfge )/255,float64 (_cgeg )/255,float64 (_fabc )/255;
_fafe :=_ddg ;if _bcea < _fafe {_fafe =_bcea ;};if _ede < _fafe {_fafe =_ede ;};var _fbac ,_fdgb bool ;_dfga :=_ddg ;if _bcea > _dfga {_dfga =_bcea ;_fbac =true ;};if _ede > _dfga {_dfga =_ede ;_fbac =false ;_fdgb =true ;};_aeddg :=(_fafe +_dfga )/2;var _gdg float64 ;
if _fafe !=_dfga {if _aeddg <=0.5{_gdg =(_dfga -_fafe )/(_dfga +_fafe );}else {_gdg =(_dfga -_fafe )/(2.0-_dfga -_fafe );};};var _daee float64 ;if _fafe !=_dfga {if _fbac {_daee =2.0+(_ede -_ddg )/(_dfga -_fafe );}else if _fdgb {_daee =4.0+(_ddg -_bcea )/(_dfga -_fafe );
}else {_daee =(_bcea -_ede )/(_dfga -_fafe );};_daee *=60;if _daee < 0{_daee +=360;};};return _daee ,_gdg ,_aeddg ;};func TwipsFromPoints (points float64 )float64 {return points /_gc .Twips };func (_dga *creatorContext )drawBarChart (_ba *_da .CT_BarChart ,_gfb *Rectangle ,_adf []*_da .CT_PlotAreaChoice1 ,_dad *_gdd .Workbook )([]*legendItem ,error ){var _ccf bool ;
if _adfa :=_ba .BarDir ;_adfa !=nil {_ccf =_adfa .ValAttr ==_da .ST_BarDirBar ;};_bad :=_ba .Ser ;_ge .Sort (barSerByOrder (_bad ));_gaa :=map[string ]serCategory {};_bdc :=[]string {};_gb :=[]*legendItem {};_egb :=_gde .Inf (1);_bb :=_gde .Inf (-1);for _ ,_efd :=range _bad {var _ab string ;
if _agbe :=_efd .Tx ;_agbe !=nil {if _eebg :=_agbe .SerTxChoice ;_eebg !=nil {if _eebg .V !=nil {_ab =*_eebg .V ;}else if _dfa :=_eebg .StrRef ;_dfa !=nil {if _gfc :=_dfa .StrCache ;_gfc !=nil {for _ ,_fdf :=range _gfc .Pt {_ab =_fdf .V ;};};};};};if _aaf :=_efd .Cat ;
_aaf !=nil {if _dab :=_aaf .AxDataSourceChoice ;_dab !=nil {if _ac :=_dab .StrRef ;_ac !=nil {if _dfc :=_ac .F ;_dfc !=""&&_dad !=nil {_dbc ,_dge ,_gag ,_fdd :=ParseExcelRange (_dfc );if _fdd ==nil {for _ ,_ebd :=range _dad .Sheets (){if _ebd .Name ()==_ag .Trim (_dbc ,"\u0027"){_dc :=_dge .String ();
for _ged :=_dge .RowIdx ;_ged <=_gag .RowIdx ;_ged +=1{_eec :=_ag .ReplaceAll (_dc ,_e .Sprint (_dge .RowIdx ),_e .Sprint (_ged ));_dga .addCatName (_ebd .Cell (_eec ).GetString (),_gaa ,&_bdc );};break ;};};};};if _gbb :=_ac .StrCache ;_gbb !=nil {for _ ,_ggf :=range _gbb .Pt {_dga .addCatName (_ggf .V ,_gaa ,&_bdc );
};};}else if _dd :=_dab .NumRef ;_dd !=nil {if _fc :=_dd .NumCache ;_fc !=nil {var _gce string ;if _fc .FormatCode !=nil {_gce =*_fc .FormatCode ;};for _ ,_fbc :=range _fc .Pt {var _ega string ;if _fbc .FormatCodeAttr ==nil {_ega =_gce ;}else {_ega =*_fbc .FormatCodeAttr ;
};var _fae string ;_dabe ,_ddc :=_geg .ParseFloat (_fbc .V ,64);if _ddc !=nil {_fae =_fbc .V ;}else {_fae =_gf .Number (_dabe ,_ega );};_dga .addCatName (_fae ,_gaa ,&_bdc );};};};};};if _gfe :=_efd .Val ;_gfe !=nil {if _ace :=_gfe .NumDataSourceChoice ;
_ace !=nil {if _fdg :=_ace .NumRef ;_fdg !=nil {if _bdca :=_fdg .F ;_bdca !=""&&_dad !=nil {_ff ,_bea ,_ecd ,_faa :=ParseExcelRange (_bdca );if _faa ==nil {for _ ,_abb :=range _dad .Sheets (){if _abb .Name ()==_ag .Trim (_ff ,"\u0027"){_cgbf :=_bea .String ();
for _aga :=_bea .RowIdx ;_aga <=_ecd .RowIdx ;_aga +=1{_egac :=_ag .ReplaceAll (_cgbf ,_e .Sprint (_bea .RowIdx ),_e .Sprint (_aga ));if _abb .FormulaContext ().HasFormula (_egac ){_bgg :=_bc .NewEvaluator ();_daa :=_abb .FormulaContext ().Cell (_egac ,_bgg );
_dgc :=_daa .Value ();_dga .addCatValue (_dgc ,_gaa ,_bdc ,(int )(_aga -_bea .RowIdx ),&_egb ,&_bb ,_ab ,_efd .SpPr );}else {_ggc :=_abb .Cell (_egac ).GetString ();_dga .addCatValue (_ggc ,_gaa ,_bdc ,(int )(_aga -_bea .RowIdx ),&_egb ,&_bb ,_ab ,_efd .SpPr );
};};break ;};};};};if _aaef :=_fdg .NumCache ;_aaef !=nil {for _dde ,_fbb :=range _aaef .Pt {_dga .addCatValue (_fbb .V ,_gaa ,_bdc ,_dde ,&_egb ,&_bb ,_ab ,_efd .SpPr );};};};};};_gb =append (_gb ,&legendItem {_bfdf :_ab ,_fbe :_efd .SpPr });};var _beae float64 ;
var _cf ,_gec float64 ;if _bb ==0&&_egb ==0{_beae =0.2;_gec =0;_cf =1;}else {var _gdc float64 ;if _cef :=_gde .Abs (_egb );_bb < _cef {_gdc =_cef ;}else {_gdc =_bb ;};_aag :=_gde .Pow (10,_gde .Floor (_gde .Log10 (_gdc )));_dfaf :=_gdc /_aag ;if _dfaf < 4.29{_beae =0.5;
}else if _dfaf >=4.29&&_dfaf < 8.58{_beae =1;}else {_beae =2;};_beae *=_aag ;if _bb <=0{_cf =0;}else {_cf =(_gde .Ceil (_bb /_beae )+1)*_beae ;};if _egb >=0{_gec =0;}else {_gec =(_gde .Floor (_egb /_beae )-1)*_beae ;};};_gdf :=_dga .drawAxes (_adf ,_gec ,_cf ,_beae ,_bdc ,_gfb ,_ccf );
if _gdf !=nil {return nil ,_gdf ;};_cgdd :=0.0;if _ba .GapWidth !=nil {if _efb :=_ba .GapWidth .ValAttr ;_efb !=nil {if _fad :=_efb .ST_GapAmountUShort ;_fad !=nil {_cgdd =float64 (*_fad )/100.0;};};};_ebf :=_gfb .Right -_gfb .Left ;_dcd :=_gfb .Bottom -_gfb .Top ;
_dfd :=float64 (len (_bdc ));if _ccf {_dfaff :=_cf /(_cf -_gec )*_ebf ;_agba :=-_gec /(_cf -_gec )*_ebf ;_fg :=_gfb .Left +_agba ;_cbc :=_dcd /_dfd ;for _gfbb ,_eab :=range _bdc {_fge :=_gaa [_eab ];_gdbc :=float64 (len (_fge ._ead ))+_cgdd ;_ebg :=_cbc /_gdbc ;
_dfe :=_ebg *_cgdd ;_gagg :=_gfb .Bottom -float64 (_gfbb )*_cbc -_dfe /2-_ebg ;for _ ,_cegb :=range _fge ._ead {if _cegb ._abbe ==0{continue ;};var _af ,_ffg float64 ;if _cegb ._abbe > 0{_ffg =_cegb ._abbe /_cf *_dfaff ;_dga .drawRectangleWithProps (_cegb ._eee ,_fg ,_gagg ,_ffg ,_ebg ,false );
}else {_ffg =_cegb ._abbe /_gec *_agba ;_af =_fg -_ffg ;_dga .drawRectangleWithProps (_cegb ._eee ,_af ,_gagg ,_ffg ,_ebg ,false );};_gagg -=_ebg ;};};}else {_aage :=_cf /(_cf -_gec )*_dcd ;_caf :=-_gec /(_cf -_gec )*_dcd ;_ade :=_gfb .Top +_aage ;_acd :=_ebf /_dfd ;
for _bfe ,_dgg :=range _bdc {_dee :=_gaa [_dgg ];_abbd :=float64 (len (_dee ._ead ))+_cgdd ;_abe :=_acd /_abbd ;_ada :=_abe *_cgdd ;_gbd :=_gfb .Left +float64 (_bfe )*_acd +_ada /2;for _ ,_gbg :=range _dee ._ead {var _fe ,_caa float64 ;if _gbg ._abbe > 0{_caa =_gbg ._abbe /_cf *_aage ;
_fe =_ade -_caa ;_dga .drawRectangleWithProps (_gbg ._eee ,_gbd ,_fe ,_abe ,_caa ,false );}else {_caa =_gbg ._abbe /_gec *_caf ;_dga .drawRectangleWithProps (_gbg ._eee ,_gbd ,_ade ,_abe ,_caa ,false );};_gbd +=_abe ;};};};return _gb ,nil ;};var _agg =_bfaf (1.5);
var _egabf =_bfaf (1);var _fgc =fontsMap {_edggf :&_g .Mutex {},_aea :map[string ]map[FontStyle ]*_fa .PdfFont {}};var _fgeb =_bfaf (5);var _bcbc =_bfaf (1.5);func FromSTCoordinate (st _agb .ST_Coordinate )int64 {if _gdefa :=st .ST_CoordinateUnqualified ;
_gdefa !=nil {return *_gdefa ;};return 0;};func (_cgegb *creatorContext )drawScatterChart (_gbbe *_da .CT_ScatterChart ,_aacg *Rectangle ,_bee []*_da .CT_PlotAreaChoice1 ,_edcd float64 )([]*legendItem ,error ){_dabf :=[]*legendItem {};_cffb :=_gbbe .Ser ;
_eef :=make (map[string ]float64 );_cbde :=make (map[string ][]float64 );_fabd :=make (map[string ][]float64 );_dcef :=[]string {};for _ ,_gbbc :=range _cffb {var _adae string ;if _fcbd :=_gbbc .Tx ;_fcbd !=nil {if _feae :=_fcbd .SerTxChoice ;_feae !=nil {if _feae .V !=nil {_adae =*_feae .V ;
}else if _geac :=_feae .StrRef ;_geac !=nil {if _fgca :=_geac .StrCache ;_fgca !=nil {for _ ,_gdgc :=range _fgca .Pt {_adae =_gdgc .V ;};};};_dcef =append (_dcef ,_adae );};};if _gbbc .Marker !=nil &&_gbbc .Marker .Size !=nil {_eef [_adae ]=float64 (*_gbbc .Marker .Size .ValAttr );
}else {_eef [_adae ]=-1.0;};if _dacg :=_gbbc .XVal ;_dacg !=nil {if _adac :=_dacg .AxDataSourceChoice ;_adac !=nil {if _daae :=_adac .NumRef ;_daae !=nil {if _fdbe :=_daae .NumCache ;_fdbe !=nil {for _ ,_adfb :=range _fdbe .Pt {_cddg ,_ :=_geg .ParseFloat (_ag .TrimSpace (_adfb .V ),64);
_cbde [_adae ]=append (_cbde [_adae ],_cddg );};};};};};if _cgdc :=_gbbc .YVal ;_cgdc !=nil {if _fgead :=_cgdc .NumDataSourceChoice ;_fgead !=nil {if _deea :=_fgead .NumRef ;_deea !=nil {if _bgfd :=_deea .NumCache ;_bgfd !=nil {for _ ,_eedd :=range _bgfd .Pt {_dfddc ,_ :=_geg .ParseFloat (_ag .TrimSpace (_eedd .V ),64);
_fabd [_adae ]=append (_fabd [_adae ],_dfddc );};};};};};};_cfef :=true ;_bddg :="";_egabd :="";if len (_bee )> 1{if _bee [0].ValAx .Delete !=nil &&_bee [1].ValAx .Delete !=nil {if !*(*_bee [0].ValAx .Delete ).ValAttr &&!*(*_bee [1].ValAx .Delete ).ValAttr {_cfef =false ;
};};_bddg =_cgegb .getTitle (_bee [0].ValAx .Title );_egabd =_cgegb .getTitle (_bee [1].ValAx .Title );};_bed :=_ae .Style {Hidden :_cfef ,FontSize :8*_edcd };_fbfe :=&_cg .Chart {Series :[]_gdb .Series {},YAxisSecondary :_cg .YAxis {Style :_bed ,Name :_egabd ,NameStyle :_bed },XAxis :_cg .XAxis {Style :_bed ,Name :_bddg ,NameStyle :_bed },YAxis :_cg .YAxis {Style :_ae .Style {Hidden :true }}};
for _ ,_baee :=range _dcef {_cfed :=_gdb .ContinuousSeries {XValues :_cbde [_baee ],YValues :_fabd [_baee ],Style :_ae .Style {StrokeWidth :-1,DotWidth :_eef [_baee ]}};_fbfe .Series =append (_fbfe .Series ,_cfed );};_fbfe .SetHeight (int (_gde .Abs (_aacg .Top -_aacg .Bottom )));
_fbfe .SetWidth (int (_gde .Abs (_aacg .Right -_aacg .Left )));_ddge :=_cgegb ._bcg ;_ebae :=_be .NewChart (_fbfe );_ebae .SetPos (_aacg .Left ,_aacg .Top );_dbaa :=_ddge .Draw (_ebae );if _dbaa !=nil {return nil ,_dbaa ;};return _dabf ,nil ;};type serCategory struct{_beaec string ;
_ead []serValue ;};func _ecdf (_bfaa ,_dfdf ,_cbcb float64 )float64 {if _bfaa *6< 1{return _cbcb +(_dfdf -_cbcb )*6*_bfaa ;}else if _bfaa *2< 1{return _dfdf ;}else if _bfaa *3< 2{return _cbcb +(_dfdf -_cbcb )*(2.0/3.0-_bfaa )*6;}else {return _cbcb ;};};
func GetColorStringFromDmlColor (dmlColor *_agb .CT_Color )string {var _cdgb string ;if _bgfg :=dmlColor .SrgbClr ;_bgfg !=nil {_cdgb =_bgfg .ValAttr ;}else if _abca :=dmlColor .SysClr ;_abca !=nil {if _abca .LastClrAttr !=nil {return *_abca .LastClrAttr ;
};return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _cdgb ;};func (_dgef *creatorContext )drawLegend (_dea *Rectangle ,_bcb []*legendItem ,_fcd bool ){_geda :=_dgef ._cbfc ;_dfec :=_bfaf (2.5)*_geda ;_fade :=_agg *_geda ;_fggf :=(_dfec -_fade )/2;
_fcb :=float64 (len (_bcb ));if _fcd {_ecf :=&Rectangle {Top :_dea .Top +_bfaf (1)*_geda ,Bottom :_dea .Bottom -_bfaf (1)*_geda ,Left :_dea .Left +_bfaf (2.5)*_geda ,Right :_dea .Right -_bfaf (2.5)*_geda };var _fcc float64 ;if _fcb > 1{_fcc =(_ecf .Right -_ecf .Left )/_fcb ;
};_ffc :=_ecf .Left ;_bbce :=_ecf .Top ;for _ ,_cbb :=range _bcb {if _fbf :=_cbb ._fbe ;_fbf !=nil {_dgef .drawRectangleWithProps (_fbf ,_ffc ,_bbce +_fggf ,_fade ,_fade ,false );_gbbf :=_ffc +_fade *2;_gad :=_dgef ._bcg .NewStyledParagraph ();_gad .SetPos (_gbbf ,_bbce );
_cgbff :=_gad .Append (_cbb ._bfdf );_baa ,_ccc :=_fa .NewStandard14Font (_fa .HelveticaName );if _ccc ==nil {_abd :=_dgef ._bcg .NewTextStyle ();_abd .Font =_baa ;_abd .FontSize =_dfec ;_abd .TextRise =0.4;_cgbff .Style =_abd ;_dgef ._bcg .Draw (_gad );
};};_ffc +=_fcc ;};}else {_daf :=&Rectangle {Top :_dea .Top +_bfaf (2.5)*_geda ,Bottom :_dea .Bottom -_bfaf (2.5)*_geda ,Left :_dea .Left +_bfaf (2.5)*_geda ,Right :_dea .Right -_bfaf (2.5)*_geda };var _gcd float64 ;if _fcb > 1{_gcd =(_daf .Bottom -_daf .Top -_dfec )/(_fcb -1);
if _gcd < _dfec {_gcd =_dfec ;};};_egbb :=_daf .Top ;_gea :=_daf .Left ;_bec :=_gea +_fade *2;for _ ,_ddd :=range _bcb {if _edda :=_ddd ._fbe ;_edda !=nil {_dgef .drawRectangleWithProps (_edda ,_gea ,_egbb +_fggf ,_fade ,_fade ,false );_agc :=_dgef ._bcg .NewStyledParagraph ();
_agc .SetPos (_bec ,_egbb );_agc .SetWidth (_daf .Right -_daf .Left );_ebe :=_agc .Append (_ddd ._bfdf );_bdcc ,_feb :=_fa .NewStandard14Font (_fa .HelveticaName );if _feb ==nil {_fdgc :=_dgef ._bcg .NewTextStyle ();_fdgc .Font =_bdcc ;_fdgc .FontSize =_dfec ;
_fdgc .TextRise =0.4;_ebe .Style =_fdgc ;_dgef ._bcg .Draw (_agc );};};_egbb +=_gcd ;};};};var _ccb =_bfaf (2);type PageSize int ;func _bdg (_aac *_da .ChartSpace ,_ed ,_fab float64 ,_dcdf *_agb .Theme ,_fgf bool ,_cfg *_gdd .Workbook )(*_be .Creator ,error ){_bbc :=1.0;
if _fgf {_bbc =8.0;};_cgc :=&Rectangle {};_cbf :=&Rectangle {Top :_cgc .Top ,Bottom :_fab -_cgc .Bottom ,Left :_cgc .Left ,Right :_ed -_cgc .Right };_gegd :=MakeTempCreator (_ed *_bbc +1,_fab *_bbc +1);_gdda :=&creatorContext {_bcg :_gegd ,_gegb :_dcdf ,_cbfc :_bbc };
var _fbec bool ;if _cfc :=_aac .Chart ;_cfc !=nil {_ecb :=_cfc .PlotArea ;if _ecb ==nil {return nil ,_ad .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");};_bag :=0.0;if _cfc .AutoTitleDeleted !=nil &&_cfc .AutoTitleDeleted .ValAttr !=nil &&!*_cfc .AutoTitleDeleted .ValAttr {if _cfc .Title !=nil &&_cfc .Title .Overlay !=nil &&_cfc .Title .Overlay .ValAttr !=nil &&!*_cfc .Title .Overlay .ValAttr {_bag =_bfaf (10);
};_ccg :=_gdda .getTitle (_cfc .Title );if _ccg ==""{_ccg ="C\u0068\u0061\u0072\u0074\u0020\u0054\u0069\u0074\u006c\u0065";};_gdda .drawTitle (_ccg ,_cbf .Left +_cbf .Right /2,_bfaf (5));};_gdbae :=&Rectangle {Top :_bfaf (10)+_bag ,Bottom :_cbf .Bottom -_bfaf (15),Left :_bfaf (10),Right :_cbf .Right -_bfaf (10)};
var _dcc *Rectangle ;_bbd :=_cfc .Legend ;if _bbd !=nil {_dedf :=_bbd .Overlay !=nil &&_bbd .Overlay .ValAttr !=nil &&*_bbd .Overlay .ValAttr ;if _aaged :=_bbd .LegendPos ;_aaged !=nil {switch _aaged .ValAttr {case _da .ST_LegendPosTr :if !_dedf {_gdbae =&Rectangle {Top :_bfaf (25)+_bag ,Bottom :_cbf .Bottom -_bfaf (10),Left :_bfaf (10),Right :_cbf .Right -_bfaf (25)};
};_dcc =&Rectangle {Top :_bfaf (2.5)+_bag ,Bottom :_bfaf (22.5),Left :_cbf .Right -_bfaf (22.5),Right :_cbf .Right -_bfaf (2.5)};case _da .ST_LegendPosT :_dcc =&Rectangle {Top :_bfaf (2.5)+_bag ,Bottom :_bfaf (7.5),Left :(_cbf .Right -_cbf .Left )*0.25,Right :(_cbf .Right -_cbf .Left )*0.75};
if !_dedf {_gdbae =&Rectangle {Top :_bfaf (12.5)+_bag ,Bottom :_cbf .Bottom -_bfaf (15),Left :_bfaf (10),Right :_cbf .Right -_bfaf (5)};};_fbec =true ;case _da .ST_LegendPosB :_dcc =&Rectangle {Top :_cbf .Bottom -_bfaf (7.5)+_bag ,Bottom :_cbf .Bottom -_bfaf (2.5),Left :(_cbf .Right -_cbf .Left )*0.25,Right :(_cbf .Right -_cbf .Left )*0.75};
if !_dedf {_gdbae =&Rectangle {Top :_bfaf (5)+_bag ,Bottom :_cbf .Bottom -_bfaf (15),Left :_bfaf (10),Right :_cbf .Right -_bfaf (5)};};_fbec =true ;case _da .ST_LegendPosR :_dcc =&Rectangle {Top :(_cbf .Bottom -_cbf .Top )/2-_bfaf (10)+_bag ,Bottom :(_cbf .Bottom -_cbf .Top )/2+_bfaf (10),Left :_cbf .Right -_bfaf (22.5),Right :_cbf .Right -_bfaf (2.5)};
if !_dedf {_gdbae =&Rectangle {Top :_bfaf (5)+_bag ,Bottom :_cbf .Bottom -_bfaf (12.5),Left :_bfaf (10),Right :_cbf .Right -_bfaf (25)};};case _da .ST_LegendPosL :_dcc =&Rectangle {Top :(_cbf .Bottom -_cbf .Top )/2-_bfaf (10)+_bag ,Bottom :(_cbf .Bottom -_cbf .Top )/2+_bfaf (10),Left :_bfaf (2.5),Right :_bfaf (22.5)};
if !_dedf {_gdbae =&Rectangle {Top :_bfaf (5)+_bag ,Bottom :_cbf .Bottom -_bfaf (12.5),Left :_bfaf (30),Right :_cbf .Right -_bfaf (5)};};default:_dcc =&Rectangle {Top :(_cbf .Bottom -_cbf .Top )/2-_bfaf (10)+_bag ,Bottom :(_cbf .Bottom -_cbf .Top )/2+_bfaf (10),Left :_cbf .Right -_bfaf (25),Right :_cbf .Right -_bfaf (5)};
if !_dedf {_gdbae =&Rectangle {Top :_bfaf (5)+_bag ,Bottom :_cbf .Bottom -_bfaf (12.5),Left :_bfaf (100),Right :_cbf .Right -_bfaf (25)};};};};};_gdbae .scale (_bbc );_gdda .drawBorderWithProps (_ecb .SpPr ,_gdbae ,_afd );_cag :=[]*legendItem {};var _bgf error ;
_fea :=_ecb .PlotAreaChoice1 ;for _ ,_ebga :=range _ecb .PlotAreaChoice {if _bga :=_ebga .BarChart ;_bga !=nil {_cag ,_bgf =_gdda .drawBarChart (_bga ,_gdbae ,_fea ,_cfg );if _bgf !=nil {return nil ,_bgf ;};break ;};if _dabg :=_ebga .PieChart ;_dabg !=nil {_cag ,_bgf =_gdda .drawPieChart (_dabg ,_gdbae ,_cfg ,_bbc );
if _bgf !=nil {return nil ,_bgf ;};break ;};if _edgg :=_ebga .ScatterChart ;_edgg !=nil {_cag ,_bgf =_gdda .drawScatterChart (_edgg ,_gdbae ,_fea ,_bbc );if _bgf !=nil {return nil ,_bgf ;};break ;};if _aab :=_ebga .LineChart ;_aab !=nil {_cag ,_bgf =_gdda .drawLineChart (_aab ,_gdbae ,_fea ,_bbc );
if _bgf !=nil {return nil ,_bgf ;};break ;};if _afb :=_ebga .AreaChart ;_afb !=nil {_cag ,_bgf =_gdda .drawAreaChart (_afb ,_gdbae ,_fea ,_bbc );if _bgf !=nil {return nil ,_bgf ;};break ;};};if _bbd !=nil {_dcc .scale (_bbc );_gdda .drawBorderWithProps (_bbd .SpPr ,_dcc ,_afd );
if len (_cag )!=0{_gdda .drawLegend (_dcc ,_cag ,_fbec );};};};_cbf .scale (_bbc );_gdda .drawBorderWithProps (_aac .SpPr ,_cbf ,_afd );return _gegd ,nil ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;
FontStyle_BoldItalic FontStyle =3;);func AdjustColorByTint (colorStr string ,tint float64 )string {var _feff ,_fdc ,_faaf uint8 ;_dceb ,_ :=_e .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_feff ,&_fdc ,&_faaf );
if _dceb !=3{return "";};return _bgbb (_feff ,tint )+_bgbb (_fdc ,tint )+_bgbb (_faaf ,tint );};func (_geb *creatorContext )drawBorderWithProps (_dceg *_agb .CT_ShapeProperties ,_aecg *Rectangle ,_bdgc float64 ){if _aecg !=nil &&_dceg !=nil &&_dceg .Ln !=nil &&_dceg .Ln .LineFillPropertiesChoice .SolidFill !=nil {_cfaa :=_geb .getPdfColorFromSolidFill (_dceg .Ln .LineFillPropertiesChoice .SolidFill );
DrawRectangle (_geb ._bcg ,_aecg ,_bdgc ,_cfaa );};};func (_dggb *creatorContext )getPdfColorFromSolidFill (_ffae *_agb .CT_SolidColorFillProperties )_be .Color {if _ffae ==nil {return nil ;};_efceb :="";if _dcdc :=_ffae .SrgbClr ;_dcdc !=nil {_efceb =_dcdc .ValAttr ;
}else if _gbca :=_ffae .SchemeClr ;_gbca !=nil {_efceb =_dcede (_gbca .ValAttr ,_dggb ._gegb );_efceb =AdjustColor (_efceb ,_gbca .EG_ColorTransform );};if _efceb ==""{return nil ;};return _be .ColorRGBFromHex ("\u0023"+_efceb );};func _bcfg (_eaa *_df .Document ,_fagf ,_fdea ,_adgea string )error {_abed ,_cad :=_eaa .GetFontBytesByRelId (_fdea );
if _cad !=nil {return _cad ;};_edeg ,_cad :=_daea (_adgea );if _cad !=nil {return _cad ;};for _cgca :=0;_cgca < 32;_cgca ++{_daed :=_cgca %len (_edeg );_abed [_cgca ]=_abed [_cgca ]^_edeg [_daed ];};_aaca :=_eaa .TmpPath +"\u002f"+_fagf +"\u002e\u0074\u0074\u0066";
_cad =_ce .WriteFile (_aaca ,_abed ,0644);if _cad !=nil {return _cad ;};_gecg (_aaca );return nil ;};func AdjustColorByLumOff (colorStr string ,lumOff float64 )string {var _edc ,_dagf ,_bacc uint8 ;_bbfb ,_ :=_e .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_edc ,&_dagf ,&_bacc );
if _bbfb !=3{return "";};_cbeb ,_beff ,_bfg :=_cgde (_edc ,_dagf ,_bacc );_bfg =_bfg +lumOff ;_edc ,_dagf ,_bacc =_fcgf (_cbeb ,_beff ,_bfg );return _e .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_edc ,_dagf ,_bacc );
};func FillRectangle (c *_be .Creator ,x ,y ,width ,height float64 ,color _be .Color ){if color ==nil {return ;};_cgddd :=c .NewRectangle (x ,y ,width ,height );_cgddd .SetFillColor (color );_cgddd .SetBorderWidth (0);c .Draw (_cgddd );};type legendItem struct{_bfdf string ;
_fbe *_agb .CT_ShapeProperties ;};func _ecc (_ggag *_da .CT_CatAx )(uint32 ,_da .ST_AxPos ,_da .ST_TickMark ,_da .ST_TickLblPos ,*_da .CT_ChartLines ,uint32 ,*_agb .CT_ShapeProperties ,error ){var _cgbfc ,_dfef uint32 ;var _dce _da .ST_AxPos ;var _dgeg _da .ST_TickMark ;
var _bggc *_da .CT_ChartLines ;var _afe _da .ST_TickLblPos ;if _ggag .AxId ==nil {return _cgbfc ,_dce ,_dgeg ,_afe ,_bggc ,_dfef ,_ggag .SpPr ,_ad .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_cgbfc =_ggag .AxId .ValAttr ;
};if _ggag .AxPos ==nil {return _cgbfc ,_dce ,_dgeg ,_afe ,_bggc ,_dfef ,_ggag .SpPr ,_ad .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_dce =_ggag .AxPos .ValAttr ;};if _ggag .MajorTickMark !=nil {_dgeg =_ggag .MajorTickMark .ValAttr ;
};if _ggag .TickLblPos !=nil {_afe =_ggag .TickLblPos .ValAttr ;};if _ggag .CrossAx ==nil {return _cgbfc ,_dce ,_dgeg ,_afe ,_bggc ,_dfef ,_ggag .SpPr ,_ad .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_dfef =_ggag .CrossAx .ValAttr ;};_bggc =_ggag .MajorGridlines ;return _cgbfc ,_dce ,_dgeg ,_afe ,_bggc ,_dfef ,_ggag .SpPr ,nil ;};func _bfaf (_gaga float64 )float64 {return _gaga *_gc .Millimeter };func _aaa (_bfab uint8 ,_ccd float64 )string {_eecg :=float64 (_bfab );
return _e .Sprintf ("\u0025\u0030\u0032\u0078",int (_eecg *_ccd ));};func (_fgea barSerByOrder )Less (i ,j int )bool {return _fgea [i ].Order .ValAttr < _fgea [j ].Order .ValAttr ;};var RtlFontFile *_fa .PdfFont ;const (PageSizeA4 PageSize =iota ;PageSizeA3 ;
PageSizeA5 ;PageSizeLetter ;PageSizeLegal ;Percent100 =100000.0;MaxPageHeight =11906;);type serValue struct{_ggd string ;_abbe float64 ;_eee *_agb .CT_ShapeProperties ;};func AdjustColor (colorStr string ,EG_ColorTransform []*_agb .EG_ColorTransform )string {for _ ,_ccfg :=range EG_ColorTransform {if _bfda :=_ccfg .ColorTransformChoice .Tint ;
_bfda !=nil {if _faegd :=_bfda .ValAttr .ST_PositiveFixedPercentageDecimal ;_faegd !=nil {colorStr =AdjustColorByTint (colorStr ,1.0-float64 (*_faegd )/Percent100 );};};if _aceg :=_ccfg .ColorTransformChoice .Shade ;_aceg !=nil {if _cgddg :=_aceg .ValAttr .ST_PositiveFixedPercentageDecimal ;
_cgddg !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_cgddg )/Percent100 );};};if _bcd :=_ccfg .ColorTransformChoice .LumMod ;_bcd !=nil {if _bac :=_bcd .ValAttr .ST_PercentageDecimal ;_bac !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_bac )/Percent100 );
};};if _fcgb :=_ccfg .ColorTransformChoice .LumOff ;_fcgb !=nil {if _cgcb :=_fcgb .ValAttr .ST_PercentageDecimal ;_cgcb !=nil {colorStr =AdjustColorByLumOff (colorStr ,float64 (*_cgcb )/Percent100 );};};};return colorStr ;};const (BorderPositionTop BorderPosition =0;
BorderPositionLeft BorderPosition =1;BorderPositionBottom BorderPosition =2;BorderPositionRight BorderPosition =3;);func FromSTCoordinate32 (st _agb .ST_Coordinate32 )int64 {if _eegg :=st .ST_Coordinate32Unqualified ;_eegg !=nil {return int64 (*_eegg );
};return 0;};func GetOpacityFromColorTransform (trs []*_agb .EG_ColorTransform )float64 {for _ ,_fba :=range trs {if _fba !=nil {if _cbegb :=_fba .ColorTransformChoice .Alpha ;_cbegb !=nil {if _dba :=_cbegb .ValAttr .ST_PositiveFixedPercentageDecimal ;
_dba !=nil {return float64 (*_dba )/Percent100 ;};};};};return 1.0;};func _faeb (_deafc _agb .ST_SchemeColorVal ,_fefb *_agb .Theme )string {if _fgd :=_fefb .ThemeElements ;_fgd !=nil {if _bfb :=_fgd .ClrScheme ;_bfb !=nil {switch _deafc {case _agb .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_bfb .Lt1 );
case _agb .ST_SchemeColorValDk1 ,_agb .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_bfb .Dk1 );case _agb .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_bfb .Lt2 );case _agb .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_bfb .Dk2 );
case _agb .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_bfb .Accent1 );case _agb .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_bfb .Accent2 );case _agb .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_bfb .Accent3 );
case _agb .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_bfb .Accent4 );case _agb .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_bfb .Accent5 );case _agb .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_bfb .Accent6 );
};};};return "";};func (_cccee *creatorContext )drawLineWithProps (_dbb *_agb .CT_ShapeProperties ,_beef ,_abac ,_daga ,_cbg float64 ,_gfg bool ){if _dbb !=nil {if _efdb :=_dbb .Ln ;_efdb !=nil {_fbbe :=_cccee .getPdfColorFromSolidFill (_efdb .LineFillPropertiesChoice .SolidFill );
if _fbbe ==nil &&_gfg {_fbbe =_be .ColorBlack ;};if _fbbe !=nil {var _bbea float64 ;if _ffdd :=_efdb .WAttr ;_ffdd !=nil {_bbea =_gc .FromEMU (int64 (*_ffdd ));}else {_bbea =_afd ;};DrawLine (_cccee ._bcg ,_beef ,_abac ,_daga ,_cbg ,_bbea ,_fbbe );};};
};};var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};
func _daea (_fbed string )([]byte ,error ){_agee :=_gd .MustCompile ("\u005b\u005e\u0061\u002d\u007a\u0041\u002d\u005a\u0030\u002d\u0039\u005d\u002b");_fbed =_agee .ReplaceAllString (_fbed ,"");_aebg :=[]rune (_fbed );_cga :=[]byte {};for _bdb :=len (_aebg )-2;
_bdb >=0;_bdb -=2{_bafd ,_cabd :=_geg .ParseUint (string (_aebg [_bdb ])+string (_aebg [_bdb +1]),16,8);if _cabd !=nil {return nil ,_cabd ;};_cga =append (_cga ,byte (_bafd ));};return _cga ,nil ;};func AdjustColorByShade (colorStr string ,shade float64 )string {var _ebc ,_dfg ,_bdea uint8 ;
_gae ,_ :=_e .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_ebc ,&_dfg ,&_bdea );if _gae !=3{return "";};return _aaa (_ebc ,shade )+_aaa (_dfg ,shade )+_aaa (_bdea ,shade );};func _dcede (_acec _agb .ST_SchemeColorVal ,_bbg *_agb .Theme )string {if _dbcf :=_bbg .ThemeElements ;
_dbcf !=nil {if _baba :=_dbcf .ClrScheme ;_baba !=nil {switch _acec {case _agb .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_baba .Lt1 );case _agb .ST_SchemeColorValDk1 ,_agb .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_baba .Dk1 );
case _agb .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_baba .Lt2 );case _agb .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_baba .Dk2 );case _agb .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_baba .Accent1 );case _agb .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_baba .Accent2 );
case _agb .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_baba .Accent3 );case _agb .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_baba .Accent4 );case _agb .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_baba .Accent5 );
case _agb .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_baba .Accent6 );};};};return "";};func GetImage (c *_be .Creator ,goImg _b .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_be .Image ,error ){if goImg ==nil {return nil ,nil ;
};_adea :=goImg .Bounds ().Size ();_cfda :=_adea .X ;_gcceg :=_adea .Y ;if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_cfda );};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_gcceg );};var _ceb _b .Rectangle ;switch part {case ImgPart_t :_ceb =_b .Rect (0,0,_cfda ,int (dividerY ));
case ImgPart_b :_ceb =_b .Rect (0,int (dividerY ),_cfda ,_gcceg );case ImgPart_l :_ceb =_b .Rect (0,0,int (dividerX ),_gcceg );case ImgPart_r :_ceb =_b .Rect (int (dividerX ),0,_cfda ,_gcceg );case ImgPart_lt :_ceb =_b .Rect (0,0,int (dividerX ),int (dividerY ));
case ImgPart_rt :_ceb =_b .Rect (int (dividerX ),0,_cfda ,int (dividerY ));case ImgPart_lb :_ceb =_b .Rect (0,int (dividerY ),int (dividerX ),_gcceg );case ImgPart_rb :_ceb =_b .Rect (int (dividerX ),int (dividerY ),_cfda ,_gcceg );default:_ceb =_b .Rect (0,0,_cfda ,_gcceg );
};_aafd :=CropImageByRect (goImg ,_ceb );_dcegc ,_gfcgd :=c .NewImageFromGoImage (_aafd );if _gfcgd !=nil {return nil ,_gfcgd ;};_dcegc .Scale (imgWidth /float64 (_cfda ),imgHeight /float64 (_gcceg ));_dcegc .SetPos (left ,top );return _dcegc ,nil ;};func RegisterEmbeddedFonts (d *_df .Document )error {_gbcfd :=d .FontTable ();
if _gbcfd ==nil {return nil ;};for _ ,_abdd :=range _gbcfd .Font {if _abdd .EmbedRegular !=nil {return _bcfg (d ,_abdd .NameAttr ,_abdd .EmbedRegular .IdAttr ,_abdd .EmbedRegular .FontKeyAttr );};if _abdd .EmbedBold !=nil {return _bcfg (d ,_abdd .NameAttr ,_abdd .EmbedBold .IdAttr ,_abdd .EmbedBold .FontKeyAttr );
};if _abdd .EmbedItalic !=nil {return _bcfg (d ,_abdd .NameAttr ,_abdd .EmbedItalic .IdAttr ,_abdd .EmbedItalic .FontKeyAttr );};if _abdd .EmbedBoldItalic !=nil {return _bcfg (d ,_abdd .NameAttr ,_abdd .EmbedBoldItalic .IdAttr ,_abdd .EmbedBoldItalic .FontKeyAttr );
};};return nil ;};func GetGroupOffsetFromXfrm (xfrm *_agb .CT_GroupTransform2D )(float64 ,float64 ){var _facaf ,_cecc float64 ;if xfrm .Off !=nil &&xfrm .ChOff !=nil {_facaf =_gc .FromEMU (FromSTCoordinate (xfrm .Off .XAttr ))-_gc .FromEMU (FromSTCoordinate (xfrm .ChOff .XAttr ));
_cecc =_gc .FromEMU (FromSTCoordinate (xfrm .Off .YAttr ))-_gc .FromEMU (FromSTCoordinate (xfrm .ChOff .YAttr ));};return _facaf ,_cecc ;};func RegisterFont (name string ,style FontStyle ,font *_fa .PdfFont ){_fgc ._edggf .Lock ();if _fgc ._aea [name ]==nil {_fgc ._aea [name ]=map[FontStyle ]*_fa .PdfFont {};
};_fgc ._aea [name ][style ]=font ;_fgc ._edggf .Unlock ();};func GetRegisteredFont (name string ,style FontStyle )*_fa .PdfFont {_fgc ._edggf .Lock ();defer _fgc ._edggf .Unlock ();if _efga ,_ffd :=_fgc ._aea [name ];_ffd {if _aafb ,_fbee :=_efga [style ];
_fbee {return _aafb ;};};return nil ;};func GetPageFromCreator (c *_be .Creator )(*_fa .PdfPage ,error ){_cead :=_cd .NewBuffer ([]byte {});_cbfe :=c .Write (_cead );if _cbfe !=nil {return nil ,_cbfe ;};_dbd :=_cd .NewReader (_cead .Bytes ());_ggac ,_cbfe :=_fa .NewPdfReader (_dbd );
if _cbfe !=nil {return nil ,_cbfe ;};return _ggac .GetPage (1);};func RegisterFontsFromFiles (files []string )error {for _ ,_cfe :=range files {if _ag .HasSuffix (_cfe ,"\u002e\u0074\u0074\u0066"){_beb :=_gecg (_cfe );if _beb !=nil {_gcg .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_beb );
continue ;};};};return nil ;};var _bfed =_bfaf (7.5);func (_dafc *creatorContext )drawLineChart (_fga *_da .CT_LineChart ,_eded *Rectangle ,_aeebc []*_da .CT_PlotAreaChoice1 ,_gabf float64 )([]*legendItem ,error ){_bcca :=[]*legendItem {};_aaac :=_fga .Ser ;
_cfd :=make (map[int ][]float64 );_bgab :=make (map[int ][]float64 );_bced :=make (map[int ]_be .Color );_dccd :=make (map[int ]float64 );for _feda ,_cba :=range _aaac {var _dagd string ;if _bdcf :=_cba .Tx ;_bdcf !=nil {if _gcee :=_bdcf .SerTxChoice ;
_gcee !=nil {if _gcee .V !=nil {_dagd =*_gcee .V ;}else if _gceb :=_gcee .StrRef ;_gceb !=nil {if _deb :=_gceb .StrCache ;_deb !=nil {for _ ,_aece :=range _deb .Pt {_dagd =_aece .V ;};};};};};_bced [_feda ]=_be .ColorWhite ;if _dcde :=_cba .SpPr ;_dcde !=nil {if _gbac :=_dcde .Ln ;
_gbac !=nil {if _gaec :=_gbac .WAttr ;_gaec !=nil {_dccd [_feda ]=_gc .FromEMU (int64 (*_gaec ));if _bdee :=_gbac .LineFillPropertiesChoice .SolidFill ;_bdee !=nil {_dgde :=_dafc .getPdfColorFromSolidFill (_bdee );if _dgde !=nil {_bced [_feda ]=_dgde ;
};};};};};if _bdcac :=_cba .Val ;_bdcac !=nil {if _ebdcf :=_bdcac .NumDataSourceChoice ;_ebdcf !=nil {if _gefb :=_ebdcf .NumRef ;_gefb !=nil {if _fca :=_gefb .NumCache ;_fca !=nil {for _ ,_cgac :=range _fca .Pt {_cfd [_feda ]=append (_cfd [_feda ],float64 (_cgac .IdxAttr ));
_gca ,_ :=_geg .ParseFloat (_ag .TrimSpace (_cgac .V ),64);_bgab [_feda ]=append (_bgab [_feda ],_gca );};};};};};_bcca =append (_bcca ,&legendItem {_bfdf :_dagd ,_fbe :_cba .SpPr });};_cacc :=true ;_ebcc :=true ;_ggge :="";_befd :="";if len (_aeebc )> 0{for _ ,_gfba :=range _aeebc {if _gfba .CatAx !=nil {if _gfba .CatAx .Delete !=nil {if !*(*_gfba .CatAx .Delete ).ValAttr {_cacc =false ;
};};_ggge =_dafc .getTitle (_gfba .CatAx .Title );}else if _gfba .ValAx !=nil {if _gfba .ValAx .Delete !=nil {if !*(*_gfba .ValAx .Delete ).ValAttr {_ebcc =false ;};};_befd =_dafc .getTitle (_gfba .ValAx .Title );};};};_aeac :=_ae .Style {Hidden :_cacc ,FontSize :8*_gabf };
_ecag :=_ae .Style {Hidden :_ebcc ,FontSize :8*_gabf };_gcgb :=&_cg .Chart {Series :[]_gdb .Series {},YAxisSecondary :_cg .YAxis {Style :_ecag ,Name :_befd ,NameStyle :_ecag },XAxis :_cg .XAxis {Style :_aeac ,Name :_ggge ,NameStyle :_aeac },YAxis :_cg .YAxis {Style :_ae .Style {Hidden :true }}};
for _aaefb :=0;_aaefb < len (_bced );_aaefb ++{_cbeea ,_cddd ,_aeef :=_bced [_aaefb ].ToRGB ();_cage :=_gdb .ContinuousSeries {XValues :_cfd [_aaefb ],YValues :_bgab [_aaefb ],Style :_ae .Style {StrokeColor :_c .RGBA {uint8 (_cbeea *255),uint8 (_cddd *255),uint8 (_aeef *255),255},StrokeWidth :_dccd [_aaefb ]}};
_gcgb .Series =append (_gcgb .Series ,_cage );};_gcgb .SetHeight (int (_gde .Abs (_eded .Top -_eded .Bottom )));_gcgb .SetWidth (int (_gde .Abs (_eded .Right -_eded .Left )));_bddb :=_dafc ._bcg ;_bfabg :=_be .NewChart (_gcgb );_bfabg .SetPos (_eded .Left ,_eded .Top );
_baea :=_bddb .Draw (_bfabg );if _baea !=nil {return nil ,_baea ;};return _bcca ,nil ;};func (_dbf *creatorContext )drawTitle (_aedb string ,_bae ,_ecbb float64 ){_faegg :=_dbf ._cbfc ;_cbee :=_dbf ._bcg .NewStyledParagraph ();_gcf :=_cbee .SetText (_aedb );
_acc ,_edd :=_fa .NewStandard14Font (_fa .HelveticaName );if _edd ==nil {_ggb :=_dbf ._bcg .NewTextStyle ();_ggb .Font =_acc ;_ggb .FontSize =14;_ggb .TextRise =0.4;_gcf .Style =_ggb ;_cbee .SetPos (_bae -_cbee .Width ()*_faegg /2,_ecbb );_dbf ._bcg .Draw (_cbee );
};};func (_daaef *creatorContext )drawRectangleWithProps (_fdfg *_agb .CT_ShapeProperties ,_gcdg ,_bfc ,_edcf ,_geae float64 ,_dabb bool ){_gecfc :=_daaef ._bcg .NewRectangle (_gcdg ,_bfc ,_edcf ,_geae );if _fdfg ==nil {if _dabb {_gecfc .SetBorderWidth (_afd );
}else {return ;};}else {_fgbg :=_daaef .getPdfColorFromSolidFill (_fdfg .FillPropertiesChoice .SolidFill );if _fgbg !=nil {_gecfc .SetFillColor (_fgbg );};if _badc :=_fdfg .Ln ;_badc !=nil {if _bggg :=_badc .WAttr ;_bggg !=nil {_bfad :=_gc .FromEMU (int64 (*_bggg ));
_gecfc .SetBorderWidth (_bfad );if _fbcg :=_badc .LineFillPropertiesChoice .SolidFill ;_fbcg !=nil {_dcebg :=_daaef .getPdfColorFromSolidFill (_fbcg );if _dcebg !=nil {_gecfc .SetBorderColor (_dcebg );};};}else {_gecfc .SetBorderWidth (0);};};};_daaef ._bcg .Draw (_gecfc );
};func GetDefaultPageSize ()_be .PageSize {return _eebgg [DefaultPageSize ]};func DrawRectangle (c *_be .Creator ,r *Rectangle ,w float64 ,color _be .Color ){if color ==nil {return ;};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );
DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};type ImgPart byte ;func (_eed *creatorContext )drawAxes (_gdcf []*_da .CT_PlotAreaChoice1 ,_acce ,_gcc ,_eegf float64 ,_aca []string ,_ddf *Rectangle ,_daaa bool )error {_cea :=_eed ._bcg ;
_bcc :=_eed ._cbfc ;if _gdcf ==nil {return _ad .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};var (_efg *_da .CT_ValAx ;_dae *_da .CT_CatAx ;_acb *_da .CT_DateAx ;_bfdff *_da .CT_SerAx ;
);for _ ,_bde :=range _gdcf {if _bde .ValAx !=nil {_efg =_bde .ValAx ;}else if _bde .CatAx !=nil {_dae =_bde .CatAx ;}else if _bde .DateAx !=nil {_acb =_bde .DateAx ;}else if _bde .SerAx !=nil {_bfdff =_bde .SerAx ;};};if _efg ==nil ||(_dae ==nil &&_acb ==nil &&_bfdff ==nil ){return _ad .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");
};var _edgd ,_gfa ,_dccc ,_gfcg uint32 ;var _ece ,_eegfe _da .ST_AxPos ;var _aeb ,_dbfa _da .ST_TickMark ;var _fbg ,_ffa *_da .CT_ChartLines ;var _dbe ,_gaf _da .ST_TickLblPos ;var _eae ,_efdc *_agb .CT_ShapeProperties ;var _bdef error ;_abc :=_ddf .Right -_ddf .Left ;
_ddcge :=_ddf .Bottom -_ddf .Top ;if _efg !=nil {_gfa ,_eegfe ,_dbfa ,_gaf ,_ffa ,_gfcg ,_efdc ,_bdef =_decd (_efg );};if _eegfe !=_da .ST_AxPosL &&_eegfe !=_da .ST_AxPosB {return _ad .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};_aee :=_gcc -_acce ;_ggdg :=int (_aee /_eegf )+1;var _cee ,_abcc float64 ;switch _dbfa {case _da .ST_TickMarkIn :_cee ,_abcc =_egabf ,0;case _da .ST_TickMarkOut :_cee ,_abcc =0,_egabf ;case _da .ST_TickMarkCross :_cee ,_abcc =_egabf ,_egabf ;};_cee =_cee *_bcc ;
_abcc =_abcc *_bcc ;var _gef *_agb .CT_ShapeProperties ;if _ffa !=nil {_gef =_ffa .SpPr ;};_cae ,_edb :=_dbe !=_da .ST_TickLblPosNone ,_gaf !=_da .ST_TickLblPosNone ;_efc :=_acce ;if _dae !=nil {_edgd ,_ece ,_aeb ,_dbe ,_fbg ,_dccc ,_eae ,_bdef =_ecc (_dae );
}else if _acb !=nil {_edgd ,_ece ,_aeb ,_dbe ,_fbg ,_dccc ,_eae ,_bdef =_fee (_acb );}else if _bfdff !=nil {_edgd ,_ece ,_aeb ,_dbe ,_fbg ,_dccc ,_eae ,_bdef =_cccb (_bfdff );};if _bdef !=nil {return _bdef ;};if _ece !=_da .ST_AxPosL &&_ece !=_da .ST_AxPosB {return _ad .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};if _edgd !=_gfcg ||_gfa !=_dccc {return _ad .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_agffg :=len (_aca )+1;var _ege ,_gdeb float64 ;switch _aeb {case _da .ST_TickMarkIn :_ege ,_gdeb =_egabf ,0;
case _da .ST_TickMarkOut :_ege ,_gdeb =0,_egabf ;case _da .ST_TickMarkCross :_ege ,_gdeb =_egabf ,_egabf ;};_ege =_ege *_bcc ;_gdeb =_gdeb *_bcc ;var _bbf *_agb .CT_ShapeProperties ;if _fbg !=nil {_bbf =_fbg .SpPr ;};if _daaa {_gcfd :=_ddcge /float64 (len (_aca ));
_acf :=_ddf .Left -_acce *_abc /_aee ;_cafd :=_acf -_bfed *_bcc ;if _cae {var _cge float64 ;for _bdgf :=0;_bdgf < _agffg ;_bdgf ++{_ddb :=_ddf .Bottom -float64 (_bdgf )*_gcfd ;if _bdgf < _agffg -1{_cfb :=_cea .NewParagraph (_aca [_bdgf ]);_cfb .SetFontSize (_ggcf *_bcc );
_cfb .SetPos (_cafd ,_ddb -_gcfd /2-_bab *_bcc );_cea .Draw (_cfb );_gee :=(_cfb .Width ()/1000-_bfed )*_bcc ;if _gee > 0&&_gee > _cge {_cge =_gee ;};};};if _cge > 0{_ddf .Left +=_cge +_ccb ;_acf =_ddf .Left -_acce *_abc /_aee ;_abc =_ddf .Right -_ddf .Left ;
};};_aedd :=_acf -_gdeb ;_gafg :=_acf +_ege ;_bgb :=_ddf .Left ;_bdd :=_ddf .Right ;for _afc :=0;_afc < _agffg ;_afc ++{_deaf :=_ddf .Bottom -float64 (_afc )*_gcfd ;_eed .drawLineWithProps (_eae ,_aedd ,_deaf ,_gafg ,_deaf ,true );_eed .drawLineWithProps (_bbf ,_bgb ,_deaf ,_bdd ,_deaf ,true );
};_fbga :=_abc /_aee ;_aagea :=_ddf .Bottom -_cee ;_fgb :=_ddf .Bottom +_abcc ;_dgd :=_ddf .Top ;_adee :=_ddf .Bottom ;for _egf :=0;_egf < _ggdg ;_egf ++{_bccf :=_ddf .Left +(_efc -_acce )*_fbga ;_eed .drawLineWithProps (_efdc ,_bccf ,_aagea ,_bccf ,_fgb ,true );
_eed .drawLineWithProps (_gef ,_bccf ,_dgd ,_bccf ,_adee ,true );if _edb {_gcb :=_cea .NewParagraph (_geg .FormatFloat (_efc ,'g',-1,64));_gcb .SetFontSize (_ggcf *_bcc );_gcb .SetPos (_bccf -_cdd *_bcc ,_adee +_bcbc *_bcc );_cea .Draw (_gcb );};_efc +=_eegf ;
};}else {_dafa :=_ddcge /_aee ;_gga :=_ddf .Left ;if _edb {var _fef float64 ;for _bccfd :=0;_bccfd < _ggdg ;_bccfd ++{_aafg :=_ddf .Bottom -(_efc -_acce )*_dafa ;_deda :=_cea .NewParagraph (_geg .FormatFloat (_efc ,'g',-1,64));_deda .SetFontSize (_ggcf *_bcc );
_deda .SetPos (_gga -_bfed *_bcc ,_aafg -_bab *_bcc );_cea .Draw (_deda );_fcdf :=(_deda .Width ()/1000-_bfed )*_bcc ;if _fcdf > 0&&_fcdf > _fef {_fef =_fcdf ;};_efc +=_eegf ;};if _fef > 0{_ddf .Left +=_fef +_ccb ;_abc =_ddf .Right -_ddf .Left ;};};_efc =_acce ;
_cbfa :=_ddf .Left -_abcc ;_gab :=_ddf .Left +_cee ;_gga =_ddf .Left ;_eeda :=_ddf .Right ;for _bbe :=0;_bbe < _ggdg ;_bbe ++{_cecf :=_ddf .Bottom -(_efc -_acce )*_dafa ;_eed .drawLineWithProps (_efdc ,_cbfa ,_cecf ,_gab ,_cecf ,true );_eed .drawLineWithProps (_gef ,_gga ,_cecf ,_eeda ,_cecf ,true );
_efc +=_eegf ;};_fafg :=_abc /float64 (len (_aca ));_ebeg :=_ddf .Bottom +_acce *_ddcge /_aee ;_adc :=_ebeg -_ege ;_ced :=_ebeg +_gdeb ;_dabd :=_ddf .Top ;_aad :=_ddf .Bottom ;_gddae :=_ebeg +_bcbc *_bcc ;for _ebff :=0;_ebff < _agffg ;_ebff ++{_dgb :=_ddf .Left +float64 (_ebff )*_fafg ;
_eed .drawLineWithProps (_eae ,_dgb ,_adc ,_dgb ,_ced ,true );_eed .drawLineWithProps (_bbf ,_dgb ,_dabd ,_dgb ,_aad ,true );if _cae &&_ebff < _agffg -1{_cfga :=_cea .NewParagraph (_aca [_ebff ]);_cfga .SetFontSize (_ggcf *_bcc );_cfga .SetPos (_dgb +_fgeb *_bcc ,_gddae );
_cea .Draw (_cfga );};};};return nil ;};func MakeTempCreator (width ,height float64 )*_be .Creator {_ddgg :=_be .New ();_ddgg .SetPageSize (_be .PageSize {width ,height });_ddgg .SetPageMargins (0,0,0,0);return _ddgg ;};func _fcgf (_eaf ,_bcdd ,_aedf float64 )(uint8 ,uint8 ,uint8 ){var _dgdb float64 ;
if _aedf < 0.5{_dgdb =_aedf *(1+_bcdd );}else {_dgdb =_aedf +_bcdd -_aedf *_bcdd ;};_gdcac :=_aedf *2-_dgdb ;_eaf /=360.0;_acbg :=_fag (_eaf +1.0/3.0);_abbef :=_fag (_eaf );_dbcfd :=_fag (_eaf -1.0/3.0);_cce :=_ecdf (_acbg ,_dgdb ,_gdcac );_cgee :=_ecdf (_abbef ,_dgdb ,_gdcac );
_gfcgf :=_ecdf (_dbcfd ,_dgdb ,_gdcac );return uint8 (255*_cce ),uint8 (255*_cgee ),uint8 (255*_gfcgf );};func _cccb (_gba *_da .CT_SerAx )(uint32 ,_da .ST_AxPos ,_da .ST_TickMark ,_da .ST_TickLblPos ,*_da .CT_ChartLines ,uint32 ,*_agb .CT_ShapeProperties ,error ){var _eedb ,_gcce uint32 ;
var _dac _da .ST_AxPos ;var _gaba _da .ST_TickMark ;var _cdde *_da .CT_ChartLines ;var _bbdd _da .ST_TickLblPos ;if _gba .AxId ==nil {return _eedb ,_dac ,_gaba ,_bbdd ,_cdde ,_gcce ,_gba .SpPr ,_ad .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_eedb =_gba .AxId .ValAttr ;};if _gba .AxPos ==nil {return _eedb ,_dac ,_gaba ,_bbdd ,_cdde ,_gcce ,_gba .SpPr ,_ad .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_dac =_gba .AxPos .ValAttr ;
};if _gba .MajorTickMark !=nil {_gaba =_gba .MajorTickMark .ValAttr ;};if _gba .TickLblPos !=nil {_bbdd =_gba .TickLblPos .ValAttr ;};if _gba .CrossAx ==nil {return _eedb ,_dac ,_gaba ,_bbdd ,_cdde ,_gcce ,_gba .SpPr ,_ad .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_gcce =_gba .CrossAx .ValAttr ;};_cdde =_gba .MajorGridlines ;return _eedb ,_dac ,_gaba ,_bbdd ,_cdde ,_gcce ,_gba .SpPr ,nil ;};type Rectangle struct{Top float64 ;Bottom float64 ;Left float64 ;Right float64 ;};func (_bbgg *creatorContext )drawPieChart (_dfdg *_da .CT_PieChart ,_fggb *Rectangle ,_abcad *_gdd .Workbook ,_dfeb float64 )([]*legendItem ,error ){_gbf :=[]*legendItem {};
_febd :=map[string ]serCategory {};_addc :=[]string {};_afdc :=_gde .Inf (1);_accef :=_gde .Inf (-1);_bfeb :=_dfdg .Ser ;for _ ,_bdfb :=range _bfeb {var _abccd string ;if _egaf :=_bdfb .Tx ;_egaf !=nil {if _afcf :=_egaf .SerTxChoice ;_afcf !=nil {if _afcf .V !=nil {_abccd =*_afcf .V ;
}else if _beaecb :=_afcf .StrRef ;_beaecb !=nil {if _dcdec :=_beaecb .StrCache ;_dcdec !=nil {for _ ,_dfde :=range _dcdec .Pt {_abccd =_dfde .V ;};};};};};if _eaac :=_bdfb .Cat ;_eaac !=nil {if _caff :=_eaac .AxDataSourceChoice ;_caff !=nil {if _cffc :=_caff .StrRef ;
_cffc !=nil {if _cfcc :=_cffc .F ;_cfcc !=""&&_abcad !=nil {_egadg ,_dfgc ,_ffag ,_aafc :=ParseExcelRange (_cfcc );if _aafc ==nil {for _ ,_dca :=range _abcad .Sheets (){if _dca .Name ()==_ag .Trim (_egadg ,"\u0027"){_agcd :=_dfgc .String ();for _bcff :=_dfgc .RowIdx ;
_bcff <=_ffag .RowIdx ;_bcff +=1{_ecdfb :=_ag .ReplaceAll (_agcd ,_e .Sprint (_dfgc .RowIdx ),_e .Sprint (_bcff ));_bbgg .addCatName (_dca .Cell (_ecdfb ).GetString (),_febd ,&_addc );};break ;};};};};if _fgfc :=_cffc .StrCache ;_fgfc !=nil {for _ ,_cfbb :=range _fgfc .Pt {_bbgg .addCatName (_cfbb .V ,_febd ,&_addc );
};};}else if _gbdc :=_caff .NumRef ;_gbdc !=nil {if _ebffa :=_gbdc .NumCache ;_ebffa !=nil {var _dcg string ;if _ebffa .FormatCode !=nil {_dcg =*_ebffa .FormatCode ;};for _ ,_efcf :=range _ebffa .Pt {var _ccdd string ;if _efcf .FormatCodeAttr ==nil {_ccdd =_dcg ;
}else {_ccdd =*_efcf .FormatCodeAttr ;};var _dbeb string ;_bbb ,_geff :=_geg .ParseFloat (_efcf .V ,64);if _geff !=nil {_dbeb =_efcf .V ;}else {_dbeb =_gf .Number (_bbb ,_ccdd );};_bbgg .addCatName (_dbeb ,_febd ,&_addc );};};};};};if _aaea :=_bdfb .Val ;
_aaea !=nil {if _ddeaa :=_aaea .NumDataSourceChoice ;_ddeaa !=nil {if _aefd :=_ddeaa .NumRef ;_aefd !=nil {if _cceg :=_aefd .F ;_cceg !=""&&_abcad !=nil {_cgcc ,_faec ,_eadb ,_ceea :=ParseExcelRange (_cceg );if _ceea ==nil {for _ ,_efgag :=range _abcad .Sheets (){if _efgag .Name ()==_ag .Trim (_cgcc ,"\u0027"){_dbea :=_faec .String ();
for _cbd :=_faec .RowIdx ;_cbd <=_eadb .RowIdx ;_cbd +=1{_ebcg :=_ag .ReplaceAll (_dbea ,_e .Sprint (_faec .RowIdx ),_e .Sprint (_cbd ));if _efgag .FormulaContext ().HasFormula (_ebcg ){_cgfe :=_bc .NewEvaluator ();_aged :=_efgag .FormulaContext ().Cell (_ebcg ,_cgfe );
_fda :=_aged .Value ();_bbgg .addCatValue (_fda ,_febd ,_addc ,(int )(_cbd -_faec .RowIdx ),&_afdc ,&_accef ,_abccd ,_bdfb .SpPr );}else {_fff :=_efgag .Cell (_ebcg ).GetString ();_bbgg .addCatValue (_fff ,_febd ,_addc ,(int )(_cbd -_faec .RowIdx ),&_afdc ,&_accef ,_abccd ,_bdfb .SpPr );
};};break ;};};};};if _egfg :=_aefd .NumCache ;_egfg !=nil {for _abba ,_ecagg :=range _egfg .Pt {_bbgg .addCatValue (_ecagg .V ,_febd ,_addc ,_abba ,&_afdc ,&_accef ,_abccd ,_bdfb .SpPr );};};};};};};_gecf :=&_cg .PieChart {Values :[]_gdb .Value {}};for _ ,_cfea :=range _addc {_adga :=_febd [_cfea ];
if len (_adga ._ead )> 0{_gecf .Values =append (_gecf .Values ,_gdb .Value {Value :_adga ._ead [0]._abbe ,Label :_cfea ,Style :_ae .Style {FontSize :12*_dfeb }});};};_gecf .SetHeight (int (_fggb .Top -_fggb .Bottom ));_gecf .SetWidth (int (_fggb .Right -_fggb .Left ));
_ddeg :=_bbgg ._bcg ;_gdcg :=_be .NewChart (_gecf );_gdcg .SetPos (_fggb .Left ,_fggb .Top );_fbcb :=_ddeg .Draw (_gdcg );if _fbcb !=nil {return nil ,_fbcb ;};return _gbf ,nil ;};func (_egbbg FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_egbbg )];
};type creatorContext struct{_bcg *_be .Creator ;_gegb *_agb .Theme ;_cbfc float64 ;};var _bab =_bfaf (1.5);func MakeBlockFromChartSpace (cs *_da .ChartSpace ,width ,height float64 ,theme *_agb .Theme )(*_be .Block ,error ){_gaaf ,_ebb :=_bdg (cs ,width ,height ,theme ,false ,nil );
if _ebb !=nil {return nil ,_ebb ;};_egab ,_ebb :=GetPageFromCreator (_gaaf );if _ebb !=nil {return nil ,_ebb ;};_ded ,_ebb :=_be .NewBlockFromPage (_egab );if _ebb !=nil {return nil ,_ebb ;};return _ded ,nil ;};func (_ee *creatorContext )drawAreaChart (_eg *_da .CT_AreaChart ,_gdba *Rectangle ,_cdb []*_da .CT_PlotAreaChoice1 ,_fac float64 )([]*legendItem ,error ){_cec :=[]*legendItem {};
_ceg :=_eg .Ser ;_cgd :=make (map[int ][]float64 );_bcf :=make (map[int ][]float64 );_bce :=make (map[int ]_be .Color );for _cgb ,_dbg :=range _ceg {_bce [_cgb ]=_be .ColorWhite ;if _bg :=_dbg .SpPr ;_bg !=nil {_eba :=_ee .getPdfColorFromSolidFill (_bg .FillPropertiesChoice .SolidFill );
if _eba !=nil {_bce [_cgb ]=_eba ;};};if _ca :=_dbg .Val ;_ca !=nil {if _egc :=_ca .NumDataSourceChoice ;_egc !=nil {if _fd :=_egc .NumRef ;_fd !=nil {if _ec :=_fd .NumCache ;_ec !=nil {for _ ,_fb :=range _ec .Pt {_cgd [_cgb ]=append (_cgd [_cgb ],float64 (_fb .IdxAttr ));
_ea ,_ :=_geg .ParseFloat (_ag .TrimSpace (_fb .V ),64);_bcf [_cgb ]=append (_bcf [_cgb ],_ea );};};};};};};_eeb :=true ;_aa :="";_dg :="";if len (_cdb )> 1{if _cdb [0].ValAx !=nil &&_cdb [1].ValAx !=nil {if _cdb [0].ValAx .Delete !=nil &&_cdb [1].ValAx .Delete !=nil {if !*(*_cdb [0].ValAx .Delete ).ValAttr &&!*(*_cdb [1].ValAx .Delete ).ValAttr {_eeb =false ;
};};_aa =_ee .getTitle (_cdb [0].ValAx .Title );_dg =_ee .getTitle (_cdb [1].ValAx .Title );};};_eeg :=_ae .Style {Hidden :_eeb ,FontSize :8*_fac };_aae :=&_cg .Chart {Series :[]_gdb .Series {},YAxisSecondary :_cg .YAxis {Style :_eeg ,Name :_dg ,NameStyle :_eeg },XAxis :_cg .XAxis {Style :_eeg ,Name :_aa ,NameStyle :_eeg },YAxis :_cg .YAxis {Style :_ae .Style {Hidden :true }}};
for _adg :=0;_adg < len (_bce );_adg ++{_gg ,_ga ,_cdg :=_bce [_adg ].ToRGB ();_ef :=_gdb .ContinuousSeries {XValues :_cgd [_adg ],YValues :_bcf [_adg ],Style :_ae .Style {StrokeWidth :1,FillColor :_c .RGBA {uint8 (_gg *255),uint8 (_ga *255),uint8 (_cdg *255),255}}};
_aae .Series =append (_aae .Series ,_ef );};_aae .SetHeight (int (_gde .Abs (_gdba .Top -_gdba .Bottom )));_aae .SetWidth (int (_gde .Abs (_gdba .Right -_gdba .Left )));_dag :=_ee ._bcg ;_cc :=_be .NewChart (_aae );_cc .SetPos (_gdba .Left ,_gdba .Top );
_de :=_dag .Draw (_cc );if _de !=nil {return nil ,_de ;};return _cec ,nil ;};func MakeBlockFromCreator (c *_be .Creator )(*_be .Block ,error ){_gccac ,_ebgd :=GetPageFromCreator (c );if _ebgd !=nil {return nil ,_ebgd ;};_abg ,_ebgd :=_be .NewBlockFromPage (_gccac );
if _ebgd !=nil {return nil ,_ebgd ;};return _abg ,nil ;};func (_cabc *Rectangle )Translate (x ,y float64 ){_cabc .Left +=x ;_cabc .Right +=x ;_cabc .Top +=y ;_cabc .Bottom +=y ;};func MakeImageFromChartSpace (cs *_da .ChartSpace ,width ,height float64 ,theme *_agb .Theme ,workbook *_gdd .Workbook )(_b .Image ,error ){_aed ,_gbc :=_bdg (cs ,width ,height ,theme ,true ,workbook );
if _gbc !=nil {return nil ,_gbc ;};_egad ,_gbc :=GetPageFromCreator (_aed );if _gbc !=nil {return nil ,_gbc ;};return _f .NewImageDevice ().Render (_egad );};func (_bba *creatorContext )addCatName (_dec string ,_agf map[string ]serCategory ,_faeg *[]string ){if _ ,_dabc :=_agf [_dec ];
!_dabc {_agf [_dec ]=serCategory {_beaec :_dec ,_ead :[]serValue {}};*_faeg =append (*_faeg ,_dec );};};func _decd (_bddf *_da .CT_ValAx )(uint32 ,_da .ST_AxPos ,_da .ST_TickMark ,_da .ST_TickLblPos ,*_da .CT_ChartLines ,uint32 ,*_agb .CT_ShapeProperties ,error ){var _aeeb ,_feed uint32 ;
var _fdb _da .ST_AxPos ;var _dced _da .ST_TickMark ;var _gdef *_da .CT_ChartLines ;var _abcg _da .ST_TickLblPos ;if _bddf .AxId ==nil {return _aeeb ,_fdb ,_dced ,_abcg ,_gdef ,_feed ,_bddf .SpPr ,_ad .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_aeeb =_bddf .AxId .ValAttr ;};if _bddf .AxPos ==nil {return _aeeb ,_fdb ,_dced ,_abcg ,_gdef ,_feed ,_bddf .SpPr ,_ad .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_fdb =_bddf .AxPos .ValAttr ;
};if _bddf .MajorTickMark !=nil {_dced =_bddf .MajorTickMark .ValAttr ;};if _bddf .TickLblPos !=nil {_abcg =_bddf .TickLblPos .ValAttr ;};if _bddf .CrossAx ==nil {return _aeeb ,_fdb ,_dced ,_abcg ,_gdef ,_feed ,_bddf .SpPr ,_ad .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_feed =_bddf .CrossAx .ValAttr ;};_gdef =_bddf .MajorGridlines ;return _aeeb ,_fdb ,_dced ,_abcg ,_gdef ,_feed ,_bddf .SpPr ,nil ;};type BorderPosition byte ;var (DefaultFontSize =12.0;DefaultImageEncoder _db .StreamEncoder ;DefaultPageSize =PageSizeA4 ;
_eebgg =map[PageSize ]_be .PageSize {PageSizeA3 :_be .PageSizeA3 ,PageSizeA4 :_be .PageSizeA4 ,PageSizeA5 :_be .PageSizeA5 ,PageSizeLetter :_be .PageSizeLetter ,PageSizeLegal :_be .PageSizeLegal };);func _fag (_age float64 )float64 {if _age < 0{_age +=float64 (-int (_age )+1);
}else if _age > 1{_age -=float64 (int (_age ));};return _age ;};var _afd =_bfaf (0.125);func (_eda *Rectangle )scale (_acg float64 ){_eda .Top *=_acg ;_eda .Bottom *=_acg ;_eda .Left *=_acg ;_eda .Right *=_acg ;};type FontStyle byte ;func (_ddcg barSerByOrder )Swap (i ,j int ){_ddcg [i ],_ddcg [j ]=_ddcg [j ],_ddcg [i ]};
func IsNoSpaceLanguage (symbol string )bool {for _ ,_aef :=range symbol {if _a .Is (_a .Han ,_aef ){return true ;};};return false ;};func GetDataFromXfrm (xfrm *_agb .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _abdg ,_gdfd ,_bca ,_cafda float64 ;
if _eafe :=xfrm .Off ;_eafe !=nil {_abdg =_gc .FromEMU (FromSTCoordinate (_eafe .XAttr ));_gdfd =_gc .FromEMU (FromSTCoordinate (_eafe .YAttr ));};if _gfcc :=xfrm .Ext ;_gfcc !=nil {_bca =_gc .FromEMU (_gfcc .CxAttr );_cafda =_gc .FromEMU (_gfcc .CyAttr );
};return _abdg ,_gdfd ,_bca ,_cafda ;};func _gecg (_cfa string )error {if !_ag .HasSuffix (_cfa ,"\u002e\u0074\u0074\u0066"){_gcg .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return _e .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_ffb ,_eebc :=_bd .ParseFile (_cfa );if _eebc !=nil {_gcg .Log .Debug ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020T\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_eebc );return _eebc ;};_dgea ,_eebc :=_fa .NewCompositePdfFontFromTTFFile (_cfa );
if _eebc !=nil {return _eebc ;};_cacb :=_ffb .GetNameRecords ();for _ ,_ccgg :=range _cacb {_cdfc :=_ccgg [1];if _cdfc ==""{continue ;};_cabe :=make ([]byte ,0);for _dged :=0;_dged < len (_cdfc );_dged ++{if _cdfc [_dged ]==39||_cdfc [_dged ]==92{continue ;
};_gggg :=4;if _dged +_gggg < len (_cdfc ){if _cdfc [_dged :_dged +_gggg ]=="\u0000"{_dged =_dged +_gggg +1;continue ;};};_cabe =append (_cabe ,_cdfc [_dged ]);};_cdfc =_ag .Replace (string (_cabe ),"\u0078\u0030\u0030","",-1);_efgg :=_ccgg [2];if _efgg ==""{return _e .Errorf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_cfa );
};_cabe =make ([]byte ,0);for _bgd :=0;_bgd < len (_efgg );_bgd ++{if _efgg [_bgd ]==39||_efgg [_bgd ]==92{continue ;};_ageeb :=4;if _bgd +_ageeb < len (_efgg ){if _efgg [_bgd :_bgd +_ageeb ]=="\u0000"{_bgd =_bgd +_ageeb +1;continue ;};};_cabe =append (_cabe ,_efgg [_bgd ]);
};_efgg =_ag .Replace (string (_cabe ),"\u0078\u0030\u0030","",-1);RegisterFont (_cdfc ,_baccb [_efgg ],_dgea );};return nil ;};func DrawLine (c *_be .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _be .Color ){if color ==nil {return ;};_ecg :=c .NewLine (x0 ,y0 ,x1 ,y1 );
_ecg .SetLineWidth (width );_ecg .SetColor (color );c .Draw (_ecg );};func GetPageDimensions (size PageSize )_be .PageSize {return _eebgg [size ]};func Lighten (clr float64 )float64 {return 0.6+0.4*clr };func CropImageByRect (sourceImg _b .Image ,rect _b .Rectangle )_b .Image {_gddac ,_ebage ,_bedg ,_cgef :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;
_egbg :=_b .NewNRGBA (_b .Rect (0,0,_bedg -_gddac ,_cgef -_ebage ));for _edag :=_gddac ;_edag < _bedg ;_edag ++{for _geeg :=_ebage ;_geeg < _cgef ;_geeg ++{_egbg .Set (_edag -_gddac ,_geeg -_ebage ,sourceImg .At (_edag ,_geeg ));};};return _egbg ;};func RegisterFontsFromDirectory (dirName string )error {_adge ,_cff :=_ce .Open (dirName );
if _cff !=nil {return _cff ;};defer _adge .Close ();_cefd ,_cff :=_adge .Readdirnames (0);if _cff !=nil {return _cff ;};for _ ,_ccfgf :=range _cefd {if _ag .HasSuffix (_ccfgf ,"\u002e\u0074\u0074\u0066"){_cac :=dirName +"\u002f"+_ccfgf ;_gecc :=_gecg (_cac );
if _gecc !=nil {_gcg .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_gecc );
continue ;};};};return nil ;};func FromSTPercentage (st *_agb .ST_Percentage )float64 {if _eaab :=st .ST_PercentageDecimal ;_eaab !=nil {return float64 (*_eaab )/Percent100 ;};return 0;};func (_fbbg *creatorContext )addCatValue (_add string ,_fcg map[string ]serCategory ,_efa []string ,_cbe int ,_ggfd ,_bdf *float64 ,_agff string ,_ebdc *_agb .CT_ShapeProperties ){_cca ,_bfd :=_geg .ParseFloat (_add ,64);
if _bfd !=nil {_cca =0;_gcg .Log .Debug ("\u0070a\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_bfd );};if _cca > *_bdf {*_bdf =_cca ;};if _cca < *_ggfd {*_ggfd =_cca ;};_bfdd :=_fcg [_efa [_cbe ]];_bfdd ._ead =append (_bfdd ._ead ,serValue {_ggd :_agff ,_abbe :_cca ,_eee :_ebdc });
_fcg [_efa [_cbe ]]=_bfdd ;};type barSerByOrder []*_da .CT_BarSer ;type fontsMap struct{_edggf *_g .Mutex ;_aea map[string ]map[FontStyle ]*_fa .PdfFont ;};func AssignStdFontByName (style _be .TextStyle ,fontName string )*_fa .PdfFont {_dfdd :=_fa .StdFontName (fontName );
return _fa .NewStandard14FontMustCompile (_dfdd );};const (ImgPart_whole ImgPart =0;ImgPart_t ImgPart =1;ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;ImgPart_rt ImgPart =6;ImgPart_lb ImgPart =7;ImgPart_rb ImgPart =8;
);func (_fde barSerByOrder )Len ()int {return len (_fde )};func (_gbcf *creatorContext )getTitle (_gcga *_da .CT_Title )string {_faf :="";if _gcga !=nil &&_gcga .Tx !=nil &&_gcga .Tx .TxChoice !=nil &&_gcga .Tx .TxChoice .Rich !=nil {if len (_gcga .Tx .TxChoice .Rich .P )> 0{for _ ,_fabg :=range _gcga .Tx .TxChoice .Rich .P {if len (_fabg .EG_TextRun )> 0{_faf +="\u000a"+_fabg .EG_TextRun [0].TextRunChoice .R .T ;
};};};};return _faf ;};func _fee (_bfa *_da .CT_DateAx )(uint32 ,_da .ST_AxPos ,_da .ST_TickMark ,_da .ST_TickLblPos ,*_da .CT_ChartLines ,uint32 ,*_agb .CT_ShapeProperties ,error ){var _bdfa ,_bef uint32 ;var _cbeg _da .ST_AxPos ;var _dgdc _da .ST_TickMark ;
var _agd *_da .CT_ChartLines ;var _aba _da .ST_TickLblPos ;if _bfa .AxId ==nil {return _bdfa ,_cbeg ,_dgdc ,_aba ,_agd ,_bef ,_bfa .SpPr ,_ad .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_bdfa =_bfa .AxId .ValAttr ;
};if _bfa .AxPos ==nil {return _bdfa ,_cbeg ,_dgdc ,_aba ,_agd ,_bef ,_bfa .SpPr ,_ad .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_cbeg =_bfa .AxPos .ValAttr ;};if _bfa .MajorTickMark !=nil {_dgdc =_bfa .MajorTickMark .ValAttr ;
};if _bfa .TickLblPos !=nil {_aba =_bfa .TickLblPos .ValAttr ;};if _bfa .CrossAx ==nil {return _bdfa ,_cbeg ,_dgdc ,_aba ,_agd ,_bef ,_bfa .SpPr ,_ad .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_bef =_bfa .CrossAx .ValAttr ;
};_agd =_bfa .MajorGridlines ;return _bdfa ,_cbeg ,_dgdc ,_aba ,_agd ,_bef ,_bfa .SpPr ,nil ;};const _ggcf =6.0;func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_gc .Twips *10+0.5))/10;};func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _fdbd ,_eca ,_ccce uint8 ;
_ggbd ,_ :=_e .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_fdbd ,&_eca ,&_ccce );if _ggbd !=3{return "";};_gdca ,_cab ,_ecbg :=_cgde (_fdbd ,_eca ,_ccce );_ecbg =lum *_ecbg ;_fdbd ,_eca ,_ccce =_fcgf (_gdca ,_cab ,_ecbg );
return _e .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_fdbd ,_eca ,_ccce );};var _baccb =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };
func ParseExcelRange (s string )(string ,_eb .CellReference ,_eb .CellReference ,error ){_bdcb :=_ag .FieldsFunc (s ,func (_ebbf rune )bool {return _ebbf ==':'||_ebbf =='!'});if len (_bdcb )==3{_beca ,_bgag :=_eb .ParseCellReference (_bdcb [1]);if _bgag !=nil {return "",_eb .CellReference {},_eb .CellReference {},_bgag ;
};_gbe ,_bgag :=_eb .ParseCellReference (_bdcb [2]);if _bgag !=nil {return "",_eb .CellReference {},_eb .CellReference {},_bgag ;};return _bdcb [0],_beca ,_gbe ,nil ;};return "",_eb .CellReference {},_eb .CellReference {},_ad .New ("\u0065r\u0072\u006f\u0072\u0020p\u0061\u0072\u0073\u0069\u006eg\u0020e\u0078c\u0065\u006c\u0020\u0072\u0061\u006e\u0067e");
};func LoadFontFromFile (filename string )(*_fa .PdfFont ,error ){if !_ag .HasSuffix (filename ,"\u002e\u0074\u0074\u0066"){_gcg .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return nil ,_e .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_cced ,_adgc :=_fa .NewCompositePdfFontFromTTFFile (filename );if _adgc !=nil {return nil ,_adgc ;};return _cced ,nil ;};func _bgbb (_cefg uint8 ,_fce float64 )string {_gdcc :=float64 (_cefg );var _cecd float64 ;if _fce < 0{_cecd =_gdcc *(1+_fce );}else {_cecd =_gdcc +(255-_gdcc )*_fce ;
};return _e .Sprintf ("\u0025\u0030\u0032\u0078",int (_cecd ));};func ClearRegisteredFonts (){_fgc ._edggf .Lock ();_fgc ._aea =map[string ]map[FontStyle ]*_fa .PdfFont {};_fgc ._edggf .Unlock ();};func MakeTempCreatorMaxHeight (width float64 )*_be .Creator {return MakeTempCreator (width ,MaxPageHeight );
};