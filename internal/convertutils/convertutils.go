//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_a "bytes";_ge "errors";_f "fmt";_aa "github.com/unidoc/unichart";_ee "github.com/unidoc/unichart/dataset";_fef "github.com/unidoc/unichart/render";_ffc "github.com/unidoc/unioffice/v2/common/logger";_cd "github.com/unidoc/unioffice/v2/document";
_bg "github.com/unidoc/unioffice/v2/measurement";_df "github.com/unidoc/unioffice/v2/schema/soo/dml";_acf "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_cfg "github.com/unidoc/unioffice/v2/spreadsheet";_eg "github.com/unidoc/unioffice/v2/spreadsheet/format";
_ff "github.com/unidoc/unioffice/v2/spreadsheet/formula";_cf "github.com/unidoc/unioffice/v2/spreadsheet/reference";_gb "github.com/unidoc/unipdf/v4/core";_ed "github.com/unidoc/unipdf/v4/creator";_ac "github.com/unidoc/unipdf/v4/model";_bc "github.com/unidoc/unipdf/v4/render";
_fe "github.com/unidoc/unitype";_be "image";_d "image/color";_cg "math";_de "os";_gd "regexp";_c "sort";_ad "strconv";_eb "strings";_e "sync";_g "unicode";);func (_bfef *creatorContext )drawRectangleWithProps (_egef *_df .CT_ShapeProperties ,_daff ,_egbc ,_fbfe ,_eea float64 ,_abbc bool ){_gcaa :=_bfef ._aga .NewRectangle (_daff ,_egbc ,_fbfe ,_eea );
if _egef ==nil {if _abbc {_gcaa .SetBorderWidth (_ccb );}else {return ;};}else {_bcbd :=_bfef .getPdfColorFromSolidFill (_egef .FillPropertiesChoice .SolidFill );if _bcbd !=nil {_gcaa .SetFillColor (_bcbd );};if _bbffc :=_egef .Ln ;_bbffc !=nil {if _cdbd :=_bbffc .WAttr ;
_cdbd !=nil {_dee :=_bg .FromEMU (int64 (*_cdbd ));_gcaa .SetBorderWidth (_dee );if _ddcb :=_bbffc .LineFillPropertiesChoice .SolidFill ;_ddcb !=nil {_gee :=_bfef .getPdfColorFromSolidFill (_ddcb );if _gee !=nil {_gcaa .SetBorderColor (_gee );};};}else {_gcaa .SetBorderWidth (0);
};};};_bfef ._aga .Draw (_gcaa );};func _egg (_fgd *_acf .CT_CatAx )(uint32 ,_acf .ST_AxPos ,_acf .ST_TickMark ,_acf .ST_TickLblPos ,*_acf .CT_ChartLines ,uint32 ,*_df .CT_ShapeProperties ,error ){var _gfd ,_efee uint32 ;var _edae _acf .ST_AxPos ;var _efd _acf .ST_TickMark ;
var _cab *_acf .CT_ChartLines ;var _abg _acf .ST_TickLblPos ;if _fgd .AxId ==nil {return _gfd ,_edae ,_efd ,_abg ,_cab ,_efee ,_fgd .SpPr ,_ge .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_gfd =_fgd .AxId .ValAttr ;
};if _fgd .AxPos ==nil {return _gfd ,_edae ,_efd ,_abg ,_cab ,_efee ,_fgd .SpPr ,_ge .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_edae =_fgd .AxPos .ValAttr ;};if _fgd .MajorTickMark !=nil {_efd =_fgd .MajorTickMark .ValAttr ;
};if _fgd .TickLblPos !=nil {_abg =_fgd .TickLblPos .ValAttr ;};if _fgd .CrossAx ==nil {return _gfd ,_edae ,_efd ,_abg ,_cab ,_efee ,_fgd .SpPr ,_ge .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_efee =_fgd .CrossAx .ValAttr ;
};_cab =_fgd .MajorGridlines ;return _gfd ,_edae ,_efd ,_abg ,_cab ,_efee ,_fgd .SpPr ,nil ;};var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};
func GetOpacityFromColorTransform (trs []*_df .EG_ColorTransform )float64 {for _ ,_cba :=range trs {if _cba !=nil {if _gfa :=_cba .ColorTransformChoice .Alpha ;_gfa !=nil {if _gdd :=_gfa .ValAttr .ST_PositiveFixedPercentageDecimal ;_gdd !=nil {return float64 (*_gdd )/Percent100 ;
};};};};return 1.0;};func MakeBlockFromCreator (c *_ed .Creator )(*_ed .Block ,error ){_afff ,_adgg :=GetPageFromCreator (c );if _adgg !=nil {return nil ,_adgg ;};_cbeb ,_adgg :=_ed .NewBlockFromPage (_afff );if _adgg !=nil {return nil ,_adgg ;};return _cbeb ,nil ;
};func (_fa *creatorContext )drawAreaChart (_fg *_acf .CT_AreaChart ,_ab *Rectangle ,_gf []*_acf .CT_PlotAreaChoice1 ,_gc float64 )([]*legendItem ,error ){_fea :=[]*legendItem {};_ca :=_fg .Ser ;_gg :=make (map[int ][]float64 );_dg :=make (map[int ][]float64 );
_aab :=make (map[int ]_ed .Color );for _cgb ,_eeb :=range _ca {_aab [_cgb ]=_ed .ColorWhite ;if _acg :=_eeb .SpPr ;_acg !=nil {_da :=_fa .getPdfColorFromSolidFill (_acg .FillPropertiesChoice .SolidFill );if _da !=nil {_aab [_cgb ]=_da ;};};if _gge :=_eeb .Val ;
_gge !=nil {if _ae :=_gge .NumDataSourceChoice ;_ae !=nil {if _fd :=_ae .NumRef ;_fd !=nil {if _fc :=_fd .NumCache ;_fc !=nil {for _ ,_gfg :=range _fc .Pt {_gg [_cgb ]=append (_gg [_cgb ],float64 (_gfg .IdxAttr ));_fce ,_ :=_ad .ParseFloat (_eb .TrimSpace (_gfg .V ),64);
_dg [_cgb ]=append (_dg [_cgb ],_fce );};};};};};};_fed :=true ;_ef :="";_ada :="";if len (_gf )> 1{if _gf [0].ValAx !=nil &&_gf [1].ValAx !=nil {if _gf [0].ValAx .Delete !=nil &&_gf [1].ValAx .Delete !=nil {if !*(*_gf [0].ValAx .Delete ).ValAttr &&!*(*_gf [1].ValAx .Delete ).ValAttr {_fed =false ;
};};_ef =_fa .getTitle (_gf [0].ValAx .Title );_ada =_fa .getTitle (_gf [1].ValAx .Title );};};_dc :=_fef .Style {Hidden :_fed ,FontSize :8*_gc };_abb :=&_aa .Chart {Series :[]_ee .Series {},YAxisSecondary :_aa .YAxis {Style :_dc ,Name :_ada ,NameStyle :_dc },XAxis :_aa .XAxis {Style :_dc ,Name :_ef ,NameStyle :_dc },YAxis :_aa .YAxis {Style :_fef .Style {Hidden :true }}};
for _fad :=0;_fad < len (_aab );_fad ++{_ga ,_caa ,_dad :=_aab [_fad ].ToRGB ();_geb :=_ee .ContinuousSeries {XValues :_gg [_fad ],YValues :_dg [_fad ],Style :_fef .Style {StrokeWidth :1,FillColor :_d .RGBA {uint8 (_ga *255),uint8 (_caa *255),uint8 (_dad *255),255}}};
_abb .Series =append (_abb .Series ,_geb );};_abb .SetHeight (int (_cg .Abs (_ab .Top -_ab .Bottom )));_abb .SetWidth (int (_cg .Abs (_ab .Right -_ab .Left )));_bgb :=_fa ._aga ;_db :=_ed .NewChart (_abb );_db .SetPos (_ab .Left ,_ab .Top );_ba :=_bgb .Draw (_db );
if _ba !=nil {return nil ,_ba ;};return _fea ,nil ;};var _bdad =_fbbb (1.5);type ImgPart byte ;func TwipsFromPoints (points float64 )float64 {return points /_bg .Twips };const (BorderPositionTop BorderPosition =0;BorderPositionLeft BorderPosition =1;BorderPositionBottom BorderPosition =2;
BorderPositionRight BorderPosition =3;);var _ece =_fbbb (1.5);var _bfg =_fbbb (0.5);func ClearRegisteredFonts (){_eec ._dfaa .Lock ();_eec ._dda =map[string ]map[FontStyle ]*_ac .PdfFont {};_eec ._dfaa .Unlock ();};func RegisterEmbeddedFonts (d *_cd .Document )error {_ebcb :=d .FontTable ();
if _ebcb ==nil {return nil ;};for _ ,_cffa :=range _ebcb .Font {if _cffa .EmbedRegular !=nil {return _gaff (d ,_cffa .NameAttr ,_cffa .EmbedRegular .IdAttr ,_cffa .EmbedRegular .FontKeyAttr );};if _cffa .EmbedBold !=nil {return _gaff (d ,_cffa .NameAttr ,_cffa .EmbedBold .IdAttr ,_cffa .EmbedBold .FontKeyAttr );
};if _cffa .EmbedItalic !=nil {return _gaff (d ,_cffa .NameAttr ,_cffa .EmbedItalic .IdAttr ,_cffa .EmbedItalic .FontKeyAttr );};if _cffa .EmbedBoldItalic !=nil {return _gaff (d ,_cffa .NameAttr ,_cffa .EmbedBoldItalic .IdAttr ,_cffa .EmbedBoldItalic .FontKeyAttr );
};};return nil ;};func FillRectangle (c *_ed .Creator ,x ,y ,width ,height float64 ,color _ed .Color ){if color ==nil {return ;};_abdf :=c .NewRectangle (x ,y ,width ,height );_abdf .SetFillColor (color );_abdf .SetBorderWidth (0);c .Draw (_abdf );};func (_fca barSerByOrder )Swap (i ,j int ){_fca [i ],_fca [j ]=_fca [j ],_fca [i ]};
func _ecbf (_effgd *_acf .CT_ValAx )(uint32 ,_acf .ST_AxPos ,_acf .ST_TickMark ,_acf .ST_TickLblPos ,*_acf .CT_ChartLines ,uint32 ,*_df .CT_ShapeProperties ,error ){var _ffeg ,_caef uint32 ;var _cbb _acf .ST_AxPos ;var _bdab _acf .ST_TickMark ;var _agg *_acf .CT_ChartLines ;
var _gfec _acf .ST_TickLblPos ;if _effgd .AxId ==nil {return _ffeg ,_cbb ,_bdab ,_gfec ,_agg ,_caef ,_effgd .SpPr ,_ge .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_ffeg =_effgd .AxId .ValAttr ;};if _effgd .AxPos ==nil {return _ffeg ,_cbb ,_bdab ,_gfec ,_agg ,_caef ,_effgd .SpPr ,_ge .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");
}else {_cbb =_effgd .AxPos .ValAttr ;};if _effgd .MajorTickMark !=nil {_bdab =_effgd .MajorTickMark .ValAttr ;};if _effgd .TickLblPos !=nil {_gfec =_effgd .TickLblPos .ValAttr ;};if _effgd .CrossAx ==nil {return _ffeg ,_cbb ,_bdab ,_gfec ,_agg ,_caef ,_effgd .SpPr ,_ge .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_caef =_effgd .CrossAx .ValAttr ;};_agg =_effgd .MajorGridlines ;return _ffeg ,_cbb ,_bdab ,_gfec ,_agg ,_caef ,_effgd .SpPr ,nil ;};func (_bcee FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_bcee )];
};func DrawLine (c *_ed .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _ed .Color ){if color ==nil {return ;};_gad :=c .NewLine (x0 ,y0 ,x1 ,y1 );_gad .SetLineWidth (width );_gad .SetColor (color );c .Draw (_gad );};func (_bbc *creatorContext )drawBorderWithProps (_fcgg *_df .CT_ShapeProperties ,_agc *Rectangle ,_fcba float64 ){if _agc !=nil &&_fcgg !=nil &&_fcgg .Ln !=nil &&_fcgg .Ln .LineFillPropertiesChoice .SolidFill !=nil {_fgfe :=_bbc .getPdfColorFromSolidFill (_fcgg .Ln .LineFillPropertiesChoice .SolidFill );
DrawRectangle (_bbc ._aga ,_agc ,_fcba ,_fgfe );};};func (_ccc *creatorContext )drawLineChart (_acdd *_acf .CT_LineChart ,_effc *Rectangle ,_ecd []*_acf .CT_PlotAreaChoice1 ,_dfab float64 )([]*legendItem ,error ){_eecg :=[]*legendItem {};_fdc :=_acdd .Ser ;
_gdff :=make (map[int ][]float64 );_adge :=make (map[int ][]float64 );_gaee :=make (map[int ]_ed .Color );_fdaa :=make (map[int ]float64 );for _gedc ,_cbbd :=range _fdc {var _agfd string ;if _gffc :=_cbbd .Tx ;_gffc !=nil {if _cdgd :=_gffc .SerTxChoice ;
_cdgd !=nil {if _cdgd .V !=nil {_agfd =*_cdgd .V ;}else if _abgac :=_cdgd .StrRef ;_abgac !=nil {if _degb :=_abgac .StrCache ;_degb !=nil {for _ ,_beed :=range _degb .Pt {_agfd =_beed .V ;};};};};};_gaee [_gedc ]=_ed .ColorWhite ;if _gdfe :=_cbbd .SpPr ;
_gdfe !=nil {if _ecffe :=_gdfe .Ln ;_ecffe !=nil {if _egbb :=_ecffe .WAttr ;_egbb !=nil {_fdaa [_gedc ]=_bg .FromEMU (int64 (*_egbb ));if _aged :=_ecffe .LineFillPropertiesChoice .SolidFill ;_aged !=nil {_fbdb :=_ccc .getPdfColorFromSolidFill (_aged );
if _fbdb !=nil {_gaee [_gedc ]=_fbdb ;};};};};};if _dcag :=_cbbd .Val ;_dcag !=nil {if _ggaa :=_dcag .NumDataSourceChoice ;_ggaa !=nil {if _bef :=_ggaa .NumRef ;_bef !=nil {if _dccf :=_bef .NumCache ;_dccf !=nil {for _ ,_gcab :=range _dccf .Pt {_gdff [_gedc ]=append (_gdff [_gedc ],float64 (_gcab .IdxAttr ));
_bdcb ,_ :=_ad .ParseFloat (_eb .TrimSpace (_gcab .V ),64);_adge [_gedc ]=append (_adge [_gedc ],_bdcb );};};};};};_eecg =append (_eecg ,&legendItem {_gfbd :_agfd ,_dbf :_cbbd .SpPr });};_cced :=true ;_acga :=true ;_cgda :="";_ddf :="";if len (_ecd )> 0{for _ ,_agb :=range _ecd {if _agb .CatAx !=nil {if _agb .CatAx .Delete !=nil {if !*(*_agb .CatAx .Delete ).ValAttr {_cced =false ;
};};_cgda =_ccc .getTitle (_agb .CatAx .Title );}else if _agb .ValAx !=nil {if _agb .ValAx .Delete !=nil {if !*(*_agb .ValAx .Delete ).ValAttr {_acga =false ;};};_ddf =_ccc .getTitle (_agb .ValAx .Title );};};};_efegg :=_fef .Style {Hidden :_cced ,FontSize :8*_dfab };
_gedb :=_fef .Style {Hidden :_acga ,FontSize :8*_dfab };_gggg :=&_aa .Chart {Series :[]_ee .Series {},YAxisSecondary :_aa .YAxis {Style :_gedb ,Name :_ddf ,NameStyle :_gedb },XAxis :_aa .XAxis {Style :_efegg ,Name :_cgda ,NameStyle :_efegg },YAxis :_aa .YAxis {Style :_fef .Style {Hidden :true }}};
for _cgcd :=0;_cgcd < len (_gaee );_cgcd ++{_bfdb ,_geg ,_afbd :=_gaee [_cgcd ].ToRGB ();_eddd :=_ee .ContinuousSeries {XValues :_gdff [_cgcd ],YValues :_adge [_cgcd ],Style :_fef .Style {StrokeColor :_d .RGBA {uint8 (_bfdb *255),uint8 (_geg *255),uint8 (_afbd *255),255},StrokeWidth :_fdaa [_cgcd ]}};
_gggg .Series =append (_gggg .Series ,_eddd );};_gggg .SetHeight (int (_cg .Abs (_effc .Top -_effc .Bottom )));_gggg .SetWidth (int (_cg .Abs (_effc .Right -_effc .Left )));_bdfb :=_ccc ._aga ;_dcdg :=_ed .NewChart (_gggg );_dcdg .SetPos (_effc .Left ,_effc .Top );
_aag :=_bdfb .Draw (_dcdg );if _aag !=nil {return nil ,_aag ;};return _eecg ,nil ;};func (_egc *creatorContext )addCatValue (_bdafd string ,_ecf map[string ]serCategory ,_fgfg []string ,_fefd int ,_adg ,_beb *float64 ,_efb string ,_cge *_df .CT_ShapeProperties ){_acfb ,_bfe :=_ad .ParseFloat (_bdafd ,64);
if _bfe !=nil {_acfb =0;_ffc .Log .Debug ("\u0070a\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_bfe );};if _acfb > *_beb {*_beb =_acfb ;};if _acfb < *_adg {*_adg =_acfb ;};_cce :=_ecf [_fgfg [_fefd ]];_cce ._ecb =append (_cce ._ecb ,serValue {_ccea :_efb ,_bgca :_acfb ,_ccf :_cge });
_ecf [_fgfg [_fefd ]]=_cce ;};type serValue struct{_ccea string ;_bgca float64 ;_ccf *_df .CT_ShapeProperties ;};func (_ebb *creatorContext )drawTitle (_aff string ,_aaeb ,_fff float64 ){_bgbf :=_ebb ._daebe ;_aafe :=_ebb ._aga .NewStyledParagraph ();_eba :=_aafe .SetText (_aff );
_ddg ,_bfc :=_ac .NewStandard14Font (_ac .HelveticaName );if _bfc ==nil {_afg :=_ebb ._aga .NewTextStyle ();_afg .Font =_ddg ;_afg .FontSize =14;_afg .TextRise =0.4;_eba .Style =_afg ;_aafe .SetPos (_aaeb -_aafe .Width ()*_bgbf /2,_fff );_ebb ._aga .Draw (_aafe );
};};func MakeImageFromChartSpace (cs *_acf .ChartSpace ,width ,height float64 ,theme *_df .Theme ,workbook *_cfg .Workbook )(_be .Image ,error ){_dbd ,_fbf :=_dce (cs ,width ,height ,theme ,true ,workbook );if _fbf !=nil {return nil ,_fbf ;};_cec ,_fbf :=GetPageFromCreator (_dbd );
if _fbf !=nil {return nil ,_fbf ;};return _bc .NewImageDevice ().Render (_cec );};const (PageSizeA4 PageSize =iota ;PageSizeA3 ;PageSizeA5 ;PageSizeLetter ;PageSizeLegal ;Percent100 =100000.0;MaxPageHeight =11906;);const _gea =6.0;func _dged (_aeef ,_bgcg ,_afc float64 )float64 {if _aeef *6< 1{return _afc +(_bgcg -_afc )*6*_aeef ;
}else if _aeef *2< 1{return _bgcg ;}else if _aeef *3< 2{return _afc +(_bgcg -_afc )*(2.0/3.0-_aeef )*6;}else {return _afc ;};};type creatorContext struct{_aga *_ed .Creator ;_agbfe *_df .Theme ;_daebe float64 ;};func DrawRectangle (c *_ed .Creator ,r *Rectangle ,w float64 ,color _ed .Color ){if color ==nil {return ;
};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};
func (_eegc *creatorContext )getTitle (_ccda *_acf .CT_Title )string {_gbcg :="";if _ccda !=nil &&_ccda .Tx !=nil &&_ccda .Tx .TxChoice !=nil &&_ccda .Tx .TxChoice .Rich !=nil {if len (_ccda .Tx .TxChoice .Rich .P )> 0{for _ ,_aaf :=range _ccda .Tx .TxChoice .Rich .P {if len (_aaf .EG_TextRun )> 0{_gbcg +="\u000a"+_aaf .EG_TextRun [0].TextRunChoice .R .T ;
};};};};return _gbcg ;};var _faag =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };
func _gcge (_dgd _df .ST_SchemeColorVal ,_cfae *_df .Theme )string {if _gfeb :=_cfae .ThemeElements ;_gfeb !=nil {if _cfe :=_gfeb .ClrScheme ;_cfe !=nil {switch _dgd {case _df .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_cfe .Lt1 );case _df .ST_SchemeColorValDk1 ,_df .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_cfe .Dk1 );
case _df .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_cfe .Lt2 );case _df .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_cfe .Dk2 );case _df .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_cfe .Accent1 );case _df .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_cfe .Accent2 );
case _df .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_cfe .Accent3 );case _df .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_cfe .Accent4 );case _df .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_cfe .Accent5 );
case _df .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_cfe .Accent6 );};};};return "";};func _fbbb (_effb float64 )float64 {return _effb *_bg .Millimeter };func (_dea *creatorContext )getPdfColorFromSolidFill (_dafca *_df .CT_SolidColorFillProperties )_ed .Color {if _dafca ==nil {return nil ;
};_eccf :="";if _cfgg :=_dafca .SrgbClr ;_cfgg !=nil {_eccf =_cfgg .ValAttr ;}else if _ffbb :=_dafca .SchemeClr ;_ffbb !=nil {_eccf =_gcge (_ffbb .ValAttr ,_dea ._agbfe );_eccf =AdjustColor (_eccf ,_ffbb .EG_ColorTransform );};if _eccf ==""{return nil ;
};return _ed .ColorRGBFromHex ("\u0023"+_eccf );};func AssignStdFontByName (style _ed .TextStyle ,fontName string )*_ac .PdfFont {_ceg :=_ac .StdFontName (fontName );return _ac .NewStandard14FontMustCompile (_ceg );};func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _badg ,_gcf ,_edc uint8 ;
_ddgf ,_ :=_f .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_badg ,&_gcf ,&_edc );if _ddgf !=3{return "";};_gbgb ,_fggf ,_gcad :=_efbe (_badg ,_gcf ,_edc );_gcad =lum *_gcad ;_badg ,_gcf ,_edc =_gffa (_gbgb ,_fggf ,_gcad );
return _f .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_badg ,_gcf ,_edc );};func FromSTCoordinate (st _df .ST_Coordinate )int64 {if _fdde :=st .ST_CoordinateUnqualified ;_fdde !=nil {return *_fdde ;};return 0;};const (FontStyle_Regular FontStyle =0;
FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func IsNoSpaceLanguage (symbol string )bool {for _ ,_gda :=range symbol {if _g .Is (_g .Han ,_gda ){return true ;};};return false ;};func _eafb (_cdba string )([]byte ,error ){_dgc :=_gd .MustCompile ("\u005b\u005e\u0061\u002d\u007a\u0041\u002d\u005a\u0030\u002d\u0039\u005d\u002b");
_cdba =_dgc .ReplaceAllString (_cdba ,"");_ecee :=[]rune (_cdba );_dgfd :=[]byte {};for _fdea :=len (_ecee )-2;_fdea >=0;_fdea -=2{_ecgc ,_cgaa :=_ad .ParseUint (string (_ecee [_fdea ])+string (_ecee [_fdea +1]),16,8);if _cgaa !=nil {return nil ,_cgaa ;
};_dgfd =append (_dgfd ,byte (_ecgc ));};return _dgfd ,nil ;};var RtlFontFile *_ac .PdfFont ;func (_dge *creatorContext )drawLegend (_ggg *Rectangle ,_dgb []*legendItem ,_ced bool ){_cefe :=_dge ._daebe ;_fcd :=_fbbb (2.5)*_cefe ;_agf :=_ece *_cefe ;_ffef :=(_fcd -_agf )/2;
_bdcc :=float64 (len (_dgb ));if _ced {_eaa :=&Rectangle {Top :_ggg .Top +_fbbb (1)*_cefe ,Bottom :_ggg .Bottom -_fbbb (1)*_cefe ,Left :_ggg .Left +_fbbb (2.5)*_cefe ,Right :_ggg .Right -_fbbb (2.5)*_cefe };var _gca float64 ;if _bdcc > 1{_gca =(_eaa .Right -_eaa .Left )/_bdcc ;
};_bce :=_eaa .Left ;_gbd :=_eaa .Top ;for _ ,_dba :=range _dgb {if _gab :=_dba ._dbf ;_gab !=nil {_dge .drawRectangleWithProps (_gab ,_bce ,_gbd +_ffef ,_agf ,_agf ,false );_badb :=_bce +_agf *2;_cgc :=_dge ._aga .NewStyledParagraph ();_cgc .SetPos (_badb ,_gbd );
_cgd :=_cgc .Append (_dba ._gfbd );_ggf ,_ebcd :=_ac .NewStandard14Font (_ac .HelveticaName );if _ebcd ==nil {_ebdf :=_dge ._aga .NewTextStyle ();_ebdf .Font =_ggf ;_ebdf .FontSize =_fcd ;_ebdf .TextRise =0.4;_cgd .Style =_ebdf ;_dge ._aga .Draw (_cgc );
};};_bce +=_gca ;};}else {_eda :=&Rectangle {Top :_ggg .Top +_fbbb (2.5)*_cefe ,Bottom :_ggg .Bottom -_fbbb (2.5)*_cefe ,Left :_ggg .Left +_fbbb (2.5)*_cefe ,Right :_ggg .Right -_fbbb (2.5)*_cefe };var _efac float64 ;if _bdcc > 1{_efac =(_eda .Bottom -_eda .Top -_fcd )/(_bdcc -1);
if _efac < _fcd {_efac =_fcd ;};};_fgb :=_eda .Top ;_ccff :=_eda .Left ;_fceb :=_ccff +_agf *2;for _ ,_abcc :=range _dgb {if _fecf :=_abcc ._dbf ;_fecf !=nil {_dge .drawRectangleWithProps (_fecf ,_ccff ,_fgb +_ffef ,_agf ,_agf ,false );_effe :=_dge ._aga .NewStyledParagraph ();
_effe .SetPos (_fceb ,_fgb );_effe .SetWidth (_eda .Right -_eda .Left );_abfe :=_effe .Append (_abcc ._gfbd );_cgg ,_fege :=_ac .NewStandard14Font (_ac .HelveticaName );if _fege ==nil {_gbg :=_dge ._aga .NewTextStyle ();_gbg .Font =_cgg ;_gbg .FontSize =_fcd ;
_gbg .TextRise =0.4;_abfe .Style =_gbg ;_dge ._aga .Draw (_effe );};};_fgb +=_efac ;};};};func _gfcc (_cedg string )error {if !_eb .HasSuffix (_cedg ,"\u002e\u0074\u0074\u0066"){_ffc .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return _f .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_egdd ,_gac :=_fe .ParseFile (_cedg );if _gac !=nil {_ffc .Log .Debug ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020T\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_gac );return _gac ;};_fbgfc ,_gac :=_ac .NewCompositePdfFontFromTTFFile (_cedg );
if _gac !=nil {return _gac ;};_bgf :=_egdd .GetNameRecords ();for _ ,_bdcea :=range _bgf {_bde :=_bdcea [1];if _bde ==""{continue ;};_bgdb :=make ([]byte ,0);for _dbg :=0;_dbg < len (_bde );_dbg ++{if _bde [_dbg ]==39||_bde [_dbg ]==92{continue ;};_gfgaa :=4;
if _dbg +_gfgaa < len (_bde ){if _bde [_dbg :_dbg +_gfgaa ]=="\u0000"{_dbg =_dbg +_gfgaa +1;continue ;};};_bgdb =append (_bgdb ,_bde [_dbg ]);};_bde =_eb .Replace (string (_bgdb ),"\u0078\u0030\u0030","",-1);_dbge :=_bdcea [2];if _dbge ==""{return _f .Errorf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_cedg );
};_bgdb =make ([]byte ,0);for _dggg :=0;_dggg < len (_dbge );_dggg ++{if _dbge [_dggg ]==39||_dbge [_dggg ]==92{continue ;};_ceef :=4;if _dggg +_ceef < len (_dbge ){if _dbge [_dggg :_dggg +_ceef ]=="\u0000"{_dggg =_dggg +_ceef +1;continue ;};};_bgdb =append (_bgdb ,_dbge [_dggg ]);
};_dbge =_eb .Replace (string (_bgdb ),"\u0078\u0030\u0030","",-1);RegisterFont (_bde ,_faag [_dbge ],_fbgfc );};return nil ;};type BorderPosition byte ;func AdjustColorByLumOff (colorStr string ,lumOff float64 )string {var _bcgc ,_dabcf ,_ebgc uint8 ;
_ffea ,_ :=_f .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_bcgc ,&_dabcf ,&_ebgc );if _ffea !=3{return "";};_abgc ,_gbec ,_cgfa :=_efbe (_bcgc ,_dabcf ,_ebgc );_cgfa =_cgfa +lumOff ;_bcgc ,_dabcf ,_ebgc =_gffa (_abgc ,_gbec ,_cgfa );
return _f .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_bcgc ,_dabcf ,_ebgc );};func AdjustColorByShade (colorStr string ,shade float64 )string {var _dafc ,_baab ,_cag uint8 ;_abe ,_ :=_f .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_dafc ,&_baab ,&_cag );
if _abe !=3{return "";};return _adad (_dafc ,shade )+_adad (_baab ,shade )+_adad (_cag ,shade );};func (_eae *creatorContext )drawPieChart (_ebf *_acf .CT_PieChart ,_fga *Rectangle ,_dcb *_cfg .Workbook ,_eadc float64 )([]*legendItem ,error ){_fdead :=[]*legendItem {};
_acdb :=map[string ]serCategory {};_aggb :=[]string {};_dgbde :=_cg .Inf (1);_efeb :=_cg .Inf (-1);_aeca :=_ebf .Ser ;for _ ,_cgea :=range _aeca {var _bbfb string ;if _afe :=_cgea .Tx ;_afe !=nil {if _edfa :=_afe .SerTxChoice ;_edfa !=nil {if _edfa .V !=nil {_bbfb =*_edfa .V ;
}else if _fegd :=_edfa .StrRef ;_fegd !=nil {if _bebe :=_fegd .StrCache ;_bebe !=nil {for _ ,_deb :=range _bebe .Pt {_bbfb =_deb .V ;};};};};};if _cbad :=_cgea .Cat ;_cbad !=nil {if _ggd :=_cbad .AxDataSourceChoice ;_ggd !=nil {if _eecgb :=_ggd .StrRef ;
_eecgb !=nil {if _caee :=_eecgb .F ;_caee !=""&&_dcb !=nil {_adfd ,_acb ,_dafb ,_fgec :=ParseExcelRange (_caee );if _fgec ==nil {for _ ,_fdb :=range _dcb .Sheets (){if _fdb .Name ()==_eb .Trim (_adfd ,"\u0027"){_cccf :=_acb .String ();for _egga :=_acb .RowIdx ;
_egga <=_dafb .RowIdx ;_egga +=1{_gedg :=_eb .ReplaceAll (_cccf ,_f .Sprint (_acb .RowIdx ),_f .Sprint (_egga ));_eae .addCatName (_fdb .Cell (_gedg ).GetString (),_acdb ,&_aggb );};break ;};};};};if _eagc :=_eecgb .StrCache ;_eagc !=nil {for _ ,_fee :=range _eagc .Pt {_eae .addCatName (_fee .V ,_acdb ,&_aggb );
};};}else if _aegab :=_ggd .NumRef ;_aegab !=nil {if _aaac :=_aegab .NumCache ;_aaac !=nil {var _fbgb string ;if _aaac .FormatCode !=nil {_fbgb =*_aaac .FormatCode ;};for _ ,_eaad :=range _aaac .Pt {var _cabd string ;if _eaad .FormatCodeAttr ==nil {_cabd =_fbgb ;
}else {_cabd =*_eaad .FormatCodeAttr ;};var _gfbe string ;_edbf ,_cbe :=_ad .ParseFloat (_eaad .V ,64);if _cbe !=nil {_gfbe =_eaad .V ;}else {_gfbe =_eg .Number (_edbf ,_cabd );};_eae .addCatName (_gfbe ,_acdb ,&_aggb );};};};};};if _edcb :=_cgea .Val ;
_edcb !=nil {if _gec :=_edcb .NumDataSourceChoice ;_gec !=nil {if _bdb :=_gec .NumRef ;_bdb !=nil {if _faaea :=_bdb .F ;_faaea !=""&&_dcb !=nil {_gbda ,_agbf ,_adgc ,_afabg :=ParseExcelRange (_faaea );if _afabg ==nil {for _ ,_fba :=range _dcb .Sheets (){if _fba .Name ()==_eb .Trim (_gbda ,"\u0027"){_aadd :=_agbf .String ();
for _eac :=_agbf .RowIdx ;_eac <=_adgc .RowIdx ;_eac +=1{_adag :=_eb .ReplaceAll (_aadd ,_f .Sprint (_agbf .RowIdx ),_f .Sprint (_eac ));if _fba .FormulaContext ().HasFormula (_adag ){_afcd :=_ff .NewEvaluator ();_aage :=_fba .FormulaContext ().Cell (_adag ,_afcd );
_aegd :=_aage .Value ();_eae .addCatValue (_aegd ,_acdb ,_aggb ,(int )(_eac -_agbf .RowIdx ),&_dgbde ,&_efeb ,_bbfb ,_cgea .SpPr );}else {_ffac :=_fba .Cell (_adag ).GetString ();_eae .addCatValue (_ffac ,_acdb ,_aggb ,(int )(_eac -_agbf .RowIdx ),&_dgbde ,&_efeb ,_bbfb ,_cgea .SpPr );
};};break ;};};};};if _ffg :=_bdb .NumCache ;_ffg !=nil {for _dfeg ,_cfgbc :=range _ffg .Pt {_eae .addCatValue (_cfgbc .V ,_acdb ,_aggb ,_dfeg ,&_dgbde ,&_efeb ,_bbfb ,_cgea .SpPr );};};};};};};_gef :=&_aa .PieChart {Values :[]_ee .Value {}};for _ ,_dgdb :=range _aggb {_gcefb :=_acdb [_dgdb ];
if len (_gcefb ._ecb )> 0{_gef .Values =append (_gef .Values ,_ee .Value {Value :_gcefb ._ecb [0]._bgca ,Label :_dgdb ,Style :_fef .Style {FontSize :12*_eadc }});};};_gef .SetHeight (int (_fga .Top -_fga .Bottom ));_gef .SetWidth (int (_fga .Right -_fga .Left ));
_aefa :=_eae ._aga ;_bdec :=_ed .NewChart (_gef );_bdec .SetPos (_fga .Left ,_fga .Top );_bdadd :=_aefa .Draw (_bdec );if _bdadd !=nil {return nil ,_bdadd ;};return _fdead ,nil ;};func (_aacf *Rectangle )scale (_eddf float64 ){_aacf .Top *=_eddf ;_aacf .Bottom *=_eddf ;
_aacf .Left *=_eddf ;_aacf .Right *=_eddf ;};func _gaff (_dfgb *_cd .Document ,_fade ,_gcga ,_aafd string )error {_aec ,_aeea :=_dfgb .GetFontBytesByRelId (_gcga );if _aeea !=nil {return _aeea ;};_fefgc ,_aeea :=_eafb (_aafd );if _aeea !=nil {return _aeea ;
};for _badgd :=0;_badgd < 32;_badgd ++{_dag :=_badgd %len (_fefgc );_aec [_badgd ]=_aec [_badgd ]^_fefgc [_dag ];};_dfb :=_dfgb .TmpPath +"\u002f"+_fade +"\u002e\u0074\u0074\u0066";_aeea =_de .WriteFile (_dfb ,_aec ,0644);if _aeea !=nil {return _aeea ;
};_gfcc (_dfb );return nil ;};func AdjustColorByTint (colorStr string ,tint float64 )string {var _gce ,_fgca ,_ccfc uint8 ;_bgea ,_ :=_f .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_gce ,&_fgca ,&_ccfc );if _bgea !=3{return "";
};return _bagc (_gce ,tint )+_bagc (_fgca ,tint )+_bagc (_ccfc ,tint );};var _eec =fontsMap {_dfaa :&_e .Mutex {},_dda :map[string ]map[FontStyle ]*_ac .PdfFont {}};func FromSTPercentage (st *_df .ST_Percentage )float64 {if _cbea :=st .ST_PercentageDecimal ;
_cbea !=nil {return float64 (*_cbea )/Percent100 ;};return 0;};var _aaef =_fbbb (5);func GetPageFromCreator (c *_ed .Creator )(*_ac .PdfPage ,error ){_gfccf :=_a .NewBuffer ([]byte {});_gddf :=c .Write (_gfccf );if _gddf !=nil {return nil ,_gddf ;};_ddad :=_a .NewReader (_gfccf .Bytes ());
_cefeb ,_gddf :=_ac .NewPdfReader (_ddad );if _gddf !=nil {return nil ,_gddf ;};return _cefeb .GetPage (1);};func RegisterFont (name string ,style FontStyle ,font *_ac .PdfFont ){_eec ._dfaa .Lock ();if _eec ._dda [name ]==nil {_eec ._dda [name ]=map[FontStyle ]*_ac .PdfFont {};
};_eec ._dda [name ][style ]=font ;_eec ._dfaa .Unlock ();};func AdjustColor (colorStr string ,EG_ColorTransform []*_df .EG_ColorTransform )string {for _ ,_bged :=range EG_ColorTransform {if _baga :=_bged .ColorTransformChoice .Tint ;_baga !=nil {if _fddf :=_baga .ValAttr .ST_PositiveFixedPercentageDecimal ;
_fddf !=nil {colorStr =AdjustColorByTint (colorStr ,1.0-float64 (*_fddf )/Percent100 );};};if _edec :=_bged .ColorTransformChoice .Shade ;_edec !=nil {if _dac :=_edec .ValAttr .ST_PositiveFixedPercentageDecimal ;_dac !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_dac )/Percent100 );
};};if _bfb :=_bged .ColorTransformChoice .LumMod ;_bfb !=nil {if _fbb :=_bfb .ValAttr .ST_PercentageDecimal ;_fbb !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_fbb )/Percent100 );};};if _cgeg :=_bged .ColorTransformChoice .LumOff ;_cgeg !=nil {if _bcge :=_cgeg .ValAttr .ST_PercentageDecimal ;
_bcge !=nil {colorStr =AdjustColorByLumOff (colorStr ,float64 (*_bcge )/Percent100 );};};};return colorStr ;};func _fcce (_baeb *_acf .CT_DateAx )(uint32 ,_acf .ST_AxPos ,_acf .ST_TickMark ,_acf .ST_TickLblPos ,*_acf .CT_ChartLines ,uint32 ,*_df .CT_ShapeProperties ,error ){var _fcbc ,_gcc uint32 ;
var _bge _acf .ST_AxPos ;var _aega _acf .ST_TickMark ;var _abga *_acf .CT_ChartLines ;var _dadd _acf .ST_TickLblPos ;if _baeb .AxId ==nil {return _fcbc ,_bge ,_aega ,_dadd ,_abga ,_gcc ,_baeb .SpPr ,_ge .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_fcbc =_baeb .AxId .ValAttr ;};if _baeb .AxPos ==nil {return _fcbc ,_bge ,_aega ,_dadd ,_abga ,_gcc ,_baeb .SpPr ,_ge .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_bge =_baeb .AxPos .ValAttr ;
};if _baeb .MajorTickMark !=nil {_aega =_baeb .MajorTickMark .ValAttr ;};if _baeb .TickLblPos !=nil {_dadd =_baeb .TickLblPos .ValAttr ;};if _baeb .CrossAx ==nil {return _fcbc ,_bge ,_aega ,_dadd ,_abga ,_gcc ,_baeb .SpPr ,_ge .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_gcc =_baeb .CrossAx .ValAttr ;};_abga =_baeb .MajorGridlines ;return _fcbc ,_bge ,_aega ,_dadd ,_abga ,_gcc ,_baeb .SpPr ,nil ;};func (_ebg *creatorContext )drawBarChart (_gbf *_acf .CT_BarChart ,_baf *Rectangle ,_ec []*_acf .CT_PlotAreaChoice1 ,_egf *_cfg .Workbook )([]*legendItem ,error ){var _gaf bool ;
if _ecg :=_gbf .BarDir ;_ecg !=nil {_gaf =_ecg .ValAttr ==_acf .ST_BarDirBar ;};_bae :=_gbf .Ser ;_c .Sort (barSerByOrder (_bae ));_def :=map[string ]serCategory {};_dcd :=[]string {};_fda :=[]*legendItem {};_fgf :=_cg .Inf (1);_dgg :=_cg .Inf (-1);for _ ,_bca :=range _bae {var _ag string ;
if _fgfa :=_bca .Tx ;_fgfa !=nil {if _bf :=_fgfa .SerTxChoice ;_bf !=nil {if _bf .V !=nil {_ag =*_bf .V ;}else if _gdc :=_bf .StrRef ;_gdc !=nil {if _aea :=_gdc .StrCache ;_aea !=nil {for _ ,_cdg :=range _aea .Pt {_ag =_cdg .V ;};};};};};if _cdga :=_bca .Cat ;
_cdga !=nil {if _gafa :=_cdga .AxDataSourceChoice ;_gafa !=nil {if _feae :=_gafa .StrRef ;_feae !=nil {if _bcac :=_feae .F ;_bcac !=""&&_egf !=nil {_fcef ,_dab ,_ecc ,_cgf :=ParseExcelRange (_bcac );if _cgf ==nil {for _ ,_fcb :=range _egf .Sheets (){if _fcb .Name ()==_eb .Trim (_fcef ,"\u0027"){_edb :=_dab .String ();
for _fb :=_dab .RowIdx ;_fb <=_ecc .RowIdx ;_fb +=1{_fbe :=_eb .ReplaceAll (_edb ,_f .Sprint (_dab .RowIdx ),_f .Sprint (_fb ));_ebg .addCatName (_fcb .Cell (_fbe ).GetString (),_def ,&_dcd );};break ;};};};};if _aad :=_feae .StrCache ;_aad !=nil {for _ ,_efa :=range _aad .Pt {_ebg .addCatName (_efa .V ,_def ,&_dcd );
};};}else if _feff :=_gafa .NumRef ;_feff !=nil {if _abf :=_feff .NumCache ;_abf !=nil {var _dd string ;if _abf .FormatCode !=nil {_dd =*_abf .FormatCode ;};for _ ,_efae :=range _abf .Pt {var _fac string ;if _efae .FormatCodeAttr ==nil {_fac =_dd ;}else {_fac =*_efae .FormatCodeAttr ;
};var _bd string ;_beg ,_ade :=_ad .ParseFloat (_efae .V ,64);if _ade !=nil {_bd =_efae .V ;}else {_bd =_eg .Number (_beg ,_fac );};_ebg .addCatName (_bd ,_def ,&_dcd );};};};};};if _dae :=_bca .Val ;_dae !=nil {if _faa :=_dae .NumDataSourceChoice ;_faa !=nil {if _dfa :=_faa .NumRef ;
_dfa !=nil {if _cfgf :=_dfa .F ;_cfgf !=""&&_egf !=nil {_dcf ,_ea ,_dbc ,_fec :=ParseExcelRange (_cfgf );if _fec ==nil {for _ ,_gae :=range _egf .Sheets (){if _gae .Name ()==_eb .Trim (_dcf ,"\u0027"){_ged :=_ea .String ();for _bda :=_ea .RowIdx ;_bda <=_dbc .RowIdx ;
_bda +=1{_fcc :=_eb .ReplaceAll (_ged ,_f .Sprint (_ea .RowIdx ),_f .Sprint (_bda ));if _gae .FormulaContext ().HasFormula (_fcc ){_bdaf :=_ff .NewEvaluator ();_cgfb :=_gae .FormulaContext ().Cell (_fcc ,_bdaf );_ddc :=_cgfb .Value ();_ebg .addCatValue (_ddc ,_def ,_dcd ,(int )(_bda -_ea .RowIdx ),&_fgf ,&_dgg ,_ag ,_bca .SpPr );
}else {_bdg :=_gae .Cell (_fcc ).GetString ();_ebg .addCatValue (_bdg ,_def ,_dcd ,(int )(_bda -_ea .RowIdx ),&_fgf ,&_dgg ,_ag ,_bca .SpPr );};};break ;};};};};if _acgc :=_dfa .NumCache ;_acgc !=nil {for _gdf ,_eff :=range _acgc .Pt {_ebg .addCatValue (_eff .V ,_def ,_dcd ,_gdf ,&_fgf ,&_dgg ,_ag ,_bca .SpPr );
};};};};};_fda =append (_fda ,&legendItem {_gfbd :_ag ,_dbf :_bca .SpPr });};var _dga float64 ;var _ege ,_bdf float64 ;if _dgg ==0&&_fgf ==0{_dga =0.2;_bdf =0;_ege =1;}else {var _ebd float64 ;if _caab :=_cg .Abs (_fgf );_dgg < _caab {_ebd =_caab ;}else {_ebd =_dgg ;
};_ebge :=_cg .Pow (10,_cg .Floor (_cg .Log10 (_ebd )));_bad :=_ebd /_ebge ;if _bad < 4.29{_dga =0.5;}else if _bad >=4.29&&_bad < 8.58{_dga =1;}else {_dga =2;};_dga *=_ebge ;if _dgg <=0{_ege =0;}else {_ege =(_cg .Ceil (_dgg /_dga )+1)*_dga ;};if _fgf >=0{_bdf =0;
}else {_bdf =(_cg .Floor (_fgf /_dga )-1)*_dga ;};};_bdaa :=_ebg .drawAxes (_ec ,_bdf ,_ege ,_dga ,_dcd ,_baf ,_gaf );if _bdaa !=nil {return nil ,_bdaa ;};_gdfc :=0.0;if _gbf .GapWidth !=nil {if _feg :=_gbf .GapWidth .ValAttr ;_feg !=nil {if _cb :=_feg .ST_GapAmountUShort ;
_cb !=nil {_gdfc =float64 (*_cb )/100.0;};};};_fecg :=_baf .Right -_baf .Left ;_daea :=_baf .Bottom -_baf .Top ;_bac :=float64 (len (_dcd ));if _gaf {_faae :=_ege /(_ege -_bdf )*_fecg ;_faca :=-_bdf /(_ege -_bdf )*_fecg ;_gfb :=_baf .Left +_faca ;_ebe :=_daea /_bac ;
for _aef ,_bff :=range _dcd {_dfd :=_def [_bff ];_bdc :=float64 (len (_dfd ._ecb ))+_gdfc ;_ffe :=_ebe /_bdc ;_ffec :=_ffe *_gdfc ;_efe :=_baf .Bottom -float64 (_aef )*_ebe -_ffec /2-_ffe ;for _ ,_gde :=range _dfd ._ecb {if _gde ._bgca ==0{continue ;};
var _facd ,_bb float64 ;if _gde ._bgca > 0{_bb =_gde ._bgca /_ege *_faae ;_ebg .drawRectangleWithProps (_gde ._ccf ,_gfb ,_efe ,_bb ,_ffe ,false );}else {_bb =_gde ._bgca /_bdf *_faca ;_facd =_gfb -_bb ;_ebg .drawRectangleWithProps (_gde ._ccf ,_facd ,_efe ,_bb ,_ffe ,false );
};_efe -=_ffe ;};};}else {_af :=_ege /(_ege -_bdf )*_daea ;_aba :=-_bdf /(_ege -_bdf )*_daea ;_bgc :=_baf .Top +_af ;_gafc :=_fecg /_bac ;for _dcda ,_fbg :=range _dcd {_aeaa :=_def [_fbg ];_edd :=float64 (len (_aeaa ._ecb ))+_gdfc ;_gga :=_gafc /_edd ;
_ffd :=_gga *_gdfc ;_dgge :=_baf .Left +float64 (_dcda )*_gafc +_ffd /2;for _ ,_effg :=range _aeaa ._ecb {var _gfe ,_cbf float64 ;if _effg ._bgca > 0{_cbf =_effg ._bgca /_ege *_af ;_gfe =_bgc -_cbf ;_ebg .drawRectangleWithProps (_effg ._ccf ,_dgge ,_gfe ,_gga ,_cbf ,false );
}else {_cbf =_effg ._bgca /_bdf *_aba ;_ebg .drawRectangleWithProps (_effg ._ccf ,_dgge ,_bgc ,_gga ,_cbf ,false );};_dgge +=_gga ;};};};return _fda ,nil ;};func GetPageDimensions (size PageSize )_ed .PageSize {return _gbac [size ]};var _dcfg =_fbbb (7.5);
func CropImageByRect (sourceImg _be .Image ,rect _be .Rectangle )_be .Image {_aagd ,_fab ,_fbdd ,_fbae :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;_bdfda :=_be .NewNRGBA (_be .Rect (0,0,_fbdd -_aagd ,_fbae -_fab ));for _ccg :=_aagd ;_ccg < _fbdd ;
_ccg ++{for _faf :=_fab ;_faf < _fbae ;_faf ++{_bdfda .Set (_ccg -_aagd ,_faf -_fab ,sourceImg .At (_ccg ,_faf ));};};return _bdfda ;};func RegisterFontsFromDirectory (dirName string )error {_fggfc ,_cdbg :=_de .Open (dirName );if _cdbg !=nil {return _cdbg ;
};defer _fggfc .Close ();_gfc ,_cdbg :=_fggfc .Readdirnames (0);if _cdbg !=nil {return _cdbg ;};for _ ,_cdfg :=range _gfc {if _eb .HasSuffix (_cdfg ,"\u002e\u0074\u0074\u0066"){_dbae :=dirName +"\u002f"+_cdfg ;_fcg :=_gfcc (_dbae );if _fcg !=nil {_ffc .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_fcg );
continue ;};};};return nil ;};type legendItem struct{_gfbd string ;_dbf *_df .CT_ShapeProperties ;};func RegisterFontsFromFiles (files []string )error {for _ ,_ecff :=range files {if _eb .HasSuffix (_ecff ,"\u002e\u0074\u0074\u0066"){_agd :=_gfcc (_ecff );
if _agd !=nil {_ffc .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_agd );
continue ;};};};return nil ;};func (_gbc barSerByOrder )Len ()int {return len (_gbc )};func (_ead *creatorContext )drawAxes (_ddb []*_acf .CT_PlotAreaChoice1 ,_ede ,_cdd ,_ecgg float64 ,_cbfe []string ,_aefc *Rectangle ,_eefa bool )error {_dgbe :=_ead ._aga ;
_feb :=_ead ._daebe ;if _ddb ==nil {return _ge .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};var (_cdgc *_acf .CT_ValAx ;_cfa *_acf .CT_CatAx ;_dcae *_acf .CT_DateAx ;_age *_acf .CT_SerAx ;
);for _ ,_bed :=range _ddb {if _bed .ValAx !=nil {_cdgc =_bed .ValAx ;}else if _bed .CatAx !=nil {_cfa =_bed .CatAx ;}else if _bed .DateAx !=nil {_dcae =_bed .DateAx ;}else if _bed .SerAx !=nil {_age =_bed .SerAx ;};};if _cdgc ==nil ||(_cfa ==nil &&_dcae ==nil &&_age ==nil ){return _ge .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");
};var _dgbf ,_aeab ,_aeae ,_dde uint32 ;var _ccbb ,_bgdf _acf .ST_AxPos ;var _ffcf ,_cecf _acf .ST_TickMark ;var _aabd ,_eebf *_acf .CT_ChartLines ;var _abbd ,_bcb _acf .ST_TickLblPos ;var _bcacb ,_ccdb *_df .CT_ShapeProperties ;var _gaad error ;_fge :=_aefc .Right -_aefc .Left ;
_ecfg :=_aefc .Bottom -_aefc .Top ;if _cdgc !=nil {_aeab ,_bgdf ,_cecf ,_bcb ,_eebf ,_dde ,_ccdb ,_gaad =_ecbf (_cdgc );};if _bgdf !=_acf .ST_AxPosL &&_bgdf !=_acf .ST_AxPosB {return _ge .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};_dbfe :=_cdd -_ede ;_dbb :=int (_dbfe /_ecgg )+1;var _ffee ,_cee float64 ;switch _cecf {case _acf .ST_TickMarkIn :_ffee ,_cee =_gaaf ,0;case _acf .ST_TickMarkOut :_ffee ,_cee =0,_gaaf ;case _acf .ST_TickMarkCross :_ffee ,_cee =_gaaf ,_gaaf ;};_ffee =_ffee *_feb ;
_cee =_cee *_feb ;var _ebad *_df .CT_ShapeProperties ;if _eebf !=nil {_ebad =_eebf .SpPr ;};_fbed ,_gcd :=_abbd !=_acf .ST_TickLblPosNone ,_bcb !=_acf .ST_TickLblPosNone ;_bfec :=_ede ;if _cfa !=nil {_dgbf ,_ccbb ,_ffcf ,_abbd ,_aabd ,_aeae ,_bcacb ,_gaad =_egg (_cfa );
}else if _dcae !=nil {_dgbf ,_ccbb ,_ffcf ,_abbd ,_aabd ,_aeae ,_bcacb ,_gaad =_fcce (_dcae );}else if _age !=nil {_dgbf ,_ccbb ,_ffcf ,_abbd ,_aabd ,_aeae ,_bcacb ,_gaad =_cgae (_age );};if _gaad !=nil {return _gaad ;};if _ccbb !=_acf .ST_AxPosL &&_ccbb !=_acf .ST_AxPosB {return _ge .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};if _dgbf !=_dde ||_aeab !=_aeae {return _ge .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_acd :=len (_cbfe )+1;var _bdce ,_cae float64 ;switch _ffcf {case _acf .ST_TickMarkIn :_bdce ,_cae =_gaaf ,0;
case _acf .ST_TickMarkOut :_bdce ,_cae =0,_gaaf ;case _acf .ST_TickMarkCross :_bdce ,_cae =_gaaf ,_gaaf ;};_bdce =_bdce *_feb ;_cae =_cae *_feb ;var _fbdg *_df .CT_ShapeProperties ;if _aabd !=nil {_fbdg =_aabd .SpPr ;};if _eefa {_cfd :=_ecfg /float64 (len (_cbfe ));
_cfge :=_aefc .Left -_ede *_fge /_dbfe ;_efeg :=_cfge -_dcfg *_feb ;if _fbed {var _gedd float64 ;for _baff :=0;_baff < _acd ;_baff ++{_gff :=_aefc .Bottom -float64 (_baff )*_cfd ;if _baff < _acd -1{_gbaf :=_dgbe .NewParagraph (_cbfe [_baff ]);_gbaf .SetFontSize (_gea *_feb );
_gbaf .SetPos (_efeg ,_gff -_cfd /2-_bdad *_feb );_dgbe .Draw (_gbaf );_eada :=(_gbaf .Width ()/1000-_dcfg )*_feb ;if _eada > 0&&_eada > _gedd {_gedd =_eada ;};};};if _gedd > 0{_aefc .Left +=_gedd +_dgbd ;_cfge =_aefc .Left -_ede *_fge /_dbfe ;_fge =_aefc .Right -_aefc .Left ;
};};_ebbf :=_cfge -_cae ;_gggb :=_cfge +_bdce ;_aca :=_aefc .Left ;_dcac :=_aefc .Right ;for _ecga :=0;_ecga < _acd ;_ecga ++{_ffb :=_aefc .Bottom -float64 (_ecga )*_cfd ;_ead .drawLineWithProps (_bcacb ,_ebbf ,_ffb ,_gggb ,_ffb ,true );_ead .drawLineWithProps (_fbdg ,_aca ,_ffb ,_dcac ,_ffb ,true );
};_bbbd :=_fge /_dbfe ;_eaga :=_aefc .Bottom -_ffee ;_aaed :=_aefc .Bottom +_cee ;_dceg :=_aefc .Top ;_fgc :=_aefc .Bottom ;for _afab :=0;_afab < _dbb ;_afab ++{_bafc :=_aefc .Left +(_bfec -_ede )*_bbbd ;_ead .drawLineWithProps (_ccdb ,_bafc ,_eaga ,_bafc ,_aaed ,true );
_ead .drawLineWithProps (_ebad ,_bafc ,_dceg ,_bafc ,_fgc ,true );if _gcd {_aeb :=_dgbe .NewParagraph (_ad .FormatFloat (_bfec ,'g',-1,64));_aeb .SetFontSize (_gea *_feb );_aeb .SetPos (_bafc -_bfg *_feb ,_fgc +_dgag *_feb );_dgbe .Draw (_aeb );};_bfec +=_ecgg ;
};}else {_gcg :=_ecfg /_dbfe ;_deg :=_aefc .Left ;if _gcd {var _cga float64 ;for _fbgf :=0;_fbgf < _dbb ;_fbgf ++{_afb :=_aefc .Bottom -(_bfec -_ede )*_gcg ;_gfga :=_dgbe .NewParagraph (_ad .FormatFloat (_bfec ,'g',-1,64));_gfga .SetFontSize (_gea *_feb );
_gfga .SetPos (_deg -_dcfg *_feb ,_afb -_bdad *_feb );_dgbe .Draw (_gfga );_efc :=(_gfga .Width ()/1000-_dcfg )*_feb ;if _efc > 0&&_efc > _cga {_cga =_efc ;};_bfec +=_ecgg ;};if _cga > 0{_aefc .Left +=_cga +_dgbd ;_fge =_aefc .Right -_aefc .Left ;};};_bfec =_ede ;
_dfff :=_aefc .Left -_cee ;_fgg :=_aefc .Left +_ffee ;_deg =_aefc .Left ;_gabc :=_aefc .Right ;for _agef :=0;_agef < _dbb ;_agef ++{_eegd :=_aefc .Bottom -(_bfec -_ede )*_gcg ;_ead .drawLineWithProps (_ccdb ,_dfff ,_eegd ,_fgg ,_eegd ,true );_ead .drawLineWithProps (_ebad ,_deg ,_eegd ,_gabc ,_eegd ,true );
_bfec +=_ecgg ;};_bafb :=_fge /float64 (len (_cbfe ));_ebcg :=_aefc .Bottom +_ede *_ecfg /_dbfe ;_baa :=_ebcg -_bdce ;_bbf :=_ebcg +_cae ;_babf :=_aefc .Top ;_cfaf :=_aefc .Bottom ;_ffa :=_ebcg +_dgag *_feb ;for _bfd :=0;_bfd < _acd ;_bfd ++{_eaf :=_aefc .Left +float64 (_bfd )*_bafb ;
_ead .drawLineWithProps (_bcacb ,_eaf ,_baa ,_eaf ,_bbf ,true );_ead .drawLineWithProps (_fbdg ,_eaf ,_babf ,_eaf ,_cfaf ,true );if _fbed &&_bfd < _acd -1{_dcfd :=_dgbe .NewParagraph (_cbfe [_bfd ]);_dcfd .SetFontSize (_gea *_feb );_dcfd .SetPos (_eaf +_aaef *_feb ,_ffa );
_dgbe .Draw (_dcfd );};};};return nil ;};func _gffa (_efg ,_bedb ,_bga float64 )(uint8 ,uint8 ,uint8 ){var _bcf float64 ;if _bga < 0.5{_bcf =_bga *(1+_bedb );}else {_bcf =_bga +_bedb -_bga *_bedb ;};_eca :=_bga *2-_bcf ;_efg /=360.0;_cdc :=_ebbfd (_efg +1.0/3.0);
_dafd :=_ebbfd (_efg );_gbde :=_ebbfd (_efg -1.0/3.0);_dcde :=_dged (_cdc ,_bcf ,_eca );_dbcb :=_dged (_dafd ,_bcf ,_eca );_gfbc :=_dged (_gbde ,_bcf ,_eca );return uint8 (255*_dcde ),uint8 (255*_dbcb ),uint8 (255*_gfbc );};var (DefaultFontSize =12.0;DefaultImageEncoder _gb .StreamEncoder ;
DefaultPageSize =PageSizeA4 ;_gbac =map[PageSize ]_ed .PageSize {PageSizeA3 :_ed .PageSizeA3 ,PageSizeA4 :_ed .PageSizeA4 ,PageSizeA5 :_ed .PageSizeA5 ,PageSizeLetter :_ed .PageSizeLetter ,PageSizeLegal :_ed .PageSizeLegal };);func LoadFontFromFile (filename string )(*_ac .PdfFont ,error ){if !_eb .HasSuffix (filename ,"\u002e\u0074\u0074\u0066"){_ffc .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return nil ,_f .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_fbbf ,_bbff :=_ac .NewCompositePdfFontFromTTFFile (filename );if _bbff !=nil {return nil ,_bbff ;};return _fbbf ,nil ;};func GetDefaultPageSize ()_ed .PageSize {return _gbac [DefaultPageSize ]};var _gaaf =_fbbb (1);var _ccb =_fbbb (0.125);func _adad (_deff uint8 ,_bfea float64 )string {_eccd :=float64 (_deff );
return _f .Sprintf ("\u0025\u0030\u0032\u0078",int (_eccd *_bfea ));};func (_dfgd *creatorContext )drawScatterChart (_cgcdg *_acf .CT_ScatterChart ,_ageb *Rectangle ,_fada []*_acf .CT_PlotAreaChoice1 ,_ecae float64 )([]*legendItem ,error ){_eagd :=[]*legendItem {};
_dagg :=_cgcdg .Ser ;_bba :=make (map[string ]float64 );_ggaf :=make (map[string ][]float64 );_bdcf :=make (map[string ][]float64 );_gcdf :=[]string {};for _ ,_acgd :=range _dagg {var _dbfa string ;if _gegd :=_acgd .Tx ;_gegd !=nil {if _cbbb :=_gegd .SerTxChoice ;
_cbbb !=nil {if _cbbb .V !=nil {_dbfa =*_cbbb .V ;}else if _bdgb :=_cbbb .StrRef ;_bdgb !=nil {if _efga :=_bdgb .StrCache ;_efga !=nil {for _ ,_dec :=range _efga .Pt {_dbfa =_dec .V ;};};};_gcdf =append (_gcdf ,_dbfa );};};if _acgd .Marker !=nil &&_acgd .Marker .Size !=nil {_bba [_dbfa ]=float64 (*_acgd .Marker .Size .ValAttr );
}else {_bba [_dbfa ]=-1.0;};if _cdcd :=_acgd .XVal ;_cdcd !=nil {if _fdaaa :=_cdcd .AxDataSourceChoice ;_fdaaa !=nil {if _gbeb :=_fdaaa .NumRef ;_gbeb !=nil {if _gcdb :=_gbeb .NumCache ;_gcdb !=nil {for _ ,_bdfg :=range _gcdb .Pt {_edbfa ,_ :=_ad .ParseFloat (_eb .TrimSpace (_bdfg .V ),64);
_ggaf [_dbfa ]=append (_ggaf [_dbfa ],_edbfa );};};};};};if _ddce :=_acgd .YVal ;_ddce !=nil {if _cfef :=_ddce .NumDataSourceChoice ;_cfef !=nil {if _eaadd :=_cfef .NumRef ;_eaadd !=nil {if _dfce :=_eaadd .NumCache ;_dfce !=nil {for _ ,_bcadb :=range _dfce .Pt {_aceg ,_ :=_ad .ParseFloat (_eb .TrimSpace (_bcadb .V ),64);
_bdcf [_dbfa ]=append (_bdcf [_dbfa ],_aceg );};};};};};};_cdgf :=true ;_gefe :="";_agdc :="";if len (_fada )> 1{if _fada [0].ValAx .Delete !=nil &&_fada [1].ValAx .Delete !=nil {if !*(*_fada [0].ValAx .Delete ).ValAttr &&!*(*_fada [1].ValAx .Delete ).ValAttr {_cdgf =false ;
};};_gefe =_dfgd .getTitle (_fada [0].ValAx .Title );_agdc =_dfgd .getTitle (_fada [1].ValAx .Title );};_abd :=_fef .Style {Hidden :_cdgf ,FontSize :8*_ecae };_cde :=&_aa .Chart {Series :[]_ee .Series {},YAxisSecondary :_aa .YAxis {Style :_abd ,Name :_agdc ,NameStyle :_abd },XAxis :_aa .XAxis {Style :_abd ,Name :_gefe ,NameStyle :_abd },YAxis :_aa .YAxis {Style :_fef .Style {Hidden :true }}};
for _ ,_gfad :=range _gcdf {_ceee :=_ee .ContinuousSeries {XValues :_ggaf [_gfad ],YValues :_bdcf [_gfad ],Style :_fef .Style {StrokeWidth :-1,DotWidth :_bba [_gfad ]}};_cde .Series =append (_cde .Series ,_ceee );};_cde .SetHeight (int (_cg .Abs (_ageb .Top -_ageb .Bottom )));
_cde .SetWidth (int (_cg .Abs (_ageb .Right -_ageb .Left )));_fgbf :=_dfgd ._aga ;_beae :=_ed .NewChart (_cde );_beae .SetPos (_ageb .Left ,_ageb .Top );_gfce :=_fgbf .Draw (_beae );if _gfce !=nil {return nil ,_gfce ;};return _eagd ,nil ;};type FontStyle byte ;
func ParseExcelRange (s string )(string ,_cf .CellReference ,_cf .CellReference ,error ){_eded :=_eb .FieldsFunc (s ,func (_gfed rune )bool {return _gfed ==':'||_gfed =='!'});if len (_eded )==3{_bfbf ,_gaec :=_cf .ParseCellReference (_eded [1]);if _gaec !=nil {return "",_cf .CellReference {},_cf .CellReference {},_gaec ;
};_ddcf ,_gaec :=_cf .ParseCellReference (_eded [2]);if _gaec !=nil {return "",_cf .CellReference {},_cf .CellReference {},_gaec ;};return _eded [0],_bfbf ,_ddcf ,nil ;};return "",_cf .CellReference {},_cf .CellReference {},_ge .New ("\u0065r\u0072\u006f\u0072\u0020p\u0061\u0072\u0073\u0069\u006eg\u0020e\u0078c\u0065\u006c\u0020\u0072\u0061\u006e\u0067e");
};func _dce (_gebe *_acf .ChartSpace ,_dfc ,_aded float64 ,_ebc *_df .Theme ,_ccd bool ,_fbd *_cfg .Workbook )(*_ed .Creator ,error ){_aee :=1.0;if _ccd {_aee =8.0;};_acc :=&Rectangle {};_cfgd :=&Rectangle {Top :_acc .Top ,Bottom :_aded -_acc .Bottom ,Left :_acc .Left ,Right :_dfc -_acc .Right };
_dfdf :=MakeTempCreator (_dfc *_aee +1,_aded *_aee +1);_bbb :=&creatorContext {_aga :_dfdf ,_agbfe :_ebc ,_daebe :_aee };var _cef bool ;if _bab :=_gebe .Chart ;_bab !=nil {_abc :=_bab .PlotArea ;if _abc ==nil {return nil ,_ge .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");
};_edf :=0.0;if _bab .AutoTitleDeleted !=nil &&_bab .AutoTitleDeleted .ValAttr !=nil &&!*_bab .AutoTitleDeleted .ValAttr {if _bab .Title !=nil &&_bab .Title .Overlay !=nil &&_bab .Title .Overlay .ValAttr !=nil &&!*_bab .Title .Overlay .ValAttr {_edf =_fbbb (10);
};_gbe :=_bbb .getTitle (_bab .Title );if _gbe ==""{_gbe ="C\u0068\u0061\u0072\u0074\u0020\u0054\u0069\u0074\u006c\u0065";};_bbb .drawTitle (_gbe ,_cfgd .Left +_cfgd .Right /2,_fbbb (5));};_dffe :=&Rectangle {Top :_fbbb (10)+_edf ,Bottom :_cfgd .Bottom -_fbbb (15),Left :_fbbb (10),Right :_cfgd .Right -_fbbb (10)};
var _dca *Rectangle ;_aae :=_bab .Legend ;if _aae !=nil {_fbgd :=_aae .Overlay !=nil &&_aae .Overlay .ValAttr !=nil &&*_aae .Overlay .ValAttr ;if _aeg :=_aae .LegendPos ;_aeg !=nil {switch _aeg .ValAttr {case _acf .ST_LegendPosTr :if !_fbgd {_dffe =&Rectangle {Top :_fbbb (25)+_edf ,Bottom :_cfgd .Bottom -_fbbb (10),Left :_fbbb (10),Right :_cfgd .Right -_fbbb (25)};
};_dca =&Rectangle {Top :_fbbb (2.5)+_edf ,Bottom :_fbbb (22.5),Left :_cfgd .Right -_fbbb (22.5),Right :_cfgd .Right -_fbbb (2.5)};case _acf .ST_LegendPosT :_dca =&Rectangle {Top :_fbbb (2.5)+_edf ,Bottom :_fbbb (7.5),Left :(_cfgd .Right -_cfgd .Left )*0.25,Right :(_cfgd .Right -_cfgd .Left )*0.75};
if !_fbgd {_dffe =&Rectangle {Top :_fbbb (12.5)+_edf ,Bottom :_cfgd .Bottom -_fbbb (15),Left :_fbbb (10),Right :_cfgd .Right -_fbbb (5)};};_cef =true ;case _acf .ST_LegendPosB :_dca =&Rectangle {Top :_cfgd .Bottom -_fbbb (7.5)+_edf ,Bottom :_cfgd .Bottom -_fbbb (2.5),Left :(_cfgd .Right -_cfgd .Left )*0.25,Right :(_cfgd .Right -_cfgd .Left )*0.75};
if !_fbgd {_dffe =&Rectangle {Top :_fbbb (5)+_edf ,Bottom :_cfgd .Bottom -_fbbb (15),Left :_fbbb (10),Right :_cfgd .Right -_fbbb (5)};};_cef =true ;case _acf .ST_LegendPosR :_dca =&Rectangle {Top :(_cfgd .Bottom -_cfgd .Top )/2-_fbbb (10)+_edf ,Bottom :(_cfgd .Bottom -_cfgd .Top )/2+_fbbb (10),Left :_cfgd .Right -_fbbb (22.5),Right :_cfgd .Right -_fbbb (2.5)};
if !_fbgd {_dffe =&Rectangle {Top :_fbbb (5)+_edf ,Bottom :_cfgd .Bottom -_fbbb (12.5),Left :_fbbb (10),Right :_cfgd .Right -_fbbb (25)};};case _acf .ST_LegendPosL :_dca =&Rectangle {Top :(_cfgd .Bottom -_cfgd .Top )/2-_fbbb (10)+_edf ,Bottom :(_cfgd .Bottom -_cfgd .Top )/2+_fbbb (10),Left :_fbbb (2.5),Right :_fbbb (22.5)};
if !_fbgd {_dffe =&Rectangle {Top :_fbbb (5)+_edf ,Bottom :_cfgd .Bottom -_fbbb (12.5),Left :_fbbb (30),Right :_cfgd .Right -_fbbb (5)};};default:_dca =&Rectangle {Top :(_cfgd .Bottom -_cfgd .Top )/2-_fbbb (10)+_edf ,Bottom :(_cfgd .Bottom -_cfgd .Top )/2+_fbbb (10),Left :_cfgd .Right -_fbbb (25),Right :_cfgd .Right -_fbbb (5)};
if !_fbgd {_dffe =&Rectangle {Top :_fbbb (5)+_edf ,Bottom :_cfgd .Bottom -_fbbb (12.5),Left :_fbbb (100),Right :_cfgd .Right -_fbbb (25)};};};};};_dffe .scale (_aee );_bbb .drawBorderWithProps (_abc .SpPr ,_dffe ,_ccb );_afa :=[]*legendItem {};var _bgd error ;
_ccfd :=_abc .PlotAreaChoice1 ;for _ ,_gaa :=range _abc .PlotAreaChoice {if _gbaa :=_gaa .BarChart ;_gbaa !=nil {_afa ,_bgd =_bbb .drawBarChart (_gbaa ,_dffe ,_ccfd ,_fbd );if _bgd !=nil {return nil ,_bgd ;};break ;};if _eef :=_gaa .PieChart ;_eef !=nil {_afa ,_bgd =_bbb .drawPieChart (_eef ,_dffe ,_fbd ,_aee );
if _bgd !=nil {return nil ,_bgd ;};break ;};if _add :=_gaa .ScatterChart ;_add !=nil {_afa ,_bgd =_bbb .drawScatterChart (_add ,_dffe ,_ccfd ,_aee );if _bgd !=nil {return nil ,_bgd ;};break ;};if _bag :=_gaa .LineChart ;_bag !=nil {_afa ,_bgd =_bbb .drawLineChart (_bag ,_dffe ,_ccfd ,_aee );
if _bgd !=nil {return nil ,_bgd ;};break ;};if _fdda :=_gaa .AreaChart ;_fdda !=nil {_afa ,_bgd =_bbb .drawAreaChart (_fdda ,_dffe ,_ccfd ,_aee );if _bgd !=nil {return nil ,_bgd ;};break ;};};if _aae !=nil {_dca .scale (_aee );_bbb .drawBorderWithProps (_aae .SpPr ,_dca ,_ccb );
if len (_afa )!=0{_bbb .drawLegend (_dca ,_afa ,_cef );};};};_cfgd .scale (_aee );_bbb .drawBorderWithProps (_gebe .SpPr ,_cfgd ,_ccb );return _dfdf ,nil ;};type barSerByOrder []*_acf .CT_BarSer ;func (_cfgb barSerByOrder )Less (i ,j int )bool {return _cfgb [i ].Order .ValAttr < _cfgb [j ].Order .ValAttr ;
};func (_ded *creatorContext )addCatName (_gba string ,_cc map[string ]serCategory ,_cdb *[]string ){if _ ,_adf :=_cc [_gba ];!_adf {_cc [_gba ]=serCategory {_egd :_gba ,_ecb :[]serValue {}};*_cdb =append (*_cdb ,_gba );};};func (_agde *creatorContext )drawLineWithProps (_adff *_df .CT_ShapeProperties ,_dcbd ,_dced ,_bcba ,_ecbg float64 ,_aaca bool ){if _adff !=nil {if _dfdfc :=_adff .Ln ;
_dfdfc !=nil {_dgee :=_agde .getPdfColorFromSolidFill (_dfdfc .LineFillPropertiesChoice .SolidFill );if _dgee ==nil &&_aaca {_dgee =_ed .ColorBlack ;};if _dgee !=nil {var _gfgdb float64 ;if _afge :=_dfdfc .WAttr ;_afge !=nil {_gfgdb =_bg .FromEMU (int64 (*_afge ));
}else {_gfgdb =_ccb ;};DrawLine (_agde ._aga ,_dcbd ,_dced ,_bcba ,_ecbg ,_gfgdb ,_dgee );};};};};func GetDataFromXfrm (xfrm *_df .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _ebac ,_dbbg ,_eaac ,_cddc float64 ;if _beag :=xfrm .Off ;_beag !=nil {_ebac =_bg .FromEMU (FromSTCoordinate (_beag .XAttr ));
_dbbg =_bg .FromEMU (FromSTCoordinate (_beag .YAttr ));};if _gddb :=xfrm .Ext ;_gddb !=nil {_eaac =_bg .FromEMU (_gddb .CxAttr );_cddc =_bg .FromEMU (_gddb .CyAttr );};return _ebac ,_dbbg ,_eaac ,_cddc ;};type PageSize int ;func _efbe (_feac ,_ebcdd ,_egce uint8 )(float64 ,float64 ,float64 ){_bfcg ,_dgac ,_ace :=float64 (_feac )/255,float64 (_ebcdd )/255,float64 (_egce )/255;
_afbe :=_bfcg ;if _dgac < _afbe {_afbe =_dgac ;};if _ace < _afbe {_afbe =_ace ;};var _cagf ,_aefg bool ;_ffdb :=_bfcg ;if _dgac > _ffdb {_ffdb =_dgac ;_cagf =true ;};if _ace > _ffdb {_ffdb =_ace ;_cagf =false ;_aefg =true ;};_bafbe :=(_afbe +_ffdb )/2;
var _dfg float64 ;if _afbe !=_ffdb {if _bafbe <=0.5{_dfg =(_ffdb -_afbe )/(_ffdb +_afbe );}else {_dfg =(_ffdb -_afbe )/(2.0-_ffdb -_afbe );};};var _cff float64 ;if _afbe !=_ffdb {if _cagf {_cff =2.0+(_ace -_bfcg )/(_ffdb -_afbe );}else if _aefg {_cff =4.0+(_bfcg -_dgac )/(_ffdb -_afbe );
}else {_cff =(_dgac -_ace )/(_ffdb -_afbe );};_cff *=60;if _cff < 0{_cff +=360;};};return _cff ,_dfg ,_bafbe ;};type fontsMap struct{_dfaa *_e .Mutex ;_dda map[string ]map[FontStyle ]*_ac .PdfFont ;};func _bagc (_dgf uint8 ,_ffad float64 )string {_gcef :=float64 (_dgf );
var _dcfgd float64 ;if _ffad < 0{_dcfgd =_gcef *(1+_ffad );}else {_dcfgd =_gcef +(255-_gcef )*_ffad ;};return _f .Sprintf ("\u0025\u0030\u0032\u0078",int (_dcfgd ));};func MakeTempCreatorMaxHeight (width float64 )*_ed .Creator {return MakeTempCreator (width ,MaxPageHeight );
};func _cgae (_bdfd *_acf .CT_SerAx )(uint32 ,_acf .ST_AxPos ,_acf .ST_TickMark ,_acf .ST_TickLblPos ,*_acf .CT_ChartLines ,uint32 ,*_df .CT_ShapeProperties ,error ){var _dfe ,_cbc uint32 ;var _dabc _acf .ST_AxPos ;var _bcab _acf .ST_TickMark ;var _eab *_acf .CT_ChartLines ;
var _eebb _acf .ST_TickLblPos ;if _bdfd .AxId ==nil {return _dfe ,_dabc ,_bcab ,_eebb ,_eab ,_cbc ,_bdfd .SpPr ,_ge .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_dfe =_bdfd .AxId .ValAttr ;};if _bdfd .AxPos ==nil {return _dfe ,_dabc ,_bcab ,_eebb ,_eab ,_cbc ,_bdfd .SpPr ,_ge .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");
}else {_dabc =_bdfd .AxPos .ValAttr ;};if _bdfd .MajorTickMark !=nil {_bcab =_bdfd .MajorTickMark .ValAttr ;};if _bdfd .TickLblPos !=nil {_eebb =_bdfd .TickLblPos .ValAttr ;};if _bdfd .CrossAx ==nil {return _dfe ,_dabc ,_bcab ,_eebb ,_eab ,_cbc ,_bdfd .SpPr ,_ge .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_cbc =_bdfd .CrossAx .ValAttr ;};_eab =_bdfd .MajorGridlines ;return _dfe ,_dabc ,_bcab ,_eebb ,_eab ,_cbc ,_bdfd .SpPr ,nil ;};func GetGroupOffsetFromXfrm (xfrm *_df .CT_GroupTransform2D )(float64 ,float64 ){var _agac ,_dgca float64 ;if xfrm .Off !=nil &&xfrm .ChOff !=nil {_agac =_bg .FromEMU (FromSTCoordinate (xfrm .Off .XAttr ))-_bg .FromEMU (FromSTCoordinate (xfrm .ChOff .XAttr ));
_dgca =_bg .FromEMU (FromSTCoordinate (xfrm .Off .YAttr ))-_bg .FromEMU (FromSTCoordinate (xfrm .ChOff .YAttr ));};return _agac ,_dgca ;};func GetImage (c *_ed .Creator ,goImg _be .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_ed .Image ,error ){if goImg ==nil {return nil ,nil ;
};_ggc :=goImg .Bounds ().Size ();_cgeb :=_ggc .X ;_ebde :=_ggc .Y ;if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_cgeb );};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_ebde );};var _bgbe _be .Rectangle ;switch part {case ImgPart_t :_bgbe =_be .Rect (0,0,_cgeb ,int (dividerY ));
case ImgPart_b :_bgbe =_be .Rect (0,int (dividerY ),_cgeb ,_ebde );case ImgPart_l :_bgbe =_be .Rect (0,0,int (dividerX ),_ebde );case ImgPart_r :_bgbe =_be .Rect (int (dividerX ),0,_cgeb ,_ebde );case ImgPart_lt :_bgbe =_be .Rect (0,0,int (dividerX ),int (dividerY ));
case ImgPart_rt :_bgbe =_be .Rect (int (dividerX ),0,_cgeb ,int (dividerY ));case ImgPart_lb :_bgbe =_be .Rect (0,int (dividerY ),int (dividerX ),_ebde );case ImgPart_rb :_bgbe =_be .Rect (int (dividerX ),int (dividerY ),_cgeb ,_ebde );default:_bgbe =_be .Rect (0,0,_cgeb ,_ebde );
};_gfbcc :=CropImageByRect (goImg ,_bgbe );_bfeg ,_cccc :=c .NewImageFromGoImage (_gfbcc );if _cccc !=nil {return nil ,_cccc ;};_bfeg .Scale (imgWidth /float64 (_cgeb ),imgHeight /float64 (_ebde ));_bfeg .SetPos (left ,top );return _bfeg ,nil ;};func GetColorStringFromDmlColor (dmlColor *_df .CT_Color )string {var _bcg string ;
if _bbfa :=dmlColor .SrgbClr ;_bbfa !=nil {_bcg =_bbfa .ValAttr ;}else if _efcd :=dmlColor .SysClr ;_efcd !=nil {if _efcd .LastClrAttr !=nil {return *_efcd .LastClrAttr ;};return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _bcg ;};const (ImgPart_whole ImgPart =0;
ImgPart_t ImgPart =1;ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;ImgPart_rt ImgPart =6;ImgPart_lb ImgPart =7;ImgPart_rb ImgPart =8;);type serCategory struct{_egd string ;_ecb []serValue ;};func _becf (_bea _df .ST_SchemeColorVal ,_ecgd *_df .Theme )string {if _gbb :=_ecgd .ThemeElements ;
_gbb !=nil {if _cdbc :=_gbb .ClrScheme ;_cdbc !=nil {switch _bea {case _df .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_cdbc .Lt1 );case _df .ST_SchemeColorValDk1 ,_df .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_cdbc .Dk1 );
case _df .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_cdbc .Lt2 );case _df .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_cdbc .Dk2 );case _df .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_cdbc .Accent1 );case _df .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_cdbc .Accent2 );
case _df .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_cdbc .Accent3 );case _df .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_cdbc .Accent4 );case _df .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_cdbc .Accent5 );
case _df .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_cdbc .Accent6 );};};};return "";};func MakeBlockFromChartSpace (cs *_acf .ChartSpace ,width ,height float64 ,theme *_df .Theme )(*_ed .Block ,error ){_gfgd ,_bec :=_dce (cs ,width ,height ,theme ,false ,nil );
if _bec !=nil {return nil ,_bec ;};_bdd ,_bec :=GetPageFromCreator (_gfgd );if _bec !=nil {return nil ,_bec ;};_daf ,_bec :=_ed .NewBlockFromPage (_bdd );if _bec !=nil {return nil ,_bec ;};return _daf ,nil ;};func _ebbfd (_fdab float64 )float64 {if _fdab < 0{_fdab +=float64 (-int (_fdab )+1);
}else if _fdab > 1{_fdab -=float64 (int (_fdab ));};return _fdab ;};func GetRegisteredFont (name string ,style FontStyle )*_ac .PdfFont {_eec ._dfaa .Lock ();defer _eec ._dfaa .Unlock ();if _aac ,_aeeb :=_eec ._dda [name ];_aeeb {if _eegb ,_fde :=_aac [style ];
_fde {return _eegb ;};};return nil ;};func MakeTempCreator (width ,height float64 )*_ed .Creator {_bafa :=_ed .New ();_bafa .SetPageSize (_ed .PageSize {width ,height });_bafa .SetPageMargins (0,0,0,0);return _bafa ;};func (_afbf *Rectangle )Translate (x ,y float64 ){_afbf .Left +=x ;
_afbf .Right +=x ;_afbf .Top +=y ;_afbf .Bottom +=y ;};func FromSTCoordinate32 (st _df .ST_Coordinate32 )int64 {if _agbd :=st .ST_Coordinate32Unqualified ;_agbd !=nil {return int64 (*_agbd );};return 0;};var _dgbd =_fbbb (2);type Rectangle struct{Top float64 ;
Bottom float64 ;Left float64 ;Right float64 ;};func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_bg .Twips *10+0.5))/10;};func Lighten (clr float64 )float64 {return 0.6+0.4*clr };var _dgag =_fbbb (1.5);