//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_c "bytes";_da "errors";_fa "fmt";_ca "github.com/unidoc/unichart";_dee "github.com/unidoc/unichart/dataset";_ggb "github.com/unidoc/unichart/render";_gee "github.com/unidoc/unioffice/v2/common/logger";_fe "github.com/unidoc/unioffice/v2/document";
_ag "github.com/unidoc/unioffice/v2/measurement";_bda "github.com/unidoc/unioffice/v2/schema/soo/dml";_aa "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_cce "github.com/unidoc/unioffice/v2/spreadsheet";_ea "github.com/unidoc/unioffice/v2/spreadsheet/format";
_de "github.com/unidoc/unioffice/v2/spreadsheet/formula";_gg "github.com/unidoc/unioffice/v2/spreadsheet/reference";_bb "github.com/unidoc/unipdf/v4/core";_e "github.com/unidoc/unipdf/v4/creator";_cb "github.com/unidoc/unipdf/v4/model";_bc "github.com/unidoc/unipdf/v4/render";
_bg "github.com/unidoc/unitype";_d "image";_a "image/color";_bd "math";_b "os";_gef "regexp";_fb "sort";_cc "strconv";_df "strings";_ge "sync";_f "unicode";);func GetColorStringFromDmlColor (dmlColor *_bda .CT_Color )string {var _bafd string ;if _efg :=dmlColor .SrgbClr ;
_efg !=nil {_bafd =_efg .ValAttr ;}else if _ead :=dmlColor .SysClr ;_ead !=nil {if _ead .LastClrAttr !=nil {return *_ead .LastClrAttr ;};return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _bafd ;};func _ggfe (_fbgd float64 )float64 {if _fbgd < 0{_fbgd +=float64 (-int (_fbgd )+1);
}else if _fbgd > 1{_fbgd -=float64 (int (_fbgd ));};return _fbgd ;};type BorderPosition byte ;func GetDefaultPageSize ()_e .PageSize {return _bgaf [DefaultPageSize ]};func _cdg (_acgfg ,_cfae ,_aebeg float64 )(uint8 ,uint8 ,uint8 ){var _gfd float64 ;if _aebeg < 0.5{_gfd =_aebeg *(1+_cfae );
}else {_gfd =_aebeg +_cfae -_aebeg *_cfae ;};_bab :=_aebeg *2-_gfd ;_acgfg /=360.0;_ecce :=_ggfe (_acgfg +1.0/3.0);_bdc :=_ggfe (_acgfg );_bde :=_ggfe (_acgfg -1.0/3.0);_cgab :=_cec (_ecce ,_gfd ,_bab );_agbf :=_cec (_bdc ,_gfd ,_bab );_cdac :=_cec (_bde ,_gfd ,_bab );
return uint8 (255*_cgab ),uint8 (255*_agbf ),uint8 (255*_cdac );};func (_aea FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_aea )];
};var _abd =_ecfc (1);var _acb =_ecfc (1.5);func GetGroupOffsetFromXfrm (xfrm *_bda .CT_GroupTransform2D )(float64 ,float64 ){var _cbad ,_fccd float64 ;if xfrm .Off !=nil &&xfrm .ChOff !=nil {_cbad =_ag .FromEMU (FromSTCoordinate (xfrm .Off .XAttr ))-_ag .FromEMU (FromSTCoordinate (xfrm .ChOff .XAttr ));
_fccd =_ag .FromEMU (FromSTCoordinate (xfrm .Off .YAttr ))-_ag .FromEMU (FromSTCoordinate (xfrm .ChOff .YAttr ));};return _cbad ,_fccd ;};func Lighten (clr float64 )float64 {return 0.6+0.4*clr };func (_dbaa *Rectangle )scale (_beg float64 ){_dbaa .Top *=_beg ;
_dbaa .Bottom *=_beg ;_dbaa .Left *=_beg ;_dbaa .Right *=_beg ;};var _ada =_ecfc (0.125);func GetRegisteredFont (name string ,style FontStyle )*_cb .PdfFont {_fdgd ._dgae .Lock ();defer _fdgd ._dgae .Unlock ();if _ddea ,_afdf :=_fdgd ._gag [name ];_afdf {if _dcgf ,_bff :=_ddea [style ];
_bff {return _dcgf ;};};return nil ;};func RegisterFontsFromFiles (files []string )error {for _ ,_gaae :=range files {if _df .HasSuffix (_gaae ,"\u002e\u0074\u0074\u0066"){_edcd :=_gcce (_gaae );if _edcd !=nil {_gee .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_edcd );
continue ;};};};return nil ;};const (BorderPositionTop BorderPosition =0;BorderPositionLeft BorderPosition =1;BorderPositionBottom BorderPosition =2;BorderPositionRight BorderPosition =3;);var _faa =_ecfc (1.5);func AdjustColorByShade (colorStr string ,shade float64 )string {var _bcb ,_fcd ,_eeb uint8 ;
_fdfg ,_ :=_fa .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_bcb ,&_fcd ,&_eeb );if _fdfg !=3{return "";};return _ggbc (_bcb ,shade )+_ggbc (_fcd ,shade )+_ggbc (_eeb ,shade );};var _adc =_ecfc (2);func _cec (_beag ,_dgfb ,_agbb float64 )float64 {if _beag *6< 1{return _agbb +(_dgfb -_agbb )*6*_beag ;
}else if _beag *2< 1{return _dgfb ;}else if _beag *3< 2{return _agbb +(_dgfb -_agbb )*(2.0/3.0-_beag )*6;}else {return _agbb ;};};var _fceg =_ecfc (0.5);func _fga (_fccf *_aa .CT_DateAx )(uint32 ,_aa .ST_AxPos ,_aa .ST_TickMark ,_aa .ST_TickLblPos ,*_aa .CT_ChartLines ,uint32 ,*_bda .CT_ShapeProperties ,error ){var _daff ,_gggb uint32 ;
var _gaa _aa .ST_AxPos ;var _dgf _aa .ST_TickMark ;var _ggcg *_aa .CT_ChartLines ;var _acefg _aa .ST_TickLblPos ;if _fccf .AxId ==nil {return _daff ,_gaa ,_dgf ,_acefg ,_ggcg ,_gggb ,_fccf .SpPr ,_da .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_daff =_fccf .AxId .ValAttr ;};if _fccf .AxPos ==nil {return _daff ,_gaa ,_dgf ,_acefg ,_ggcg ,_gggb ,_fccf .SpPr ,_da .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_gaa =_fccf .AxPos .ValAttr ;
};if _fccf .MajorTickMark !=nil {_dgf =_fccf .MajorTickMark .ValAttr ;};if _fccf .TickLblPos !=nil {_acefg =_fccf .TickLblPos .ValAttr ;};if _fccf .CrossAx ==nil {return _daff ,_gaa ,_dgf ,_acefg ,_ggcg ,_gggb ,_fccf .SpPr ,_da .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_gggb =_fccf .CrossAx .ValAttr ;};_ggcg =_fccf .MajorGridlines ;return _daff ,_gaa ,_dgf ,_acefg ,_ggcg ,_gggb ,_fccf .SpPr ,nil ;};type Rectangle struct{Top float64 ;Bottom float64 ;Left float64 ;Right float64 ;};func LoadFontFromFile (filename string )(*_cb .PdfFont ,error ){if !_df .HasSuffix (filename ,"\u002e\u0074\u0074\u0066"){_gee .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return nil ,_fa .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_ddgb ,_fggc :=_cb .NewCompositePdfFontFromTTFFile (filename );if _fggc !=nil {return nil ,_fggc ;};return _ddgb ,nil ;};type serValue struct{_dga string ;_agf float64 ;_cae *_bda .CT_ShapeProperties ;};type barSerByOrder []*_aa .CT_BarSer ;func (_age *creatorContext )drawAxes (_fdc []*_aa .CT_PlotAreaChoice1 ,_fgb ,_aag ,_abgf float64 ,_bbbe []string ,_ece *Rectangle ,_dcb bool )error {_cfcf :=_age ._fdba ;
_aaac :=_age ._gfcd ;if _fdc ==nil {return _da .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};var (_eceg *_aa .CT_ValAx ;_faef *_aa .CT_CatAx ;_dff *_aa .CT_DateAx ;_gegc *_aa .CT_SerAx ;
);for _ ,_bdb :=range _fdc {if _bdb .ValAx !=nil {_eceg =_bdb .ValAx ;}else if _bdb .CatAx !=nil {_faef =_bdb .CatAx ;}else if _bdb .DateAx !=nil {_dff =_bdb .DateAx ;}else if _bdb .SerAx !=nil {_gegc =_bdb .SerAx ;};};if _eceg ==nil ||(_faef ==nil &&_dff ==nil &&_gegc ==nil ){return _da .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");
};var _gdg ,_cfee ,_aebe ,_fgbf uint32 ;var _ggeba ,_ggf _aa .ST_AxPos ;var _bacf ,_bee _aa .ST_TickMark ;var _ege ,_eab *_aa .CT_ChartLines ;var _cebc ,_cead _aa .ST_TickLblPos ;var _feb ,_bce *_bda .CT_ShapeProperties ;var _egga error ;_afed :=_ece .Right -_ece .Left ;
_ced :=_ece .Bottom -_ece .Top ;if _eceg !=nil {_cfee ,_ggf ,_bee ,_cead ,_eab ,_fgbf ,_bce ,_egga =_gac (_eceg );};if _ggf !=_aa .ST_AxPosL &&_ggf !=_aa .ST_AxPosB {return _da .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};_fdg :=_aag -_fgb ;_bdgg :=int (_fdg /_abgf )+1;var _eaee ,_bbfg float64 ;switch _bee {case _aa .ST_TickMarkIn :_eaee ,_bbfg =_abd ,0;case _aa .ST_TickMarkOut :_eaee ,_bbfg =0,_abd ;case _aa .ST_TickMarkCross :_eaee ,_bbfg =_abd ,_abd ;};_eaee =_eaee *_aaac ;
_bbfg =_bbfg *_aaac ;var _efd *_bda .CT_ShapeProperties ;if _eab !=nil {_efd =_eab .SpPr ;};_gca ,_effg :=_cebc !=_aa .ST_TickLblPosNone ,_cead !=_aa .ST_TickLblPosNone ;_fcf :=_fgb ;if _faef !=nil {_gdg ,_ggeba ,_bacf ,_cebc ,_ege ,_aebe ,_feb ,_egga =_bgg (_faef );
}else if _dff !=nil {_gdg ,_ggeba ,_bacf ,_cebc ,_ege ,_aebe ,_feb ,_egga =_fga (_dff );}else if _gegc !=nil {_gdg ,_ggeba ,_bacf ,_cebc ,_ege ,_aebe ,_feb ,_egga =_ebaa (_gegc );};if _egga !=nil {return _egga ;};if _ggeba !=_aa .ST_AxPosL &&_ggeba !=_aa .ST_AxPosB {return _da .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};if _gdg !=_fgbf ||_cfee !=_aebe {return _da .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_bfe :=len (_bbbe )+1;var _gefg ,_bdggf float64 ;switch _bacf {case _aa .ST_TickMarkIn :_gefg ,_bdggf =_abd ,0;
case _aa .ST_TickMarkOut :_gefg ,_bdggf =0,_abd ;case _aa .ST_TickMarkCross :_gefg ,_bdggf =_abd ,_abd ;};_gefg =_gefg *_aaac ;_bdggf =_bdggf *_aaac ;var _gde *_bda .CT_ShapeProperties ;if _ege !=nil {_gde =_ege .SpPr ;};if _dcb {_dgbf :=_ced /float64 (len (_bbbe ));
_aaab :=_ece .Left -_fgb *_afed /_fdg ;_ebab :=_aaab -_dad *_aaac ;if _gca {var _bae float64 ;for _bdab :=0;_bdab < _bfe ;_bdab ++{_dffd :=_ece .Bottom -float64 (_bdab )*_dgbf ;if _bdab < _bfe -1{_bgde :=_cfcf .NewParagraph (_bbbe [_bdab ]);_bgde .SetFontSize (_fgfe *_aaac );
_bgde .SetPos (_ebab ,_dffd -_dgbf /2-_faa *_aaac );_cfcf .Draw (_bgde );_bbfb :=(_bgde .Width ()/1000-_dad )*_aaac ;if _bbfb > 0&&_bbfb > _bae {_bae =_bbfb ;};};};if _bae > 0{_ece .Left +=_bae +_adc ;_aaab =_ece .Left -_fgb *_afed /_fdg ;_afed =_ece .Right -_ece .Left ;
};};_afc :=_aaab -_bdggf ;_cda :=_aaab +_gefg ;_fef :=_ece .Left ;_eefg :=_ece .Right ;for _gfa :=0;_gfa < _bfe ;_gfa ++{_bcd :=_ece .Bottom -float64 (_gfa )*_dgbf ;_age .drawLineWithProps (_feb ,_afc ,_bcd ,_cda ,_bcd ,true );_age .drawLineWithProps (_gde ,_fef ,_bcd ,_eefg ,_bcd ,true );
};_dgba :=_afed /_fdg ;_cbe :=_ece .Bottom -_eaee ;_dda :=_ece .Bottom +_bbfg ;_bcca :=_ece .Top ;_baf :=_ece .Bottom ;for _cfca :=0;_cfca < _bdgg ;_cfca ++{_ebag :=_ece .Left +(_fcf -_fgb )*_dgba ;_age .drawLineWithProps (_bce ,_ebag ,_cbe ,_ebag ,_dda ,true );
_age .drawLineWithProps (_efd ,_ebag ,_bcca ,_ebag ,_baf ,true );if _effg {_deb :=_cfcf .NewParagraph (_cc .FormatFloat (_fcf ,'g',-1,64));_deb .SetFontSize (_fgfe *_aaac );_deb .SetPos (_ebag -_fceg *_aaac ,_baf +_gff *_aaac );_cfcf .Draw (_deb );};_fcf +=_abgf ;
};}else {_egb :=_ced /_fdg ;_gcdff :=_ece .Left ;if _effg {var _abea float64 ;for _dada :=0;_dada < _bdgg ;_dada ++{_gdfa :=_ece .Bottom -(_fcf -_fgb )*_egb ;_egd :=_cfcf .NewParagraph (_cc .FormatFloat (_fcf ,'g',-1,64));_egd .SetFontSize (_fgfe *_aaac );
_egd .SetPos (_gcdff -_dad *_aaac ,_gdfa -_faa *_aaac );_cfcf .Draw (_egd );_bged :=(_egd .Width ()/1000-_dad )*_aaac ;if _bged > 0&&_bged > _abea {_abea =_bged ;};_fcf +=_abgf ;};if _abea > 0{_ece .Left +=_abea +_adc ;_afed =_ece .Right -_ece .Left ;};
};_fcf =_fgb ;_gaea :=_ece .Left -_bbfg ;_ebc :=_ece .Left +_eaee ;_gcdff =_ece .Left ;_cfg :=_ece .Right ;for _adgf :=0;_adgf < _bdgg ;_adgf ++{_fafe :=_ece .Bottom -(_fcf -_fgb )*_egb ;_age .drawLineWithProps (_bce ,_gaea ,_fafe ,_ebc ,_fafe ,true );
_age .drawLineWithProps (_efd ,_gcdff ,_fafe ,_cfg ,_fafe ,true );_fcf +=_abgf ;};_bbbg :=_afed /float64 (len (_bbbe ));_ebgg :=_ece .Bottom +_fgb *_ced /_fdg ;_ddf :=_ebgg -_gefg ;_gga :=_ebgg +_bdggf ;_edd :=_ece .Top ;_abf :=_ece .Bottom ;_ddag :=_ebgg +_gff *_aaac ;
for _cbd :=0;_cbd < _bfe ;_cbd ++{_dbd :=_ece .Left +float64 (_cbd )*_bbbg ;_age .drawLineWithProps (_feb ,_dbd ,_ddf ,_dbd ,_gga ,true );_age .drawLineWithProps (_gde ,_dbd ,_edd ,_dbd ,_abf ,true );if _gca &&_cbd < _bfe -1{_bgdf :=_cfcf .NewParagraph (_bbbe [_cbd ]);
_bgdf .SetFontSize (_fgfe *_aaac );_bgdf .SetPos (_dbd +_bebc *_aaac ,_ddag );_cfcf .Draw (_bgdf );};};};return nil ;};func MakeBlockFromCreator (c *_e .Creator )(*_e .Block ,error ){_becb ,_eedf :=GetPageFromCreator (c );if _eedf !=nil {return nil ,_eedf ;
};_adbd ,_eedf :=_e .NewBlockFromPage (_becb );if _eedf !=nil {return nil ,_eedf ;};return _adbd ,nil ;};func _aabfb (_bec _bda .ST_SchemeColorVal ,_afa *_bda .Theme )string {if _ecfe :=_afa .ThemeElements ;_ecfe !=nil {if _gbd :=_ecfe .ClrScheme ;_gbd !=nil {switch _bec {case _bda .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_gbd .Lt1 );
case _bda .ST_SchemeColorValDk1 ,_bda .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_gbd .Dk1 );case _bda .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_gbd .Lt2 );case _bda .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_gbd .Dk2 );
case _bda .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_gbd .Accent1 );case _bda .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_gbd .Accent2 );case _bda .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_gbd .Accent3 );
case _bda .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_gbd .Accent4 );case _bda .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_gbd .Accent5 );case _bda .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_gbd .Accent6 );
};};};return "";};func GetImage (c *_e .Creator ,goImg _d .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_e .Image ,error ){if goImg ==nil {return nil ,nil ;};_def :=goImg .Bounds ().Size ();_bgcg :=_def .X ;_afbg :=_def .Y ;
if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_bgcg );};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_afbg );};var _ccgbd _d .Rectangle ;switch part {case ImgPart_t :_ccgbd =_d .Rect (0,0,_bgcg ,int (dividerY ));case ImgPart_b :_ccgbd =_d .Rect (0,int (dividerY ),_bgcg ,_afbg );
case ImgPart_l :_ccgbd =_d .Rect (0,0,int (dividerX ),_afbg );case ImgPart_r :_ccgbd =_d .Rect (int (dividerX ),0,_bgcg ,_afbg );case ImgPart_lt :_ccgbd =_d .Rect (0,0,int (dividerX ),int (dividerY ));case ImgPart_rt :_ccgbd =_d .Rect (int (dividerX ),0,_bgcg ,int (dividerY ));
case ImgPart_lb :_ccgbd =_d .Rect (0,int (dividerY ),int (dividerX ),_afbg );case ImgPart_rb :_ccgbd =_d .Rect (int (dividerX ),int (dividerY ),_bgcg ,_afbg );default:_ccgbd =_d .Rect (0,0,_bgcg ,_afbg );};_eddc :=CropImageByRect (goImg ,_ccgbd );_begf ,_fdgg :=c .NewImageFromGoImage (_eddc );
if _fdgg !=nil {return nil ,_fdgg ;};_begf .Scale (imgWidth /float64 (_bgcg ),imgHeight /float64 (_afbg ));_begf .SetPos (left ,top );return _begf ,nil ;};var _agdf =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };
func (_dfge *creatorContext )drawRectangleWithProps (_ggaa *_bda .CT_ShapeProperties ,_gfbd ,_ebfce ,_dcd ,_fgd float64 ,_ebac bool ){_cdc :=_dfge ._fdba .NewRectangle (_gfbd ,_ebfce ,_dcd ,_fgd );if _ggaa ==nil {if _ebac {_cdc .SetBorderWidth (_ada );
}else {return ;};}else {_eag :=_dfge .getPdfColorFromSolidFill (_ggaa .FillPropertiesChoice .SolidFill );if _eag !=nil {_cdc .SetFillColor (_eag );};if _bdgb :=_ggaa .Ln ;_bdgb !=nil {if _baede :=_bdgb .WAttr ;_baede !=nil {_edag :=_ag .FromEMU (int64 (*_baede ));
_cdc .SetBorderWidth (_edag );if _gaee :=_bdgb .LineFillPropertiesChoice .SolidFill ;_gaee !=nil {_gceg :=_dfge .getPdfColorFromSolidFill (_gaee );if _gceg !=nil {_cdc .SetBorderColor (_gceg );};};}else {_cdc .SetBorderWidth (0);};};};_dfge ._fdba .Draw (_cdc );
};func _gac (_gcca *_aa .CT_ValAx )(uint32 ,_aa .ST_AxPos ,_aa .ST_TickMark ,_aa .ST_TickLblPos ,*_aa .CT_ChartLines ,uint32 ,*_bda .CT_ShapeProperties ,error ){var _bfgb ,_egfb uint32 ;var _aedg _aa .ST_AxPos ;var _cfaf _aa .ST_TickMark ;var _cgg *_aa .CT_ChartLines ;
var _fcbb _aa .ST_TickLblPos ;if _gcca .AxId ==nil {return _bfgb ,_aedg ,_cfaf ,_fcbb ,_cgg ,_egfb ,_gcca .SpPr ,_da .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_bfgb =_gcca .AxId .ValAttr ;};if _gcca .AxPos ==nil {return _bfgb ,_aedg ,_cfaf ,_fcbb ,_cgg ,_egfb ,_gcca .SpPr ,_da .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");
}else {_aedg =_gcca .AxPos .ValAttr ;};if _gcca .MajorTickMark !=nil {_cfaf =_gcca .MajorTickMark .ValAttr ;};if _gcca .TickLblPos !=nil {_fcbb =_gcca .TickLblPos .ValAttr ;};if _gcca .CrossAx ==nil {return _bfgb ,_aedg ,_cfaf ,_fcbb ,_cgg ,_egfb ,_gcca .SpPr ,_da .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_egfb =_gcca .CrossAx .ValAttr ;};_cgg =_gcca .MajorGridlines ;return _bfgb ,_aedg ,_cfaf ,_fcbb ,_cgg ,_egfb ,_gcca .SpPr ,nil ;};type fontsMap struct{_dgae *_ge .Mutex ;_gag map[string ]map[FontStyle ]*_cb .PdfFont ;};func AdjustColorByTint (colorStr string ,tint float64 )string {var _fbbg ,_fdcd ,_befg uint8 ;
_acea ,_ :=_fa .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_fbbg ,&_fdcd ,&_befg );if _acea !=3{return "";};return _cfab (_fbbg ,tint )+_cfab (_fdcd ,tint )+_cfab (_befg ,tint );};func AdjustColor (colorStr string ,EG_ColorTransform []*_bda .EG_ColorTransform )string {for _ ,_dfde :=range EG_ColorTransform {if _cfeg :=_dfde .ColorTransformChoice .Tint ;
_cfeg !=nil {if _ceed :=_cfeg .ValAttr .ST_PositiveFixedPercentageDecimal ;_ceed !=nil {colorStr =AdjustColorByTint (colorStr ,1.0-float64 (*_ceed )/Percent100 );};};if _bcgc :=_dfde .ColorTransformChoice .Shade ;_bcgc !=nil {if _acgd :=_bcgc .ValAttr .ST_PositiveFixedPercentageDecimal ;
_acgd !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_acgd )/Percent100 );};};if _dccb :=_dfde .ColorTransformChoice .LumMod ;_dccb !=nil {if _cfd :=_dccb .ValAttr .ST_PercentageDecimal ;_cfd !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_cfd )/Percent100 );
};};if _dffg :=_dfde .ColorTransformChoice .LumOff ;_dffg !=nil {if _agcc :=_dffg .ValAttr .ST_PercentageDecimal ;_agcc !=nil {colorStr =AdjustColorByLumOff (colorStr ,float64 (*_agcc )/Percent100 );};};};return colorStr ;};func (_cde *creatorContext )drawBarChart (_dac *_aa .CT_BarChart ,_bbda *Rectangle ,_acf []*_aa .CT_PlotAreaChoice1 ,_gfb *_cce .Workbook )([]*legendItem ,error ){var _cdd bool ;
if _aaa :=_dac .BarDir ;_aaa !=nil {_cdd =_aaa .ValAttr ==_aa .ST_BarDirBar ;};_gd :=_dac .Ser ;_fb .Sort (barSerByOrder (_gd ));_db :=map[string ]serCategory {};_fcg :=[]string {};_gebf :=[]*legendItem {};_adg :=_bd .Inf (1);_bbdc :=_bd .Inf (-1);for _ ,_eac :=range _gd {var _acg string ;
if _ga :=_eac .Tx ;_ga !=nil {if _cge :=_ga .SerTxChoice ;_cge !=nil {if _cge .V !=nil {_acg =*_cge .V ;}else if _ab :=_cge .StrRef ;_ab !=nil {if _geec :=_ab .StrCache ;_geec !=nil {for _ ,_fg :=range _geec .Pt {_acg =_fg .V ;};};};};};if _eg :=_eac .Cat ;
_eg !=nil {if _bbf :=_eg .AxDataSourceChoice ;_bbf !=nil {if _fca :=_bbf .StrRef ;_fca !=nil {if _ged :=_fca .F ;_ged !=""&&_gfb !=nil {_afg ,_aeb ,_beb ,_gebc :=ParseExcelRange (_ged );if _gebc ==nil {for _ ,_ed :=range _gfb .Sheets (){if _ed .Name ()==_df .Trim (_afg ,"\u0027"){_dbe :=_aeb .String ();
for _dc :=_aeb .RowIdx ;_dc <=_beb .RowIdx ;_dc +=1{_afd :=_df .ReplaceAll (_dbe ,_fa .Sprint (_aeb .RowIdx ),_fa .Sprint (_dc ));_cde .addCatName (_ed .Cell (_afd ).GetString (),_db ,&_fcg );};break ;};};};};if _fdb :=_fca .StrCache ;_fdb !=nil {for _ ,_eec :=range _fdb .Pt {_cde .addCatName (_eec .V ,_db ,&_fcg );
};};}else if _acfe :=_bbf .NumRef ;_acfe !=nil {if _bef :=_acfe .NumCache ;_bef !=nil {var _deef string ;if _bef .FormatCode !=nil {_deef =*_bef .FormatCode ;};for _ ,_fgf :=range _bef .Pt {var _gb string ;if _fgf .FormatCodeAttr ==nil {_gb =_deef ;}else {_gb =*_fgf .FormatCodeAttr ;
};var _cf string ;_ce ,_acgf :=_cc .ParseFloat (_fgf .V ,64);if _acgf !=nil {_cf =_fgf .V ;}else {_cf =_ea .Number (_ce ,_gb );};_cde .addCatName (_cf ,_db ,&_fcg );};};};};};if _bcf :=_eac .Val ;_bcf !=nil {if _bdf :=_bcf .NumDataSourceChoice ;_bdf !=nil {if _eaa :=_bdf .NumRef ;
_eaa !=nil {if _gab :=_eaa .F ;_gab !=""&&_gfb !=nil {_gge ,_daf ,_fdec ,_fce :=ParseExcelRange (_gab );if _fce ==nil {for _ ,_gc :=range _gfb .Sheets (){if _gc .Name ()==_df .Trim (_gge ,"\u0027"){_gaf :=_daf .String ();for _bbb :=_daf .RowIdx ;_bbb <=_fdec .RowIdx ;
_bbb +=1{_egf :=_df .ReplaceAll (_gaf ,_fa .Sprint (_daf .RowIdx ),_fa .Sprint (_bbb ));if _gc .FormulaContext ().HasFormula (_egf ){_dcc :=_de .NewEvaluator ();_bfa :=_gc .FormulaContext ().Cell (_egf ,_dcc );_dcf :=_bfa .Value ();_cde .addCatValue (_dcf ,_db ,_fcg ,(int )(_bbb -_daf .RowIdx ),&_adg ,&_bbdc ,_acg ,_eac .SpPr );
}else {_ega :=_gc .Cell (_egf ).GetString ();_cde .addCatValue (_ega ,_db ,_fcg ,(int )(_bbb -_daf .RowIdx ),&_adg ,&_bbdc ,_acg ,_eac .SpPr );};};break ;};};};};if _ccd :=_eaa .NumCache ;_ccd !=nil {for _gefc ,_dgb :=range _ccd .Pt {_cde .addCatValue (_dgb .V ,_db ,_fcg ,_gefc ,&_adg ,&_bbdc ,_acg ,_eac .SpPr );
};};};};};_gebf =append (_gebf ,&legendItem {_bfc :_acg ,_fdf :_eac .SpPr });};var _dfg float64 ;var _bcc ,_edf float64 ;if _bbdc ==0&&_adg ==0{_dfg =0.2;_edf =0;_bcc =1;}else {var _cgef float64 ;if _gbg :=_bd .Abs (_adg );_bbdc < _gbg {_cgef =_gbg ;}else {_cgef =_bbdc ;
};_aaad :=_bd .Pow (10,_bd .Floor (_bd .Log10 (_cgef )));_dfa :=_cgef /_aaad ;if _dfa < 4.29{_dfg =0.5;}else if _dfa >=4.29&&_dfa < 8.58{_dfg =1;}else {_dfg =2;};_dfg *=_aaad ;if _bbdc <=0{_bcc =0;}else {_bcc =(_bd .Ceil (_bbdc /_dfg )+1)*_dfg ;};if _adg >=0{_edf =0;
}else {_edf =(_bd .Floor (_adg /_dfg )-1)*_dfg ;};};_gdb :=_cde .drawAxes (_acf ,_edf ,_bcc ,_dfg ,_fcg ,_bbda ,_cdd );if _gdb !=nil {return nil ,_gdb ;};_aaae :=0.0;if _dac .GapWidth !=nil {if _aebc :=_dac .GapWidth .ValAttr ;_aebc !=nil {if _ecb :=_aebc .ST_GapAmountUShort ;
_ecb !=nil {_aaae =float64 (*_ecb )/100.0;};};};_gdd :=_bbda .Right -_bbda .Left ;_bbff :=_bbda .Bottom -_bbda .Top ;_bea :=float64 (len (_fcg ));if _cdd {_cff :=_bcc /(_bcc -_edf )*_gdd ;_ecg :=-_edf /(_bcc -_edf )*_gdd ;_aga :=_bbda .Left +_ecg ;_gae :=_bbff /_bea ;
for _cee ,_ba :=range _fcg {_ef :=_db [_ba ];_ffb :=float64 (len (_ef ._ffcg ))+_aaae ;_fff :=_gae /_ffb ;_bdg :=_fff *_aaae ;_cea :=_bbda .Bottom -float64 (_cee )*_gae -_bdg /2-_fff ;for _ ,_eaab :=range _ef ._ffcg {if _eaab ._agf ==0{continue ;};var _cffe ,_agd float64 ;
if _eaab ._agf > 0{_agd =_eaab ._agf /_bcc *_cff ;_cde .drawRectangleWithProps (_eaab ._cae ,_aga ,_cea ,_agd ,_fff ,false );}else {_agd =_eaab ._agf /_edf *_ecg ;_cffe =_aga -_agd ;_cde .drawRectangleWithProps (_eaab ._cae ,_cffe ,_cea ,_agd ,_fff ,false );
};_cea -=_fff ;};};}else {_ceb :=_bcc /(_bcc -_edf )*_bbff ;_fcac :=-_edf /(_bcc -_edf )*_bbff ;_ceaf :=_bbda .Top +_ceb ;_ggc :=_gdd /_bea ;for _ace ,_add :=range _fcg {_bge :=_db [_add ];_eacc :=float64 (len (_bge ._ffcg ))+_aaae ;_fda :=_ggc /_eacc ;
_gdf :=_fda *_aaae ;_cgd :=_bbda .Left +float64 (_ace )*_ggc +_gdf /2;for _ ,_acef :=range _bge ._ffcg {var _bad ,_agb float64 ;if _acef ._agf > 0{_agb =_acef ._agf /_bcc *_ceb ;_bad =_ceaf -_agb ;_cde .drawRectangleWithProps (_acef ._cae ,_cgd ,_bad ,_fda ,_agb ,false );
}else {_agb =_acef ._agf /_edf *_fcac ;_cde .drawRectangleWithProps (_acef ._cae ,_cgd ,_ceaf ,_fda ,_agb ,false );};_cgd +=_fda ;};};};return _gebf ,nil ;};func FillRectangle (c *_e .Creator ,x ,y ,width ,height float64 ,color _e .Color ){if color ==nil {return ;
};_gea :=c .NewRectangle (x ,y ,width ,height );_gea .SetFillColor (color );_gea .SetBorderWidth (0);c .Draw (_gea );};func RegisterFont (name string ,style FontStyle ,font *_cb .PdfFont ){_fdgd ._dgae .Lock ();if _fdgd ._gag [name ]==nil {_fdgd ._gag [name ]=map[FontStyle ]*_cb .PdfFont {};
};_fdgd ._gag [name ][style ]=font ;_fdgd ._dgae .Unlock ();};type legendItem struct{_bfc string ;_fdf *_bda .CT_ShapeProperties ;};var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};
func (_fdbc *creatorContext )drawLegend (_fbc *Rectangle ,_efb []*legendItem ,_ebg bool ){_bfab :=_fdbc ._gfcd ;_dbc :=_ecfc (2.5)*_bfab ;_bgd :=_acb *_bfab ;_bgb :=(_dbc -_bgd )/2;_dgd :=float64 (len (_efb ));if _ebg {_deca :=&Rectangle {Top :_fbc .Top +_ecfc (1)*_bfab ,Bottom :_fbc .Bottom -_ecfc (1)*_bfab ,Left :_fbc .Left +_ecfc (2.5)*_bfab ,Right :_fbc .Right -_ecfc (2.5)*_bfab };
var _eef float64 ;if _dgd > 1{_eef =(_deca .Right -_deca .Left )/_dgd ;};_acgg :=_deca .Left ;_adb :=_deca .Top ;for _ ,_afeg :=range _efb {if _gdae :=_afeg ._fdf ;_gdae !=nil {_fdbc .drawRectangleWithProps (_gdae ,_acgg ,_adb +_bgb ,_bgd ,_bgd ,false );
_ffcc :=_acgg +_bgd *2;_bfg :=_fdbc ._fdba .NewStyledParagraph ();_bfg .SetPos (_ffcc ,_adb );_dfaa :=_bfg .Append (_afeg ._bfc );_bac ,_cfa :=_cb .NewStandard14Font (_cb .HelveticaName );if _cfa ==nil {_fae :=_fdbc ._fdba .NewTextStyle ();_fae .Font =_bac ;
_fae .FontSize =_dbc ;_fae .TextRise =0.4;_dfaa .Style =_fae ;_fdbc ._fdba .Draw (_bfg );};};_acgg +=_eef ;};}else {_aabf :=&Rectangle {Top :_fbc .Top +_ecfc (2.5)*_bfab ,Bottom :_fbc .Bottom -_ecfc (2.5)*_bfab ,Left :_fbc .Left +_ecfc (2.5)*_bfab ,Right :_fbc .Right -_ecfc (2.5)*_bfab };
var _cga float64 ;if _dgd > 1{_cga =(_aabf .Bottom -_aabf .Top -_dbc )/(_dgd -1);if _cga < _dbc {_cga =_dbc ;};};_dccc :=_aabf .Top ;_gefca :=_aabf .Left ;_ceg :=_gefca +_bgd *2;for _ ,_bgba :=range _efb {if _fdeb :=_bgba ._fdf ;_fdeb !=nil {_fdbc .drawRectangleWithProps (_fdeb ,_gefca ,_dccc +_bgb ,_bgd ,_bgd ,false );
_ebb :=_fdbc ._fdba .NewStyledParagraph ();_ebb .SetPos (_ceg ,_dccc );_ebb .SetWidth (_aabf .Right -_aabf .Left );_gbe :=_ebb .Append (_bgba ._bfc );_eedg ,_daa :=_cb .NewStandard14Font (_cb .HelveticaName );if _daa ==nil {_gfbb :=_fdbc ._fdba .NewTextStyle ();
_gfbb .Font =_eedg ;_gfbb .FontSize =_dbc ;_gfbb .TextRise =0.4;_gbe .Style =_gfbb ;_fdbc ._fdba .Draw (_ebb );};};_dccc +=_cga ;};};};func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _dbg ,_gddd ,_ecca uint8 ;_efbe ,_ :=_fa .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_dbg ,&_gddd ,&_ecca );
if _efbe !=3{return "";};_adcc ,_fbd ,_aabe :=_dacc (_dbg ,_gddd ,_ecca );_aabe =lum *_aabe ;_dbg ,_gddd ,_ecca =_cdg (_adcc ,_fbd ,_aabe );return _fa .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_dbg ,_gddd ,_ecca );
};func MakeBlockFromChartSpace (cs *_aa .ChartSpace ,width ,height float64 ,theme *_bda .Theme )(*_e .Block ,error ){_cfc ,_gce :=_fbf (cs ,width ,height ,theme ,false ,nil );if _gce !=nil {return nil ,_gce ;};_deea ,_gce :=GetPageFromCreator (_cfc );if _gce !=nil {return nil ,_gce ;
};_cgf ,_gce :=_e .NewBlockFromPage (_deea );if _gce !=nil {return nil ,_gce ;};return _cgf ,nil ;};var RtlFontFile *_cb .PdfFont ;func _cfab (_ebf uint8 ,_acc float64 )string {_ecc :=float64 (_ebf );var _caa float64 ;if _acc < 0{_caa =_ecc *(1+_acc );
}else {_caa =_ecc +(255-_ecc )*_acc ;};return _fa .Sprintf ("\u0025\u0030\u0032\u0078",int (_caa ));};var _fdgd =fontsMap {_dgae :&_ge .Mutex {},_gag :map[string ]map[FontStyle ]*_cb .PdfFont {}};func CropImageByRect (sourceImg _d .Image ,rect _d .Rectangle )_d .Image {_cba ,_edaa ,_bdcac ,_efdg :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;
_efcd :=_d .NewNRGBA (_d .Rect (0,0,_bdcac -_cba ,_efdg -_edaa ));for _aeba :=_cba ;_aeba < _bdcac ;_aeba ++{for _cfdf :=_edaa ;_cfdf < _efdg ;_cfdf ++{_efcd .Set (_aeba -_cba ,_cfdf -_edaa ,sourceImg .At (_aeba ,_cfdf ));};};return _efcd ;};func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_ag .Twips *10+0.5))/10;
};var _bebc =_ecfc (5);func MakeTempCreator (width ,height float64 )*_e .Creator {_gfg :=_e .New ();_gfg .SetPageSize (_e .PageSize {width ,height });_gfg .SetPageMargins (0,0,0,0);return _gfg ;};func AssignStdFontByName (style _e .TextStyle ,fontName string )*_cb .PdfFont {_cdf :=_cb .StdFontName (fontName );
return _cb .NewStandard14FontMustCompile (_cdf );};type ImgPart byte ;func (_gbb *creatorContext )drawLineChart (_aeg *_aa .CT_LineChart ,_aggb *Rectangle ,_fdd []*_aa .CT_PlotAreaChoice1 ,_bca float64 )([]*legendItem ,error ){_bdca :=[]*legendItem {};
_efga :=_aeg .Ser ;_dbcd :=make (map[int ][]float64 );_edg :=make (map[int ][]float64 );_baaf :=make (map[int ]_e .Color );_gec :=make (map[int ]float64 );for _bbba ,_baed :=range _efga {var _ebff string ;if _fecf :=_baed .Tx ;_fecf !=nil {if _gegf :=_fecf .SerTxChoice ;
_gegf !=nil {if _gegf .V !=nil {_ebff =*_gegf .V ;}else if _ddee :=_gegf .StrRef ;_ddee !=nil {if _fafg :=_ddee .StrCache ;_fafg !=nil {for _ ,_aacd :=range _fafg .Pt {_ebff =_aacd .V ;};};};};};_baaf [_bbba ]=_e .ColorWhite ;if _bdd :=_baed .SpPr ;_bdd !=nil {if _cceca :=_bdd .Ln ;
_cceca !=nil {if _acbf :=_cceca .WAttr ;_acbf !=nil {_gec [_bbba ]=_ag .FromEMU (int64 (*_acbf ));if _fbe :=_cceca .LineFillPropertiesChoice .SolidFill ;_fbe !=nil {_cgdd :=_gbb .getPdfColorFromSolidFill (_fbe );if _cgdd !=nil {_baaf [_bbba ]=_cgdd ;};
};};};};if _egef :=_baed .Val ;_egef !=nil {if _acgb :=_egef .NumDataSourceChoice ;_acgb !=nil {if _fdabf :=_acgb .NumRef ;_fdabf !=nil {if _adf :=_fdabf .NumCache ;_adf !=nil {for _ ,_fdbcd :=range _adf .Pt {_dbcd [_bbba ]=append (_dbcd [_bbba ],float64 (_fdbcd .IdxAttr ));
_effgd ,_ :=_cc .ParseFloat (_df .TrimSpace (_fdbcd .V ),64);_edg [_bbba ]=append (_edg [_bbba ],_effgd );};};};};};_bdca =append (_bdca ,&legendItem {_bfc :_ebff ,_fdf :_baed .SpPr });};_bgda :=true ;_ecff :=true ;_cbdd :="";_gabb :="";if len (_fdd )> 0{for _ ,_cgee :=range _fdd {if _cgee .CatAx !=nil {if _cgee .CatAx .Delete !=nil {if !*(*_cgee .CatAx .Delete ).ValAttr {_bgda =false ;
};};_cbdd =_gbb .getTitle (_cgee .CatAx .Title );}else if _cgee .ValAx !=nil {if _cgee .ValAx .Delete !=nil {if !*(*_cgee .ValAx .Delete ).ValAttr {_ecff =false ;};};_gabb =_gbb .getTitle (_cgee .ValAx .Title );};};};_abc :=_ggb .Style {Hidden :_bgda ,FontSize :8*_bca };
_eecc :=_ggb .Style {Hidden :_ecff ,FontSize :8*_bca };_edb :=&_ca .Chart {Series :[]_dee .Series {},YAxisSecondary :_ca .YAxis {Style :_eecc ,Name :_gabb ,NameStyle :_eecc },XAxis :_ca .XAxis {Style :_abc ,Name :_cbdd ,NameStyle :_abc },YAxis :_ca .YAxis {Style :_ggb .Style {Hidden :true }}};
for _ebfc :=0;_ebfc < len (_baaf );_ebfc ++{_dce ,_dbbb ,_beec :=_baaf [_ebfc ].ToRGB ();_eafe :=_dee .ContinuousSeries {XValues :_dbcd [_ebfc ],YValues :_edg [_ebfc ],Style :_ggb .Style {StrokeColor :_a .RGBA {uint8 (_dce *255),uint8 (_dbbb *255),uint8 (_beec *255),255},StrokeWidth :_gec [_ebfc ]}};
_edb .Series =append (_edb .Series ,_eafe );};_edb .SetHeight (int (_bd .Abs (_aggb .Top -_aggb .Bottom )));_edb .SetWidth (int (_bd .Abs (_aggb .Right -_aggb .Left )));_dbbbc :=_gbb ._fdba ;_eaac :=_e .NewChart (_edb );_eaac .SetPos (_aggb .Left ,_aggb .Top );
_acdc :=_dbbbc .Draw (_eaac );if _acdc !=nil {return nil ,_acdc ;};return _bdca ,nil ;};func (_ggeb barSerByOrder )Len ()int {return len (_ggeb )};func (_fcge *creatorContext )getTitle (_dfe *_aa .CT_Title )string {_dbee :="";if _dfe !=nil &&_dfe .Tx !=nil &&_dfe .Tx .TxChoice !=nil &&_dfe .Tx .TxChoice .Rich !=nil {if len (_dfe .Tx .TxChoice .Rich .P )> 0{for _ ,_gad :=range _dfe .Tx .TxChoice .Rich .P {if len (_gad .EG_TextRun )> 0{_dbee +="\u000a"+_gad .EG_TextRun [0].TextRunChoice .R .T ;
};};};};return _dbee ;};func RegisterEmbeddedFonts (d *_fe .Document )error {_afcb :=d .FontTable ();if _afcb ==nil {return nil ;};for _ ,_baa :=range _afcb .Font {if _baa .EmbedRegular !=nil {return _debd (d ,_baa .NameAttr ,_baa .EmbedRegular .IdAttr ,_baa .EmbedRegular .FontKeyAttr );
};if _baa .EmbedBold !=nil {return _debd (d ,_baa .NameAttr ,_baa .EmbedBold .IdAttr ,_baa .EmbedBold .FontKeyAttr );};if _baa .EmbedItalic !=nil {return _debd (d ,_baa .NameAttr ,_baa .EmbedItalic .IdAttr ,_baa .EmbedItalic .FontKeyAttr );};if _baa .EmbedBoldItalic !=nil {return _debd (d ,_baa .NameAttr ,_baa .EmbedBoldItalic .IdAttr ,_baa .EmbedBoldItalic .FontKeyAttr );
};};return nil ;};func _gdgb (_ggec _bda .ST_SchemeColorVal ,_bbdae *_bda .Theme )string {if _dbdd :=_bbdae .ThemeElements ;_dbdd !=nil {if _dfbdc :=_dbdd .ClrScheme ;_dfbdc !=nil {switch _ggec {case _bda .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_dfbdc .Lt1 );
case _bda .ST_SchemeColorValDk1 ,_bda .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_dfbdc .Dk1 );case _bda .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_dfbdc .Lt2 );case _bda .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_dfbdc .Dk2 );
case _bda .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_dfbdc .Accent1 );case _bda .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_dfbdc .Accent2 );case _bda .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_dfbdc .Accent3 );
case _bda .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_dfbdc .Accent4 );case _bda .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_dfbdc .Accent5 );case _bda .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_dfbdc .Accent6 );
};};};return "";};func (_feag *creatorContext )drawLineWithProps (_gebe *_bda .CT_ShapeProperties ,_dfdd ,_gddc ,_cfeef ,_egdg float64 ,_edgc bool ){if _gebe !=nil {if _dfgd :=_gebe .Ln ;_dfgd !=nil {_gegb :=_feag .getPdfColorFromSolidFill (_dfgd .LineFillPropertiesChoice .SolidFill );
if _gegb ==nil &&_edgc {_gegb =_e .ColorBlack ;};if _gegb !=nil {var _cceaa float64 ;if _bddc :=_dfgd .WAttr ;_bddc !=nil {_cceaa =_ag .FromEMU (int64 (*_bddc ));}else {_cceaa =_ada ;};DrawLine (_feag ._fdba ,_dfdd ,_gddc ,_cfeef ,_egdg ,_cceaa ,_gegb );
};};};};type creatorContext struct{_fdba *_e .Creator ;_fbfe *_bda .Theme ;_gfcd float64 ;};func (_ddaf *creatorContext )drawBorderWithProps (_efac *_bda .CT_ShapeProperties ,_fdef *Rectangle ,_gddfe float64 ){if _fdef !=nil &&_efac !=nil &&_efac .Ln !=nil &&_efac .Ln .LineFillPropertiesChoice .SolidFill !=nil {_bded :=_ddaf .getPdfColorFromSolidFill (_efac .Ln .LineFillPropertiesChoice .SolidFill );
DrawRectangle (_ddaf ._fdba ,_fdef ,_gddfe ,_bded );};};const _fgfe =6.0;func TwipsFromPoints (points float64 )float64 {return points /_ag .Twips };func (_agff *creatorContext )drawPieChart (_fac *_aa .CT_PieChart ,_cfcfc *Rectangle ,_gddf *_cce .Workbook ,_fdfgb float64 )([]*legendItem ,error ){_aeda :=[]*legendItem {};
_cggf :=map[string ]serCategory {};_dece :=[]string {};_dbgf :=_bd .Inf (1);_fdgc :=_bd .Inf (-1);_egc :=_fac .Ser ;for _ ,_ffed :=range _egc {var _dgbag string ;if _dabc :=_ffed .Tx ;_dabc !=nil {if _gcae :=_dabc .SerTxChoice ;_gcae !=nil {if _gcae .V !=nil {_dgbag =*_gcae .V ;
}else if _ggbe :=_gcae .StrRef ;_ggbe !=nil {if _agca :=_ggbe .StrCache ;_agca !=nil {for _ ,_cfbd :=range _agca .Pt {_dgbag =_cfbd .V ;};};};};};if _feg :=_ffed .Cat ;_feg !=nil {if _dbbbca :=_feg .AxDataSourceChoice ;_dbbbca !=nil {if _gdab :=_dbbbca .StrRef ;
_gdab !=nil {if _gbda :=_gdab .F ;_gbda !=""&&_gddf !=nil {_dbcda ,_egfc ,_ddc ,_eccag :=ParseExcelRange (_gbda );if _eccag ==nil {for _ ,_bbe :=range _gddf .Sheets (){if _bbe .Name ()==_df .Trim (_dbcda ,"\u0027"){_abeb :=_egfc .String ();for _ccc :=_egfc .RowIdx ;
_ccc <=_ddc .RowIdx ;_ccc +=1{_ecfa :=_df .ReplaceAll (_abeb ,_fa .Sprint (_egfc .RowIdx ),_fa .Sprint (_ccc ));_agff .addCatName (_bbe .Cell (_ecfa ).GetString (),_cggf ,&_dece );};break ;};};};};if _ggba :=_gdab .StrCache ;_ggba !=nil {for _ ,_fag :=range _ggba .Pt {_agff .addCatName (_fag .V ,_cggf ,&_dece );
};};}else if _cagd :=_dbbbca .NumRef ;_cagd !=nil {if _eggb :=_cagd .NumCache ;_eggb !=nil {var _cbec string ;if _eggb .FormatCode !=nil {_cbec =*_eggb .FormatCode ;};for _ ,_deeab :=range _eggb .Pt {var _feec string ;if _deeab .FormatCodeAttr ==nil {_feec =_cbec ;
}else {_feec =*_deeab .FormatCodeAttr ;};var _dba string ;_ffbf ,_acfd :=_cc .ParseFloat (_deeab .V ,64);if _acfd !=nil {_dba =_deeab .V ;}else {_dba =_ea .Number (_ffbf ,_feec );};_agff .addCatName (_dba ,_cggf ,&_dece );};};};};};if _gggc :=_ffed .Val ;
_gggc !=nil {if _ecabg :=_gggc .NumDataSourceChoice ;_ecabg !=nil {if _gdc :=_ecabg .NumRef ;_gdc !=nil {if _gcg :=_gdc .F ;_gcg !=""&&_gddf !=nil {_ddgc ,_abebb ,_afda ,_dffgc :=ParseExcelRange (_gcg );if _dffgc ==nil {for _ ,_caef :=range _gddf .Sheets (){if _caef .Name ()==_df .Trim (_ddgc ,"\u0027"){_eced :=_abebb .String ();
for _cac :=_abebb .RowIdx ;_cac <=_afda .RowIdx ;_cac +=1{_fdgf :=_df .ReplaceAll (_eced ,_fa .Sprint (_abebb .RowIdx ),_fa .Sprint (_cac ));if _caef .FormulaContext ().HasFormula (_fdgf ){_fcfg :=_de .NewEvaluator ();_ffa :=_caef .FormulaContext ().Cell (_fdgf ,_fcfg );
_agfge :=_ffa .Value ();_agff .addCatValue (_agfge ,_cggf ,_dece ,(int )(_cac -_abebb .RowIdx ),&_dbgf ,&_fdgc ,_dgbag ,_ffed .SpPr );}else {_gcac :=_caef .Cell (_fdgf ).GetString ();_agff .addCatValue (_gcac ,_cggf ,_dece ,(int )(_cac -_abebb .RowIdx ),&_dbgf ,&_fdgc ,_dgbag ,_ffed .SpPr );
};};break ;};};};};if _gebd :=_gdc .NumCache ;_gebd !=nil {for _gagc ,_cdgd :=range _gebd .Pt {_agff .addCatValue (_cdgd .V ,_cggf ,_dece ,_gagc ,&_dbgf ,&_fdgc ,_dgbag ,_ffed .SpPr );};};};};};};_dbed :=&_ca .PieChart {Values :[]_dee .Value {}};for _ ,_gfe :=range _dece {_dca :=_cggf [_gfe ];
if len (_dca ._ffcg )> 0{_dbed .Values =append (_dbed .Values ,_dee .Value {Value :_dca ._ffcg [0]._agf ,Label :_gfe ,Style :_ggb .Style {FontSize :12*_fdfgb }});};};_dbed .SetHeight (int (_cfcfc .Top -_cfcfc .Bottom ));_dbed .SetWidth (int (_cfcfc .Right -_cfcfc .Left ));
_cdbd :=_agff ._fdba ;_aedb :=_e .NewChart (_dbed );_aedb .SetPos (_cfcfc .Left ,_cfcfc .Top );_efff :=_cdbd .Draw (_aedb );if _efff !=nil {return nil ,_efff ;};return _aeda ,nil ;};func FromSTCoordinate32 (st _bda .ST_Coordinate32 )int64 {if _dabe :=st .ST_Coordinate32Unqualified ;
_dabe !=nil {return int64 (*_dabe );};return 0;};var (DefaultFontSize =12.0;DefaultImageEncoder _bb .StreamEncoder ;DefaultPageSize =PageSizeA4 ;_bgaf =map[PageSize ]_e .PageSize {PageSizeA3 :_e .PageSizeA3 ,PageSizeA4 :_e .PageSizeA4 ,PageSizeA5 :_e .PageSizeA5 ,PageSizeLetter :_e .PageSizeLetter ,PageSizeLegal :_e .PageSizeLegal };
);func _bgg (_agc *_aa .CT_CatAx )(uint32 ,_aa .ST_AxPos ,_aa .ST_TickMark ,_aa .ST_TickLblPos ,*_aa .CT_ChartLines ,uint32 ,*_bda .CT_ShapeProperties ,error ){var _cede ,_agfg uint32 ;var _edde _aa .ST_AxPos ;var _bbbgc _aa .ST_TickMark ;var _bdba *_aa .CT_ChartLines ;
var _gfce _aa .ST_TickLblPos ;if _agc .AxId ==nil {return _cede ,_edde ,_bbbgc ,_gfce ,_bdba ,_agfg ,_agc .SpPr ,_da .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_cede =_agc .AxId .ValAttr ;};if _agc .AxPos ==nil {return _cede ,_edde ,_bbbgc ,_gfce ,_bdba ,_agfg ,_agc .SpPr ,_da .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");
}else {_edde =_agc .AxPos .ValAttr ;};if _agc .MajorTickMark !=nil {_bbbgc =_agc .MajorTickMark .ValAttr ;};if _agc .TickLblPos !=nil {_gfce =_agc .TickLblPos .ValAttr ;};if _agc .CrossAx ==nil {return _cede ,_edde ,_bbbgc ,_gfce ,_bdba ,_agfg ,_agc .SpPr ,_da .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_agfg =_agc .CrossAx .ValAttr ;};_bdba =_agc .MajorGridlines ;return _cede ,_edde ,_bbbgc ,_gfce ,_bdba ,_agfg ,_agc .SpPr ,nil ;};func (_dbf barSerByOrder )Swap (i ,j int ){_dbf [i ],_dbf [j ]=_dbf [j ],_dbf [i ]};func _gcce (_fec string )error {if !_df .HasSuffix (_fec ,"\u002e\u0074\u0074\u0066"){_gee .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return _fa .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_adgd ,_decb :=_bg .ParseFile (_fec );if _decb !=nil {_gee .Log .Debug ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020T\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_decb );return _decb ;};_bcfg ,_decb :=_cb .NewCompositePdfFontFromTTFFile (_fec );
if _decb !=nil {return _decb ;};_fbac :=_adgd .GetNameRecords ();for _ ,_decf :=range _fbac {_gadc :=_decf [1];if _gadc ==""{continue ;};_bgc :=make ([]byte ,0);for _fdcg :=0;_fdcg < len (_gadc );_fdcg ++{if _gadc [_fdcg ]==39||_gadc [_fdcg ]==92{continue ;
};_beae :=4;if _fdcg +_beae < len (_gadc ){if _gadc [_fdcg :_fdcg +_beae ]=="\u0000"{_fdcg =_fdcg +_beae +1;continue ;};};_bgc =append (_bgc ,_gadc [_fdcg ]);};_gadc =_df .Replace (string (_bgc ),"\u0078\u0030\u0030","",-1);_aebee :=_decf [2];if _aebee ==""{return _fa .Errorf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_fec );
};_bgc =make ([]byte ,0);for _cfed :=0;_cfed < len (_aebee );_cfed ++{if _aebee [_cfed ]==39||_aebee [_cfed ]==92{continue ;};_gdfe :=4;if _cfed +_gdfe < len (_aebee ){if _aebee [_cfed :_cfed +_gdfe ]=="\u0000"{_cfed =_cfed +_gdfe +1;continue ;};};_bgc =append (_bgc ,_aebee [_cfed ]);
};_aebee =_df .Replace (string (_bgc ),"\u0078\u0030\u0030","",-1);RegisterFont (_gadc ,_agdf [_aebee ],_bcfg );};return nil ;};func MakeImageFromChartSpace (cs *_aa .ChartSpace ,width ,height float64 ,theme *_bda .Theme ,workbook *_cce .Workbook )(_d .Image ,error ){_dbb ,_dfbb :=_fbf (cs ,width ,height ,theme ,true ,workbook );
if _dfbb !=nil {return nil ,_dfbb ;};_cgefe ,_dfbb :=GetPageFromCreator (_dbb );if _dfbb !=nil {return nil ,_dfbb ;};return _bc .NewImageDevice ().Render (_cgefe );};func DrawLine (c *_e .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _e .Color ){if color ==nil {return ;
};_caf :=c .NewLine (x0 ,y0 ,x1 ,y1 );_caf .SetLineWidth (width );_caf .SetColor (color );c .Draw (_caf );};func DrawRectangle (c *_e .Creator ,r *Rectangle ,w float64 ,color _e .Color ){if color ==nil {return ;};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );
DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};const (PageSizeA4 PageSize =iota ;PageSizeA3 ;PageSizeA5 ;PageSizeLetter ;
PageSizeLegal ;Percent100 =100000.0;MaxPageHeight =11906;);const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func (_aca *creatorContext )addCatName (_dfd string ,_gba map[string ]serCategory ,_geg *[]string ){if _ ,_ccgb :=_gba [_dfd ];
!_ccgb {_gba [_dfd ]=serCategory {_gda :_dfd ,_ffcg :[]serValue {}};*_geg =append (*_geg ,_dfd );};};func (_cag *creatorContext )addCatValue (_ccea string ,_ffd map[string ]serCategory ,_fbaf []string ,_fgg int ,_afdg ,_acde *float64 ,_dfb string ,_gcd *_bda .CT_ShapeProperties ){_afb ,_bfb :=_cc .ParseFloat (_ccea ,64);
if _bfb !=nil {_afb =0;_gee .Log .Debug ("\u0070a\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_bfb );};if _afb > *_acde {*_acde =_afb ;};if _afb < *_afdg {*_afdg =_afb ;};_aed :=_ffd [_fbaf [_fgg ]];_aed ._ffcg =append (_aed ._ffcg ,serValue {_dga :_dfb ,_agf :_afb ,_cae :_gcd });
_ffd [_fbaf [_fgg ]]=_aed ;};func ClearRegisteredFonts (){_fdgd ._dgae .Lock ();_fdgd ._gag =map[string ]map[FontStyle ]*_cb .PdfFont {};_fdgd ._dgae .Unlock ();};func _dacc (_deeb ,_dgde ,_fbg uint8 )(float64 ,float64 ,float64 ){_ebe ,_fgc ,_edc :=float64 (_deeb )/255,float64 (_dgde )/255,float64 (_fbg )/255;
_ccb :=_ebe ;if _fgc < _ccb {_ccb =_fgc ;};if _edc < _ccb {_ccb =_edc ;};var _ecgb ,_fbae bool ;_fee :=_ebe ;if _fgc > _fee {_fee =_fgc ;_ecgb =true ;};if _edc > _fee {_fee =_edc ;_ecgb =false ;_fbae =true ;};_faag :=(_ccb +_fee )/2;var _cfb float64 ;if _ccb !=_fee {if _faag <=0.5{_cfb =(_fee -_ccb )/(_fee +_ccb );
}else {_cfb =(_fee -_ccb )/(2.0-_fee -_ccb );};};var _cefc float64 ;if _ccb !=_fee {if _ecgb {_cefc =2.0+(_edc -_ebe )/(_fee -_ccb );}else if _fbae {_cefc =4.0+(_ebe -_fgc )/(_fee -_ccb );}else {_cefc =(_fgc -_edc )/(_fee -_ccb );};_cefc *=60;if _cefc < 0{_cefc +=360;
};};return _cefc ,_cfb ,_faag ;};func GetOpacityFromColorTransform (trs []*_bda .EG_ColorTransform )float64 {for _ ,_gdeg :=range trs {if _gdeg !=nil {if _bdfb :=_gdeg .ColorTransformChoice .Alpha ;_bdfb !=nil {if _gaed :=_bdfb .ValAttr .ST_PositiveFixedPercentageDecimal ;
_gaed !=nil {return float64 (*_gaed )/Percent100 ;};};};};return 1.0;};func (_ggg barSerByOrder )Less (i ,j int )bool {return _ggg [i ].Order .ValAttr < _ggg [j ].Order .ValAttr };var _dad =_ecfc (7.5);func _fbf (_dfbf *_aa .ChartSpace ,_dec ,_cfce float64 ,_ecf *_bda .Theme ,_efa bool ,_gcdf *_cce .Workbook )(*_e .Creator ,error ){_cgc :=1.0;
if _efa {_cgc =8.0;};_dccd :=&Rectangle {};_gaef :=&Rectangle {Top :_dccd .Top ,Bottom :_cfce -_dccd .Bottom ,Left :_dccd .Left ,Right :_dec -_dccd .Right };_efe :=MakeTempCreator (_dec *_cgc +1,_cfce *_cgc +1);_aac :=&creatorContext {_fdba :_efe ,_fbfe :_ecf ,_gfcd :_cgc };
var _fbfg bool ;if _gbf :=_dfbf .Chart ;_gbf !=nil {_afdga :=_gbf .PlotArea ;if _afdga ==nil {return nil ,_da .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");};_cbf :=0.0;if _gbf .AutoTitleDeleted !=nil &&_gbf .AutoTitleDeleted .ValAttr !=nil &&!*_gbf .AutoTitleDeleted .ValAttr {if _gbf .Title !=nil &&_gbf .Title .Overlay !=nil &&_gbf .Title .Overlay .ValAttr !=nil &&!*_gbf .Title .Overlay .ValAttr {_cbf =_ecfc (10);
};_gcea :=_aac .getTitle (_gbf .Title );if _gcea ==""{_gcea ="C\u0068\u0061\u0072\u0074\u0020\u0054\u0069\u0074\u006c\u0065";};_aac .drawTitle (_gcea ,_gaef .Left +_gaef .Right /2,_ecfc (5));};_dab :=&Rectangle {Top :_ecfc (10)+_cbf ,Bottom :_gaef .Bottom -_ecfc (15),Left :_ecfc (10),Right :_gaef .Right -_ecfc (10)};
var _cef *Rectangle ;_bbbb :=_gbf .Legend ;if _bbbb !=nil {_aceff :=_bbbb .Overlay !=nil &&_bbbb .Overlay .ValAttr !=nil &&*_bbbb .Overlay .ValAttr ;if _faf :=_bbbb .LegendPos ;_faf !=nil {switch _faf .ValAttr {case _aa .ST_LegendPosTr :if !_aceff {_dab =&Rectangle {Top :_ecfc (25)+_cbf ,Bottom :_gaef .Bottom -_ecfc (10),Left :_ecfc (10),Right :_gaef .Right -_ecfc (25)};
};_cef =&Rectangle {Top :_ecfc (2.5)+_cbf ,Bottom :_ecfc (22.5),Left :_gaef .Right -_ecfc (22.5),Right :_gaef .Right -_ecfc (2.5)};case _aa .ST_LegendPosT :_cef =&Rectangle {Top :_ecfc (2.5)+_cbf ,Bottom :_ecfc (7.5),Left :(_gaef .Right -_gaef .Left )*0.25,Right :(_gaef .Right -_gaef .Left )*0.75};
if !_aceff {_dab =&Rectangle {Top :_ecfc (12.5)+_cbf ,Bottom :_gaef .Bottom -_ecfc (15),Left :_ecfc (10),Right :_gaef .Right -_ecfc (5)};};_fbfg =true ;case _aa .ST_LegendPosB :_cef =&Rectangle {Top :_gaef .Bottom -_ecfc (7.5)+_cbf ,Bottom :_gaef .Bottom -_ecfc (2.5),Left :(_gaef .Right -_gaef .Left )*0.25,Right :(_gaef .Right -_gaef .Left )*0.75};
if !_aceff {_dab =&Rectangle {Top :_ecfc (5)+_cbf ,Bottom :_gaef .Bottom -_ecfc (15),Left :_ecfc (10),Right :_gaef .Right -_ecfc (5)};};_fbfg =true ;case _aa .ST_LegendPosR :_cef =&Rectangle {Top :(_gaef .Bottom -_gaef .Top )/2-_ecfc (10)+_cbf ,Bottom :(_gaef .Bottom -_gaef .Top )/2+_ecfc (10),Left :_gaef .Right -_ecfc (22.5),Right :_gaef .Right -_ecfc (2.5)};
if !_aceff {_dab =&Rectangle {Top :_ecfc (5)+_cbf ,Bottom :_gaef .Bottom -_ecfc (12.5),Left :_ecfc (10),Right :_gaef .Right -_ecfc (25)};};case _aa .ST_LegendPosL :_cef =&Rectangle {Top :(_gaef .Bottom -_gaef .Top )/2-_ecfc (10)+_cbf ,Bottom :(_gaef .Bottom -_gaef .Top )/2+_ecfc (10),Left :_ecfc (2.5),Right :_ecfc (22.5)};
if !_aceff {_dab =&Rectangle {Top :_ecfc (5)+_cbf ,Bottom :_gaef .Bottom -_ecfc (12.5),Left :_ecfc (30),Right :_gaef .Right -_ecfc (5)};};default:_cef =&Rectangle {Top :(_gaef .Bottom -_gaef .Top )/2-_ecfc (10)+_cbf ,Bottom :(_gaef .Bottom -_gaef .Top )/2+_ecfc (10),Left :_gaef .Right -_ecfc (25),Right :_gaef .Right -_ecfc (5)};
if !_aceff {_dab =&Rectangle {Top :_ecfc (5)+_cbf ,Bottom :_gaef .Bottom -_ecfc (12.5),Left :_ecfc (100),Right :_gaef .Right -_ecfc (25)};};};};};_dab .scale (_cgc );_aac .drawBorderWithProps (_afdga .SpPr ,_dab ,_ada );_cfe :=[]*legendItem {};var _cddg error ;
_dge :=_afdga .PlotAreaChoice1 ;for _ ,_cdec :=range _afdga .PlotAreaChoice {if _dgc :=_cdec .BarChart ;_dgc !=nil {_cfe ,_cddg =_aac .drawBarChart (_dgc ,_dab ,_dge ,_gcdf );if _cddg !=nil {return nil ,_cddg ;};break ;};if _fcc :=_cdec .PieChart ;_fcc !=nil {_cfe ,_cddg =_aac .drawPieChart (_fcc ,_dab ,_gcdf ,_cgc );
if _cddg !=nil {return nil ,_cddg ;};break ;};if _fdae :=_cdec .ScatterChart ;_fdae !=nil {_cfe ,_cddg =_aac .drawScatterChart (_fdae ,_dab ,_dge ,_cgc );if _cddg !=nil {return nil ,_cddg ;};break ;};if _gcf :=_cdec .LineChart ;_gcf !=nil {_cfe ,_cddg =_aac .drawLineChart (_gcf ,_dab ,_dge ,_cgc );
if _cddg !=nil {return nil ,_cddg ;};break ;};if _aaadg :=_cdec .AreaChart ;_aaadg !=nil {_cfe ,_cddg =_aac .drawAreaChart (_aaadg ,_dab ,_dge ,_cgc );if _cddg !=nil {return nil ,_cddg ;};break ;};};if _bbbb !=nil {_cef .scale (_cgc );_aac .drawBorderWithProps (_bbbb .SpPr ,_cef ,_ada );
if len (_cfe )!=0{_aac .drawLegend (_cef ,_cfe ,_fbfg );};};};_gaef .scale (_cgc );_aac .drawBorderWithProps (_dfbf .SpPr ,_gaef ,_ada );return _efe ,nil ;};func (_eaeee *Rectangle )Translate (x ,y float64 ){_eaeee .Left +=x ;_eaeee .Right +=x ;_eaeee .Top +=y ;
_eaeee .Bottom +=y ;};func RegisterFontsFromDirectory (dirName string )error {_cdb ,_gbdf :=_b .Open (dirName );if _gbdf !=nil {return _gbdf ;};defer _cdb .Close ();_dfded ,_gbdf :=_cdb .Readdirnames (0);if _gbdf !=nil {return _gbdf ;};for _ ,_bbdaf :=range _dfded {if _df .HasSuffix (_bbdaf ,"\u002e\u0074\u0074\u0066"){_abdc :=dirName +"\u002f"+_bbdaf ;
_dfeg :=_gcce (_abdc );if _dfeg !=nil {_gee .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_dfeg );
continue ;};};};return nil ;};func FromSTPercentage (st *_bda .ST_Percentage )float64 {if _fbdb :=st .ST_PercentageDecimal ;_fbdb !=nil {return float64 (*_fbdb )/Percent100 ;};return 0;};func (_fbb *creatorContext )drawAreaChart (_eae *_aa .CT_AreaChart ,_dea *Rectangle ,_eb []*_aa .CT_PlotAreaChoice1 ,_dd float64 )([]*legendItem ,error ){_af :=[]*legendItem {};
_ee :=_eae .Ser ;_fd :=make (map[int ][]float64 );_ccg :=make (map[int ][]float64 );_bcg :=make (map[int ]_e .Color );for _fba ,_ad :=range _ee {_bcg [_fba ]=_e .ColorWhite ;if _be :=_ad .SpPr ;_be !=nil {_cceg :=_fbb .getPdfColorFromSolidFill (_be .FillPropertiesChoice .SolidFill );
if _cceg !=nil {_bcg [_fba ]=_cceg ;};};if _ff :=_ad .Val ;_ff !=nil {if _ac :=_ff .NumDataSourceChoice ;_ac !=nil {if _ae :=_ac .NumRef ;_ae !=nil {if _acd :=_ae .NumCache ;_acd !=nil {for _ ,_cbg :=range _acd .Pt {_fd [_fba ]=append (_fd [_fba ],float64 (_cbg .IdxAttr ));
_ffg ,_ :=_cc .ParseFloat (_df .TrimSpace (_cbg .V ),64);_ccg [_fba ]=append (_ccg [_fba ],_ffg );};};};};};};_bf :=true ;_eed :="";_ddb :="";if len (_eb )> 1{if _eb [0].ValAx !=nil &&_eb [1].ValAx !=nil {if _eb [0].ValAx .Delete !=nil &&_eb [1].ValAx .Delete !=nil {if !*(*_eb [0].ValAx .Delete ).ValAttr &&!*(*_eb [1].ValAx .Delete ).ValAttr {_bf =false ;
};};_eed =_fbb .getTitle (_eb [0].ValAx .Title );_ddb =_fbb .getTitle (_eb [1].ValAx .Title );};};_fc :=_ggb .Style {Hidden :_bf ,FontSize :8*_dd };_geb :=&_ca .Chart {Series :[]_dee .Series {},YAxisSecondary :_ca .YAxis {Style :_fc ,Name :_ddb ,NameStyle :_fc },XAxis :_ca .XAxis {Style :_fc ,Name :_eed ,NameStyle :_fc },YAxis :_ca .YAxis {Style :_ggb .Style {Hidden :true }}};
for _gf :=0;_gf < len (_bcg );_gf ++{_eba ,_ec ,_bbg :=_bcg [_gf ].ToRGB ();_gfc :=_dee .ContinuousSeries {XValues :_fd [_gf ],YValues :_ccg [_gf ],Style :_ggb .Style {StrokeWidth :1,FillColor :_a .RGBA {uint8 (_eba *255),uint8 (_ec *255),uint8 (_bbg *255),255}}};
_geb .Series =append (_geb .Series ,_gfc );};_geb .SetHeight (int (_bd .Abs (_dea .Top -_dea .Bottom )));_geb .SetWidth (int (_bd .Abs (_dea .Right -_dea .Left )));_cg :=_fbb ._fdba ;_cd :=_e .NewChart (_geb );_cd .SetPos (_dea .Left ,_dea .Top );_ffe :=_cg .Draw (_cd );
if _ffe !=nil {return nil ,_ffe ;};return _af ,nil ;};func GetPageFromCreator (c *_e .Creator )(*_cb .PdfPage ,error ){_bag :=_c .NewBuffer ([]byte {});_fcfa :=c .Write (_bag );if _fcfa !=nil {return nil ,_fcfa ;};_ccgd :=_c .NewReader (_bag .Bytes ());
_dcae ,_fcfa :=_cb .NewPdfReader (_ccgd );if _fcfa !=nil {return nil ,_fcfa ;};return _dcae .GetPage (1);};type FontStyle byte ;func _ggbc (_efab uint8 ,_bbdag float64 )string {_accf :=float64 (_efab );return _fa .Sprintf ("\u0025\u0030\u0032\u0078",int (_accf *_bbdag ));
};type PageSize int ;func GetPageDimensions (size PageSize )_e .PageSize {return _bgaf [size ]};func (_dfdea *creatorContext )getPdfColorFromSolidFill (_ebabd *_bda .CT_SolidColorFillProperties )_e .Color {if _ebabd ==nil {return nil ;};_ccgg :="";if _ddfa :=_ebabd .SrgbClr ;
_ddfa !=nil {_ccgg =_ddfa .ValAttr ;}else if _eegb :=_ebabd .SchemeClr ;_eegb !=nil {_ccgg =_aabfb (_eegb .ValAttr ,_dfdea ._fbfe );_ccgg =AdjustColor (_ccgg ,_eegb .EG_ColorTransform );};if _ccgg ==""{return nil ;};return _e .ColorRGBFromHex ("\u0023"+_ccgg );
};func FromSTCoordinate (st _bda .ST_Coordinate )int64 {if _deg :=st .ST_CoordinateUnqualified ;_deg !=nil {return *_deg ;};return 0;};const (ImgPart_whole ImgPart =0;ImgPart_t ImgPart =1;ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;
ImgPart_rt ImgPart =6;ImgPart_lb ImgPart =7;ImgPart_rb ImgPart =8;);func (_cgdg *creatorContext )drawTitle (_ggge string ,_dfbd ,_dcfb float64 ){_eea :=_cgdg ._gfcd ;_acbc :=_cgdg ._fdba .NewStyledParagraph ();_gfcg :=_acbc .SetText (_ggge );_ggdg ,_gddb :=_cb .NewStandard14Font (_cb .HelveticaName );
if _gddb ==nil {_ddg :=_cgdg ._fdba .NewTextStyle ();_ddg .Font =_ggdg ;_ddg .FontSize =14;_ddg .TextRise =0.4;_gfcg .Style =_ddg ;_acbc .SetPos (_dfbd -_acbc .Width ()*_eea /2,_dcfb );_cgdg ._fdba .Draw (_acbc );};};var _gff =_ecfc (1.5);func _debd (_eaf *_fe .Document ,_eda ,_gbee ,_dgce string )error {_ccec ,_efbg :=_eaf .GetFontBytesByRelId (_gbee );
if _efbg !=nil {return _efbg ;};_deac ,_efbg :=_gebg (_dgce );if _efbg !=nil {return _efbg ;};for _bbc :=0;_bbc < 32;_bbc ++{_daccc :=_bbc %len (_deac );_ccec [_bbc ]=_ccec [_bbc ]^_deac [_daccc ];};_eddf :=_eaf .TmpPath +"\u002f"+_eda +"\u002e\u0074\u0074\u0066";
_efbg =_b .WriteFile (_eddf ,_ccec ,0644);if _efbg !=nil {return _efbg ;};_gcce (_eddf );return nil ;};func GetDataFromXfrm (xfrm *_bda .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _gadd ,_dfeb ,_eaga ,_ffdb float64 ;if _facg :=xfrm .Off ;
_facg !=nil {_gadd =_ag .FromEMU (FromSTCoordinate (_facg .XAttr ));_dfeb =_ag .FromEMU (FromSTCoordinate (_facg .YAttr ));};if _dgfa :=xfrm .Ext ;_dgfa !=nil {_eaga =_ag .FromEMU (_dgfa .CxAttr );_ffdb =_ag .FromEMU (_dgfa .CyAttr );};return _gadd ,_dfeb ,_eaga ,_ffdb ;
};func _gebg (_cfcc string )([]byte ,error ){_feee :=_gef .MustCompile ("\u005b\u005e\u0061\u002d\u007a\u0041\u002d\u005a\u0030\u002d\u0039\u005d\u002b");_cfcc =_feee .ReplaceAllString (_cfcc ,"");_dgcb :=[]rune (_cfcc );_ccf :=[]byte {};for _dbdc :=len (_dgcb )-2;
_dbdc >=0;_dbdc -=2{_feed ,_ecab :=_cc .ParseUint (string (_dgcb [_dbdc ])+string (_dgcb [_dbdc +1]),16,8);if _ecab !=nil {return nil ,_ecab ;};_ccf =append (_ccf ,byte (_feed ));};return _ccf ,nil ;};func MakeTempCreatorMaxHeight (width float64 )*_e .Creator {return MakeTempCreator (width ,MaxPageHeight );
};func _ebaa (_eeg *_aa .CT_SerAx )(uint32 ,_aa .ST_AxPos ,_aa .ST_TickMark ,_aa .ST_TickLblPos ,*_aa .CT_ChartLines ,uint32 ,*_bda .CT_ShapeProperties ,error ){var _bbfa ,_eggaa uint32 ;var _fggd _aa .ST_AxPos ;var _geee _aa .ST_TickMark ;var _aebcd *_aa .CT_ChartLines ;
var _acee _aa .ST_TickLblPos ;if _eeg .AxId ==nil {return _bbfa ,_fggd ,_geee ,_acee ,_aebcd ,_eggaa ,_eeg .SpPr ,_da .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_bbfa =_eeg .AxId .ValAttr ;};if _eeg .AxPos ==nil {return _bbfa ,_fggd ,_geee ,_acee ,_aebcd ,_eggaa ,_eeg .SpPr ,_da .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");
}else {_fggd =_eeg .AxPos .ValAttr ;};if _eeg .MajorTickMark !=nil {_geee =_eeg .MajorTickMark .ValAttr ;};if _eeg .TickLblPos !=nil {_acee =_eeg .TickLblPos .ValAttr ;};if _eeg .CrossAx ==nil {return _bbfa ,_fggd ,_geee ,_acee ,_aebcd ,_eggaa ,_eeg .SpPr ,_da .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_eggaa =_eeg .CrossAx .ValAttr ;};_aebcd =_eeg .MajorGridlines ;return _bbfa ,_fggd ,_geee ,_acee ,_aebcd ,_eggaa ,_eeg .SpPr ,nil ;};func (_cdab *creatorContext )drawScatterChart (_bbbc *_aa .CT_ScatterChart ,_abca *Rectangle ,_eccb []*_aa .CT_PlotAreaChoice1 ,_abga float64 )([]*legendItem ,error ){_fggca :=[]*legendItem {};
_ddac :=_bbbc .Ser ;_efc :=make (map[string ]float64 );_gadf :=make (map[string ][]float64 );_efce :=make (map[string ][]float64 );_afeb :=[]string {};for _ ,_gdde :=range _ddac {var _fdad string ;if _bgdc :=_gdde .Tx ;_bgdc !=nil {if _bfec :=_bgdc .SerTxChoice ;
_bfec !=nil {if _bfec .V !=nil {_fdad =*_bfec .V ;}else if _abfg :=_bfec .StrRef ;_abfg !=nil {if _bbbf :=_abfg .StrCache ;_bbbf !=nil {for _ ,_daba :=range _bbbf .Pt {_fdad =_daba .V ;};};};_afeb =append (_afeb ,_fdad );};};if _gdde .Marker !=nil &&_gdde .Marker .Size !=nil {_efc [_fdad ]=float64 (*_gdde .Marker .Size .ValAttr );
}else {_efc [_fdad ]=-1.0;};if _bdda :=_gdde .XVal ;_bdda !=nil {if _bbbba :=_bdda .AxDataSourceChoice ;_bbbba !=nil {if _bfgg :=_bbbba .NumRef ;_bfgg !=nil {if _agcd :=_bfgg .NumCache ;_agcd !=nil {for _ ,_eadb :=range _agcd .Pt {_agef ,_ :=_cc .ParseFloat (_df .TrimSpace (_eadb .V ),64);
_gadf [_fdad ]=append (_gadf [_fdad ],_agef );};};};};};if _geba :=_gdde .YVal ;_geba !=nil {if _ade :=_geba .NumDataSourceChoice ;_ade !=nil {if _gbgd :=_ade .NumRef ;_gbgd !=nil {if _dgdf :=_gbgd .NumCache ;_dgdf !=nil {for _ ,_gafc :=range _dgdf .Pt {_dgff ,_ :=_cc .ParseFloat (_df .TrimSpace (_gafc .V ),64);
_efce [_fdad ]=append (_efce [_fdad ],_dgff );};};};};};};_dgea :=true ;_cbfd :="";_egbg :="";if len (_eccb )> 1{if _eccb [0].ValAx .Delete !=nil &&_eccb [1].ValAx .Delete !=nil {if !*(*_eccb [0].ValAx .Delete ).ValAttr &&!*(*_eccb [1].ValAx .Delete ).ValAttr {_dgea =false ;
};};_cbfd =_cdab .getTitle (_eccb [0].ValAx .Title );_egbg =_cdab .getTitle (_eccb [1].ValAx .Title );};_fggf :=_ggb .Style {Hidden :_dgea ,FontSize :8*_abga };_deed :=&_ca .Chart {Series :[]_dee .Series {},YAxisSecondary :_ca .YAxis {Style :_fggf ,Name :_egbg ,NameStyle :_fggf },XAxis :_ca .XAxis {Style :_fggf ,Name :_cbfd ,NameStyle :_fggf },YAxis :_ca .YAxis {Style :_ggb .Style {Hidden :true }}};
for _ ,_eaca :=range _afeb {_febf :=_dee .ContinuousSeries {XValues :_gadf [_eaca ],YValues :_efce [_eaca ],Style :_ggb .Style {StrokeWidth :-1,DotWidth :_efc [_eaca ]}};_deed .Series =append (_deed .Series ,_febf );};_deed .SetHeight (int (_bd .Abs (_abca .Top -_abca .Bottom )));
_deed .SetWidth (int (_bd .Abs (_abca .Right -_abca .Left )));_cbeg :=_cdab ._fdba ;_bgbd :=_e .NewChart (_deed );_bgbd .SetPos (_abca .Left ,_abca .Top );_eedd :=_cbeg .Draw (_bgbd );if _eedd !=nil {return nil ,_eedd ;};return _fggca ,nil ;};func AdjustColorByLumOff (colorStr string ,lumOff float64 )string {var _cfag ,_ccdd ,_bfgf uint8 ;
_adaa ,_ :=_fa .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_cfag ,&_ccdd ,&_bfgf );if _adaa !=3{return "";};_dfae ,_ccdc ,_dgbg :=_dacc (_cfag ,_ccdd ,_bfgf );_dgbg =_dgbg +lumOff ;_cfag ,_ccdd ,_bfgf =_cdg (_dfae ,_ccdc ,_dgbg );
return _fa .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_cfag ,_ccdd ,_bfgf );};func IsNoSpaceLanguage (symbol string )bool {for _ ,_fccb :=range symbol {if _f .Is (_f .Han ,_fccb ){return true ;};};return false ;};type serCategory struct{_gda string ;
_ffcg []serValue ;};func _ecfc (_adcb float64 )float64 {return _adcb *_ag .Millimeter };func ParseExcelRange (s string )(string ,_gg .CellReference ,_gg .CellReference ,error ){_acbd :=_df .FieldsFunc (s ,func (_bfd rune )bool {return _bfd ==':'||_bfd =='!'});
if len (_acbd )==3{_defd ,_debe :=_gg .ParseCellReference (_acbd [1]);if _debe !=nil {return "",_gg .CellReference {},_gg .CellReference {},_debe ;};_dbcb ,_debe :=_gg .ParseCellReference (_acbd [2]);if _debe !=nil {return "",_gg .CellReference {},_gg .CellReference {},_debe ;
};return _acbd [0],_defd ,_dbcb ,nil ;};return "",_gg .CellReference {},_gg .CellReference {},_da .New ("\u0065r\u0072\u006f\u0072\u0020p\u0061\u0072\u0073\u0069\u006eg\u0020e\u0078c\u0065\u006c\u0020\u0072\u0061\u006e\u0067e");};