//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_b "bytes";_ed "errors";_d "fmt";_de "github.com/unidoc/unichart";_bd "github.com/unidoc/unichart/dataset";_eee "github.com/unidoc/unichart/render";_def "github.com/unidoc/unioffice/v2/common/logger";_ff "github.com/unidoc/unioffice/v2/document";
_df "github.com/unidoc/unioffice/v2/measurement";_fa "github.com/unidoc/unioffice/v2/schema/soo/dml";_eb "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_ac "github.com/unidoc/unioffice/v2/spreadsheet";_ba "github.com/unidoc/unioffice/v2/spreadsheet/format";
_eca "github.com/unidoc/unioffice/v2/spreadsheet/formula";_ab "github.com/unidoc/unioffice/v2/spreadsheet/reference";_gfb "github.com/unidoc/unipdf/v4/core";_ee "github.com/unidoc/unipdf/v4/creator";_fg "github.com/unidoc/unipdf/v4/model";_bf "github.com/unidoc/unipdf/v4/render";
_dc "github.com/unidoc/unitype";_ec "image";_e "image/color";_be "math";_a "os";_gf "regexp";_gff "sort";_bg "strconv";_fe "strings";_g "sync";_f "unicode";);func (_dffb *creatorContext )drawPieChart (_efc *_eb .CT_PieChart ,_gddf *Rectangle ,_bgbgc *_ac .Workbook ,_dfcf float64 )([]*legendItem ,error ){_bdccc :=[]*legendItem {};
_adda :=map[string ]serCategory {};_aeag :=[]string {};_cacac :=_be .Inf (1);_aba :=_be .Inf (-1);_cdag :=_efc .Ser ;for _ ,_acaa :=range _cdag {var _baae string ;if _bfcb :=_acaa .Tx ;_bfcb !=nil {if _aeca :=_bfcb .SerTxChoice ;_aeca !=nil {if _aeca .V !=nil {_baae =*_aeca .V ;
}else if _gdga :=_aeca .StrRef ;_gdga !=nil {if _aeff :=_gdga .StrCache ;_aeff !=nil {for _ ,_fda :=range _aeff .Pt {_baae =_fda .V ;};};};};};if _bfde :=_acaa .Cat ;_bfde !=nil {if _fbecg :=_bfde .AxDataSourceChoice ;_fbecg !=nil {if _faee :=_fbecg .StrRef ;
_faee !=nil {if _efab :=_faee .F ;_efab !=""&&_bgbgc !=nil {_ceadg ,_fbfb ,_gdf ,_cfc :=ParseExcelRange (_efab );if _cfc ==nil {for _ ,_agf :=range _bgbgc .Sheets (){if _agf .Name ()==_fe .Trim (_ceadg ,"\u0027"){_bdca :=_fbfb .String ();for _aedf :=_fbfb .RowIdx ;
_aedf <=_gdf .RowIdx ;_aedf +=1{_gdfb :=_fe .ReplaceAll (_bdca ,_d .Sprint (_fbfb .RowIdx ),_d .Sprint (_aedf ));_dffb .addCatName (_agf .Cell (_gdfb ).GetString (),_adda ,&_aeag );};break ;};};};};if _adgf :=_faee .StrCache ;_adgf !=nil {for _ ,_abfd :=range _adgf .Pt {_dffb .addCatName (_abfd .V ,_adda ,&_aeag );
};};}else if _dcga :=_fbecg .NumRef ;_dcga !=nil {if _dcgf :=_dcga .NumCache ;_dcgf !=nil {var _ebac string ;if _dcgf .FormatCode !=nil {_ebac =*_dcgf .FormatCode ;};for _ ,_cgfb :=range _dcgf .Pt {var _bfab string ;if _cgfb .FormatCodeAttr ==nil {_bfab =_ebac ;
}else {_bfab =*_cgfb .FormatCodeAttr ;};var _abgg string ;_agfa ,_bfabf :=_bg .ParseFloat (_cgfb .V ,64);if _bfabf !=nil {_abgg =_cgfb .V ;}else {_abgg =_ba .Number (_agfa ,_bfab );};_dffb .addCatName (_abgg ,_adda ,&_aeag );};};};};};if _faab :=_acaa .Val ;
_faab !=nil {if _degg :=_faab .NumDataSourceChoice ;_degg !=nil {if _fbed :=_degg .NumRef ;_fbed !=nil {if _cgbd :=_fbed .F ;_cgbd !=""&&_bgbgc !=nil {_bbfe ,_acbb ,_fdfd ,_gfcd :=ParseExcelRange (_cgbd );if _gfcd ==nil {for _ ,_bedc :=range _bgbgc .Sheets (){if _bedc .Name ()==_fe .Trim (_bbfe ,"\u0027"){_gegg :=_acbb .String ();
for _adce :=_acbb .RowIdx ;_adce <=_fdfd .RowIdx ;_adce +=1{_eff :=_fe .ReplaceAll (_gegg ,_d .Sprint (_acbb .RowIdx ),_d .Sprint (_adce ));if _bedc .FormulaContext ().HasFormula (_eff ){_afcc :=_eca .NewEvaluator ();_eaga :=_bedc .FormulaContext ().Cell (_eff ,_afcc );
_ceag :=_eaga .Value ();_dffb .addCatValue (_ceag ,_adda ,_aeag ,(int )(_adce -_acbb .RowIdx ),&_cacac ,&_aba ,_baae ,_acaa .SpPr );}else {_ccfg :=_bedc .Cell (_eff ).GetString ();_dffb .addCatValue (_ccfg ,_adda ,_aeag ,(int )(_adce -_acbb .RowIdx ),&_cacac ,&_aba ,_baae ,_acaa .SpPr );
};};break ;};};};};if _bcag :=_fbed .NumCache ;_bcag !=nil {for _cdc ,_dedc :=range _bcag .Pt {_dffb .addCatValue (_dedc .V ,_adda ,_aeag ,_cdc ,&_cacac ,&_aba ,_baae ,_acaa .SpPr );};};};};};};_ebge :=&_de .PieChart {Values :[]_bd .Value {}};for _ ,_fbcc :=range _aeag {_ddde :=_adda [_fbcc ];
if len (_ddde ._cca )> 0{_ebge .Values =append (_ebge .Values ,_bd .Value {Value :_ddde ._cca [0]._cbgbd ,Label :_fbcc ,Style :_eee .Style {FontSize :12*_dfcf }});};};_ebge .SetHeight (int (_gddf .Top -_gddf .Bottom ));_ebge .SetWidth (int (_gddf .Right -_gddf .Left ));
_edbb :=_dffb ._gefg ;_eadf :=_ee .NewChart (_ebge );_eadf .SetPos (_gddf .Left ,_gddf .Top );_efe :=_edbb .Draw (_eadf );if _efe !=nil {return nil ,_efe ;};return _bdccc ,nil ;};func (_ffa *creatorContext )addCatName (_cgg string ,_fdc map[string ]serCategory ,_cdf *[]string ){if _ ,_ffe :=_fdc [_cgg ];
!_ffe {_fdc [_cgg ]=serCategory {_bbe :_cgg ,_cca :[]serValue {}};*_cdf =append (*_cdf ,_cgg );};};func AssignStdFontByName (style _ee .TextStyle ,fontName string )*_fg .PdfFont {_fbf :=_fg .StdFontName (fontName );return _fg .NewStandard14FontMustCompile (_fbf );
};func (_acf *creatorContext )drawAreaChart (_bdf *_eb .CT_AreaChart ,_feb *Rectangle ,_dg []*_eb .CT_PlotAreaChoice1 ,_cf float64 )([]*legendItem ,error ){_bdb :=[]*legendItem {};_fff :=_bdf .Ser ;_ae :=make (map[int ][]float64 );_abd :=make (map[int ][]float64 );
_eg :=make (map[int ]_ee .Color );for _ag ,_eba :=range _fff {_eg [_ag ]=_ee .ColorWhite ;if _gb :=_eba .SpPr ;_gb !=nil {_cd :=_acf .getPdfColorFromSolidFill (_gb .FillPropertiesChoice .SolidFill );if _cd !=nil {_eg [_ag ]=_cd ;};};if _ce :=_eba .Val ;
_ce !=nil {if _cdb :=_ce .NumDataSourceChoice ;_cdb !=nil {if _ad :=_cdb .NumRef ;_ad !=nil {if _db :=_ad .NumCache ;_db !=nil {for _ ,_adf :=range _db .Pt {_ae [_ag ]=append (_ae [_ag ],float64 (_adf .IdxAttr ));_ceb ,_ :=_bg .ParseFloat (_fe .TrimSpace (_adf .V ),64);
_abd [_ag ]=append (_abd [_ag ],_ceb );};};};};};};_fc :=true ;_cfg :="";_ca :="";if len (_dg )> 1{if _dg [0].ValAx !=nil &&_dg [1].ValAx !=nil {if _dg [0].ValAx .Delete !=nil &&_dg [1].ValAx .Delete !=nil {if !*(*_dg [0].ValAx .Delete ).ValAttr &&!*(*_dg [1].ValAx .Delete ).ValAttr {_fc =false ;
};};_cfg =_acf .getTitle (_dg [0].ValAx .Title );_ca =_acf .getTitle (_dg [1].ValAx .Title );};};_bfa :=_eee .Style {Hidden :_fc ,FontSize :8*_cf };_fcc :=&_de .Chart {Series :[]_bd .Series {},YAxisSecondary :_de .YAxis {Style :_bfa ,Name :_ca ,NameStyle :_bfa },XAxis :_de .XAxis {Style :_bfa ,Name :_cfg ,NameStyle :_bfa },YAxis :_de .YAxis {Style :_eee .Style {Hidden :true }}};
for _acfe :=0;_acfe < len (_eg );_acfe ++{_ge ,_af ,_da :=_eg [_acfe ].ToRGB ();_cb :=_bd .ContinuousSeries {XValues :_ae [_acfe ],YValues :_abd [_acfe ],Style :_eee .Style {StrokeWidth :1,FillColor :_e .RGBA {uint8 (_ge *255),uint8 (_af *255),uint8 (_da *255),255}}};
_fcc .Series =append (_fcc .Series ,_cb );};_fcc .SetHeight (int (_be .Abs (_feb .Top -_feb .Bottom )));_fcc .SetWidth (int (_be .Abs (_feb .Right -_feb .Left )));_gd :=_acf ._gefg ;_egb :=_ee .NewChart (_fcc );_egb .SetPos (_feb .Left ,_feb .Top );_cc :=_gd .Draw (_egb );
if _cc !=nil {return nil ,_cc ;};return _bdb ,nil ;};func AdjustColorByShade (colorStr string ,shade float64 )string {var _cfab ,_egbd ,_bdcf uint8 ;_bdg ,_ :=_d .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_cfab ,&_egbd ,&_bdcf );
if _bdg !=3{return "";};return _ffab (_cfab ,shade )+_ffab (_egbd ,shade )+_ffab (_bdcf ,shade );};type legendItem struct{_agc string ;_cad *_fa .CT_ShapeProperties ;};type ImgPart byte ;func Lighten (clr float64 )float64 {return 0.6+0.4*clr };var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};
func _dge (_bec *_eb .CT_DateAx )(uint32 ,_eb .ST_AxPos ,_eb .ST_TickMark ,_eb .ST_TickLblPos ,*_eb .CT_ChartLines ,uint32 ,*_fa .CT_ShapeProperties ,error ){var _gfc ,_dagc uint32 ;var _dbe _eb .ST_AxPos ;var _ddga _eb .ST_TickMark ;var _cafe *_eb .CT_ChartLines ;
var _acfeb _eb .ST_TickLblPos ;if _bec .AxId ==nil {return _gfc ,_dbe ,_ddga ,_acfeb ,_cafe ,_dagc ,_bec .SpPr ,_ed .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_gfc =_bec .AxId .ValAttr ;};if _bec .AxPos ==nil {return _gfc ,_dbe ,_ddga ,_acfeb ,_cafe ,_dagc ,_bec .SpPr ,_ed .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");
}else {_dbe =_bec .AxPos .ValAttr ;};if _bec .MajorTickMark !=nil {_ddga =_bec .MajorTickMark .ValAttr ;};if _bec .TickLblPos !=nil {_acfeb =_bec .TickLblPos .ValAttr ;};if _bec .CrossAx ==nil {return _gfc ,_dbe ,_ddga ,_acfeb ,_cafe ,_dagc ,_bec .SpPr ,_ed .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_dagc =_bec .CrossAx .ValAttr ;};_cafe =_bec .MajorGridlines ;return _gfc ,_dbe ,_ddga ,_acfeb ,_cafe ,_dagc ,_bec .SpPr ,nil ;};func (_cbc barSerByOrder )Len ()int {return len (_cbc )};func _caeb (_fcaf ,_afaa ,_gbef float64 )(uint8 ,uint8 ,uint8 ){var _fdega float64 ;
if _gbef < 0.5{_fdega =_gbef *(1+_afaa );}else {_fdega =_gbef +_afaa -_gbef *_afaa ;};_fafa :=_gbef *2-_fdega ;_fcaf /=360.0;_fddd :=_cde (_fcaf +1.0/3.0);_dff :=_cde (_fcaf );_cab :=_cde (_fcaf -1.0/3.0);_dga :=_ddca (_fddd ,_fdega ,_fafa );_fgaf :=_ddca (_dff ,_fdega ,_fafa );
_eeag :=_ddca (_cab ,_fdega ,_fafa );return uint8 (255*_dga ),uint8 (255*_fgaf ),uint8 (255*_eeag );};func _gef (_aac uint8 ,_gec float64 )string {_afdb :=float64 (_aac );var _afbb float64 ;if _gec < 0{_afbb =_afdb *(1+_gec );}else {_afbb =_afdb +(255-_afdb )*_gec ;
};return _d .Sprintf ("\u0025\u0030\u0032\u0078",int (_afbb ));};func (_bbbb *creatorContext )drawRectangleWithProps (_cebd *_fa .CT_ShapeProperties ,_fgab ,_ggd ,_cgbe ,_gdgf float64 ,_bdfg bool ){_ddaa :=_bbbb ._gefg .NewRectangle (_fgab ,_ggd ,_cgbe ,_gdgf );
if _cebd ==nil {if _bdfg {_ddaa .SetBorderWidth (_dag );}else {return ;};}else {_eec :=_bbbb .getPdfColorFromSolidFill (_cebd .FillPropertiesChoice .SolidFill );if _eec !=nil {_ddaa .SetFillColor (_eec );};if _aeg :=_cebd .Ln ;_aeg !=nil {if _geeea :=_aeg .WAttr ;
_geeea !=nil {_bef :=_df .FromEMU (int64 (*_geeea ));_ddaa .SetBorderWidth (_bef );if _dcgg :=_aeg .LineFillPropertiesChoice .SolidFill ;_dcgg !=nil {_gffe :=_bbbb .getPdfColorFromSolidFill (_dcgg );if _gffe !=nil {_ddaa .SetBorderColor (_gffe );};};}else {_ddaa .SetBorderWidth (0);
};};};_bbbb ._gefg .Draw (_ddaa );};func _gde (_ffbf _fa .ST_SchemeColorVal ,_dab *_fa .Theme )string {if _aafea :=_dab .ThemeElements ;_aafea !=nil {if _edgg :=_aafea .ClrScheme ;_edgg !=nil {switch _ffbf {case _fa .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_edgg .Lt1 );
case _fa .ST_SchemeColorValDk1 ,_fa .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_edgg .Dk1 );case _fa .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_edgg .Lt2 );case _fa .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_edgg .Dk2 );
case _fa .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_edgg .Accent1 );case _fa .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_edgg .Accent2 );case _fa .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_edgg .Accent3 );
case _fa .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_edgg .Accent4 );case _fa .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_edgg .Accent5 );case _fa .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_edgg .Accent6 );
};};};return "";};func _aef (_faf *_eb .ChartSpace ,_fcd ,_dcf float64 ,_bea *_fa .Theme ,_fga bool ,_cda *_ac .Workbook )(*_ee .Creator ,error ){_ded :=1.0;if _fga {_ded =8.0;};_dfe :=&Rectangle {};_eag :=&Rectangle {Top :_dfe .Top ,Bottom :_dcf -_dfe .Bottom ,Left :_dfe .Left ,Right :_fcd -_dfe .Right };
_cgf :=MakeTempCreator (_fcd *_ded +1,_dcf *_ded +1);_eddf :=&creatorContext {_gefg :_cgf ,_bfe :_bea ,_fbcfg :_ded };var _ega bool ;if _bbb :=_faf .Chart ;_bbb !=nil {_cea :=_bbb .PlotArea ;if _cea ==nil {return nil ,_ed .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");
};_gafa :=0.0;if _bbb .AutoTitleDeleted !=nil &&_bbb .AutoTitleDeleted .ValAttr !=nil &&!*_bbb .AutoTitleDeleted .ValAttr {if _bbb .Title !=nil &&_bbb .Title .Overlay !=nil &&_bbb .Title .Overlay .ValAttr !=nil &&!*_bbb .Title .Overlay .ValAttr {_gafa =_dgcb (10);
};_dbad :=_eddf .getTitle (_bbb .Title );if _dbad ==""{_dbad ="C\u0068\u0061\u0072\u0074\u0020\u0054\u0069\u0074\u006c\u0065";};_eddf .drawTitle (_dbad ,_eag .Left +_eag .Right /2,_dgcb (5));};_bca :=&Rectangle {Top :_dgcb (10)+_gafa ,Bottom :_eag .Bottom -_dgcb (15),Left :_dgcb (10),Right :_eag .Right -_dgcb (10)};
var _eeed *Rectangle ;_afa :=_bbb .Legend ;if _afa !=nil {_dad :=_afa .Overlay !=nil &&_afa .Overlay .ValAttr !=nil &&*_afa .Overlay .ValAttr ;if _dfa :=_afa .LegendPos ;_dfa !=nil {switch _dfa .ValAttr {case _eb .ST_LegendPosTr :if !_dad {_bca =&Rectangle {Top :_dgcb (25)+_gafa ,Bottom :_eag .Bottom -_dgcb (10),Left :_dgcb (10),Right :_eag .Right -_dgcb (25)};
};_eeed =&Rectangle {Top :_dgcb (2.5)+_gafa ,Bottom :_dgcb (22.5),Left :_eag .Right -_dgcb (22.5),Right :_eag .Right -_dgcb (2.5)};case _eb .ST_LegendPosT :_eeed =&Rectangle {Top :_dgcb (2.5)+_gafa ,Bottom :_dgcb (7.5),Left :(_eag .Right -_eag .Left )*0.25,Right :(_eag .Right -_eag .Left )*0.75};
if !_dad {_bca =&Rectangle {Top :_dgcb (12.5)+_gafa ,Bottom :_eag .Bottom -_dgcb (15),Left :_dgcb (10),Right :_eag .Right -_dgcb (5)};};_ega =true ;case _eb .ST_LegendPosB :_eeed =&Rectangle {Top :_eag .Bottom -_dgcb (7.5)+_gafa ,Bottom :_eag .Bottom -_dgcb (2.5),Left :(_eag .Right -_eag .Left )*0.25,Right :(_eag .Right -_eag .Left )*0.75};
if !_dad {_bca =&Rectangle {Top :_dgcb (5)+_gafa ,Bottom :_eag .Bottom -_dgcb (15),Left :_dgcb (10),Right :_eag .Right -_dgcb (5)};};_ega =true ;case _eb .ST_LegendPosR :_eeed =&Rectangle {Top :(_eag .Bottom -_eag .Top )/2-_dgcb (10)+_gafa ,Bottom :(_eag .Bottom -_eag .Top )/2+_dgcb (10),Left :_eag .Right -_dgcb (22.5),Right :_eag .Right -_dgcb (2.5)};
if !_dad {_bca =&Rectangle {Top :_dgcb (5)+_gafa ,Bottom :_eag .Bottom -_dgcb (12.5),Left :_dgcb (10),Right :_eag .Right -_dgcb (25)};};case _eb .ST_LegendPosL :_eeed =&Rectangle {Top :(_eag .Bottom -_eag .Top )/2-_dgcb (10)+_gafa ,Bottom :(_eag .Bottom -_eag .Top )/2+_dgcb (10),Left :_dgcb (2.5),Right :_dgcb (22.5)};
if !_dad {_bca =&Rectangle {Top :_dgcb (5)+_gafa ,Bottom :_eag .Bottom -_dgcb (12.5),Left :_dgcb (30),Right :_eag .Right -_dgcb (5)};};default:_eeed =&Rectangle {Top :(_eag .Bottom -_eag .Top )/2-_dgcb (10)+_gafa ,Bottom :(_eag .Bottom -_eag .Top )/2+_dgcb (10),Left :_eag .Right -_dgcb (25),Right :_eag .Right -_dgcb (5)};
if !_dad {_bca =&Rectangle {Top :_dgcb (5)+_gafa ,Bottom :_eag .Bottom -_dgcb (12.5),Left :_dgcb (100),Right :_eag .Right -_dgcb (25)};};};};};_bca .scale (_ded );_eddf .drawBorderWithProps (_cea .SpPr ,_bca ,_dag );_gda :=[]*legendItem {};var _fffbe error ;
_ddc :=_cea .PlotAreaChoice1 ;for _ ,_ceg :=range _cea .PlotAreaChoice {if _fdgb :=_ceg .BarChart ;_fdgb !=nil {_gda ,_fffbe =_eddf .drawBarChart (_fdgb ,_bca ,_ddc ,_cda );if _fffbe !=nil {return nil ,_fffbe ;};break ;};if _gbd :=_ceg .PieChart ;_gbd !=nil {_gda ,_fffbe =_eddf .drawPieChart (_gbd ,_bca ,_cda ,_ded );
if _fffbe !=nil {return nil ,_fffbe ;};break ;};if _afg :=_ceg .ScatterChart ;_afg !=nil {_gda ,_fffbe =_eddf .drawScatterChart (_afg ,_bca ,_ddc ,_ded );if _fffbe !=nil {return nil ,_fffbe ;};break ;};if _fge :=_ceg .LineChart ;_fge !=nil {_gda ,_fffbe =_eddf .drawLineChart (_fge ,_bca ,_ddc ,_ded );
if _fffbe !=nil {return nil ,_fffbe ;};break ;};if _fdeb :=_ceg .AreaChart ;_fdeb !=nil {_gda ,_fffbe =_eddf .drawAreaChart (_fdeb ,_bca ,_ddc ,_ded );if _fffbe !=nil {return nil ,_fffbe ;};break ;};};if _afa !=nil {_eeed .scale (_ded );_eddf .drawBorderWithProps (_afa .SpPr ,_eeed ,_dag );
if len (_gda )!=0{_eddf .drawLegend (_eeed ,_gda ,_ega );};};};_eag .scale (_ded );_eddf .drawBorderWithProps (_faf .SpPr ,_eag ,_dag );return _cgf ,nil ;};func TwipsFromPoints (points float64 )float64 {return points /_df .Twips };type Rectangle struct{Top float64 ;
Bottom float64 ;Left float64 ;Right float64 ;};const (ImgPart_whole ImgPart =0;ImgPart_t ImgPart =1;ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;ImgPart_rt ImgPart =6;ImgPart_lb ImgPart =7;ImgPart_rb ImgPart =8;);
const (PageSizeA4 PageSize =iota ;PageSizeA3 ;PageSizeA5 ;PageSizeLetter ;PageSizeLegal ;Percent100 =100000.0;MaxPageHeight =11906;);func RegisterFont (name string ,style FontStyle ,font *_fg .PdfFont ){_fgbg ._baa .Lock ();if _fgbg ._geee [name ]==nil {_fgbg ._geee [name ]=map[FontStyle ]*_fg .PdfFont {};
};_fgbg ._geee [name ][style ]=font ;_fgbg ._baa .Unlock ();};func (_bce *creatorContext )drawTitle (_fb string ,_cbd ,_fcf float64 ){_gac :=_bce ._fbcfg ;_gcbf :=_bce ._gefg .NewStyledParagraph ();_cbgg :=_gcbf .SetText (_fb );_fab ,_fdb :=_fg .NewStandard14Font (_fg .HelveticaName );
if _fdb ==nil {_gggg :=_bce ._gefg .NewTextStyle ();_gggg .Font =_fab ;_gggg .FontSize =14;_gggg .TextRise =0.4;_cbgg .Style =_gggg ;_gcbf .SetPos (_cbd -_gcbf .Width ()*_gac /2,_fcf );_bce ._gefg .Draw (_gcbf );};};type BorderPosition byte ;var _dbada =_dgcb (0.5);
type PageSize int ;func _aggd (_ebd *_eb .CT_SerAx )(uint32 ,_eb .ST_AxPos ,_eb .ST_TickMark ,_eb .ST_TickLblPos ,*_eb .CT_ChartLines ,uint32 ,*_fa .CT_ShapeProperties ,error ){var _fced ,_dbgg uint32 ;var _adfc _eb .ST_AxPos ;var _acab _eb .ST_TickMark ;
var _fbb *_eb .CT_ChartLines ;var _bbfa _eb .ST_TickLblPos ;if _ebd .AxId ==nil {return _fced ,_adfc ,_acab ,_bbfa ,_fbb ,_dbgg ,_ebd .SpPr ,_ed .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_fced =_ebd .AxId .ValAttr ;
};if _ebd .AxPos ==nil {return _fced ,_adfc ,_acab ,_bbfa ,_fbb ,_dbgg ,_ebd .SpPr ,_ed .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_adfc =_ebd .AxPos .ValAttr ;};if _ebd .MajorTickMark !=nil {_acab =_ebd .MajorTickMark .ValAttr ;
};if _ebd .TickLblPos !=nil {_bbfa =_ebd .TickLblPos .ValAttr ;};if _ebd .CrossAx ==nil {return _fced ,_adfc ,_acab ,_bbfa ,_fbb ,_dbgg ,_ebd .SpPr ,_ed .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_dbgg =_ebd .CrossAx .ValAttr ;
};_fbb =_ebd .MajorGridlines ;return _fced ,_adfc ,_acab ,_bbfa ,_fbb ,_dbgg ,_ebd .SpPr ,nil ;};func (_dcfc *creatorContext )drawLegend (_ace *Rectangle ,_gdc []*legendItem ,_aec bool ){_bbbe :=_dcfc ._fbcfg ;_bbf :=_dgcb (2.5)*_bbbe ;_dae :=_ggc *_bbbe ;
_gcd :=(_bbf -_dae )/2;_bfd :=float64 (len (_gdc ));if _aec {_cbgbf :=&Rectangle {Top :_ace .Top +_dgcb (1)*_bbbe ,Bottom :_ace .Bottom -_dgcb (1)*_bbbe ,Left :_ace .Left +_dgcb (2.5)*_bbbe ,Right :_ace .Right -_dgcb (2.5)*_bbbe };var _eddg float64 ;if _bfd > 1{_eddg =(_cbgbf .Right -_cbgbf .Left )/_bfd ;
};_bggbb :=_cbgbf .Left ;_cbag :=_cbgbf .Top ;for _ ,_ffd :=range _gdc {if _gcec :=_ffd ._cad ;_gcec !=nil {_dcfc .drawRectangleWithProps (_gcec ,_bggbb ,_cbag +_gcd ,_dae ,_dae ,false );_fedc :=_bggbb +_dae *2;_bgde :=_dcfc ._gefg .NewStyledParagraph ();
_bgde .SetPos (_fedc ,_cbag );_gdac :=_bgde .Append (_ffd ._agc );_agg ,_cade :=_fg .NewStandard14Font (_fg .HelveticaName );if _cade ==nil {_gacd :=_dcfc ._gefg .NewTextStyle ();_gacd .Font =_agg ;_gacd .FontSize =_bbf ;_gacd .TextRise =0.4;_gdac .Style =_gacd ;
_dcfc ._gefg .Draw (_bgde );};};_bggbb +=_eddg ;};}else {_aea :=&Rectangle {Top :_ace .Top +_dgcb (2.5)*_bbbe ,Bottom :_ace .Bottom -_dgcb (2.5)*_bbbe ,Left :_ace .Left +_dgcb (2.5)*_bbbe ,Right :_ace .Right -_dgcb (2.5)*_bbbe };var _afb float64 ;if _bfd > 1{_afb =(_aea .Bottom -_aea .Top -_bbf )/(_bfd -1);
if _afb < _bbf {_afb =_bbf ;};};_bdbdg :=_aea .Top ;_ecd :=_aea .Left ;_cga :=_ecd +_dae *2;for _ ,_ede :=range _gdc {if _bcb :=_ede ._cad ;_bcb !=nil {_dcfc .drawRectangleWithProps (_bcb ,_ecd ,_bdbdg +_gcd ,_dae ,_dae ,false );_bda :=_dcfc ._gefg .NewStyledParagraph ();
_bda .SetPos (_cga ,_bdbdg );_bda .SetWidth (_aea .Right -_aea .Left );_dcg :=_bda .Append (_ede ._agc );_dfc ,_cgce :=_fg .NewStandard14Font (_fg .HelveticaName );if _cgce ==nil {_dfbc :=_dcfc ._gefg .NewTextStyle ();_dfbc .Font =_dfc ;_dfbc .FontSize =_bbf ;
_dfbc .TextRise =0.4;_dcg .Style =_dfbc ;_dcfc ._gefg .Draw (_bda );};};_bdbdg +=_afb ;};};};func _ddca (_cfabe ,_dcad ,_abfe float64 )float64 {if _cfabe *6< 1{return _abfe +(_dcad -_abfe )*6*_cfabe ;}else if _cfabe *2< 1{return _dcad ;}else if _cfabe *3< 2{return _abfe +(_dcad -_abfe )*(2.0/3.0-_cfabe )*6;
}else {return _abfe ;};};func ClearRegisteredFonts (){_fgbg ._baa .Lock ();_fgbg ._geee =map[string ]map[FontStyle ]*_fg .PdfFont {};_fgbg ._baa .Unlock ();};var RtlFontFile *_fg .PdfFont ;var _dag =_dgcb (0.125);func GetPageDimensions (size PageSize )_ee .PageSize {return _dgb [size ]};
func _edb (_fbga _fa .ST_SchemeColorVal ,_edgc *_fa .Theme )string {if _cada :=_edgc .ThemeElements ;_cada !=nil {if _gccg :=_cada .ClrScheme ;_gccg !=nil {switch _fbga {case _fa .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_gccg .Lt1 );case _fa .ST_SchemeColorValDk1 ,_fa .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_gccg .Dk1 );
case _fa .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_gccg .Lt2 );case _fa .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_gccg .Dk2 );case _fa .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_gccg .Accent1 );case _fa .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_gccg .Accent2 );
case _fa .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_gccg .Accent3 );case _fa .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_gccg .Accent4 );case _fa .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_gccg .Accent5 );
case _fa .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_gccg .Accent6 );};};};return "";};func (_fdcc *Rectangle )Translate (x ,y float64 ){_fdcc .Left +=x ;_fdcc .Right +=x ;_fdcc .Top +=y ;_fdcc .Bottom +=y ;};func _dbgc (_fcfd ,_gfbb ,_daac uint8 )(float64 ,float64 ,float64 ){_aee ,_cagd ,_dfbd :=float64 (_fcfd )/255,float64 (_gfbb )/255,float64 (_daac )/255;
_bdaf :=_aee ;if _cagd < _bdaf {_bdaf =_cagd ;};if _dfbd < _bdaf {_bdaf =_dfbd ;};var _ebgf ,_ccbda bool ;_fac :=_aee ;if _cagd > _fac {_fac =_cagd ;_ebgf =true ;};if _dfbd > _fac {_fac =_dfbd ;_ebgf =false ;_ccbda =true ;};_acc :=(_bdaf +_fac )/2;var _deef float64 ;
if _bdaf !=_fac {if _acc <=0.5{_deef =(_fac -_bdaf )/(_fac +_bdaf );}else {_deef =(_fac -_bdaf )/(2.0-_fac -_bdaf );};};var _agea float64 ;if _bdaf !=_fac {if _ebgf {_agea =2.0+(_dfbd -_aee )/(_fac -_bdaf );}else if _ccbda {_agea =4.0+(_aee -_cagd )/(_fac -_bdaf );
}else {_agea =(_cagd -_dfbd )/(_fac -_bdaf );};_agea *=60;if _agea < 0{_agea +=360;};};return _agea ,_deef ,_acc ;};func MakeImageFromChartSpace (cs *_eb .ChartSpace ,width ,height float64 ,theme *_fa .Theme ,workbook *_ac .Workbook )(_ec .Image ,error ){_gae ,_ffc :=_aef (cs ,width ,height ,theme ,true ,workbook );
if _ffc !=nil {return nil ,_ffc ;};_faa ,_ffc :=GetPageFromCreator (_gae );if _ffc !=nil {return nil ,_ffc ;};return _bf .NewImageDevice ().Render (_faa );};func GetRegisteredFont (name string ,style FontStyle )*_fg .PdfFont {_fgbg ._baa .Lock ();defer _fgbg ._baa .Unlock ();
if _bga ,_gaa :=_fgbg ._geee [name ];_gaa {if _bbg ,_fddg :=_bga [style ];_fddg {return _bbg ;};};return nil ;};func _dgcb (_fefc float64 )float64 {return _fefc *_df .Millimeter };func _cde (_bbbd float64 )float64 {if _bbbd < 0{_bbbd +=float64 (-int (_bbbd )+1);
}else if _bbbd > 1{_bbbd -=float64 (int (_bbbd ));};return _bbbd ;};func GetImage (c *_ee .Creator ,goImg _ec .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_ee .Image ,error ){if goImg ==nil {return nil ,nil ;};_edgbe :=goImg .Bounds ().Size ();
_cdagc :=_edgbe .X ;_adgg :=_edgbe .Y ;if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_cdagc );};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_adgg );};var _egfb _ec .Rectangle ;switch part {case ImgPart_t :_egfb =_ec .Rect (0,0,_cdagc ,int (dividerY ));
case ImgPart_b :_egfb =_ec .Rect (0,int (dividerY ),_cdagc ,_adgg );case ImgPart_l :_egfb =_ec .Rect (0,0,int (dividerX ),_adgg );case ImgPart_r :_egfb =_ec .Rect (int (dividerX ),0,_cdagc ,_adgg );case ImgPart_lt :_egfb =_ec .Rect (0,0,int (dividerX ),int (dividerY ));
case ImgPart_rt :_egfb =_ec .Rect (int (dividerX ),0,_cdagc ,int (dividerY ));case ImgPart_lb :_egfb =_ec .Rect (0,int (dividerY ),int (dividerX ),_adgg );case ImgPart_rb :_egfb =_ec .Rect (int (dividerX ),int (dividerY ),_cdagc ,_adgg );default:_egfb =_ec .Rect (0,0,_cdagc ,_adgg );
};_bgdb :=CropImageByRect (goImg ,_egfb );_ageaa ,_cacab :=c .NewImageFromGoImage (_bgdb );if _cacab !=nil {return nil ,_cacab ;};_ageaa .Scale (imgWidth /float64 (_cdagc ),imgHeight /float64 (_adgg ));_ageaa .SetPos (left ,top );return _ageaa ,nil ;};
func (_cefb *creatorContext )getPdfColorFromSolidFill (_cbgf *_fa .CT_SolidColorFillProperties )_ee .Color {if _cbgf ==nil {return nil ;};_gcdg :="";if _acgg :=_cbgf .SrgbClr ;_acgg !=nil {_gcdg =_acgg .ValAttr ;}else if _abgde :=_cbgf .SchemeClr ;_abgde !=nil {_gcdg =_edb (_abgde .ValAttr ,_cefb ._bfe );
_gcdg =AdjustColor (_gcdg ,_abgde .EG_ColorTransform );};if _gcdg ==""{return nil ;};return _ee .ColorRGBFromHex ("\u0023"+_gcdg );};var _ggc =_dgcb (1.5);func (_abfa *creatorContext )addCatValue (_dbg string ,_gca map[string ]serCategory ,_gebd []string ,_fffb int ,_gce ,_egd *float64 ,_gaf string ,_fgba *_fa .CT_ShapeProperties ){_bdbd ,_agb :=_bg .ParseFloat (_dbg ,64);
if _agb !=nil {_bdbd =0;_def .Log .Debug ("\u0070a\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_agb );};if _bdbd > *_egd {*_egd =_bdbd ;};if _bdbd < *_gce {*_gce =_bdbd ;};_fgf :=_gca [_gebd [_fffb ]];_fgf ._cca =append (_fgf ._cca ,serValue {_gfg :_gaf ,_cbgbd :_bdbd ,_gab :_fgba });
_gca [_gebd [_fffb ]]=_fgf ;};func (_dbgcg *creatorContext )drawLineWithProps (_daag *_fa .CT_ShapeProperties ,_ddce ,_bdafg ,_cdef ,_fccg float64 ,_cadg bool ){if _daag !=nil {if _gbcd :=_daag .Ln ;_gbcd !=nil {_gbad :=_dbgcg .getPdfColorFromSolidFill (_gbcd .LineFillPropertiesChoice .SolidFill );
if _gbad ==nil &&_cadg {_gbad =_ee .ColorBlack ;};if _gbad !=nil {var _dabg float64 ;if _dedb :=_gbcd .WAttr ;_dedb !=nil {_dabg =_df .FromEMU (int64 (*_dedb ));}else {_dabg =_dag ;};DrawLine (_dbgcg ._gefg ,_ddce ,_bdafg ,_cdef ,_fccg ,_dabg ,_gbad );
};};};};func MakeTempCreatorMaxHeight (width float64 )*_ee .Creator {return MakeTempCreator (width ,MaxPageHeight );};func LoadFontFromFile (filename string )(*_fg .PdfFont ,error ){if !_fe .HasSuffix (filename ,"\u002e\u0074\u0074\u0066"){_def .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return nil ,_d .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_bddf ,_febb :=_fg .NewCompositePdfFontFromTTFFile (filename );if _febb !=nil {return nil ,_febb ;};return _bddf ,nil ;};func (_eef *creatorContext )drawBarChart (_cbg *_eb .CT_BarChart ,_dba *Rectangle ,_fca []*_eb .CT_PlotAreaChoice1 ,_ebf *_ac .Workbook )([]*legendItem ,error ){var _beg bool ;
if _geb :=_cbg .BarDir ;_geb !=nil {_beg =_geb .ValAttr ==_eb .ST_BarDirBar ;};_ea :=_cbg .Ser ;_gff .Sort (barSerByOrder (_ea ));_dca :=map[string ]serCategory {};_aab :=[]string {};_egc :=[]*legendItem {};_bfc :=_be .Inf (1);_bgg :=_be .Inf (-1);for _ ,_eac :=range _ea {var _gc string ;
if _cec :=_eac .Tx ;_cec !=nil {if _eea :=_cec .SerTxChoice ;_eea !=nil {if _eea .V !=nil {_gc =*_eea .V ;}else if _fd :=_eea .StrRef ;_fd !=nil {if _bggg :=_fd .StrCache ;_bggg !=nil {for _ ,_fde :=range _bggg .Pt {_gc =_fde .V ;};};};};};if _ef :=_eac .Cat ;
_ef !=nil {if _fef :=_ef .AxDataSourceChoice ;_fef !=nil {if _bc :=_fef .StrRef ;_bc !=nil {if _bgggb :=_bc .F ;_bgggb !=""&&_ebf !=nil {_aaf ,_fdg ,_bfad ,_gfe :=ParseExcelRange (_bgggb );if _gfe ==nil {for _ ,_bcg :=range _ebf .Sheets (){if _bcg .Name ()==_fe .Trim (_aaf ,"\u0027"){_bdc :=_fdg .String ();
for _bdcc :=_fdg .RowIdx ;_bdcc <=_bfad .RowIdx ;_bdcc +=1{_cdd :=_fe .ReplaceAll (_bdc ,_d .Sprint (_fdg .RowIdx ),_d .Sprint (_bdcc ));_eef .addCatName (_bcg .Cell (_cdd ).GetString (),_dca ,&_aab );};break ;};};};};if _cee :=_bc .StrCache ;_cee !=nil {for _ ,_fea :=range _cee .Pt {_eef .addCatName (_fea .V ,_dca ,&_aab );
};};}else if _abdb :=_fef .NumRef ;_abdb !=nil {if _edg :=_abdb .NumCache ;_edg !=nil {var _dd string ;if _edg .FormatCode !=nil {_dd =*_edg .FormatCode ;};for _ ,_gbc :=range _edg .Pt {var _egcf string ;if _gbc .FormatCodeAttr ==nil {_egcf =_dd ;}else {_egcf =*_gbc .FormatCodeAttr ;
};var _ecf string ;_bggb ,_ga :=_bg .ParseFloat (_gbc .V ,64);if _ga !=nil {_ecf =_gbc .V ;}else {_ecf =_ba .Number (_bggb ,_egcf );};_eef .addCatName (_ecf ,_dca ,&_aab );};};};};};if _eaa :=_eac .Val ;_eaa !=nil {if _gcc :=_eaa .NumDataSourceChoice ;
_gcc !=nil {if _ffg :=_gcc .NumRef ;_ffg !=nil {if _aca :=_ffg .F ;_aca !=""&&_ebf !=nil {_bff ,_feed ,_bed ,_dgf :=ParseExcelRange (_aca );if _dgf ==nil {for _ ,_aed :=range _ebf .Sheets (){if _aed .Name ()==_fe .Trim (_bff ,"\u0027"){_geba :=_feed .String ();
for _bfff :=_feed .RowIdx ;_bfff <=_bed .RowIdx ;_bfff +=1{_bgf :=_fe .ReplaceAll (_geba ,_d .Sprint (_feed .RowIdx ),_d .Sprint (_bfff ));if _aed .FormulaContext ().HasFormula (_bgf ){_bgb :=_eca .NewEvaluator ();_edge :=_aed .FormulaContext ().Cell (_bgf ,_bgb );
_gbg :=_edge .Value ();_eef .addCatValue (_gbg ,_dca ,_aab ,(int )(_bfff -_feed .RowIdx ),&_bfc ,&_bgg ,_gc ,_eac .SpPr );}else {_ade :=_aed .Cell (_bgf ).GetString ();_eef .addCatValue (_ade ,_dca ,_aab ,(int )(_bfff -_feed .RowIdx ),&_bfc ,&_bgg ,_gc ,_eac .SpPr );
};};break ;};};};};if _abe :=_ffg .NumCache ;_abe !=nil {for _dgff ,_dgc :=range _abe .Pt {_eef .addCatValue (_dgc .V ,_dca ,_aab ,_dgff ,&_bfc ,&_bgg ,_gc ,_eac .SpPr );};};};};};_egc =append (_egc ,&legendItem {_agc :_gc ,_cad :_eac .SpPr });};var _fgg float64 ;
var _cae ,_ffgf float64 ;if _bgg ==0&&_bfc ==0{_fgg =0.2;_ffgf =0;_cae =1;}else {var _daa float64 ;if _fgb :=_be .Abs (_bfc );_bgg < _fgb {_daa =_fgb ;}else {_daa =_bgg ;};_daf :=_be .Pow (10,_be .Floor (_be .Log10 (_daa )));_cag :=_daa /_daf ;if _cag < 4.29{_fgg =0.5;
}else if _cag >=4.29&&_cag < 8.58{_fgg =1;}else {_fgg =2;};_fgg *=_daf ;if _bgg <=0{_cae =0;}else {_cae =(_be .Ceil (_bgg /_fgg )+1)*_fgg ;};if _bfc >=0{_ffgf =0;}else {_ffgf =(_be .Floor (_bfc /_fgg )-1)*_fgg ;};};_cac :=_eef .drawAxes (_fca ,_ffgf ,_cae ,_fgg ,_aab ,_dba ,_beg );
if _cac !=nil {return nil ,_cac ;};_egf :=0.0;if _cbg .GapWidth !=nil {if _gfd :=_cbg .GapWidth .ValAttr ;_gfd !=nil {if _febd :=_gfd .ST_GapAmountUShort ;_febd !=nil {_egf =float64 (*_febd )/100.0;};};};_fae :=_dba .Right -_dba .Left ;_geg :=_dba .Bottom -_dba .Top ;
_cg :=float64 (len (_aab ));if _beg {_cgc :=_cae /(_cae -_ffgf )*_fae ;_ebb :=-_ffgf /(_cae -_ffgf )*_fae ;_gg :=_dba .Left +_ebb ;_ebg :=_geg /_cg ;for _bfb ,_bgd :=range _aab {_add :=_dca [_bgd ];_gcb :=float64 (len (_add ._cca ))+_egf ;_bcgf :=_ebg /_gcb ;
_fgc :=_bcgf *_egf ;_eaf :=_dba .Bottom -float64 (_bfb )*_ebg -_fgc /2-_bcgf ;for _ ,_fad :=range _add ._cca {if _fad ._cbgbd ==0{continue ;};var _dfb ,_gba float64 ;if _fad ._cbgbd > 0{_gba =_fad ._cbgbd /_cae *_cgc ;_eef .drawRectangleWithProps (_fad ._gab ,_gg ,_eaf ,_gba ,_bcgf ,false );
}else {_gba =_fad ._cbgbd /_ffgf *_ebb ;_dfb =_gg -_gba ;_eef .drawRectangleWithProps (_fad ._gab ,_dfb ,_eaf ,_gba ,_bcgf ,false );};_eaf -=_bcgf ;};};}else {_dee :=_cae /(_cae -_ffgf )*_geg ;_bcd :=-_ffgf /(_cae -_ffgf )*_geg ;_ccb :=_dba .Top +_dee ;
_ggg :=_fae /_cg ;for _ccf ,_cbgb :=range _aab {_fcad :=_dca [_cbgb ];_abg :=float64 (len (_fcad ._cca ))+_egf ;_edd :=_ggg /_abg ;_ddd :=_edd *_egf ;_ebe :=_dba .Left +float64 (_ccf )*_ggg +_ddd /2;for _ ,_edf :=range _fcad ._cca {var _bb ,_cce float64 ;
if _edf ._cbgbd > 0{_cce =_edf ._cbgbd /_cae *_dee ;_bb =_ccb -_cce ;_eef .drawRectangleWithProps (_edf ._gab ,_ebe ,_bb ,_edd ,_cce ,false );}else {_cce =_edf ._cbgbd /_ffgf *_bcd ;_eef .drawRectangleWithProps (_edf ._gab ,_ebe ,_ccb ,_edd ,_cce ,false );
};_ebe +=_edd ;};};};return _egc ,nil ;};func (_gdffc *Rectangle )scale (_fabg float64 ){_gdffc .Top *=_fabg ;_gdffc .Bottom *=_fabg ;_gdffc .Left *=_fabg ;_gdffc .Right *=_fabg ;};var _cggg =_dgcb (2);const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;
FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func GetColorStringFromDmlColor (dmlColor *_fa .CT_Color )string {var _ddf string ;if _cgb :=dmlColor .SrgbClr ;_cgb !=nil {_ddf =_cgb .ValAttr ;}else if _cgceg :=dmlColor .SysClr ;_cgceg !=nil {if _cgceg .LastClrAttr !=nil {return *_cgceg .LastClrAttr ;
};return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _ddf ;};func DrawRectangle (c *_ee .Creator ,r *Rectangle ,w float64 ,color _ee .Color ){if color ==nil {return ;};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );
DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};func (_dcd *creatorContext )drawBorderWithProps (_agfb *_fa .CT_ShapeProperties ,_bfce *Rectangle ,_bcca float64 ){if _bfce !=nil &&_agfb !=nil &&_agfb .Ln !=nil &&_agfb .Ln .LineFillPropertiesChoice .SolidFill !=nil {_efeb :=_dcd .getPdfColorFromSolidFill (_agfb .Ln .LineFillPropertiesChoice .SolidFill );
DrawRectangle (_dcd ._gefg ,_bfce ,_bcca ,_efeb );};};func GetDataFromXfrm (xfrm *_fa .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _ebfg ,_agdd ,_feede ,_bfdd float64 ;if _gfbc :=xfrm .Off ;_gfbc !=nil {_ebfg =_df .FromEMU (FromSTCoordinate (_gfbc .XAttr ));
_agdd =_df .FromEMU (FromSTCoordinate (_gfbc .YAttr ));};if _fgae :=xfrm .Ext ;_fgae !=nil {_feede =_df .FromEMU (_fgae .CxAttr );_bfdd =_df .FromEMU (_fgae .CyAttr );};return _ebfg ,_agdd ,_feede ,_bfdd ;};var _cfa =_dgcb (1.5);func FromSTPercentage (st *_fa .ST_Percentage )float64 {if _dcgff :=st .ST_PercentageDecimal ;
_dcgff !=nil {return float64 (*_dcgff )/Percent100 ;};return 0;};func (_eccd FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_eccd )];
};func _abec (_dbcg string )([]byte ,error ){_dce :=_gf .MustCompile ("\u005b\u005e\u0061\u002d\u007a\u0041\u002d\u005a\u0030\u002d\u0039\u005d\u002b");_dbcg =_dce .ReplaceAllString (_dbcg ,"");_adec :=[]rune (_dbcg );_bba :=[]byte {};for _deed :=len (_adec )-2;
_deed >=0;_deed -=2{_bcga ,_geag :=_bg .ParseUint (string (_adec [_deed ])+string (_adec [_deed +1]),16,8);if _geag !=nil {return nil ,_geag ;};_bba =append (_bba ,byte (_bcga ));};return _bba ,nil ;};var (DefaultFontSize =12.0;DefaultImageEncoder _gfb .StreamEncoder ;
DefaultPageSize =PageSizeA4 ;_dgb =map[PageSize ]_ee .PageSize {PageSizeA3 :_ee .PageSizeA3 ,PageSizeA4 :_ee .PageSizeA4 ,PageSizeA5 :_ee .PageSizeA5 ,PageSizeLetter :_ee .PageSizeLetter ,PageSizeLegal :_ee .PageSizeLegal };);func GetDefaultPageSize ()_ee .PageSize {return _dgb [DefaultPageSize ]};
func ParseExcelRange (s string )(string ,_ab .CellReference ,_ab .CellReference ,error ){_caab :=_fe .FieldsFunc (s ,func (_dcef rune )bool {return _dcef ==':'||_dcef =='!'});if len (_caab )==3{_cbfe ,_aad :=_ab .ParseCellReference (_caab [1]);if _aad !=nil {return "",_ab .CellReference {},_ab .CellReference {},_aad ;
};_gdb ,_aad :=_ab .ParseCellReference (_caab [2]);if _aad !=nil {return "",_ab .CellReference {},_ab .CellReference {},_aad ;};return _caab [0],_cbfe ,_gdb ,nil ;};return "",_ab .CellReference {},_ab .CellReference {},_ed .New ("\u0065r\u0072\u006f\u0072\u0020p\u0061\u0072\u0073\u0069\u006eg\u0020e\u0078c\u0065\u006c\u0020\u0072\u0061\u006e\u0067e");
};func GetOpacityFromColorTransform (trs []*_fa .EG_ColorTransform )float64 {for _ ,_gfde :=range trs {if _gfde !=nil {if _gddc :=_gfde .ColorTransformChoice .Alpha ;_gddc !=nil {if _agcd :=_gddc .ValAttr .ST_PositiveFixedPercentageDecimal ;_agcd !=nil {return float64 (*_agcd )/Percent100 ;
};};};};return 1.0;};func MakeTempCreator (width ,height float64 )*_ee .Creator {_edgb :=_ee .New ();_edgb .SetPageSize (_ee .PageSize {width ,height });_edgb .SetPageMargins (0,0,0,0);return _edgb ;};func MakeBlockFromCreator (c *_ee .Creator )(*_ee .Block ,error ){_ceed ,_dea :=GetPageFromCreator (c );
if _dea !=nil {return nil ,_dea ;};_bbdg ,_dea :=_ee .NewBlockFromPage (_ceed );if _dea !=nil {return nil ,_dea ;};return _bbdg ,nil ;};func FromSTCoordinate (st _fa .ST_Coordinate )int64 {if _afcd :=st .ST_CoordinateUnqualified ;_afcd !=nil {return *_afcd ;
};return 0;};func _ccdd (_gdace *_eb .CT_CatAx )(uint32 ,_eb .ST_AxPos ,_eb .ST_TickMark ,_eb .ST_TickLblPos ,*_eb .CT_ChartLines ,uint32 ,*_fa .CT_ShapeProperties ,error ){var _caca ,_eafg uint32 ;var _ccde _eb .ST_AxPos ;var _bdcd _eb .ST_TickMark ;var _edfb *_eb .CT_ChartLines ;
var _cafg _eb .ST_TickLblPos ;if _gdace .AxId ==nil {return _caca ,_ccde ,_bdcd ,_cafg ,_edfb ,_eafg ,_gdace .SpPr ,_ed .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_caca =_gdace .AxId .ValAttr ;};if _gdace .AxPos ==nil {return _caca ,_ccde ,_bdcd ,_cafg ,_edfb ,_eafg ,_gdace .SpPr ,_ed .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");
}else {_ccde =_gdace .AxPos .ValAttr ;};if _gdace .MajorTickMark !=nil {_bdcd =_gdace .MajorTickMark .ValAttr ;};if _gdace .TickLblPos !=nil {_cafg =_gdace .TickLblPos .ValAttr ;};if _gdace .CrossAx ==nil {return _caca ,_ccde ,_bdcd ,_cafg ,_edfb ,_eafg ,_gdace .SpPr ,_ed .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_eafg =_gdace .CrossAx .ValAttr ;};_edfb =_gdace .MajorGridlines ;return _caca ,_ccde ,_bdcd ,_cafg ,_edfb ,_eafg ,_gdace .SpPr ,nil ;};func (_gfgf *creatorContext )drawScatterChart (_eeac *_eb .CT_ScatterChart ,_bfg *Rectangle ,_dcgc []*_eb .CT_PlotAreaChoice1 ,_aeed float64 )([]*legendItem ,error ){_fdee :=[]*legendItem {};
_bgaf :=_eeac .Ser ;_ecdb :=make (map[string ]float64 );_ggb :=make (map[string ][]float64 );_cdea :=make (map[string ][]float64 );_agac :=[]string {};for _ ,_cgdg :=range _bgaf {var _cgdee string ;if _gacdb :=_cgdg .Tx ;_gacdb !=nil {if _efcf :=_gacdb .SerTxChoice ;
_efcf !=nil {if _efcf .V !=nil {_cgdee =*_efcf .V ;}else if _aafb :=_efcf .StrRef ;_aafb !=nil {if _ebfa :=_aafb .StrCache ;_ebfa !=nil {for _ ,_fbdf :=range _ebfa .Pt {_cgdee =_fbdf .V ;};};};_agac =append (_agac ,_cgdee );};};if _cgdg .Marker !=nil &&_cgdg .Marker .Size !=nil {_ecdb [_cgdee ]=float64 (*_cgdg .Marker .Size .ValAttr );
}else {_ecdb [_cgdee ]=-1.0;};if _bdeb :=_cgdg .XVal ;_bdeb !=nil {if _eabg :=_bdeb .AxDataSourceChoice ;_eabg !=nil {if _bbcc :=_eabg .NumRef ;_bbcc !=nil {if _fffc :=_bbcc .NumCache ;_fffc !=nil {for _ ,_gage :=range _fffc .Pt {_eafee ,_ :=_bg .ParseFloat (_fe .TrimSpace (_gage .V ),64);
_ggb [_cgdee ]=append (_ggb [_cgdee ],_eafee );};};};};};if _acfg :=_cgdg .YVal ;_acfg !=nil {if _cegb :=_acfg .NumDataSourceChoice ;_cegb !=nil {if _bcdd :=_cegb .NumRef ;_bcdd !=nil {if _gbf :=_bcdd .NumCache ;_gbf !=nil {for _ ,_bffa :=range _gbf .Pt {_gbcb ,_ :=_bg .ParseFloat (_fe .TrimSpace (_bffa .V ),64);
_cdea [_cgdee ]=append (_cdea [_cgdee ],_gbcb );};};};};};};_egfc :=true ;_agae :="";_cecb :="";if len (_dcgc )> 1{if _dcgc [0].ValAx .Delete !=nil &&_dcgc [1].ValAx .Delete !=nil {if !*(*_dcgc [0].ValAx .Delete ).ValAttr &&!*(*_dcgc [1].ValAx .Delete ).ValAttr {_egfc =false ;
};};_agae =_gfgf .getTitle (_dcgc [0].ValAx .Title );_cecb =_gfgf .getTitle (_dcgc [1].ValAx .Title );};_cbfb :=_eee .Style {Hidden :_egfc ,FontSize :8*_aeed };_dcccf :=&_de .Chart {Series :[]_bd .Series {},YAxisSecondary :_de .YAxis {Style :_cbfb ,Name :_cecb ,NameStyle :_cbfb },XAxis :_de .XAxis {Style :_cbfb ,Name :_agae ,NameStyle :_cbfb },YAxis :_de .YAxis {Style :_eee .Style {Hidden :true }}};
for _ ,_eceb :=range _agac {_fecc :=_bd .ContinuousSeries {XValues :_ggb [_eceb ],YValues :_cdea [_eceb ],Style :_eee .Style {StrokeWidth :-1,DotWidth :_ecdb [_eceb ]}};_dcccf .Series =append (_dcccf .Series ,_fecc );};_dcccf .SetHeight (int (_be .Abs (_bfg .Top -_bfg .Bottom )));
_dcccf .SetWidth (int (_be .Abs (_bfg .Right -_bfg .Left )));_ebc :=_gfgf ._gefg ;_aead :=_ee .NewChart (_dcccf );_aead .SetPos (_bfg .Left ,_bfg .Top );_babb :=_ebc .Draw (_aead );if _babb !=nil {return nil ,_babb ;};return _fdee ,nil ;};func (_afe *creatorContext )drawAxes (_cage []*_eb .CT_PlotAreaChoice1 ,_bgdd ,_fgaa ,_ece float64 ,_adfd []string ,_gea *Rectangle ,_fce bool )error {_fgd :=_afe ._gefg ;
_baf :=_afe ._fbcfg ;if _cage ==nil {return _ed .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};var (_dgd *_eb .CT_ValAx ;_gaed *_eb .CT_CatAx ;_gbe *_eb .CT_DateAx ;_cbcg *_eb .CT_SerAx ;
);for _ ,_eeg :=range _cage {if _eeg .ValAx !=nil {_dgd =_eeg .ValAx ;}else if _eeg .CatAx !=nil {_gaed =_eeg .CatAx ;}else if _eeg .DateAx !=nil {_gbe =_eeg .DateAx ;}else if _eeg .SerAx !=nil {_cbcg =_eeg .SerAx ;};};if _dgd ==nil ||(_gaed ==nil &&_gbe ==nil &&_cbcg ==nil ){return _ed .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");
};var _caf ,_fcg ,_acb ,_eeee uint32 ;var _dcfe ,_ccac _eb .ST_AxPos ;var _ecca ,_caef _eb .ST_TickMark ;var _aafe ,_ceac *_eb .CT_ChartLines ;var _cgd ,_bdd _eb .ST_TickLblPos ;var _bgbg ,_cef *_fa .CT_ShapeProperties ;var _fdga error ;_ead :=_gea .Right -_gea .Left ;
_caa :=_gea .Bottom -_gea .Top ;if _dgd !=nil {_fcg ,_ccac ,_caef ,_bdd ,_ceac ,_eeee ,_cef ,_fdga =_dgdg (_dgd );};if _ccac !=_eb .ST_AxPosL &&_ccac !=_eb .ST_AxPosB {return _ed .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};_gbb :=_fgaa -_bgdd ;_eab :=int (_gbb /_ece )+1;var _afeb ,_fag float64 ;switch _caef {case _eb .ST_TickMarkIn :_afeb ,_fag =_aedc ,0;case _eb .ST_TickMarkOut :_afeb ,_fag =0,_aedc ;case _eb .ST_TickMarkCross :_afeb ,_fag =_aedc ,_aedc ;};_afeb =_afeb *_baf ;
_fag =_fag *_baf ;var _cagc *_fa .CT_ShapeProperties ;if _ceac !=nil {_cagc =_ceac .SpPr ;};_eed ,_gdd :=_cgd !=_eb .ST_TickLblPosNone ,_bdd !=_eb .ST_TickLblPosNone ;_ffb :=_bgdd ;if _gaed !=nil {_caf ,_dcfe ,_ecca ,_cgd ,_aafe ,_acb ,_bgbg ,_fdga =_ccdd (_gaed );
}else if _gbe !=nil {_caf ,_dcfe ,_ecca ,_cgd ,_aafe ,_acb ,_bgbg ,_fdga =_dge (_gbe );}else if _cbcg !=nil {_caf ,_dcfe ,_ecca ,_cgd ,_aafe ,_acb ,_bgbg ,_fdga =_aggd (_cbcg );};if _fdga !=nil {return _fdga ;};if _dcfe !=_eb .ST_AxPosL &&_dcfe !=_eb .ST_AxPosB {return _ed .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};if _caf !=_eeee ||_fcg !=_acb {return _ed .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_bfag :=len (_adfd )+1;var _cbde ,_fbea float64 ;switch _ecca {case _eb .ST_TickMarkIn :_cbde ,_fbea =_aedc ,0;
case _eb .ST_TickMarkOut :_cbde ,_fbea =0,_aedc ;case _eb .ST_TickMarkCross :_cbde ,_fbea =_aedc ,_aedc ;};_cbde =_cbde *_baf ;_fbea =_fbea *_baf ;var _cfb *_fa .CT_ShapeProperties ;if _aafe !=nil {_cfb =_aafe .SpPr ;};if _fce {_fbec :=_caa /float64 (len (_adfd ));
_ddg :=_gea .Left -_bgdd *_ead /_gbb ;_dda :=_ddg -_bcdc *_baf ;if _eed {var _cbf float64 ;for _fbg :=0;_fbg < _bfag ;_fbg ++{_cge :=_gea .Bottom -float64 (_fbg )*_fbec ;if _fbg < _bfag -1{_eddd :=_fgd .NewParagraph (_adfd [_fbg ]);_eddd .SetFontSize (_bde *_baf );
_eddd .SetPos (_dda ,_cge -_fbec /2-_cfa *_baf );_fgd .Draw (_eddd );_bbbg :=(_eddd .Width ()/1000-_bcdc )*_baf ;if _bbbg > 0&&_bbbg > _cbf {_cbf =_bbbg ;};};};if _cbf > 0{_gea .Left +=_cbf +_cggg ;_ddg =_gea .Left -_bgdd *_ead /_gbb ;_ead =_gea .Right -_gea .Left ;
};};_bddd :=_ddg -_fbea ;_agd :=_ddg +_cbde ;_dcc :=_gea .Left ;_agde :=_gea .Right ;for _gdg :=0;_gdg < _bfag ;_gdg ++{_faba :=_gea .Bottom -float64 (_gdg )*_fbec ;_afe .drawLineWithProps (_bgbg ,_bddd ,_faba ,_agd ,_faba ,true );_afe .drawLineWithProps (_cfb ,_dcc ,_faba ,_agde ,_faba ,true );
};_ccbc :=_ead /_gbb ;_geac :=_gea .Bottom -_afeb ;_ggcd :=_gea .Bottom +_fag ;_bge :=_gea .Top ;_gebe :=_gea .Bottom ;for _aga :=0;_aga < _eab ;_aga ++{_dcfb :=_gea .Left +(_ffb -_bgdd )*_ccbc ;_afe .drawLineWithProps (_cef ,_dcfb ,_geac ,_dcfb ,_ggcd ,true );
_afe .drawLineWithProps (_cagc ,_dcfb ,_bge ,_dcfb ,_gebe ,true );if _gdd {_edgd :=_fgd .NewParagraph (_bg .FormatFloat (_ffb ,'g',-1,64));_edgd .SetFontSize (_bde *_baf );_edgd .SetPos (_dcfb -_dbada *_baf ,_gebe +_gad *_baf );_fgd .Draw (_edgd );};_ffb +=_ece ;
};}else {_afbd :=_caa /_gbb ;_deg :=_gea .Left ;if _gdd {var _fbd float64 ;for _fgbd :=0;_fgbd < _eab ;_fgbd ++{_dbc :=_gea .Bottom -(_ffb -_bgdd )*_afbd ;_ffff :=_fgd .NewParagraph (_bg .FormatFloat (_ffb ,'g',-1,64));_ffff .SetFontSize (_bde *_baf );
_ffff .SetPos (_deg -_bcdc *_baf ,_dbc -_cfa *_baf );_fgd .Draw (_ffff );_gcfc :=(_ffff .Width ()/1000-_bcdc )*_baf ;if _gcfc > 0&&_gcfc > _fbd {_fbd =_gcfc ;};_ffb +=_ece ;};if _fbd > 0{_gea .Left +=_fbd +_cggg ;_ead =_gea .Right -_gea .Left ;};};_ffb =_bgdd ;
_ceca :=_gea .Left -_fag ;_gccb :=_gea .Left +_afeb ;_deg =_gea .Left ;_feea :=_gea .Right ;for _cebe :=0;_cebe < _eab ;_cebe ++{_bab :=_gea .Bottom -(_ffb -_bgdd )*_afbd ;_afe .drawLineWithProps (_cef ,_ceca ,_bab ,_gccb ,_bab ,true );_afe .drawLineWithProps (_cagc ,_deg ,_bab ,_feea ,_bab ,true );
_ffb +=_ece ;};_gabd :=_ead /float64 (len (_adfd ));_afbg :=_gea .Bottom +_bgdd *_caa /_gbb ;_bee :=_afbg -_cbde ;_bbeb :=_afbg +_fbea ;_acd :=_gea .Top ;_adeb :=_gea .Bottom ;_fdd :=_afbg +_gad *_baf ;for _gbed :=0;_gbed < _bfag ;_gbed ++{_gdgg :=_gea .Left +float64 (_gbed )*_gabd ;
_afe .drawLineWithProps (_bgbg ,_gdgg ,_bee ,_gdgg ,_bbeb ,true );_afe .drawLineWithProps (_cfb ,_gdgg ,_acd ,_gdgg ,_adeb ,true );if _eed &&_gbed < _bfag -1{_dgfff :=_fgd .NewParagraph (_adfd [_gbed ]);_dgfff .SetFontSize (_bde *_baf );_dgfff .SetPos (_gdgg +_fbe *_baf ,_fdd );
_fgd .Draw (_dgfff );};};};return nil ;};func IsNoSpaceLanguage (symbol string )bool {for _ ,_acbd :=range symbol {if _f .Is (_f .Han ,_acbd ){return true ;};};return false ;};func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_df .Twips *10+0.5))/10;
};const (BorderPositionTop BorderPosition =0;BorderPositionLeft BorderPosition =1;BorderPositionBottom BorderPosition =2;BorderPositionRight BorderPosition =3;);func DrawLine (c *_ee .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _ee .Color ){if color ==nil {return ;
};_abga :=c .NewLine (x0 ,y0 ,x1 ,y1 );_abga .SetLineWidth (width );_abga .SetColor (color );c .Draw (_abga );};type serValue struct{_gfg string ;_cbgbd float64 ;_gab *_fa .CT_ShapeProperties ;};func (_cebg barSerByOrder )Swap (i ,j int ){_cebg [i ],_cebg [j ]=_cebg [j ],_cebg [i ]};
func FromSTCoordinate32 (st _fa .ST_Coordinate32 )int64 {if _gbee :=st .ST_Coordinate32Unqualified ;_gbee !=nil {return int64 (*_gbee );};return 0;};func CropImageByRect (sourceImg _ec .Image ,rect _ec .Rectangle )_ec .Image {_efag ,_cbad ,_fcag ,_bbga :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;
_gbeec :=_ec .NewNRGBA (_ec .Rect (0,0,_fcag -_efag ,_bbga -_cbad ));for _bfeg :=_efag ;_bfeg < _fcag ;_bfeg ++{for _abb :=_cbad ;_abb < _bbga ;_abb ++{_gbeec .Set (_bfeg -_efag ,_abb -_cbad ,sourceImg .At (_bfeg ,_abb ));};};return _gbeec ;};var _gad =_dgcb (1.5);
func AdjustColor (colorStr string ,EG_ColorTransform []*_fa .EG_ColorTransform )string {for _ ,_beea :=range EG_ColorTransform {if _ccbd :=_beea .ColorTransformChoice .Tint ;_ccbd !=nil {if _daeb :=_ccbd .ValAttr .ST_PositiveFixedPercentageDecimal ;_daeb !=nil {colorStr =AdjustColorByTint (colorStr ,1.0-float64 (*_daeb )/Percent100 );
};};if _abea :=_beea .ColorTransformChoice .Shade ;_abea !=nil {if _ddff :=_abea .ValAttr .ST_PositiveFixedPercentageDecimal ;_ddff !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_ddff )/Percent100 );};};if _cfd :=_beea .ColorTransformChoice .LumMod ;
_cfd !=nil {if _bcf :=_cfd .ValAttr .ST_PercentageDecimal ;_bcf !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_bcf )/Percent100 );};};if _aeac :=_beea .ColorTransformChoice .LumOff ;_aeac !=nil {if _gag :=_aeac .ValAttr .ST_PercentageDecimal ;
_gag !=nil {colorStr =AdjustColorByLumOff (colorStr ,float64 (*_gag )/Percent100 );};};};return colorStr ;};func RegisterEmbeddedFonts (d *_ff .Document )error {_dadd :=d .FontTable ();if _dadd ==nil {return nil ;};for _ ,_fdde :=range _dadd .Font {if _fdde .EmbedRegular !=nil {return _bbd (d ,_fdde .NameAttr ,_fdde .EmbedRegular .IdAttr ,_fdde .EmbedRegular .FontKeyAttr );
};if _fdde .EmbedBold !=nil {return _bbd (d ,_fdde .NameAttr ,_fdde .EmbedBold .IdAttr ,_fdde .EmbedBold .FontKeyAttr );};if _fdde .EmbedItalic !=nil {return _bbd (d ,_fdde .NameAttr ,_fdde .EmbedItalic .IdAttr ,_fdde .EmbedItalic .FontKeyAttr );};if _fdde .EmbedBoldItalic !=nil {return _bbd (d ,_fdde .NameAttr ,_fdde .EmbedBoldItalic .IdAttr ,_fdde .EmbedBoldItalic .FontKeyAttr );
};};return nil ;};var _aedc =_dgcb (1);type fontsMap struct{_baa *_g .Mutex ;_geee map[string ]map[FontStyle ]*_fg .PdfFont ;};func MakeBlockFromChartSpace (cs *_eb .ChartSpace ,width ,height float64 ,theme *_fa .Theme )(*_ee .Block ,error ){_aeb ,_fgbf :=_aef (cs ,width ,height ,theme ,false ,nil );
if _fgbf !=nil {return nil ,_fgbf ;};_aag ,_fgbf :=GetPageFromCreator (_aeb );if _fgbf !=nil {return nil ,_fgbf ;};_afd ,_fgbf :=_ee .NewBlockFromPage (_aag );if _fgbf !=nil {return nil ,_fgbf ;};return _afd ,nil ;};func (_bbab *creatorContext )drawLineChart (_gdgd *_eb .CT_LineChart ,_bdcfa *Rectangle ,_dec []*_eb .CT_PlotAreaChoice1 ,_adga float64 )([]*legendItem ,error ){_adc :=[]*legendItem {};
_gcba :=_gdgd .Ser ;_cacd :=make (map[int ][]float64 );_cfbb :=make (map[int ][]float64 );_dgcc :=make (map[int ]_ee .Color );_fbdg :=make (map[int ]float64 );for _dfad ,_bggd :=range _gcba {var _gfga string ;if _eedd :=_bggd .Tx ;_eedd !=nil {if _caaf :=_eedd .SerTxChoice ;
_caaf !=nil {if _caaf .V !=nil {_gfga =*_caaf .V ;}else if _cfgb :=_caaf .StrRef ;_cfgb !=nil {if _aeab :=_cfgb .StrCache ;_aeab !=nil {for _ ,_dbb :=range _aeab .Pt {_gfga =_dbb .V ;};};};};};_dgcc [_dfad ]=_ee .ColorWhite ;if _dccc :=_bggd .SpPr ;_dccc !=nil {if _beb :=_dccc .Ln ;
_beb !=nil {if _ebgg :=_beb .WAttr ;_ebgg !=nil {_fbdg [_dfad ]=_df .FromEMU (int64 (*_ebgg ));if _eefc :=_beb .LineFillPropertiesChoice .SolidFill ;_eefc !=nil {_ceff :=_bbab .getPdfColorFromSolidFill (_eefc );if _ceff !=nil {_dgcc [_dfad ]=_ceff ;};};
};};};if _acgc :=_bggd .Val ;_acgc !=nil {if _bffd :=_acgc .NumDataSourceChoice ;_bffd !=nil {if _fgbfg :=_bffd .NumRef ;_fgbfg !=nil {if _aabg :=_fgbfg .NumCache ;_aabg !=nil {for _ ,_cbe :=range _aabg .Pt {_cacd [_dfad ]=append (_cacd [_dfad ],float64 (_cbe .IdxAttr ));
_bafd ,_ :=_bg .ParseFloat (_fe .TrimSpace (_cbe .V ),64);_cfbb [_dfad ]=append (_cfbb [_dfad ],_bafd );};};};};};_adc =append (_adc ,&legendItem {_agc :_gfga ,_cad :_bggd .SpPr });};_eccda :=true ;_acbc :=true ;_gedg :="";_cgea :="";if len (_dec )> 0{for _ ,_agdg :=range _dec {if _agdg .CatAx !=nil {if _agdg .CatAx .Delete !=nil {if !*(*_agdg .CatAx .Delete ).ValAttr {_eccda =false ;
};};_gedg =_bbab .getTitle (_agdg .CatAx .Title );}else if _agdg .ValAx !=nil {if _agdg .ValAx .Delete !=nil {if !*(*_agdg .ValAx .Delete ).ValAttr {_acbc =false ;};};_cgea =_bbab .getTitle (_agdg .ValAx .Title );};};};_bccb :=_eee .Style {Hidden :_eccda ,FontSize :8*_adga };
_ggca :=_eee .Style {Hidden :_acbc ,FontSize :8*_adga };_dafb :=&_de .Chart {Series :[]_bd .Series {},YAxisSecondary :_de .YAxis {Style :_ggca ,Name :_cgea ,NameStyle :_ggca },XAxis :_de .XAxis {Style :_bccb ,Name :_gedg ,NameStyle :_bccb },YAxis :_de .YAxis {Style :_eee .Style {Hidden :true }}};
for _bbgb :=0;_bbgb < len (_dgcc );_bbgb ++{_aafa ,_gegf ,_ffbb :=_dgcc [_bbgb ].ToRGB ();_dbca :=_bd .ContinuousSeries {XValues :_cacd [_bbgb ],YValues :_cfbb [_bbgb ],Style :_eee .Style {StrokeColor :_e .RGBA {uint8 (_aafa *255),uint8 (_gegf *255),uint8 (_ffbb *255),255},StrokeWidth :_fbdg [_bbgb ]}};
_dafb .Series =append (_dafb .Series ,_dbca );};_dafb .SetHeight (int (_be .Abs (_bdcfa .Top -_bdcfa .Bottom )));_dafb .SetWidth (int (_be .Abs (_bdcfa .Right -_bdcfa .Left )));_bgba :=_bbab ._gefg ;_bddg :=_ee .NewChart (_dafb );_bddg .SetPos (_bdcfa .Left ,_bdcfa .Top );
_ecaf :=_bgba .Draw (_bddg );if _ecaf !=nil {return nil ,_ecaf ;};return _adc ,nil ;};func _ffab (_afgd uint8 ,_ged float64 )string {_cbge :=float64 (_afgd );return _d .Sprintf ("\u0025\u0030\u0032\u0078",int (_cbge *_ged ));};const _bde =6.0;func GetPageFromCreator (c *_ee .Creator )(*_fg .PdfPage ,error ){_begg :=_b .NewBuffer ([]byte {});
_eafa :=c .Write (_begg );if _eafa !=nil {return nil ,_eafa ;};_eegf :=_b .NewReader (_begg .Bytes ());_dgg ,_eafa :=_fg .NewPdfReader (_eegf );if _eafa !=nil {return nil ,_eafa ;};return _dgg .GetPage (1);};type FontStyle byte ;func (_fdeg *creatorContext )getTitle (_ecc *_eb .CT_Title )string {_bbc :="";
if _ecc !=nil &&_ecc .Tx !=nil &&_ecc .Tx .TxChoice !=nil &&_ecc .Tx .TxChoice .Rich !=nil {if len (_ecc .Tx .TxChoice .Rich .P )> 0{for _ ,_cff :=range _ecc .Tx .TxChoice .Rich .P {if len (_cff .EG_TextRun )> 0{_bbc +="\u000a"+_cff .EG_TextRun [0].TextRunChoice .R .T ;
};};};};return _bbc ;};func _dgdg (_edeb *_eb .CT_ValAx )(uint32 ,_eb .ST_AxPos ,_eb .ST_TickMark ,_eb .ST_TickLblPos ,*_eb .CT_ChartLines ,uint32 ,*_fa .CT_ShapeProperties ,error ){var _eae ,_fcfb uint32 ;var _edgde _eb .ST_AxPos ;var _feda _eb .ST_TickMark ;
var _cedd *_eb .CT_ChartLines ;var _feg _eb .ST_TickLblPos ;if _edeb .AxId ==nil {return _eae ,_edgde ,_feda ,_feg ,_cedd ,_fcfb ,_edeb .SpPr ,_ed .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_eae =_edeb .AxId .ValAttr ;
};if _edeb .AxPos ==nil {return _eae ,_edgde ,_feda ,_feg ,_cedd ,_fcfb ,_edeb .SpPr ,_ed .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_edgde =_edeb .AxPos .ValAttr ;};if _edeb .MajorTickMark !=nil {_feda =_edeb .MajorTickMark .ValAttr ;
};if _edeb .TickLblPos !=nil {_feg =_edeb .TickLblPos .ValAttr ;};if _edeb .CrossAx ==nil {return _eae ,_edgde ,_feda ,_feg ,_cedd ,_fcfb ,_edeb .SpPr ,_ed .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_fcfb =_edeb .CrossAx .ValAttr ;};_cedd =_edeb .MajorGridlines ;return _eae ,_edgde ,_feda ,_feg ,_cedd ,_fcfb ,_edeb .SpPr ,nil ;};func FillRectangle (c *_ee .Creator ,x ,y ,width ,height float64 ,color _ee .Color ){if color ==nil {return ;};_acfgf :=c .NewRectangle (x ,y ,width ,height );
_acfgf .SetFillColor (color );_acfgf .SetBorderWidth (0);c .Draw (_acfgf );};func AdjustColorByTint (colorStr string ,tint float64 )string {var _age ,_gbdg ,_cgba uint8 ;_adde ,_ :=_d .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_age ,&_gbdg ,&_cgba );
if _adde !=3{return "";};return _gef (_age ,tint )+_gef (_gbdg ,tint )+_gef (_cgba ,tint );};var _fbe =_dgcb (5);func RegisterFontsFromDirectory (dirName string )error {_ddag ,_gge :=_a .Open (dirName );if _gge !=nil {return _gge ;};defer _ddag .Close ();
_caebc ,_gge :=_ddag .Readdirnames (0);if _gge !=nil {return _gge ;};for _ ,_aff :=range _caebc {if _fe .HasSuffix (_aff ,"\u002e\u0074\u0074\u0066"){_fdf :=dirName +"\u002f"+_aff ;_efa :=_aae (_fdf );if _efa !=nil {_def .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_efa );
continue ;};};};return nil ;};func AdjustColorByLumOff (colorStr string ,lumOff float64 )string {var _fec ,_bcc ,_cgde uint8 ;_ddac ,_ :=_d .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_fec ,&_bcc ,&_cgde );
if _ddac !=3{return "";};_gacb ,_egfd ,_dde :=_dbgc (_fec ,_bcc ,_cgde );_dde =_dde +lumOff ;_fec ,_bcc ,_cgde =_caeb (_gacb ,_egfd ,_dde );return _d .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_fec ,_bcc ,_cgde );};
type serCategory struct{_bbe string ;_cca []serValue ;};type creatorContext struct{_gefg *_ee .Creator ;_bfe *_fa .Theme ;_fbcfg float64 ;};func RegisterFontsFromFiles (files []string )error {for _ ,_fbc :=range files {if _fe .HasSuffix (_fbc ,"\u002e\u0074\u0074\u0066"){_ffca :=_aae (_fbc );
if _ffca !=nil {_def .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_ffca );
continue ;};};};return nil ;};type barSerByOrder []*_eb .CT_BarSer ;func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _ccg ,_ebgc ,_fgea uint8 ;_agag ,_ :=_d .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_ccg ,&_ebgc ,&_fgea );
if _agag !=3{return "";};_adg ,_afc ,_faeb :=_dbgc (_ccg ,_ebgc ,_fgea );_faeb =lum *_faeb ;_ccg ,_ebgc ,_fgea =_caeb (_adg ,_afc ,_faeb );return _d .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_ccg ,_ebgc ,_fgea );};
var _bcdc =_dgcb (7.5);func (_ffeb barSerByOrder )Less (i ,j int )bool {return _ffeb [i ].Order .ValAttr < _ffeb [j ].Order .ValAttr ;};func GetGroupOffsetFromXfrm (xfrm *_fa .CT_GroupTransform2D )(float64 ,float64 ){var _cecbd ,_aaec float64 ;if xfrm .Off !=nil &&xfrm .ChOff !=nil {_cecbd =_df .FromEMU (FromSTCoordinate (xfrm .Off .XAttr ))-_df .FromEMU (FromSTCoordinate (xfrm .ChOff .XAttr ));
_aaec =_df .FromEMU (FromSTCoordinate (xfrm .Off .YAttr ))-_df .FromEMU (FromSTCoordinate (xfrm .ChOff .YAttr ));};return _cecbd ,_aaec ;};func _bbd (_bag *_ff .Document ,_acg ,_bcda ,_gfea string )error {_gaedc ,_dbcd :=_bag .GetFontBytesByRelId (_bcda );
if _dbcd !=nil {return _dbcd ;};_fgeg ,_dbcd :=_abec (_gfea );if _dbcd !=nil {return _dbcd ;};for _fgegb :=0;_fgegb < 32;_fgegb ++{_dcfd :=_fgegb %len (_fgeg );_gaedc [_fgegb ]=_gaedc [_fgegb ]^_fgeg [_dcfd ];};_gccf :=_bag .TmpPath +"\u002f"+_acg +"\u002e\u0074\u0074\u0066";
_dbcd =_a .WriteFile (_gccf ,_gaedc ,0644);if _dbcd !=nil {return _dbcd ;};_aae (_gccf );return nil ;};var _fgbg =fontsMap {_baa :&_g .Mutex {},_geee :map[string ]map[FontStyle ]*_fg .PdfFont {}};func _aae (_geea string )error {if !_fe .HasSuffix (_geea ,"\u002e\u0074\u0074\u0066"){_def .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return _d .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_cfe ,_gaga :=_dc .ParseFile (_geea );if _gaga !=nil {_def .Log .Debug ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020T\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_gaga );return _gaga ;};_eede ,_gaga :=_fg .NewCompositePdfFontFromTTFFile (_geea );
if _gaga !=nil {return _gaga ;};_gbge :=_cfe .GetNameRecords ();for _ ,_cfdg :=range _gbge {_caeg :=_cfdg [1];if _caeg ==""{continue ;};_fgfc :=make ([]byte ,0);for _gdgb :=0;_gdgb < len (_caeg );_gdgb ++{if _caeg [_gdgb ]==39||_caeg [_gdgb ]==92{continue ;
};_dfd :=4;if _gdgb +_dfd < len (_caeg ){if _caeg [_gdgb :_gdgb +_dfd ]=="\u0000"{_gdgb =_gdgb +_dfd +1;continue ;};};_fgfc =append (_fgfc ,_caeg [_gdgb ]);};_caeg =_fe .Replace (string (_fgfc ),"\u0078\u0030\u0030","",-1);_gggga :=_cfdg [2];if _gggga ==""{return _d .Errorf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_geea );
};_fgfc =make ([]byte ,0);for _fbcd :=0;_fbcd < len (_gggga );_fbcd ++{if _gggga [_fbcd ]==39||_gggga [_fbcd ]==92{continue ;};_fggb :=4;if _fbcd +_fggb < len (_gggga ){if _gggga [_fbcd :_fbcd +_fggb ]=="\u0000"{_fbcd =_fbcd +_fggb +1;continue ;};};_fgfc =append (_fgfc ,_gggga [_fbcd ]);
};_gggga =_fe .Replace (string (_fgfc ),"\u0078\u0030\u0030","",-1);RegisterFont (_caeg ,_gfge [_gggga ],_eede );};return nil ;};var _gfge =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };
