//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_dg "bytes";_a "errors";_dgg "github.com/unidoc/unioffice/v2/common";_gg "github.com/unidoc/unioffice/v2/common/logger";_fa "github.com/unidoc/unioffice/v2/common/tempstorage";_f "github.com/unidoc/unioffice/v2/internal/convertutils";
_g "github.com/unidoc/unioffice/v2/measurement";_eg "github.com/unidoc/unioffice/v2/presentation";_cc "github.com/unidoc/unioffice/v2/schema/soo/dml";_af "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_ga "github.com/unidoc/unioffice/v2/schema/soo/pml";
_c "github.com/unidoc/unipdf/v4/contentstream/draw";_ef "github.com/unidoc/unipdf/v4/core";_ge "github.com/unidoc/unipdf/v4/creator";_ba "github.com/unidoc/unipdf/v4/model";_ad "github.com/unidoc/unipdf/v4/render";_e "image";_aa "image/color";_de "image/draw";
_b "math";_db "strconv";_ee "strings";);func (_dgc *convertContext )makePdfBlockFromChart (_gb *_af .Chart ,_ag ,_be float64 )(*_ge .Block ,error ){_cg :=_gb .CT_RelId .IdAttr ;_bg :=_dgc ._cead .GetChartSpaceByRelId (_cg );if _bg ==nil {return nil ,_a .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");
};var _bc *_cc .Theme ;_cd :=_dgc ._ccbd .Themes ();if len (_cd )> 0{_bc =_cd [0];};return _f .MakeBlockFromChartSpace (_bg ,_ag ,_be ,_bc );};func (_afcd *convertContext )stretchImage (_dgbc *_ge .Image ,_bdf *_cc .CT_StretchInfoProperties ,_dac ,_dae ,_geb ,_afb float64 )(*_ge .Image ,float64 ,float64 ){_gfgcf :=_bdf .FillRect ;
if _gfgcf ==nil {_gad :=_dgbc .Width ()/_dgbc .Height ();_daf :=_geb /_afb ;var _fda ,_ddg float64 ;if _gad > _daf {_ddg =_afb ;_fda =_afb *_gad ;}else {_fda =_geb ;_ddg =_geb /_gad ;};_dgbc .Scale (_fda /_dgbc .Width (),_ddg /_dgbc .Height ());return _dgbc ,_dac ,_dae ;
};var _ddb ,_aecc ,_cgae ,_ffd float64 ;if _aef :=_gfgcf .LAttr ;_aef !=nil {_cgae =_f .FromSTPercentage (_aef );};if _aga :=_gfgcf .TAttr ;_aga !=nil {_ddb =_f .FromSTPercentage (_aga );};if _bga :=_gfgcf .RAttr ;_bga !=nil {_ffd =_f .FromSTPercentage (_bga );
};if _cfa :=_gfgcf .BAttr ;_cfa !=nil {_aecc =_f .FromSTPercentage (_cfa );};_geec :=_geb *(1-_cgae -_ffd );_ggd :=_afb *(1-_ddb -_aecc );_dgbc .Scale (_geec /_dgbc .Width (),_ggd /_dgbc .Height ());return _dgbc ,_dac +_cgae *_geb ,_dae +_ddb *_afb ;};
type romanMatch struct{_aaf int ;_gdeb string ;};func _dda (_becd ,_acc *_cc .CT_TextParagraphProperties )*_cc .CT_TextParagraphProperties {_adfdf :=_cc .NewCT_TextParagraphProperties ();if _becd !=nil {*_adfdf =*_becd ;};if _acc ==nil {return _adfdf ;
};if _adfdf .MarLAttr ==nil {_adfdf .MarLAttr =_acc .MarLAttr ;};if _adfdf .MarRAttr ==nil {_adfdf .MarRAttr =_acc .MarRAttr ;};if _adfdf .LvlAttr ==nil {_adfdf .LvlAttr =_acc .LvlAttr ;};if _adfdf .IndentAttr ==nil {_adfdf .IndentAttr =_acc .IndentAttr ;
};if _adfdf .AlgnAttr ==_cc .ST_TextAlignTypeUnset {_adfdf .AlgnAttr =_acc .AlgnAttr ;};if _adfdf .DefTabSzAttr ==nil {_adfdf .DefTabSzAttr =_acc .DefTabSzAttr ;};if _adfdf .RtlAttr ==nil {_adfdf .RtlAttr =_acc .RtlAttr ;};if _adfdf .EaLnBrkAttr ==nil {_adfdf .EaLnBrkAttr =_acc .EaLnBrkAttr ;
};if _adfdf .FontAlgnAttr ==_cc .ST_TextFontAlignTypeUnset {_adfdf .FontAlgnAttr =_acc .FontAlgnAttr ;};if _adfdf .LatinLnBrkAttr ==nil {_adfdf .LatinLnBrkAttr =_acc .LatinLnBrkAttr ;};if _adfdf .HangingPunctAttr ==nil {_adfdf .HangingPunctAttr =_acc .HangingPunctAttr ;
};if _adfdf .LnSpc ==nil {_adfdf .LnSpc =_acc .LnSpc ;};if _adfdf .SpcBef ==nil {_adfdf .SpcBef =_acc .SpcBef ;};if _adfdf .SpcAft ==nil {_adfdf .SpcAft =_acc .SpcAft ;};if _adfdf .TextBulletColorChoice .BuClrTx ==nil {_adfdf .TextBulletColorChoice .BuClrTx =_acc .TextBulletColorChoice .BuClrTx ;
};if _adfdf .TextBulletColorChoice .BuClr ==nil {_adfdf .TextBulletColorChoice .BuClr =_acc .TextBulletColorChoice .BuClr ;};if _adfdf .TextBulletSizeChoice .BuSzTx ==nil {_adfdf .TextBulletSizeChoice .BuSzTx =_acc .TextBulletSizeChoice .BuSzTx ;};if _adfdf .TextBulletSizeChoice .BuSzPct ==nil {_adfdf .TextBulletSizeChoice .BuSzPct =_acc .TextBulletSizeChoice .BuSzPct ;
};if _adfdf .TextBulletSizeChoice .BuSzPts ==nil {_adfdf .TextBulletSizeChoice .BuSzPts =_acc .TextBulletSizeChoice .BuSzPts ;};if _adfdf .TextBulletTypefaceChoice .BuFontTx ==nil {_adfdf .TextBulletTypefaceChoice .BuFontTx =_acc .TextBulletTypefaceChoice .BuFontTx ;
};if _adfdf .TextBulletTypefaceChoice .BuFont ==nil {_adfdf .TextBulletTypefaceChoice .BuFont =_acc .TextBulletTypefaceChoice .BuFont ;};if _adfdf .TextBulletChoice .BuNone ==nil {_adfdf .TextBulletChoice .BuNone =_acc .TextBulletChoice .BuNone ;};if _adfdf .TextBulletChoice .BuAutoNum ==nil {_adfdf .TextBulletChoice .BuAutoNum =_acc .TextBulletChoice .BuAutoNum ;
};if _adfdf .TextBulletChoice .BuChar ==nil {_adfdf .TextBulletChoice .BuChar =_acc .TextBulletChoice .BuChar ;};if _adfdf .TextBulletChoice .BuBlip ==nil {_adfdf .TextBulletChoice .BuBlip =_acc .TextBulletChoice .BuBlip ;};if _adfdf .TabLst ==nil {_adfdf .TabLst =_acc .TabLst ;
};if _adfdf .ExtLst ==nil {_adfdf .ExtLst =_acc .ExtLst ;};_adfdf .DefRPr =_ggfe (_adfdf .DefRPr ,_acc .DefRPr );return _adfdf ;};type paragraph struct{_gbgd float64 ;_afcf float64 ;_efb float64 ;_eea float64 ;_debcc float64 ;_dccfc float64 ;_cdcec float64 ;
_ccad float64 ;_adff _cc .ST_TextAlignType ;_caaa float64 ;_aab bool ;_ceae []*line ;};func _cafb (_fac string )[]*symbol {_fagd :=[]*symbol {};for _ ,_eagg :=range _fac {_fagd =append (_fagd ,&symbol {_ffdee :string (_eagg )});};return _fagd ;};func _cae (_edfd *_cc .CT_AdjPoint2D )(float64 ,float64 ){var _egedf ,_cdcf float64 ;
_aagd ,_dbdb :=_edfd .XAttr ,_edfd .YAttr ;if _cbdf :=_aagd .ST_Coordinate ;_cbdf !=nil {_egedf =_g .FromEMU (_f .FromSTCoordinate (*_cbdf ));};if _afgd :=_dbdb .ST_Coordinate ;_afgd !=nil {_cdcf =_g .FromEMU (_f .FromSTCoordinate (*_afgd ));};return _egedf ,_cdcf ;
};func _gcdb (_edea *_cc .CT_TableCellProperties ,_adce *_cc .CT_TableStyleCellStyle ,_ceg ,_afcfe ,_cdfd ,_aafa bool )*_cc .CT_TableCellProperties {_bgad :=_cc .NewCT_TableCellProperties ();if _edea !=nil {*_bgad =*_edea ;};if _adce ==nil {return _bgad ;
};if _bgfd :=_adce .ThemeableFillStyleChoice .FillRef ;_bgfd !=nil {_dadg :=_cc .NewCT_SolidColorFillProperties ();_dadg .ScrgbClr =_bgfd .ScrgbClr ;_dadg .SrgbClr =_bgfd .SrgbClr ;_dadg .HslClr =_bgfd .HslClr ;_dadg .SysClr =_bgfd .SysClr ;_dadg .SchemeClr =_bgfd .SchemeClr ;
_dadg .PrstClr =_bgfd .PrstClr ;_bgad .FillPropertiesChoice .SolidFill =_dadg ;};if _bgad .FillPropertiesChoice .NoFill ==nil &&_bgad .FillPropertiesChoice .SolidFill ==nil {if _agacg :=_adce .ThemeableFillStyleChoice .Fill ;_agacg !=nil {if _bgad .FillPropertiesChoice .NoFill ==nil {_bgad .FillPropertiesChoice .NoFill =_agacg .FillPropertiesChoice .NoFill ;
};if _bgad .FillPropertiesChoice .SolidFill ==nil {_bgad .FillPropertiesChoice .SolidFill =_agacg .FillPropertiesChoice .SolidFill ;};};};if _geac :=_adce .TcBdr ;_geac !=nil {if _bgad .LnL ==nil {var _edcb *_cc .CT_ThemeableLineStyle ;if _cdfd {_edcb =_geac .Left ;
}else {_edcb =_geac .InsideV ;};if _edcb !=nil {_bgad .LnL =_edcb .ThemeableLineStyleChoice .Ln ;};};if _bgad .LnR ==nil {var _bcgg *_cc .CT_ThemeableLineStyle ;if _aafa {_bcgg =_geac .Right ;}else {_bcgg =_geac .InsideV ;};if _bcgg !=nil {_bgad .LnR =_bcgg .ThemeableLineStyleChoice .Ln ;
};};if _bgad .LnT ==nil {var _ffcc *_cc .CT_ThemeableLineStyle ;if _ceg {_ffcc =_geac .Top ;}else {_ffcc =_geac .InsideH ;};if _ffcc !=nil {_bgad .LnT =_ffcc .ThemeableLineStyleChoice .Ln ;};};if _bgad .LnB ==nil {var _fecb *_cc .CT_ThemeableLineStyle ;
if _afcfe {_fecb =_geac .Bottom ;}else {_fecb =_geac .InsideH ;};if _fecb !=nil {_bgad .LnB =_fecb .ThemeableLineStyleChoice .Ln ;};};};return _bgad ;};type symbolStyle struct{_ecde *string ;_gdbe *float64 ;_ecaf *string ;_gdab *bool ;_fdbc *bool ;_bcb *bool ;
_bbaef *bool ;_cccfc *bool ;};func _ebca (_fbcdc *bool )bool {return _fbcdc !=nil &&*_fbcdc };func (_egg *textboxContext )assignPropsToCurrentParagraph (_dfgg *_cc .CT_TextParagraphProperties ){_affgc :=12.4;if _dfgg ==nil {_egg ._bbae ._caaa =_affgc ;
return ;};if _fgge :=_dfgg .DefRPr ;_fgge !=nil {_gdgc :=_fgge .SzAttr ;if _gdgc !=nil {_bbfc :=float64 (*_gdgc )/1200;if _affgc <=_bbfc {_affgc =_bbfc ;};};};if _bagf :=_dfgg .MarLAttr ;_bagf !=nil {_egg ._bbae ._debcc =_g .FromEMU (int64 (*_bagf ));};
_egg ._bbae ._dccfc =_egg ._fgbf ;if _eabd :=_dfgg .MarRAttr ;_eabd !=nil {_egg ._bbae ._dccfc -=_g .FromEMU (int64 (*_eabd ));};if _fdeg :=_dfgg .IndentAttr ;_fdeg !=nil {_egg ._bbae ._eea =_g .FromEMU (int64 (*_fdeg ));};if _adgf :=_dfgg .LatinLnBrkAttr ;
_adgf !=nil {_egg ._bbae ._aab =*_adgf ;};if _agbf :=_dfgg .LnSpc ;_agbf !=nil &&_agbf .TextSpacingChoice !=nil {if _abe :=_agbf .TextSpacingChoice .SpcPct ;_abe !=nil {if _gecd :=_abe .ValAttr .ST_TextSpacingPercent ;_gecd !=nil {_affgc =float64 (*_gecd )/5000;
};};};var _gdgd float64 ;if _cdde :=_dfgg .SpcBef ;_cdde !=nil &&_cdde .TextSpacingChoice !=nil {if _agad :=_cdde .TextSpacingChoice .SpcPts ;_agad !=nil {_gdgd =float64 (_agad .ValAttr )/100;};};_adffd :=_egg ._caacb ;if len (_adffd )> 0{_gdgd -=_adffd [len (_adffd )-1]._efb ;
if _gdgd < 0{_gdgd =0;};};_egg ._bbae ._afcf =_gdgd ;if _deec :=_dfgg .SpcAft ;_deec !=nil &&_deec .TextSpacingChoice !=nil {if _bbec :=_deec .TextSpacingChoice .SpcPts ;_bbec !=nil {_egg ._bbae ._efb =float64 (_bbec .ValAttr )/100;};};_egg ._bbae ._caaa =_affgc ;
_egg ._bbae ._adff =_dfgg .AlgnAttr ;};func (_cdf *convertContext )makeSlide (){_bdg :=_cdf ._cead .GetSlideLayout ().CSld ;_cdf .addShapes (_bdg ,true );_bdg =_cdf ._cead .X ().CSld ;_cdf .addShapes (_bdg ,false );};type convertContext struct{_fdde *_ge .Creator ;
_aae *_f .Rectangle ;_ccbd *_eg .Presentation ;_cead *_eg .Slide ;_ede *_ga .SldMaster ;_dag *_ga .SldLayout ;_bcd float64 ;_deae float64 ;_egea []_ge .Drawable ;_gfdc *background ;_cafdf *_cc .CT_TextParagraphProperties ;_cecb *_cc .CT_TextCharacterProperties ;
_ceaa *_cc .CT_TextParagraphProperties ;_eged *_cc .CT_TextCharacterProperties ;_fgfb *_cc .CT_TextParagraphProperties ;_cade *_cc .CT_TextCharacterProperties ;_fbf []*_cc .CT_TextParagraphProperties ;_gagg []*_cc .CT_TextParagraphProperties ;_degf []*_cc .CT_TextParagraphProperties ;
_gdf *_cc .Theme ;_ddfa *_cc .CT_ColorMappingOverride ;};func _ggfe (_cfbb ,_fged *_cc .CT_TextCharacterProperties )*_cc .CT_TextCharacterProperties {_gfe :=_cc .NewCT_TextCharacterProperties ();if _cfbb !=nil {*_gfe =*_cfbb ;};if _fged ==nil {return _gfe ;
};if _gfe .KumimojiAttr ==nil {_gfe .KumimojiAttr =_fged .KumimojiAttr ;};if _gfe .LangAttr ==nil {_gfe .LangAttr =_fged .LangAttr ;};if _gfe .AltLangAttr ==nil {_gfe .AltLangAttr =_fged .AltLangAttr ;};if _gfe .SzAttr ==nil {_gfe .SzAttr =_fged .SzAttr ;
};if _gfe .BAttr ==nil {_gfe .BAttr =_fged .BAttr ;};if _gfe .IAttr ==nil {_gfe .IAttr =_fged .IAttr ;};if _gfe .UAttr ==_cc .ST_TextUnderlineTypeUnset {_gfe .UAttr =_fged .UAttr ;};if _gfe .StrikeAttr ==_cc .ST_TextStrikeTypeUnset {_gfe .StrikeAttr =_fged .StrikeAttr ;
};if _gfe .KernAttr ==nil {_gfe .KernAttr =_fged .KernAttr ;};if _gfe .CapAttr ==_cc .ST_TextCapsTypeUnset {_gfe .CapAttr =_fged .CapAttr ;};if _gfe .SpcAttr ==nil {_gfe .SpcAttr =_fged .SpcAttr ;};if _gfe .NormalizeHAttr ==nil {_gfe .NormalizeHAttr =_fged .NormalizeHAttr ;
};if _gfe .BaselineAttr ==nil {_gfe .BaselineAttr =_fged .BaselineAttr ;};if _gfe .NoProofAttr ==nil {_gfe .NoProofAttr =_fged .NoProofAttr ;};if _gfe .DirtyAttr ==nil {_gfe .DirtyAttr =_fged .DirtyAttr ;};if _gfe .ErrAttr ==nil {_gfe .ErrAttr =_fged .ErrAttr ;
};if _gfe .SmtCleanAttr ==nil {_gfe .SmtCleanAttr =_fged .SmtCleanAttr ;};if _gfe .SmtIdAttr ==nil {_gfe .SmtIdAttr =_fged .SmtIdAttr ;};if _gfe .BmkAttr ==nil {_gfe .BmkAttr =_fged .BmkAttr ;};if _gfe .Ln ==nil {_gfe .Ln =_fged .Ln ;};if _gfe .FillPropertiesChoice .NoFill ==nil {_gfe .FillPropertiesChoice .NoFill =_fged .FillPropertiesChoice .NoFill ;
};if _gfe .FillPropertiesChoice .SolidFill ==nil {_gfe .FillPropertiesChoice .SolidFill =_fged .FillPropertiesChoice .SolidFill ;};if _gfe .FillPropertiesChoice .BlipFill ==nil {_gfe .FillPropertiesChoice .BlipFill =_fged .FillPropertiesChoice .BlipFill ;
};if _gfe .EffectPropertiesChoice .EffectLst ==nil {_gfe .EffectPropertiesChoice .EffectLst =_fged .EffectPropertiesChoice .EffectLst ;};if _gfe .EffectPropertiesChoice .EffectDag ==nil {_gfe .EffectPropertiesChoice .EffectDag =_fged .EffectPropertiesChoice .EffectDag ;
};if _gfe .Highlight ==nil {_gfe .Highlight =_fged .Highlight ;};if _gfe .TextUnderlineLineChoice .ULnTx ==nil {_gfe .TextUnderlineLineChoice .ULnTx =_fged .TextUnderlineLineChoice .ULnTx ;};if _gfe .TextUnderlineLineChoice .ULn ==nil {_gfe .TextUnderlineLineChoice .ULn =_fged .TextUnderlineLineChoice .ULn ;
};if _gfe .TextUnderlineFillChoice .UFillTx ==nil {_gfe .TextUnderlineFillChoice .UFillTx =_fged .TextUnderlineFillChoice .UFillTx ;};if _gfe .TextUnderlineFillChoice .UFill ==nil {_gfe .TextUnderlineFillChoice .UFill =_fged .TextUnderlineFillChoice .UFill ;
};if _gfe .Latin ==nil {_gfe .Latin =_fged .Latin ;};if _gfe .Ea ==nil {_gfe .Ea =_fged .Ea ;};if _gfe .Cs ==nil {_gfe .Cs =_fged .Cs ;};if _gfe .Sym ==nil {_gfe .Sym =_fged .Sym ;};if _gfe .Rtl ==nil {_gfe .Rtl =_fged .Rtl ;};return _gfe ;};func (_agee *convertContext )makePdfBlockFromTxBody (_dbgg *_cc .CT_TextBody ,_eecb *_cc .CT_TextBodyProperties ,_eae *_cc .CT_TextListStyle ,_fcb ,_ecb float64 ,_bdda _ge .Color ,_afg ,_cded bool )(*_ge .Block ,error ){var _eeg *_cc .CT_TextParagraphProperties ;
if _bdea :=_dbgg .LstStyle ;_bdea !=nil {var _affg *_cc .CT_TextParagraphProperties ;if _bdea .Lvl1pPr !=nil {_affg =_bdea .Lvl1pPr ;};_eeg =_dda (_affg ,_bdea .DefPPr );};var _agag *_cc .CT_TextParagraphProperties ;if _eeg !=nil {if _afg {_agag =_agee ._gagg [0];
}else if _cded {_agag =_agee ._degf [0];}else {_agag =_agee ._fbf [0];};if _eae !=nil {_agag =_dda (_dda (_eae .Lvl1pPr ,_eae .DefPPr ),_agag );};_agag =_dda (_eeg ,_agag );}else {if _afg {_agag =_agee ._ceaa ;}else if _cded {_agag =_agee ._fgfb ;}else {_agag =_agee ._cafdf ;
};};_bbde ,_ddgd :=_dbdf (2.5),_dbdf (2.5);_ebea ,_eed :=_dbdf (1.3),_dbdf (1.3);_fcaa :=true ;_ebcd :=_cc .ST_TextAnchoringTypeT ;if _eecb !=nil {if _cea :=_eecb .AnchorAttr ;_cea !=_cc .ST_TextAnchoringTypeUnset {_ebcd =_cea ;};};if _cddc :=_dbgg .BodyPr ;
_cddc !=nil {if _cced :=_cddc .LInsAttr ;_cced !=nil {_bbde =_g .FromEMU (_f .FromSTCoordinate32 (*_cced ));};if _eafa :=_cddc .TInsAttr ;_eafa !=nil {_ebea =_g .FromEMU (_f .FromSTCoordinate32 (*_eafa ));};if _gcd :=_cddc .RInsAttr ;_gcd !=nil {_ddgd =_g .FromEMU (_f .FromSTCoordinate32 (*_gcd ));
};if _ggf :=_cddc .BInsAttr ;_ggf !=nil {_eed =_g .FromEMU (_f .FromSTCoordinate32 (*_ggf ));};_fcaa =_cddc .WrapAttr !=_cc .ST_TextWrappingTypeNone ;if _babe :=_cddc .AnchorAttr ;_babe !=_cc .ST_TextAnchoringTypeUnset {_ebcd =_cddc .AnchorAttr ;};};_edab :=_f .MakeTempCreator (_fcb ,_ecb );
_edab .SetPageMargins (_bbde ,_ddgd ,_ebea ,_eed );_fbgd :=&textboxContext {_edg :_agee ,_fgcg :_fcaa ,_fgbf :_fcb -_bbde -_ddgd ,_feac :_ecb -_ebea -_eed ,_cadd :_edab ,_caacb :[]*paragraph {}};_gdc :=1;for _ ,_dfa :=range _dbgg .P {if _dfa !=nil {_agde :=_dfa .PPr ;
var _cdgb *prefixData ;if _agde !=nil &&_agde .TextBulletChoice .BuNone ==nil {var _agdb string ;var _dgbd bool ;if _gfa :=_agde .TextBulletChoice .BuAutoNum ;_gfa !=nil {var _gcc string ;if _cca :=_gfa .StartAtAttr ;_cca !=nil {_gdc =int (*_cca );};var _bbag string ;
switch _gfa .TypeAttr {case _cc .ST_TextAutonumberSchemeAlphaUcParenBoth ,_cc .ST_TextAutonumberSchemeAlphaUcParenR ,_cc .ST_TextAutonumberSchemeAlphaUcPeriod :_bbag =_ddga (_gdc ,true );case _cc .ST_TextAutonumberSchemeAlphaLcParenBoth ,_cc .ST_TextAutonumberSchemeAlphaLcParenR ,_cc .ST_TextAutonumberSchemeAlphaLcPeriod :_bbag =_ddga (_gdc ,false );
case _cc .ST_TextAutonumberSchemeRomanUcParenBoth ,_cc .ST_TextAutonumberSchemeRomanUcParenR ,_cc .ST_TextAutonumberSchemeRomanUcPeriod :_bbag =_dab (_gdc ,true );case _cc .ST_TextAutonumberSchemeRomanLcParenBoth ,_cc .ST_TextAutonumberSchemeRomanLcParenR ,_cc .ST_TextAutonumberSchemeRomanLcPeriod :_bbag =_dab (_gdc ,false );
default:_bbag =_db .Itoa (_gdc );};switch _gfa .TypeAttr {case _cc .ST_TextAutonumberSchemeAlphaLcPeriod ,_cc .ST_TextAutonumberSchemeAlphaUcPeriod ,_cc .ST_TextAutonumberSchemeArabicPeriod ,_cc .ST_TextAutonumberSchemeRomanLcPeriod ,_cc .ST_TextAutonumberSchemeRomanUcPeriod ,_cc .ST_TextAutonumberSchemeArabicDbPeriod ,_cc .ST_TextAutonumberSchemeEa1ChsPeriod ,_cc .ST_TextAutonumberSchemeEa1ChtPeriod ,_cc .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_cc .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_cc .ST_TextAutonumberSchemeThaiAlphaPeriod ,_cc .ST_TextAutonumberSchemeThaiNumPeriod ,_cc .ST_TextAutonumberSchemeHindiAlphaPeriod ,_cc .ST_TextAutonumberSchemeHindiNumPeriod ,_cc .ST_TextAutonumberSchemeHindiAlpha1Period :_gcc ="\u002e";
case _cc .ST_TextAutonumberSchemeAlphaLcParenR ,_cc .ST_TextAutonumberSchemeAlphaUcParenR ,_cc .ST_TextAutonumberSchemeArabicParenR ,_cc .ST_TextAutonumberSchemeRomanLcParenR ,_cc .ST_TextAutonumberSchemeRomanUcParenR ,_cc .ST_TextAutonumberSchemeThaiAlphaParenR ,_cc .ST_TextAutonumberSchemeThaiNumParenR ,_cc .ST_TextAutonumberSchemeHindiNumParenR :_gcc ="\u0029";
};_agdb =_bbag +_gcc ;_gdc ++;}else if _ceaf :=_agde .TextBulletChoice .BuChar ;_ceaf !=nil {_bfg :=_ceaf .CharAttr ;if _gfc ,_bddg :=_dabf [_bfg ];_bddg {_bfg =string (rune (_gfc ));}else {_bfg ="\u2022";};_agdb =_bfg ;_dgbd =true ;};if _agdb !=""{var _fag ,_dbadf float64 ;
if _agde .MarLAttr !=nil {_fag =_g .FromEMU (int64 (*_agde .MarLAttr ));};if _agde .IndentAttr !=nil {_dbadf =_g .FromEMU (int64 (*_agde .IndentAttr ));};_cdgb =&prefixData {_cdgd :_agdb ,_eaed :_dgbd ,_bbaf :_fag ,_add :_dbadf };};};_agde =_dda (_agde ,_agag );
_ebcdb :=_ggfe (_dfa .EndParaRPr ,_agde .DefRPr );_fbgd .newParagraph ();_fbgd .assignPropsToCurrentParagraph (_agde );_fbgd .newLine ();_fbgd .newWord ();for _acfc ,_gadd :=range _dfa .EG_TextRun {_fbgd .addTextRun (_gadd ,_ebcdb ,_bdda ,_cdgb );if _acfc > 0{_cdgb =nil ;
};};_fbgd .addCurrentWordToParagraph ();};_fbgd .addCurrentParagraph ();};_fbgd .alignVertically (_ebcd );_fbgd .drawParagraphs ();return _f .MakeBlockFromCreator (_edab );};func (_gebb *convertContext )getPhData (_agae *_ga .CT_Shape )(*_cc .CT_Transform2D ,*_cc .CT_TextBodyProperties ,*_cc .CT_TextListStyle ,bool ,bool ,bool ){_edfeb ,_bbeb :=_efeb (_agae );
_cbfb ,_aeba ,_dfd ,_gcfg ,_cbbgb :=_bgfe (_gebb ._ede .CSld ,_edfeb ,_bbeb );_cbgc ,_baf ,_cgf ,_daad ,_fbdc :=_bgfe (_gebb ._dag .CSld ,_edfeb ,_bbeb );if _cbgc ==nil {_cbgc =_cbfb ;};_aaea ,_cceg :=_geae (_baf ,_aeba );var _fbcb ,_edba ,_aggf bool ;
if _cgf ==nil {if _dfd !=nil {_fbcb =*_dfd ;};}else {_fbcb =*_cgf ;};if _fbdc ==nil {if _cbbgb !=nil {_aggf =*_cbbgb ;};}else {_aggf =*_fbdc ;};if _daad ==nil {if _gcfg !=nil {_edba =*_gcfg ;};}else {_edba =*_daad ;};return _cbgc ,_aaea ,_cceg ,_fbcb ,_edba ,_aggf ;
};var _dabf =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};func _efeb (_efde *_ga .CT_Shape )(_ga .ST_PlaceholderType ,*uint32 ){if _daga :=_efde .NvSpPr ;_daga !=nil {if _ecad :=_daga .NvPr ;_ecad !=nil {if _ceda :=_ecad .Ph ;_ceda !=nil {return _ceda .TypeAttr ,_ceda .IdxAttr ;
};};};return _ga .ST_PlaceholderTypeUnset ,nil ;};func (_eegfc *textboxContext )alignVertically (_fffg _cc .ST_TextAnchoringType ){_eegfc .alignParagraphsVertically (_fffg );_eegfc .alignSymbolsVertically ();};func (_eedb *convertContext )addCellToTable (_cfg *_ge .Table ,_ccf *_cc .CT_TableCell ,_ece *_cc .CT_TablePartStyle ,_fbgc ,_cfc ,_cfeg ,_aagb bool )float64 {var _gage *_ge .TableCell ;
_edf :=1;if _ccf .GridSpanAttr !=nil {_edf =int (*_ccf .GridSpanAttr );};_gage =_cfg .MultiColCell (_edf );_fade :=_ccf .TcPr ;var _ccbg *_cc .CT_TableStyleTextStyle ;if _ece !=nil {_fade =_gcdb (_fade ,_ece .TcStyle ,_fbgc ,_cfc ,_cfeg ,_aagb );_ccbg =_ece .TcTxStyle ;
};_ecc :=_eb ;_dccf :=_ge .CellVerticalAlignmentMiddle ;_cfgf :=_deag (0.05);_cda :=_deag (0.05);if _fade !=nil {if _dded :=_fade .LnL ;_dded !=nil {_bbge ,_ffgc ,_dggb :=_eedb .getBorderStyle (_dded );_gage .SetBorder (_ge .CellBorderSideLeft ,_bbge ,_dggb );
if _ffgc !=nil &&*_ffgc !=nil {_gage .SetSideBorderColor (_ge .CellBorderSideLeft ,*_ffgc );};};if _ffde :=_fade .LnT ;_ffde !=nil {_fgfa ,_adc ,_fggb :=_eedb .getBorderStyle (_ffde );_gage .SetBorder (_ge .CellBorderSideTop ,_fgfa ,_fggb );if _adc !=nil &&*_adc !=nil {_gage .SetSideBorderColor (_ge .CellBorderSideTop ,*_adc );
};};if _fffae :=_fade .LnR ;_fffae !=nil {_bfe ,_dce ,_cgbd :=_eedb .getBorderStyle (_fffae );_gage .SetBorder (_ge .CellBorderSideRight ,_bfe ,_cgbd );if _dce !=nil &&*_dce !=nil {_gage .SetSideBorderColor (_ge .CellBorderSideRight ,*_dce );};};if _gbge :=_fade .LnB ;
_gbge !=nil {_bfdd ,_fgag ,_eegc :=_eedb .getBorderStyle (_gbge );_gage .SetBorder (_ge .CellBorderSideBottom ,_bfdd ,_eegc );if _fgag !=nil &&*_fgag !=nil {_gage .SetSideBorderColor (_ge .CellBorderSideBottom ,*_fgag );};};if _ffe :=_fade .MarLAttr ;_ffe !=nil {_ecc =float64 (_f .FromSTCoordinate32 (*_ffe ));
};switch _fade .AnchorAttr {case _cc .ST_TextAnchoringTypeT :_dccf =_ge .CellVerticalAlignmentTop ;case _cc .ST_TextAnchoringTypeB :_dccf =_ge .CellVerticalAlignmentBottom ;};if _fade .FillPropertiesChoice .NoFill ==nil {if _eba :=_fade .FillPropertiesChoice .SolidFill ;
_eba !=nil {_eca ,_bedb :=_eedb .getColorFromSolidFill (_eba );_gage .SetOpacity (_bedb );_gage .SetBackgroundColor (_eca );};};if _fgd :=_fade .MarBAttr ;_fgd !=nil {_cfgf =float64 (_f .FromSTCoordinate32 (*_fgd ));};if _adfd :=_fade .MarTAttr ;_adfd !=nil {_cda =float64 (_f .FromSTCoordinate32 (*_adfd ));
};};_gage .SetVerticalAlignment (_dccf );_gage .SetIndent (_ecc );var _eddg float64 ;if _agb :=_ccf .TxBody ;_agb !=nil {_ecge :=_eedb .makePdfDivisionFromTxBody (_agb ,_ccbg );_eddg =_ecge .Height ()+_cda +_cfgf ;_gage .SetContent (_ecge );};return _eddg ;
};type textboxContext struct{_edg *convertContext ;_fgbf float64 ;_feac float64 ;_cadd *_ge .Creator ;_ddc float64 ;_caacb []*paragraph ;_bbae *paragraph ;_cgeb *line ;_cdce *word ;_fgcg bool ;};func (_bff *convertContext )getBorderStyle (_agga *_cc .CT_LineProperties )(_ge .CellBorderStyle ,*_ge .Color ,float64 ){if _agga ==nil ||_agga .LineFillPropertiesChoice .NoFill !=nil {return _ge .CellBorderStyleNone ,nil ,0;
};var _cedf _ge .Color ;if _cac :=_agga .LineFillPropertiesChoice .SolidFill ;_cac !=nil {_cedf ,_ =_bff .getColorFromSolidFill (_cac );};_fcf :=0.0;if _egfbc :=_agga .WAttr ;_egfbc !=nil {_fcf =_g .FromEMU (int64 (*_egfbc ));};return _ge .CellBorderStyleSingle ,&_cedf ,_fcf ;
};func (_gfgb *convertContext )makePdfImageFromBlipFill (_cbe *_cc .CT_BlipFillProperties ,_fdba bool )(*_ge .Image ,[]*_cc .CT_BlipChoice ,error ){if _aedc :=_cbe .Blip ;_aedc !=nil {if _eedbd :=_aedc .EmbedAttr ;_eedbd !=nil {var _ccaf _dgg .ImageRef ;
var _eabf bool ;if _fdba {_ccaf ,_eabf =_gfgb ._cead .GetLayoutImageByRelID (*_eedbd );}else {_ccaf ,_eabf =_gfgb ._cead .GetImageByRelID (*_eedbd );};if _eabf {_gfbb ,_afce :=_fa .Open (_ccaf .Path ());if _afce !=nil {_gg .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_afce );
return nil ,nil ,_afce ;};defer _gfbb .Close ();_dcee ,_ ,_afce :=_e .Decode (_gfbb );if _afce !=nil {_gg .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_afce );return nil ,nil ,_afce ;
};if _agfe :=_cbe .SrcRect ;_agfe !=nil {_bebb :=_dcee .Bounds ().Size ();_cee :=_bebb .X ;_fdfc :=_bebb .Y ;var _gcge ,_edfda ,_afbdg ,_bgc int ;var _eebc bool ;if _dcd :=_agfe .LAttr ;_dcd !=nil {_gcge =int (float64 (_cee )*_f .FromSTPercentage (_dcd ));
_eebc =true ;}else {_gcge =0;};if _bdbb :=_agfe .TAttr ;_bdbb !=nil {_afbdg =int (float64 (_fdfc )*_f .FromSTPercentage (_bdbb ));_eebc =true ;}else {_afbdg =0;};if _bddac :=_agfe .RAttr ;_bddac !=nil {_edfda =int (float64 (_cee )*(1-_f .FromSTPercentage (_bddac )));
_eebc =true ;}else {_edfda =_cee ;};if _dcaf :=_agfe .BAttr ;_dcaf !=nil {_bgc =int (float64 (_fdfc )*(1-_f .FromSTPercentage (_dcaf )));_eebc =true ;}else {_bgc =_fdfc ;};if _eebc {_dcee =_f .CropImageByRect (_dcee ,_e .Rect (_gcge ,_afbdg ,_edfda +1,_bgc +1));
};};_dabg ,_afce :=_gfgb ._fdde .NewImageFromGoImage (_dcee );_dabg .SetEncoder (_ef .NewFlateEncoder ());if _ee .ToLower (_ccaf .Format ())=="\u006a\u0070\u0067"||_ee .ToLower (_ccaf .Format ())=="\u006a\u0070\u0065\u0067"{_dabg .SetEncoder (_ef .NewDCTEncoder ());
};if _afce !=nil {_gg .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_afce );
return nil ,nil ,_afce ;};return _dabg ,_aedc .BlipChoice ,nil ;};};};return nil ,nil ,nil ;};type word struct{_eacb []*symbol ;_dbfd float64 ;_dgad float64 ;_cgec bool ;};func (_cgc *line )moveRight (_adb float64 ){for _ ,_ebaf :=range _cgc ._cfcb {_ebaf ._dbfd +=_adb ;
};};func _dbdf (_ccbc float64 )float64 {return _ccbc *_g .Millimeter };func (_baa *textboxContext )addTextRun (_feb *_cc .EG_TextRun ,_egda *_cc .CT_TextCharacterProperties ,_fgfaa _ge .Color ,_egb *prefixData ){if _bcgd :=_feb .TextRunChoice .Br ;_bcgd !=nil {_baa .addCurrentWordToParagraph ();
_baa .newLine ();_baa .newWord ();}else if _gbad :=_feb .TextRunChoice .R ;_gbad !=nil {var _aaed _ge .Color ;if _gbad .RPr !=nil &&_gbad .RPr .FillPropertiesChoice .SolidFill !=nil {_aaed ,_ =_baa ._edg .getColorFromSolidFill (_gbad .RPr .FillPropertiesChoice .SolidFill );
}else if _fgfaa !=nil {_aaed =_fgfaa ;}else if _egda .FillPropertiesChoice .SolidFill !=nil {_aaed ,_ =_baa ._edg .getColorFromSolidFill (_egda .FillPropertiesChoice .SolidFill );}else {_aaed =_ge .ColorBlack ;};_fcge :=_ggfe (_gbad .RPr ,_egda );_fagg ,_agfg ,_egde ,_deff :=_baa ._edg .makeStyleFromRPr (_fcge );
_fagg .Color =_aaed ;if _egb !=nil {_baa .addPrefix (_egb ,_fagg );};_gegc :=_cafb (_gbad .T );for _ ,_fffad :=range _gegc {_fffad ._gcdgb =_fagg ;_fffad ._afca =_agfg ;_fffad ._bbgc =_egde ;_fffad ._acad =_deff ;if _fcge .CapAttr ==_cc .ST_TextCapsTypeAll {_fffad ._ffdee =_ee .ToUpper (_fffad ._ffdee );
};_baa .addTextSymbol (_fffad );};};};func (_dege *textboxContext )addTextSymbol (_dagc *symbol ){_cafe :=_ge .New ();_gaga :=_cafe .NewStyledParagraph ();_gaga .SetMargins (0,0,0,0);_feee :=_gaga .Append (_dagc ._ffdee );_cdab :=0.0;if _dagc ._gcdgb !=nil {_feee .Style =*_dagc ._gcdgb ;
if _dagc ._gcdgb .CharSpacing !=0{_cdab =_dagc ._gcdgb .CharSpacing ;};};_dagc ._fbfa =_gaga .Height ();_dagc ._gfac =_gaga .Height ()*1.2;if _dagc ._eaacd ==0{_dagc ._eaacd =_gaga .Width ()+_cdab ;};if len (_dege ._cdce ._eacb )> 0{_bbfg :=_dege ._cdce ._eacb [len (_dege ._cdce ._eacb )-1]._ffdee ;
if _dege ._bbae ._aab ||_f .IsNoSpaceLanguage (_bbfg )||(_bbfg =="\u0020")!=(_dagc ._ffdee =="\u0020"){_dege .addCurrentWordToParagraph ();_dege .newWord ();};};_dege ._cdce ._eacb =append (_dege ._cdce ._eacb ,_dagc );_dagc ._def =_dege ._cdce ._dgad ;
_dege ._cdce ._dgad +=_dagc ._eaacd ;if _dagc ._ffdee !="\u0020"{_dege ._cdce ._cgec =false ;};if _dege ._cdce ._dgad >=_dege ._bbae ._dccfc -_dege ._bbae ._debcc {_dege .addCurrentWordToParagraph ();_dege .newLine ();_dege .newWord ();};};func (_adf *convertContext )drawSlide (){_adf ._fdde .NewPage ();
for _ ,_efg :=range _adf ._egea {if _efg !=nil {_adf ._fdde .MoveTo (0,0);_adf ._fdde .Draw (_efg );};};};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_f .FontStyle ;

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_eg .Presentation )*_ge .Creator {return ConvertToPdfWithOptions (pr ,nil )};func (_ecdd *textboxContext )addPrefix (_cfad *prefixData ,_bcga *_ge .TextStyle ){_afdc :=_cafb (_cfad ._cdgd );_ffdd :=*_bcga ;if _cfad ._eaed {_ffdd .Font =_f .AssignStdFontByName (_ffdd ,"\u0053\u0079\u006d\u0062\u006f\u006c");
};for _ ,_ade :=range _afdc {_ade ._gcdgb =&_ffdd ;_ecdd .addTextSymbol (_ade );};_cff :=-(_cfad ._add +_ecdd ._cdce ._dgad );if _cff < 0{_cff =0;};_cdb :=&symbol {_ffdee :"\u0020",_eaacd :_cff };_ecdd .addTextSymbol (_cdb );_ecdd ._cdce ._dbfd +=(_cfad ._add +_cfad ._bbaf );
};func (_ffc *textboxContext )newLine (){if _ffc ._bbae ==nil {_ffc .newParagraph ();};_beca :=_ffc ._bbae ._ccad +_ffc ._bbae ._afcf ;_fffd :=&line {};_fffd ._cfbe =_ffc ._bbae ._debcc ;if len (_ffc ._bbae ._ceae )==0{_fffd ._cfbe +=_ffc ._bbae ._eea ;
};_fffd ._bcc =_ffc ._bbae ._dccfc ;_fffd ._feg =_fffd ._cfbe ;_fffd ._adad =_beca ;_ffc ._bbae ._ceae =append (_ffc ._bbae ._ceae ,_fffd );_ffc ._cgeb =_fffd ;};func (_agff *convertContext )getInfoFromLn (_becee *_cc .CT_LineProperties )(_ge .Color ,float64 ,float64 ){if _becee ==nil ||_becee .LineFillPropertiesChoice .NoFill !=nil {return nil ,0,0;
};var _deeg float64 ;_caaf ,_dcg :=_agff .getColorFromSolidFill (_becee .LineFillPropertiesChoice .SolidFill );if _gdba :=_becee .WAttr ;_gdba !=nil {_deeg =_g .FromEMU (int64 (*_gdba ));}else {_deeg =1;};return _caaf ,_deeg ,_dcg ;};

// Options contains the options for convert process
type Options struct{

// DefaultPageSize is applied when there is no page size explicitly set in the document.
// A4 is the default option.
DefaultPageSize _f .PageSize ;};func (_gfcc *textboxContext )newWord (){_gfcc ._cdce =&word {_cgec :true ,_dbfd :_gfcc ._cgeb ._feg }};func (_aebe *textboxContext )newParagraph (){_acef :=&paragraph {};_acef ._cdcec =_aebe ._ddc ;_aebe ._bbae =_acef ;};
func (_fgfd *convertContext )getGroupConnectors (_ced *_ga .CT_Connector ,_dbff float64 ,_dfefc float64 )[]_ge .Drawable {_dadb ,_ ,_ ,_ ,_ ,_ ,_ :=_fgfd .getShapesFromSpPr (_ced .SpPr ,_ced .Style ,false ,_dbff ,_dfefc );return _dadb ;};func (_ec *convertContext )extractDefaultProperties (){_gfg :=_ec ._ccbd .X ();
_bb :=_gfg .DefaultTextStyle ;var _bed ,_deb ,_cdd ,_ca ,_fc ,_dd ,_ae ,_dge ,_bba ,_ac *_cc .CT_TextParagraphProperties ;if _bb !=nil {_bed =_bb .DefPPr ;_deb =_dda (_bb .Lvl1pPr ,_bed );_cdd =_dda (_bb .Lvl2pPr ,_bed );_ca =_dda (_bb .Lvl3pPr ,_bed );
_fc =_dda (_bb .Lvl4pPr ,_bed );_dd =_dda (_bb .Lvl5pPr ,_bed );_ae =_dda (_bb .Lvl6pPr ,_bed );_dge =_dda (_bb .Lvl7pPr ,_bed );_bba =_dda (_bb .Lvl8pPr ,_bed );_ac =_dda (_bb .Lvl9pPr ,_bed );_ec ._cafdf =_bed ;_ec ._cecb =_bed .DefRPr ;};_ec ._fbf =make ([]*_cc .CT_TextParagraphProperties ,9);
_ec ._fbf [0]=_deb ;_ec ._fbf [1]=_cdd ;_ec ._fbf [2]=_ca ;_ec ._fbf [3]=_fc ;_ec ._fbf [4]=_dd ;_ec ._fbf [5]=_ae ;_ec ._fbf [6]=_dge ;_ec ._fbf [7]=_bba ;_ec ._fbf [8]=_ac ;_gef :=_ec ._ccbd .SlideMasters ()[0].X ();_fg :=_gef .TxStyles ;_gfgc :=_fg .TitleStyle ;
_ec ._ceaa =_dda (_gfgc .DefPPr ,_bed );_ec ._eged =_ec ._ceaa .DefRPr ;_ec ._gagg =make ([]*_cc .CT_TextParagraphProperties ,9);_ec ._gagg [0]=_dda (_gfgc .Lvl1pPr ,_deb );_ec ._gagg [1]=_dda (_gfgc .Lvl2pPr ,_cdd );_ec ._gagg [2]=_dda (_gfgc .Lvl3pPr ,_ca );
_ec ._gagg [3]=_dda (_gfgc .Lvl4pPr ,_fc );_ec ._gagg [4]=_dda (_gfgc .Lvl5pPr ,_dd );_ec ._gagg [5]=_dda (_gfgc .Lvl6pPr ,_ae );_ec ._gagg [6]=_dda (_gfgc .Lvl7pPr ,_dge );_ec ._gagg [7]=_dda (_gfgc .Lvl8pPr ,_bba );_ec ._gagg [8]=_dda (_gfgc .Lvl9pPr ,_ac );
_bab :=_fg .BodyStyle ;_ec ._fgfb =_dda (_bab .DefPPr ,_bed );_ec ._cade =_ec ._fgfb .DefRPr ;_ec ._degf =make ([]*_cc .CT_TextParagraphProperties ,9);_ec ._degf [0]=_dda (_bab .Lvl1pPr ,_deb );_ec ._degf [1]=_dda (_bab .Lvl2pPr ,_cdd );_ec ._degf [2]=_dda (_bab .Lvl3pPr ,_ca );
_ec ._degf [3]=_dda (_bab .Lvl4pPr ,_fc );_ec ._degf [4]=_dda (_bab .Lvl5pPr ,_dd );_ec ._degf [5]=_dda (_bab .Lvl6pPr ,_ae );_ec ._degf [6]=_dda (_bab .Lvl7pPr ,_dge );_ec ._degf [7]=_dda (_bab .Lvl8pPr ,_bba );_ec ._degf [8]=_dda (_bab .Lvl9pPr ,_ac );
};

// ConvertToPdfWithOptions convert a presentation to PDF with given options.
func ConvertToPdfWithOptions (pr *_eg .Presentation ,opts *Options )*_ge .Creator {_da :=pr .X ().SldSz ;_dbg :=_g .FromEMU (int64 (_da .CxAttr ));_dbgd :=_g .FromEMU (int64 (_da .CyAttr ));_fb :=_ge .PageSize {_dbg ,_dbgd };if (_fb ==_ge .PageSize {}){_fb =_f .GetDefaultPageSize ();
if opts !=nil &&opts .DefaultPageSize !=_f .DefaultPageSize {_fb =_f .GetPageDimensions (opts .DefaultPageSize );};};_gf :=_ge .New ();_gf .SetPageSize (_fb );var _bd *_cc .Theme ;if len (pr .Themes ())> 0{_bd =pr .Themes ()[0];};for _ ,_cf :=range pr .Slides (){if _cf .X ()==nil {continue ;
};_fad :=&convertContext {_fdde :_gf ,_cead :&_cf ,_dag :_cf .GetSlideLayout (),_ede :pr .SlideMasters ()[0].X (),_ccbd :pr ,_gdf :_bd ,_ddfa :_cf .X ().ClrMapOvr ,_bcd :_fb [1],_deae :_fb [0]};_fad .extractDefaultProperties ();_fad .makeSlide ();_fad .drawSlide ();
};return _gf ;};func _gabe (_cdcb ,_bcge *_cc .CT_TextBodyProperties )*_cc .CT_TextBodyProperties {_bfa :=_cc .NewCT_TextBodyProperties ();if _cdcb !=nil {*_bfa =*_cdcb ;};if _bcge ==nil {return _bfa ;};if _bfa .RotAttr ==nil {_bfa .RotAttr =_bcge .RotAttr ;
};if _bfa .SpcFirstLastParaAttr ==nil {_bfa .SpcFirstLastParaAttr =_bcge .SpcFirstLastParaAttr ;};if _bfa .VertOverflowAttr ==_cc .ST_TextVertOverflowTypeUnset {_bfa .VertOverflowAttr =_bcge .VertOverflowAttr ;};if _bfa .HorzOverflowAttr ==_cc .ST_TextHorzOverflowTypeUnset {_bfa .HorzOverflowAttr =_bcge .HorzOverflowAttr ;
};if _bfa .VertAttr ==_cc .ST_TextVerticalTypeUnset {_bfa .VertAttr =_bcge .VertAttr ;};if _bfa .WrapAttr ==_cc .ST_TextWrappingTypeUnset {_bfa .WrapAttr =_bcge .WrapAttr ;};if _bfa .LInsAttr ==nil {_bfa .LInsAttr =_bcge .LInsAttr ;};if _bfa .TInsAttr ==nil {_bfa .TInsAttr =_bcge .TInsAttr ;
};if _bfa .RInsAttr ==nil {_bfa .RInsAttr =_bcge .RInsAttr ;};if _bfa .BInsAttr ==nil {_bfa .BInsAttr =_bcge .BInsAttr ;};if _bfa .NumColAttr ==nil {_bfa .NumColAttr =_bcge .NumColAttr ;};if _bfa .SpcColAttr ==nil {_bfa .SpcColAttr =_bcge .SpcColAttr ;
};if _bfa .RtlColAttr ==nil {_bfa .RtlColAttr =_bcge .RtlColAttr ;};if _bfa .AnchorAttr ==_cc .ST_TextAnchoringTypeUnset {_bfa .AnchorAttr =_bcge .AnchorAttr ;};if _bfa .AnchorCtrAttr ==nil {_bfa .AnchorCtrAttr =_bcge .AnchorCtrAttr ;};if _bfa .ForceAAAttr ==nil {_bfa .ForceAAAttr =_bcge .ForceAAAttr ;
};if _bfa .UprightAttr ==nil {_bfa .UprightAttr =_bcge .UprightAttr ;};if _bfa .CompatLnSpcAttr ==nil {_bfa .CompatLnSpcAttr =_bcge .CompatLnSpcAttr ;};if _bfa .PrstTxWarp ==nil {_bfa .PrstTxWarp =_bcge .PrstTxWarp ;};if _bfa .TextAutofitChoice .NoAutofit ==nil {_bfa .TextAutofitChoice .NoAutofit =_bcge .TextAutofitChoice .NoAutofit ;
};if _bfa .TextAutofitChoice .NormAutofit ==nil {_bfa .TextAutofitChoice .NormAutofit =_bcge .TextAutofitChoice .NormAutofit ;};if _bfa .TextAutofitChoice .SpAutoFit ==nil {_bfa .TextAutofitChoice .SpAutoFit =_bcge .TextAutofitChoice .SpAutoFit ;};if _bfa .Scene3d ==nil {_bfa .Scene3d =_bcge .Scene3d ;
};if _bfa .Text3DChoice .Sp3d ==nil {_bfa .Text3DChoice .Sp3d =_bcge .Text3DChoice .Sp3d ;};if _bfa .Text3DChoice .FlatTx ==nil {_bfa .Text3DChoice .FlatTx =_bcge .Text3DChoice .FlatTx ;};if _bfa .ExtLst ==nil {_bfa .ExtLst =_bcge .ExtLst ;};return _bfa ;
};func _deag (_beg float64 )float64 {return _beg *_g .Inch };var _eb =_dbdf (1.9);func (_gead *textboxContext )addCurrentParagraph (){_gead ._ddc =_gead ._bbae ._cdcec +_gead ._bbae ._afcf +_gead ._bbae ._ccad +_gead ._bbae ._efb ;_gead ._caacb =append (_gead ._caacb ,_gead ._bbae );
_gead .alignParagraph ();};func (_bcbc *convertContext )renderCurrentStateToGoImage ()(_e .Image ,error ){_gaac :=_f .MakeTempCreator (_bcbc ._deae ,_bcbc ._bcd );_gaac .NewPage ();for _ ,_ggda :=range _bcbc ._egea {if _ggda !=nil {_gaac .MoveTo (0,0);
_gaac .Draw (_ggda );};};_cgebf ,_ebcc :=_f .GetPageFromCreator (_gaac );if _ebcc !=nil {return nil ,_ebcc ;};return _ad .NewImageDevice ().Render (_cgebf );};type line struct{_adad float64 ;_cfbe float64 ;_bcc float64 ;_feg float64 ;_dbc float64 ;_cfcb []*word ;
};func _eace (_egaa *_cc .CT_TextCharacterProperties ,_gbae *_cc .CT_TableStyleTextStyle )*_cc .CT_TextCharacterProperties {_fcd :=_cc .NewCT_TextCharacterProperties ();if _egaa !=nil {*_fcd =*_egaa ;};if _gbae ==nil {return _fcd ;};if _fcd .BAttr ==nil &&_gbae .BAttr !=_cc .ST_OnOffStyleTypeUnset {_gaa :=_gbae .BAttr ==_cc .ST_OnOffStyleTypeOn ;
_fcd .BAttr =&_gaa ;};if _fcd .IAttr ==nil &&_gbae .IAttr !=_cc .ST_OnOffStyleTypeUnset {_ccadc :=_gbae .IAttr ==_cc .ST_OnOffStyleTypeOn ;_fcd .IAttr =&_ccadc ;};if _fcd .FillPropertiesChoice .NoFill ==nil &&_fcd .FillPropertiesChoice .SolidFill ==nil {_fcd .FillPropertiesChoice .SolidFill =_cc .NewCT_SolidColorFillProperties ();
_fcd .FillPropertiesChoice .SolidFill .ScrgbClr =_gbae .ScrgbClr ;_fcd .FillPropertiesChoice .SolidFill .SrgbClr =_gbae .SrgbClr ;_fcd .FillPropertiesChoice .SolidFill .HslClr =_gbae .HslClr ;_fcd .FillPropertiesChoice .SolidFill .SysClr =_gbae .SysClr ;
_fcd .FillPropertiesChoice .SolidFill .SchemeClr =_gbae .SchemeClr ;_fcd .FillPropertiesChoice .SolidFill .PrstClr =_gbae .PrstClr ;};if _dabeb :=_gbae .ThemeableFontStylesChoice .Font ;_dabeb !=nil &&_fcd .Latin ==nil &&_fcd .Ea ==nil &&_fcd .Cs ==nil {_fcd .Latin =_dabeb .Latin ;
_fcd .Ea =_dabeb .Ea ;_fcd .Cs =_dabeb .Cs ;};return _fcd ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_ba .PdfFont ){_f .RegisterFont (name ,style ,font );};func _abb (_efae ,_gcfe *_cc .CT_TextListStyle )*_cc .CT_TextListStyle {_edb :=_cc .NewCT_TextListStyle ();if _efae !=nil {*_edb =*_efae ;};if _gcfe ==nil {return _edb ;
};_edb .DefPPr =_dda (_edb .DefPPr ,_gcfe .DefPPr );_edb .Lvl1pPr =_dda (_edb .Lvl1pPr ,_gcfe .Lvl1pPr );_edb .Lvl2pPr =_dda (_edb .Lvl2pPr ,_gcfe .Lvl2pPr );_edb .Lvl3pPr =_dda (_edb .Lvl3pPr ,_gcfe .Lvl3pPr );_edb .Lvl4pPr =_dda (_edb .Lvl4pPr ,_gcfe .Lvl4pPr );
_edb .Lvl5pPr =_dda (_edb .Lvl5pPr ,_gcfe .Lvl5pPr );_edb .Lvl6pPr =_dda (_edb .Lvl6pPr ,_gcfe .Lvl6pPr );_edb .Lvl7pPr =_dda (_edb .Lvl7pPr ,_gcfe .Lvl7pPr );_edb .Lvl8pPr =_dda (_edb .Lvl8pPr ,_gcfe .Lvl8pPr );_edb .Lvl9pPr =_dda (_edb .Lvl9pPr ,_gcfe .Lvl9pPr );
return _edb ;};func (_ddgf *convertContext )getColorFromFontReference (_eaaf *_cc .CT_FontReference )_ge .Color {var _cdbe _ge .Color ;var _cfba string ;if _ebbd :=_eaaf .SrgbClr ;_ebbd !=nil {_cfba =_ebbd .ValAttr ;}else if _bcgb :=_eaaf .SchemeClr ;_bcgb !=nil {_cfba =_f .GetColorStringFromDmlColor (_ddgf ._ccbd .GetColorBySchemeColor (_bcgb .ValAttr ));
_cfba =_f .AdjustColor (_cfba ,_bcgb .EG_ColorTransform );};if _cfba !=""{_cdbe =_ge .ColorRGBFromHex ("\u0023"+_cfba );};return _cdbe ;};func (_bae *textboxContext )adjustHeights (_fbae float64 ){if _bae ._cgeb ._dbc < _fbae {_bae ._bbae ._ccad +=(_fbae -_bae ._cgeb ._dbc );
_bae ._cgeb ._dbc =_fbae ;};};func _geae (_edgd ,_bdgcf *_cc .CT_TextBody )(*_cc .CT_TextBodyProperties ,*_cc .CT_TextListStyle ){if _edgd ==nil &&_bdgcf ==nil {return nil ,nil ;};if _edgd ==nil {return _bdgcf .BodyPr ,_bdgcf .LstStyle ;};if _bdgcf ==nil {return _edgd .BodyPr ,_edgd .LstStyle ;
};_efdb ,_deaf :=_edgd .BodyPr ,_edgd .LstStyle ;_edfe ,_egefe :=_bdgcf .BodyPr ,_bdgcf .LstStyle ;_agda :=_gabe (_efdb ,_edfe );_gbe :=_abb (_deaf ,_egefe );return _agda ,_gbe ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;
FontStyle_BoldItalic FontStyle =3;);func (_eeb *convertContext )addShapes (_ff *_ga .CT_CommonSlideData ,_gae bool ){if _ff ==nil {return ;};_cfd :=&background {};if _ea :=_ff .Bg ;_ea !=nil {if _gc :=_ea .BackgroundChoice .BgPr ;_gc !=nil {if _gc .FillPropertiesChoice .NoFill ==nil {if _dgea :=_gc .FillPropertiesChoice .SolidFill ;
_dgea !=nil {_cb ,_age :=_eeb .getColorFromSolidFill (_dgea );if _cb !=nil {_cfd ._bfc =_cb ;_cfd ._bef =_age ;};}else if _gd :=_gc .FillPropertiesChoice .BlipFill ;_gd !=nil {_cfd ._fbcd =_gd ;};};};};_eeb ._gfdc =_cfd ;if _babf :=_ff .SpTree ;_babf !=nil {for _ ,_fe :=range _babf .GroupShapeChoice {if _fe !=nil {if _fe .Sp !=nil {_cad :=_eeb .getShapes (_fe .Sp ,_gae ,false );
_eeb ._egea =append (_eeb ._egea ,_cad ...);};if _fe .GraphicFrame !=nil {var _fab ,_aag ,_gcg ,_afd float64 ;if _gdg :=_fe .GraphicFrame .Xfrm ;_gdg !=nil {_fab ,_aag ,_gcg ,_afd =_f .GetDataFromXfrm (_gdg );};if _gcg ==0&&_afd ==0{_gcg =_eeb ._deae ;
_afd =_eeb ._bcd ;};if _bbg :=_fe .GraphicFrame .Graphic ;_bbg !=nil {if _bfb :=_bbg .GraphicData ;_bfb !=nil {for _ ,_ce :=range _bfb .Any {if _gdb ,_dgd :=_ce .(*_af .Chart );_dgd {_gee ,_fbb :=_eeb .makePdfBlockFromChart (_gdb ,_gcg ,_afd );if _fbb !=nil {_gg .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_fbb );
};if _gee !=nil {_gee .SetPos (_fab ,_aag );_eeb ._egea =append (_eeb ._egea ,_gee );};}else if _bcf ,_dea :=_ce .(*_cc .Tbl );_dea {_ccc :=_eeb .makePdfBlockFromTable (_bcf );if _ccc !=nil {_fbg :=_ge .NewBlock (_gcg ,_afd );_fbg .SetPos (_fab ,_aag );
_gac :=_fbg .Draw (_ccc );if _gac !=nil {_gg .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0064r\u0061\u0077\u0020\u0074\u0061b\u006c\u0065\u003a\u0020\u0025\u0073",_gac );if _gac ==_ge .ErrContentNotFit {_fbg =_ge .NewBlock (_eeb ._deae -1.5*_fab ,_eeb ._bcd -1.5*_aag );
_fbg .SetPos (_fab ,_aag );_gac =_fbg .Draw (_ccc );};};if _gac ==nil {_eeb ._egea =append (_eeb ._egea ,_fbg );};};};};};};};if _fe .CxnSp !=nil {_ebc :=_eeb .getConnectors (_fe .CxnSp );_eeb ._egea =append (_eeb ._egea ,_ebc ...);};if _fe .GrpSp !=nil {_aec :=0.0;
_fde :=0.0;if _df :=_fe .GrpSp .GrpSpPr .Xfrm ;_df !=nil {_aec ,_fde =_f .GetGroupOffsetFromXfrm (_df );};for _ ,_cbd :=range _fe .GrpSp .GroupShapeChoice {if _cbd .CxnSp !=nil {_eac :=_eeb .getGroupConnectors (_cbd .CxnSp ,_aec ,_fde );_eeb ._egea =append (_eeb ._egea ,_eac ...);
};};};if _fe .Pic !=nil {_aad :=false ;var _dfe ,_dgdc ,_eec ,_dgb float64 ;if _ebd :=_fe .Pic .SpPr ;_ebd !=nil {if _gbd :=_ebd .Xfrm ;_gbd !=nil {_dfe ,_dgdc ,_eec ,_dgb =_f .GetDataFromXfrm (_gbd );_aad =true ;};};var _dfef _ga .ST_PlaceholderType ;
var _fff *uint32 ;if _eaa :=_fe .Pic .NvPicPr ;_eaa !=nil {if _fgg :=_eaa .NvPr ;_fgg !=nil {if _fadc :=_fgg .Ph ;_fadc !=nil {_dfef =_fadc .TypeAttr ;_fff =_fadc .IdxAttr ;};};};_cde ,_ ,_ ,_ ,_ :=_bgfe (_eeb ._ede .CSld ,_dfef ,_fff );_ed ,_ ,_ ,_ ,_ :=_bgfe (_eeb ._dag .CSld ,_dfef ,_fff );
if _ed ==nil {_ed =_cde ;};if _ed !=nil &&!_aad {_dfe ,_dgdc ,_eec ,_dgb =_f .GetDataFromXfrm (_ed );};if _fec :=_fe .Pic .BlipFill ;_fec !=nil {_fffa :=_eeb .getShapeFromBlipFill (_fec ,_dfe ,_dgdc ,_eec ,_dgb ,_gae );_eeb ._egea =append (_eeb ._egea ,_fffa );
};};};};};};func (_gbb *convertContext )getShapes (_fabg *_ga .CT_Shape ,_agg bool ,_bbf bool )[]_ge .Drawable {_cag :=[]_ge .Drawable {};_dcf :=_fabg .SpPr ;if _dcf ==nil {return _cag ;};var _gcga bool ;if _aefd :=_fabg .UseBgFillAttr ;_aefd !=nil {_gcga =*_aefd ;
};_cbg ,_cgbg ,_cdfg ,_fdec ,_ebb ,_cbb ,_acb :=_gbb .getShapesFromSpPr (_dcf ,_fabg .Style ,_gcga ,0.0,0.0);if !_bbf {_cag =append (_cag ,_cbg ...);};if _aea :=_fabg .TxBody ;_aea !=nil &&!_agg {_gab ,_fgb ,_eebb ,_ecf ,_aed ,_eaf :=_gbb .getPhData (_fabg );
if _bbf &&!(_ecf ||_aed ){return _cag ;};if _gab !=nil &&!_acb {_cgbg ,_cdfg ,_fdec ,_ebb =_f .GetDataFromXfrm (_gab );};_dad ,_eda :=_gbb .makePdfBlockFromTxBody (_aea ,_fgb ,_eebb ,_fdec ,_ebb ,_cbb ,_ecf ,_eaf );if _eda !=nil {_gg .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_eda );
}else if _dad !=nil {_dad .SetPos (_cgbg ,_cdfg );_cag =append (_cag ,_dad );};};return _cag ;};func (_bce *convertContext )makePdfDivisionFromTxBody (_gfbg *_cc .CT_TextBody ,_ebg *_cc .CT_TableStyleTextStyle )*_ge .Division {_ecdf :=_bce ._fdde .NewDivision ();
_bge :=_bce ._cafdf ;_cccf :=_cc .ST_TextAnchoringTypeT ;if _bbd :=_gfbg .BodyPr ;_bbd !=nil {if _ddf :=_bbd .AnchorAttr ;_ddf !=_cc .ST_TextAnchoringTypeUnset {_cccf =_bbd .AnchorAttr ;};};if _gbc :=_gfbg .LstStyle ;_gbc !=nil {var _bbc *_cc .CT_TextParagraphProperties ;
if _gbc .Lvl1pPr !=nil {_bbc =_gbc .Lvl1pPr ;}else {_bbc =_bce ._fbf [0];};_bge =_dda (_bbc ,_dda (_gbc .DefPPr ,_bge ));};for _ ,_acgd :=range _gfbg .P {if _acgd !=nil {_efaf :=_bce ._fdde .NewStyledParagraph ();_cce :=_dda (_acgd .PPr ,_bge );_caff :=_ggfe (_acgd .EndParaRPr ,_cce .DefRPr );
switch _cce .AlgnAttr {case _cc .ST_TextAlignTypeR :_efaf .SetTextAlignment (_ge .TextAlignmentRight );case _cc .ST_TextAlignTypeCtr :_efaf .SetTextAlignment (_ge .TextAlignmentCenter );case _cc .ST_TextAlignTypeJust :_efaf .SetTextAlignment (_ge .TextAlignmentJustify );
};if len (_acgd .EG_TextRun )==0{_efaf .Append ("\u000a");_ecdf .Add (_efaf );continue ;};for _ ,_gadg :=range _acgd .EG_TextRun {if _fba :=_gadg .TextRunChoice .Br ;_fba !=nil {_efaf .Append ("\u000a");}else if _gddf :=_gadg .TextRunChoice .R ;_gddf !=nil {_acde :=_eace (_gddf .RPr ,_ebg );
_acde =_ggfe (_acde ,_caff );var _bbb _ge .Color ;if _acde .FillPropertiesChoice .SolidFill !=nil {_bbb ,_ =_bce .getColorFromSolidFill (_acde .FillPropertiesChoice .SolidFill );}else {_bbb =_ge .ColorBlack ;};_dbe ,_agf ,_bec ,_ :=_bce .makeStyleFromRPr (_acde );
_dbe .Color =_bbb ;if _agf {_dbe .TextRise =0.5;}else if _bec {_dbe .TextRise =-0.5;};_dfed :=_gddf .T ;if _acde .CapAttr ==_cc .ST_TextCapsTypeAll {for _ ,_dcb :=range _dfed {_dcb =[]rune (_ee .ToUpper (string (_dcb )))[0];};};_acf :=_efaf .Append (_dfed );
_acf .Style =*_dbe ;};};_ =_cccf ;_ecdf .Add (_efaf );};};return _ecdf ;};type prefixData struct{_cdgd string ;_eaed bool ;_bbaf float64 ;_add float64 ;};type background struct{_bfc _ge .Color ;_bef float64 ;_fbcd *_cc .CT_BlipFillProperties ;};func (_bccb *convertContext )applyBlipEffectsOnImg (_fcfb *_ge .Image ,_bceb ,_ffa float64 ,_agagf []*_cc .CT_BlipChoice )*_ge .Image {if len (_agagf )==0{return _fcfb ;
};_fcfb .SetPos (_bceb ,_ffa );_dfdg ,_afcfd :=_bccb .renderPageWithDrawableToGoImage (_fcfb );if _afcfd !=nil {_gg .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_afcfd );
return _fcfb ;};_dcda ,_afcfd :=_bccb .renderCurrentStateToGoImage ();if _afcfd !=nil {_gg .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_afcfd );
return _fcfb ;};_cdaf :=_dfdg .Bounds ();_ffaf :=_e .NewRGBA (_cdaf );_abff ,_bebe :=_fcfb .Width (),_fcfb .Height ();for _ ,_cegb :=range _agagf {if _gbf :=_cegb .AlphaModFix ;_gbf ==nil {continue ;};if _gedeg :=_cegb .AlphaModFix .AmtAttr ;_gedeg !=nil {if _efbf :=_gedeg .ST_PositivePercentageDecimal ;
_efbf !=nil {_aecf :=uint8 (255*(*_efbf )/100000);_afbdga :=_e .NewUniform (_aa .Alpha {_aecf });_de .Draw (_ffaf ,_cdaf ,_dcda ,_e .Point {0,0},_de .Src );_de .DrawMask (_ffaf ,_cdaf ,_dfdg ,_e .Point {0,0},_afbdga ,_e .Point {0,0},_de .Over );};};};_cdcd :=_e .Rect (int (_bceb ),int (_ffa ),int (_bceb +_abff )+1,int (_ffa +_bebe )+1);
_ecda :=_f .CropImageByRect (_ffaf ,_cdcd );_bded ,_afcfd :=_bccb ._fdde .NewImageFromGoImage (_ecda );if _afcfd !=nil {_gg .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_afcfd );
return _fcfb ;};return _bded ;};func (_egc *convertContext )getShapeFromBlipFill (_ggde *_cc .CT_BlipFillProperties ,_dabb ,_bbed ,_ecag ,_dfbc float64 ,_dgcd bool )_ge .Drawable {_gegba ,_cbf ,_daca :=_egc .makePdfImageFromBlipFill (_ggde ,_dgcd );if _daca !=nil {_gg .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_daca );
return nil ;};if _gegba ==nil {return nil ;};if _eff :=_ggde .FillModePropertiesChoice .Tile ;_eff !=nil {_gegba =_egc .tileImage (_gegba ,_ggde .FillModePropertiesChoice .Tile ,_ecag ,_dfbc );};if _bddf :=_ggde .FillModePropertiesChoice .Stretch ;_bddf !=nil {_gegba ,_dabb ,_bbed =_egc .stretchImage (_gegba ,_ggde .FillModePropertiesChoice .Stretch ,_dabb ,_bbed ,_ecag ,_dfbc );
};if _gegba ==nil {return nil ;};if len (_cbf )==0{_gegba .SetPos (_dabb ,_bbed );return _gegba ;};_gegba =_egc .applyBlipEffectsOnImg (_gegba ,_dabb ,_bbed ,_cbf );_gegba .SetPos (_dabb ,_bbed );return _gegba ;};func (_dggf *textboxContext )alignParagraphsVertically (_ceaac _cc .ST_TextAnchoringType ){if _ceaac ==_cc .ST_TextAnchoringTypeT {return ;
};_dabe :=0.0;for _ ,_cbbg :=range _dggf ._caacb {_dabe +=_cbbg ._afcf +_cbbg ._ccad +_cbbg ._efb ;};var _caacf float64 ;switch _ceaac {case _cc .ST_TextAnchoringTypeCtr :_caacf =(_dggf ._feac -_dabe )/2;case _cc .ST_TextAnchoringTypeB :_caacf =_dggf ._feac -_dabe ;
};for _ ,_gdac :=range _dggf ._caacb {_gdac ._cdcec +=_caacf ;};};func _ddea (_bfee ,_fcc *_cc .CT_TablePartStyle )*_cc .CT_TablePartStyle {_efab :=_cc .NewCT_TablePartStyle ();if _bfee !=nil {*_efab =*_bfee ;};if _fcc ==nil {return _efab ;};if _efab .TcTxStyle ==nil {_efab .TcTxStyle =_fcc .TcTxStyle ;
}else {_efab .TcTxStyle =_dec (_efab .TcTxStyle ,_fcc .TcTxStyle );};if _efab .TcStyle ==nil {_efab .TcStyle =_fcc .TcStyle ;}else {_efab .TcStyle =_bffe (_efab .TcStyle ,_fcc .TcStyle );};return _efab ;};func _dab (_bdbc int ,_gca bool )string {_bcdg :=_dg .NewBuffer ([]byte {});
for _ ,_ccae :=range _gec {for {if _bdbc < _ccae ._aaf {break ;};_bcdg .WriteString (_ccae ._gdeb );_bdbc -=_ccae ._aaf ;};};_agbb :=_bcdg .String ();if _gca {_agbb =_ee .ToUpper (_agbb );};return _agbb ;};func (_ada *convertContext )getConnectors (_ffg *_ga .CT_Connector )[]_ge .Drawable {_dafe ,_ ,_ ,_ ,_ ,_ ,_ :=_ada .getShapesFromSpPr (_ffg .SpPr ,_ffg .Style ,false ,0.0,0.0);
return _dafe ;};func (_eab *convertContext )makePdfBlockFromTable (_efaa *_cc .Tbl )*_ge .Table {_cfb :=_efaa .TblGrid ;if _cfb ==nil {return nil ;};_eaab :=len (_cfb .GridCol );if _eaab ==0{return nil ;};_cfe :=[]float64 {};_deg :=0.0;for _ ,_egfb :=range _cfb .GridCol {_ageg :=_g .FromEMU (_f .FromSTCoordinate (_egfb .WAttr ));
_cfe =append (_cfe ,_ageg );_deg +=_ageg ;};_bcg :=[]float64 {};for _gea :=0;_gea < _eaab ;_gea ++{_bcg =append (_bcg ,_cfe [_gea ]/_deg );};_eegf :=_eab ._fdde .NewTable (_eaab );_eegf .SetColumnWidths (_bcg ...);_cgd :=_efaa .TblPr ;var _bdec *_cc .CT_TableStyle ;
if _cab :=_cgd .TablePropertiesChoice ;_cab !=nil {if _cab .TableStyle !=nil {_bdec =_cab .TableStyle ;}else if _cab .TableStyleId !=nil {_bdec =_eab ._ccbd .GetTableStyleById (*_cab .TableStyleId );};};_ddge :=_cc .NewCT_TablePartStyle ();_ddge .TcStyle =_cc .NewCT_TableStyleCellStyle ();
_ddge .TcTxStyle =_cc .NewCT_TableStyleTextStyle ();if _bdec !=nil {if _bdec .WholeTbl !=nil {*_ddge =*_bdec .WholeTbl ;};if _bdec .TblBg !=nil {if _ddge .TcStyle .ThemeableFillStyleChoice .Fill ==nil {_ddge .TcStyle .ThemeableFillStyleChoice .Fill =_bdec .TblBg .ThemeableFillStyleChoice .Fill ;
};};};if _ddge .TcStyle .ThemeableFillStyleChoice .Fill ==nil {_ddge .TcStyle .ThemeableFillStyleChoice .Fill =_cc .NewCT_FillProperties ();_ddge .TcStyle .ThemeableFillStyleChoice .Fill .FillPropertiesChoice .NoFill =_cgd .FillPropertiesChoice .NoFill ;
_ddge .TcStyle .ThemeableFillStyleChoice .Fill .FillPropertiesChoice .SolidFill =_cgd .FillPropertiesChoice .SolidFill ;};_cgbc :=len (_efaa .Tr );_fcgg :=_efaa .TblPr .BandRowAttr !=nil &&*_efaa .TblPr .BandRowAttr ;_gda :=_efaa .TblPr .FirstRowAttr !=nil &&*_efaa .TblPr .FirstRowAttr ;
_ccd :=_efaa .TblPr .LastRowAttr !=nil &&*_efaa .TblPr .LastRowAttr ;_dee :=_efaa .TblPr .BandColAttr !=nil &&*_efaa .TblPr .BandColAttr ;_dead :=_efaa .TblPr .FirstColAttr !=nil &&*_efaa .TblPr .FirstColAttr ;_cbae :=_efaa .TblPr .LastColAttr !=nil &&*_efaa .TblPr .LastColAttr ;
for _afaa ,_dfgc :=range _efaa .Tr {_fed :=_afaa ==0;_aegd :=_afaa ==_cgbc -1;_abf :=_afaa %2==0;_ecg :=len (_dfgc .Tc );var _dbb *_cc .CT_TablePartStyle ;if _bdec !=nil {if _fed &&_gda {_dbb =_bdec .FirstRow ;}else if _aegd &&_ccd {_dbb =_bdec .LastRow ;
}else if _abf &&_fcgg {_dbb =_bdec .Band2H ;}else if _fcgg {_dbb =_bdec .Band1H ;};};var _aeaf float64 ;for _bdb ,_ecgd :=range _dfgc .Tc {_fadcc :=_bdb ==0;_cge :=_bdb ==_ecg -1;_aeb :=_bdb %2==0;var _edac *_cc .CT_TablePartStyle ;if _bdec !=nil {if _fadcc &&_dead {_edac =_bdec .FirstCol ;
}else if _cge &&_cbae {_edac =_bdec .LastCol ;}else if _aeb &&_dee {_edac =_bdec .Band2V ;}else if _dee {_edac =_bdec .Band1V ;};};_facf :=_ddea (_ddea (_edac ,_dbb ),_ddge );_dde :=_eab .addCellToTable (_eegf ,_ecgd ,_facf ,_fed ,_aegd ,_fadcc ,_cge );
if _dde > _aeaf {_aeaf =_dde ;};};_dca :=_g .FromEMU (_f .FromSTCoordinate (_dfgc .HAttr ));if _dca < _aeaf {_dca =_aeaf ;};if _dca < _dbdf (4){_dca =_dbdf (4);};_eegf .SetRowHeight (_eegf .CurRow (),_dca );};return _eegf ;};type symbol struct{_ffdee string ;
_def float64 ;_gfac float64 ;_fbfa float64 ;_gde float64 ;_eaacd float64 ;_gcdgb *_ge .TextStyle ;_agc string ;_afca bool ;_bbgc bool ;_acad bool ;};func (_eag *convertContext )getShapesFromSpPr (_bbe *_cc .CT_ShapeProperties ,_eebg *_cc .CT_ShapeStyle ,_fef bool ,_egd float64 ,_afa float64 )([]_ge .Drawable ,float64 ,float64 ,float64 ,float64 ,_ge .Color ,bool ){_edaf :=[]_ge .Drawable {};
var _aecg ,_bag ,_gag ,_caf ,_gfb float64 ;var _ffff ,_eefa ,_eaca ,_geee _ge .Color ;var _fbe *_cc .CT_BlipFillProperties ;_fbc ,_dcc :=1.0,1.0;if _eebg !=nil {_ffff ,_eefa ,_geee =_eag .getStyleColors (_eebg );};if _bfd :=_bbe .Ln ;_bfd !=nil {if _bfd .LineFillPropertiesChoice .NoFill !=nil {_eaca ,_gfb =nil ,0;
}else {_eaca ,_gfb ,_fbc =_eag .getInfoFromLn (_bfd );if _eaca ==nil {_eaca =_geee ;};};};if _bbe .FillPropertiesChoice .NoFill !=nil {_eefa ,_dcc =nil ,0;}else if _fef {_eefa =_eag ._gfdc ._bfc ;_dcc =_eag ._gfdc ._bef ;_fbe =_eag ._gfdc ._fbcd ;}else if _ged :=_bbe .FillPropertiesChoice .SolidFill ;
_ged !=nil {_eefa ,_dcc =_eag .getColorFromSolidFill (_ged );};var _fbd bool ;if _ccb :=_bbe .Xfrm ;_ccb !=nil {_aecg ,_bag ,_gag ,_caf =_f .GetDataFromXfrm (_ccb );_aecg +=_egd ;_bag +=_afa ;_fbd =true ;};if _ebe :=_bbe .GeometryChoice .CustGeom ;_ebe !=nil {_fee :=[]_c .Point {};
_bdfg ,_fdf :=1.0,1.0;if _fbgf :=_ebe .PathLst ;_fbgf !=nil {for _ ,_bdd :=range _fbgf .Path {if _bdd !=nil {if _geg :=_bdd .WAttr ;_geg !=nil {_bdfg =_gag /_g .FromEMU (*_geg );};if _gcf :=_bdd .HAttr ;_gcf !=nil {_fdf =_caf /_g .FromEMU (*_gcf );};for _ ,_fga :=range _bdd .Path2DChoice {if _fga .Close !=nil {};
if _edcg :=_fga .MoveTo ;_fga .MoveTo !=nil {if _edcg !=nil &&_edcg .Pt !=nil {_gga ,_cdg :=_cae (_edcg .Pt );_fee =append (_fee ,_c .Point {X :_gga *_bdfg +_aecg ,Y :_cdg *_fdf +_bag });};};if _dfg :=_fga .LnTo ;_dfg !=nil &&_dfg .Pt !=nil {_fcg ,_cfab :=_cae (_dfg .Pt );
_fee =append (_fee ,_c .Point {X :_fcg *_bdfg +_aecg ,Y :_cfab *_fdf +_bag });};};_dbad :=_eag ._fdde .NewPolygon ([][]_c .Point {_fee });_dbad .SetFillColor (_eefa );_dbad .SetFillOpacity (_dcc );_dbad .SetBorderWidth (_gfb );if _eaca !=nil {_dbad .SetBorderColor (_eaca );
_dbad .SetBorderOpacity (_fbc );};_edaf =append (_edaf ,_dbad );};};};};if _abg :=_bbe .GeometryChoice .PrstGeom ;_abg !=nil {switch _abg .PrstAttr {case _cc .ST_ShapeTypeRect :if _fbe !=nil {_afdb :=_eag .getShapeFromBlipFill (_fbe ,_aecg ,_bag ,_gag ,_caf ,false );
_edaf =append (_edaf ,_afdb );}else {_agge :=_eag ._fdde .NewRectangle (_aecg ,_bag ,_gag ,_caf );_gdd :=_eefa !=nil &&_dcc > 0;if _gdd {_agge .SetFillColor (_eefa );_agge .SetFillOpacity (_dcc );};_gefe :=_eaca !=nil &&_fbc > 0&&_gfb > 0;if _gefe {_agge .SetBorderWidth (_gfb );
_agge .SetBorderColor (_eaca );_agge .SetBorderOpacity (_fbc );};if _gdd ||_gefe {_edaf =append (_edaf ,_agge );};};case _cc .ST_ShapeTypeLine :_fca :=_eag ._fdde .NewLine (_aecg ,_bag ,_aecg +_gag ,_bag +_caf );_fca .SetLineWidth (_gfb );if _eaca !=nil {_fca .SetColor (_eaca );
};_edaf =append (_edaf ,_fca );};};return _edaf ,_aecg ,_bag ,_gag ,_caf ,_ffff ,_fbd ;};var _gec =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};
func (_ccbda *textboxContext )alignParagraph (){_ecdc :=_ccbda ._bbae ;if _ecdc ._adff ==_cc .ST_TextAlignTypeL {return ;};_aaa :=len (_ecdc ._ceae )-1;for _geece ,_babee :=range _ecdc ._ceae {_bbbe :=true ;_bfbf :=len (_babee ._cfcb );_aegc :=0.0;for _fbad :=len (_babee ._cfcb )-1;
_fbad >=0;_fbad --{_fgea :=_babee ._cfcb [_fbad ];if _bbbe &&_fgea ._cgec {_bfbf =_fbad ;}else {_bbbe =false ;for _ ,_fcaaa :=range _fgea ._eacb {_aegc +=_fcaaa ._eaacd ;};};};_babee ._cfcb =_babee ._cfcb [:_bfbf ];_fgaf :=_babee ._bcc -_babee ._cfbe -_aegc ;
switch _ecdc ._adff {case _cc .ST_TextAlignTypeR :_babee .moveRight (_fgaf );case _cc .ST_TextAlignTypeCtr :_babee .moveRight (_fgaf /2);case _cc .ST_TextAlignTypeJust :if _geece !=_aaa {_gdbb :=[]*word {};for _ ,_fefd :=range _babee ._cfcb {if _fefd ._cgec {_gdbb =append (_gdbb ,_fefd );
};};_egef :=_fgaf /float64 (len (_gdbb ));for _ ,_gegb :=range _gdbb {_gegb ._dgad +=_egef ;};var _dfb *word ;for _ ,_fbaea :=range _babee ._cfcb {if _dfb !=nil {_fbaea ._dbfd =_dfb ._dbfd +_dfb ._dgad ;};_dfb =_fbaea ;};};};};};func (_bgf *convertContext )tileImage (_gaf *_ge .Image ,_dbf *_cc .CT_TileInfoProperties ,_cgb ,_agd float64 )*_ge .Image {_afc ,_gbdg :=1.0,1.0;
if _daa :=_dbf .SxAttr ;_daa !=nil {_afc =_f .FromSTPercentage (_daa );};if _ecd :=_dbf .SyAttr ;_ecd !=nil {_gbdg =_f .FromSTPercentage (_ecd );};_efd :=_f .MakeTempCreator (_cgb ,_agd );_gaf .Scale (_afc ,_gbdg );_caac ,_eef :=_gaf .Width (),_gaf .Height ();
var _cga ,_fce float64 ;if _efa :=_dbf .TxAttr ;_efa !=nil {_cga =_g .FromEMU (_f .FromSTCoordinate (*_efa ));};if _fdd :=_dbf .TyAttr ;_fdd !=nil {_fce =_g .FromEMU (_f .FromSTCoordinate (*_fdd ));};if _cga > 0{_cga -=_caac ;};if _fce > 0{_fce -=_eef ;
};_bde :=_bgf ._deae /_caac +1;_bea :=_bgf ._bcd /_eef +1;for _fgf :=0.0;_fgf <=_bde ;_fgf ++{_dba :=_fgf *_caac ;for _aff :=0.0;_aff <=_bea ;_aff ++{_acd :=_aff *_eef ;_gaf .SetPos (_dba +_cga ,_acd +_fce );_efd .Draw (_gaf );};};_dga ,_gfde :=_f .GetPageFromCreator (_efd );
if _gfde !=nil {_gg .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_gfde );return nil ;};_ab ,_gfde :=_ad .NewImageDevice ().Render (_dga );
if _gfde !=nil {_gg .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_gfde );return nil ;};_cgac ,_gfde :=_bgf ._fdde .NewImageFromGoImage (_ab );if _gfde !=nil {_gg .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_gfde );
return nil ;};return _cgac ;};func (_affc *textboxContext )drawParagraphs (){_affc ._cadd .NewPage ();for _ ,_egbd :=range _affc ._caacb {for _ ,_fbfd :=range _egbd ._ceae {for _ ,_gecg :=range _fbfd ._cfcb {for _ ,_dbadd :=range _gecg ._eacb {_gge :=_affc ._cadd .NewStyledParagraph ();
if _dbadd ._afca {_dbadd ._gde =0;}else if _dbadd ._bbgc {_dbadd ._gde =1.2*_fbfd ._dbc -_dbadd ._fbfa ;};_affb :=_gecg ._dbfd +_dbadd ._def ;_dgde :=_egbd ._cdcec +_fbfd ._adad +_dbadd ._gde ;_gge .SetPos (_affb ,_dgde );_bgb :=_gge .Append (_dbadd ._ffdee );
if _dbadd ._gcdgb !=nil {_bgb .Style =*_dbadd ._gcdgb ;};_affc ._cadd .Draw (_gge );if _dbadd ._acad {_aabd :=_dgde +_dbadd ._fbfa +2;_f .DrawLine (_affc ._cadd ,_affb ,_aabd ,_affb +_dbadd ._eaacd ,_aabd ,1,_dbadd ._gcdgb .Color );};};};};};};func (_bca *convertContext )getColorFromMatrixReference (_dddf *_cc .CT_StyleMatrixReference )_ge .Color {if _dddf ==nil {return nil ;
};var _gdca _ge .Color ;var _ega string ;if _bbab :=_dddf .SrgbClr ;_bbab !=nil {_ega =_bbab .ValAttr ;}else if _dagg :=_dddf .SchemeClr ;_dagg !=nil {_ega =_f .GetColorStringFromDmlColor (_bca ._ccbd .GetColorBySchemeColor (_dagg .ValAttr ));_ega =_f .AdjustColor (_ega ,_dagg .EG_ColorTransform );
};if _ega !=""{_gdca =_ge .ColorRGBFromHex ("\u0023"+_ega );};return _gdca ;};func (_gace *convertContext )renderPageWithDrawableToGoImage (_aeafe _ge .Drawable )(_e .Image ,error ){_fagb :=_f .MakeTempCreator (_gace ._deae ,_gace ._bcd );_fagb .NewPage ();
_fagb .Draw (_aeafe );_aaef ,_ebbf :=_f .GetPageFromCreator (_fagb );if _ebbf !=nil {return nil ,_ebbf ;};return _ad .NewImageDevice ().Render (_aaef );};func (_dgba *textboxContext )addCurrentWordToParagraph (){if _dgba ._fgcg &&_dgba ._cgeb ._feg +_dgba ._cdce ._dgad > _dgba ._cgeb ._bcc {_dgba .newLine ();
};if !_dgba ._cdce ._cgec ||len (_dgba ._cgeb ._cfcb )> 0{_dgba ._cdce ._dbfd =_dgba ._cgeb ._feg ;_dgba ._cgeb ._cfcb =append (_dgba ._cgeb ._cfcb ,_dgba ._cdce );_dgba ._cgeb ._feg +=_dgba ._cdce ._dgad ;for _ ,_gedg :=range _dgba ._cdce ._eacb {_dgba .adjustHeights (_gedg ._gfac );
};};};func _bffe (_ecff ,_deege *_cc .CT_TableStyleCellStyle )*_cc .CT_TableStyleCellStyle {_bddgd :=_cc .NewCT_TableStyleCellStyle ();if _ecff !=nil {*_bddgd =*_ecff ;};if _deege ==nil {return _bddgd ;};if _bddgd .TcBdr ==nil {_bddgd .TcBdr =_deege .TcBdr ;
}else {if _bddgd .TcBdr .Left ==nil {_bddgd .TcBdr .Left =_deege .TcBdr .Left ;};if _bddgd .TcBdr .Right ==nil {_bddgd .TcBdr .Right =_deege .TcBdr .Right ;};if _bddgd .TcBdr .Top ==nil {_bddgd .TcBdr .Top =_deege .TcBdr .Top ;};if _bddgd .TcBdr .Bottom ==nil {_bddgd .TcBdr .Bottom =_deege .TcBdr .Bottom ;
};if _bddgd .TcBdr .InsideH ==nil {_bddgd .TcBdr .InsideH =_deege .TcBdr .InsideH ;};if _bddgd .TcBdr .InsideV ==nil {_bddgd .TcBdr .InsideV =_deege .TcBdr .InsideV ;};};if _bddgd .ThemeableFillStyleChoice .Fill ==nil {_bddgd .ThemeableFillStyleChoice .Fill =_deege .ThemeableFillStyleChoice .Fill ;
};if _bddgd .ThemeableFillStyleChoice .FillRef ==nil {_bddgd .ThemeableFillStyleChoice .FillRef =_deege .ThemeableFillStyleChoice .FillRef ;};return _bddgd ;};func (_gede *convertContext )getStyleColors (_deee *_cc .CT_ShapeStyle )(_ge .Color ,_ge .Color ,_ge .Color ){var _bcba ,_fdef ,_gddd _ge .Color ;
if _cafc :=_deee .LnRef ;_cafc !=nil {_fdef =_gede .getColorFromMatrixReference (_cafc );};if _dafg :=_deee .FillRef ;_dafg !=nil {_gddd =_gede .getColorFromMatrixReference (_dafg );};if _gbbf :=_deee .FontRef ;_gbbf !=nil {_bcba =_gede .getColorFromFontReference (_gbbf );
};return _bcba ,_gddd ,_fdef ;};func _dec (_bebg ,_debce *_cc .CT_TableStyleTextStyle )*_cc .CT_TableStyleTextStyle {_eegg :=_cc .NewCT_TableStyleTextStyle ();if _bebg !=nil {*_eegg =*_bebg ;};if _debce ==nil {return _eegg ;};if _eegg .BAttr ==_cc .ST_OnOffStyleTypeUnset {_eegg .BAttr =_debce .BAttr ;
};if _eegg .IAttr ==_cc .ST_OnOffStyleTypeUnset {_eegg .IAttr =_debce .IAttr ;};if _eegg .ThemeableFontStylesChoice .Font ==nil {_eegg .ThemeableFontStylesChoice .Font =_debce .ThemeableFontStylesChoice .Font ;};if _eegg .ThemeableFontStylesChoice .FontRef ==nil {_eegg .ThemeableFontStylesChoice .FontRef =_debce .ThemeableFontStylesChoice .FontRef ;
};if _eegg .ScrgbClr ==nil {_eegg .ScrgbClr =_debce .ScrgbClr ;};if _eegg .SrgbClr ==nil {_eegg .SrgbClr =_debce .SrgbClr ;};if _eegg .HslClr ==nil {_eegg .HslClr =_debce .HslClr ;};if _eegg .SysClr ==nil {_eegg .SysClr =_debce .SysClr ;};if _eegg .SchemeClr ==nil {_eegg .SchemeClr =_debce .SchemeClr ;
};if _eegg .PrstClr ==nil {_eegg .PrstClr =_debce .PrstClr ;};return _eegg ;};func _bgfe (_efgg *_ga .CT_CommonSlideData ,_ffed _ga .ST_PlaceholderType ,_gbdc *uint32 )(*_cc .CT_Transform2D ,*_cc .CT_TextBody ,*bool ,*bool ,*bool ){_gacf :=_gbdc ==nil ;
if _efgg !=nil &&(_ffed !=_ga .ST_PlaceholderTypeUnset ||!_gacf ){if _bbfcd :=_efgg .SpTree ;_bbfcd !=nil {for _ ,_fdbd :=range _bbfcd .GroupShapeChoice {if _fdbd !=nil {if _fdbd .Sp !=nil {_bcad ,_debg :=_efeb (_fdbd .Sp );if _ffed ==_bcad {if (_gacf &&_debg ==nil )||(!_gacf &&_debg !=nil &&*_debg ==*_gbdc ){var _feda *_cc .CT_Transform2D ;
if _fdbd .Sp .SpPr !=nil {_feda =_fdbd .Sp .SpPr .Xfrm ;};_gbca :=_ffed ==_ga .ST_PlaceholderTypeTitle ||_ffed ==_ga .ST_PlaceholderTypeCtrTitle ;_degd :=_ffed ==_ga .ST_PlaceholderTypeSubTitle ;_gbgg :=!_gbca &&_ffed !=_ga .ST_PlaceholderTypeUnset ;return _feda ,_fdbd .Sp .TxBody ,&_gbca ,&_degd ,&_gbgg ;
};};};};};};};return nil ,nil ,nil ,nil ,nil ;};func (_adaa *textboxContext )alignSymbolsVertically (){for _ ,_beae :=range _adaa ._caacb {for _ ,_cdgdc :=range _beae ._ceae {_gabg :=0.0;for _ ,_aebea :=range _cdgdc ._cfcb {for _ ,_aggd :=range _aebea ._eacb {if _aggd ._gfac > _gabg {_gabg =_aggd ._gfac ;
};};};for _ ,_ebgf :=range _cdgdc ._cfcb {for _ ,_egge :=range _ebgf ._eacb {if _egge ._fbfa < _gabg {_egge ._gde =_gabg -_egge ._fbfa ;};};};};};};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _f .RegisterFontsFromDirectory (dirName )};func (_ccgf *convertContext )getColorFromSolidFill (_eecd *_cc .CT_SolidColorFillProperties )(_ge .Color ,float64 ){if _eecd ==nil {return nil ,1;
};var _gce string ;_feaa :=1.0;if _cgad :=_eecd .SrgbClr ;_cgad !=nil {_gce =_cgad .ValAttr ;_feaa =_f .GetOpacityFromColorTransform (_cgad .EG_ColorTransform );}else if _aage :=_eecd .SchemeClr ;_aage !=nil {_gce =_f .GetColorStringFromDmlColor (_ccgf ._cead .GetColorBySchemeColor (_aage .ValAttr ));
_gce =_f .AdjustColor (_gce ,_aage .EG_ColorTransform );_feaa =_f .GetOpacityFromColorTransform (_aage .EG_ColorTransform );};if _gce !=""{_aabc :=_ge .ColorRGBFromHex ("\u0023"+_gce );return _aabc ,_feaa ;};return nil ,1;};func (_acdd *convertContext )makeStyleFromRPr (_fefg *_cc .CT_TextCharacterProperties )(*_ge .TextStyle ,bool ,bool ,bool ){var _afge ,_fcbg ,_gcdg bool ;
_cdede :=_acdd ._fdde .NewTextStyle ();if _fefg !=nil {_fbaa :=_f .FontStyle_Regular ;_agac :=_ebca (_fefg .BAttr );_efe :=_ebca (_fefg .IAttr );if _agac &&_efe {_fbaa =_f .FontStyle_BoldItalic ;}else if _agac {_fbaa =_f .FontStyle_Bold ;}else if _efe {_fbaa =_f .FontStyle_Italic ;
};_gcdg =_fefg .UAttr !=_cc .ST_TextUnderlineTypeUnset &&_fefg .UAttr !=_cc .ST_TextUnderlineTypeNone ;_egfd :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _cdc :=_fefg .Latin ;_cdc !=nil {_egfd =_cdc .TypefaceAttr ;}else if _gcda :=_fefg .Ea ;_gcda !=nil {_egfd =_gcda .TypefaceAttr ;
}else if _fdfb :=_fefg .Cs ;_fdfb !=nil {_egfd =_fdfb .TypefaceAttr ;}else if _fbef :=_fefg .Sym ;_fbef !=nil {_egfd =_fbef .TypefaceAttr ;};if _gba ,_fdb :=_f .StdFontsMap [_egfd ];_fdb {_cdede .Font =_f .AssignStdFontByName (_cdede ,_gba [_fbaa ]);}else if _acdgd :=_f .GetRegisteredFont (_egfd ,_fbaa );
_acdgd !=nil {_cdede .Font =_acdgd ;}else {_gg .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_egfd ,_fbaa );
_cdede .Font =_f .AssignStdFontByName (_cdede ,_f .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_fbaa ]);};var _aee float64 ;if _afbd :=_fefg .SzAttr ;_afbd !=nil {_aee =_b .Round (float64 (*_afbd )/100)-0.5;}else {_aee =_f .DefaultFontSize ;};
if _aca :=_fefg .BaselineAttr ;_aca !=nil {if _geff :=_aca .ST_PercentageDecimal ;_geff !=nil {if *_geff > 0{_afge =true ;}else if *_geff < 0{_fcbg =true ;};};};if _afge ||_fcbg {_aee =_b .Round (_aee *0.64);};_cdede .FontSize =_aee ;_beab :=0.0;if _aeg :=_fefg .SpcAttr ;
_aeg !=nil {if _debc :=_aeg .ST_TextPointUnqualified ;_debc !=nil &&*_debc > 0{_beab =float64 (*_debc )/100;};};_cdede .CharSpacing =_beab ;};return &_cdede ,_afge ,_fcbg ,_gcdg ;};func _ddga (_agab int ,_agdg bool )string {_cbbe :=(_agab -1)/26+1;_ffgcd :=byte ((_agab -1)%26);
if _agdg {_ffgcd +=byte (65);}else {_ffgcd +=byte (97);};_bad :=_dg .NewBuffer ([]byte {});for _fced :=0;_fced < _cbbe ;_fced ++{_bad .Write ([]byte {_ffgcd });};return _bad .String ();};