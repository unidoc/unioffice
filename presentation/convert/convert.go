//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_ee "bytes";_e "errors";_dg "github.com/unidoc/unioffice/v2/common";_ege "github.com/unidoc/unioffice/v2/common/logger";_bb "github.com/unidoc/unioffice/v2/common/tempstorage";_d "github.com/unidoc/unioffice/v2/internal/convertutils";
_aa "github.com/unidoc/unioffice/v2/measurement";_ac "github.com/unidoc/unioffice/v2/presentation";_gg "github.com/unidoc/unioffice/v2/schema/soo/dml";_f "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_ce "github.com/unidoc/unioffice/v2/schema/soo/pml";
_cc "github.com/unidoc/unipdf/v4/contentstream/draw";_cf "github.com/unidoc/unipdf/v4/core";_cbc "github.com/unidoc/unipdf/v4/creator";_de "github.com/unidoc/unipdf/v4/model";_cfe "github.com/unidoc/unipdf/v4/render";_b "image";_eb "image/color";_eg "image/draw";
_a "math";_g "strconv";_cb "strings";);func (_dedc *textboxContext )alignParagraph (){_ecdfd :=_dedc ._bcgb ;if _ecdfd ._ebaf ==_gg .ST_TextAlignTypeL {return ;};_faea :=len (_ecdfd ._acdg )-1;for _fcdg ,_abab :=range _ecdfd ._acdg {_aaea :=true ;_eda :=len (_abab ._baag );
_acf :=0.0;for _feg :=len (_abab ._baag )-1;_feg >=0;_feg --{_dced :=_abab ._baag [_feg ];if _aaea &&_dced ._dgggb {_eda =_feg ;}else {_aaea =false ;for _ ,_gddab :=range _dced ._dfec {_acf +=_gddab ._aced ;};};};_abab ._baag =_abab ._baag [:_eda ];_cfed :=_abab ._efca -_abab ._ecdfg -_acf ;
switch _ecdfd ._ebaf {case _gg .ST_TextAlignTypeR :_abab .moveRight (_cfed );case _gg .ST_TextAlignTypeCtr :_abab .moveRight (_cfed /2);case _gg .ST_TextAlignTypeJust :if _fcdg !=_faea {_fcbb :=[]*word {};for _ ,_eab :=range _abab ._baag {if _eab ._dgggb {_fcbb =append (_fcbb ,_eab );
};};_begf :=_cfed /float64 (len (_fcbb ));for _ ,_ccfc :=range _fcbb {_ccfc ._bbfd +=_begf ;};var _dac *word ;for _ ,_aeea :=range _abab ._baag {if _dac !=nil {_aeea ._dde =_dac ._dde +_dac ._bbfd ;};_dac =_aeea ;};};};};};func (_gedb *line )moveRight (_faa float64 ){for _ ,_gbcg :=range _gedb ._baag {_gbcg ._dde +=_faa ;
};};func _egdf (_cdfa ,_bdce *_gg .CT_TextCharacterProperties )*_gg .CT_TextCharacterProperties {_ggab :=_gg .NewCT_TextCharacterProperties ();if _cdfa !=nil {*_ggab =*_cdfa ;};if _bdce ==nil {return _ggab ;};if _ggab .KumimojiAttr ==nil {_ggab .KumimojiAttr =_bdce .KumimojiAttr ;
};if _ggab .LangAttr ==nil {_ggab .LangAttr =_bdce .LangAttr ;};if _ggab .AltLangAttr ==nil {_ggab .AltLangAttr =_bdce .AltLangAttr ;};if _ggab .SzAttr ==nil {_ggab .SzAttr =_bdce .SzAttr ;};if _ggab .BAttr ==nil {_ggab .BAttr =_bdce .BAttr ;};if _ggab .IAttr ==nil {_ggab .IAttr =_bdce .IAttr ;
};if _ggab .UAttr ==_gg .ST_TextUnderlineTypeUnset {_ggab .UAttr =_bdce .UAttr ;};if _ggab .StrikeAttr ==_gg .ST_TextStrikeTypeUnset {_ggab .StrikeAttr =_bdce .StrikeAttr ;};if _ggab .KernAttr ==nil {_ggab .KernAttr =_bdce .KernAttr ;};if _ggab .CapAttr ==_gg .ST_TextCapsTypeUnset {_ggab .CapAttr =_bdce .CapAttr ;
};if _ggab .SpcAttr ==nil {_ggab .SpcAttr =_bdce .SpcAttr ;};if _ggab .NormalizeHAttr ==nil {_ggab .NormalizeHAttr =_bdce .NormalizeHAttr ;};if _ggab .BaselineAttr ==nil {_ggab .BaselineAttr =_bdce .BaselineAttr ;};if _ggab .NoProofAttr ==nil {_ggab .NoProofAttr =_bdce .NoProofAttr ;
};if _ggab .DirtyAttr ==nil {_ggab .DirtyAttr =_bdce .DirtyAttr ;};if _ggab .ErrAttr ==nil {_ggab .ErrAttr =_bdce .ErrAttr ;};if _ggab .SmtCleanAttr ==nil {_ggab .SmtCleanAttr =_bdce .SmtCleanAttr ;};if _ggab .SmtIdAttr ==nil {_ggab .SmtIdAttr =_bdce .SmtIdAttr ;
};if _ggab .BmkAttr ==nil {_ggab .BmkAttr =_bdce .BmkAttr ;};if _ggab .Ln ==nil {_ggab .Ln =_bdce .Ln ;};if _ggab .FillPropertiesChoice .NoFill ==nil {_ggab .FillPropertiesChoice .NoFill =_bdce .FillPropertiesChoice .NoFill ;};if _ggab .FillPropertiesChoice .SolidFill ==nil {_ggab .FillPropertiesChoice .SolidFill =_bdce .FillPropertiesChoice .SolidFill ;
};if _ggab .FillPropertiesChoice .BlipFill ==nil {_ggab .FillPropertiesChoice .BlipFill =_bdce .FillPropertiesChoice .BlipFill ;};if _ggab .EffectPropertiesChoice .EffectLst ==nil {_ggab .EffectPropertiesChoice .EffectLst =_bdce .EffectPropertiesChoice .EffectLst ;
};if _ggab .EffectPropertiesChoice .EffectDag ==nil {_ggab .EffectPropertiesChoice .EffectDag =_bdce .EffectPropertiesChoice .EffectDag ;};if _ggab .Highlight ==nil {_ggab .Highlight =_bdce .Highlight ;};if _ggab .TextUnderlineLineChoice .ULnTx ==nil {_ggab .TextUnderlineLineChoice .ULnTx =_bdce .TextUnderlineLineChoice .ULnTx ;
};if _ggab .TextUnderlineLineChoice .ULn ==nil {_ggab .TextUnderlineLineChoice .ULn =_bdce .TextUnderlineLineChoice .ULn ;};if _ggab .TextUnderlineFillChoice .UFillTx ==nil {_ggab .TextUnderlineFillChoice .UFillTx =_bdce .TextUnderlineFillChoice .UFillTx ;
};if _ggab .TextUnderlineFillChoice .UFill ==nil {_ggab .TextUnderlineFillChoice .UFill =_bdce .TextUnderlineFillChoice .UFill ;};if _ggab .Latin ==nil {_ggab .Latin =_bdce .Latin ;};if _ggab .Ea ==nil {_ggab .Ea =_bdce .Ea ;};if _ggab .Cs ==nil {_ggab .Cs =_bdce .Cs ;
};if _ggab .Sym ==nil {_ggab .Sym =_bdce .Sym ;};if _ggab .Rtl ==nil {_ggab .Rtl =_bdce .Rtl ;};return _ggab ;};func (_ccbd *convertContext )makePdfDivisionFromTxBody (_fadb *_gg .CT_TextBody ,_ada *_gg .CT_TableStyleTextStyle )*_cbc .Division {_dff :=_ccbd ._dedd .NewDivision ();
_gge :=_ccbd ._gbde ;_efdg :=_gg .ST_TextAnchoringTypeT ;if _cce :=_fadb .BodyPr ;_cce !=nil {if _bdcd :=_cce .AnchorAttr ;_bdcd !=_gg .ST_TextAnchoringTypeUnset {_efdg =_cce .AnchorAttr ;};};if _bef :=_fadb .LstStyle ;_bef !=nil {var _cgd *_gg .CT_TextParagraphProperties ;
if _bef .Lvl1pPr !=nil {_cgd =_bef .Lvl1pPr ;}else {_cgd =_ccbd ._ggc [0];};_gge =_eebf (_cgd ,_eebf (_bef .DefPPr ,_gge ));};for _ ,_aba :=range _fadb .P {if _aba !=nil {_afg :=_ccbd ._dedd .NewStyledParagraph ();_bdcf :=_eebf (_aba .PPr ,_gge );_bba :=_egdf (_aba .EndParaRPr ,_bdcf .DefRPr );
switch _bdcf .AlgnAttr {case _gg .ST_TextAlignTypeR :_afg .SetTextAlignment (_cbc .TextAlignmentRight );case _gg .ST_TextAlignTypeCtr :_afg .SetTextAlignment (_cbc .TextAlignmentCenter );case _gg .ST_TextAlignTypeJust :_afg .SetTextAlignment (_cbc .TextAlignmentJustify );
};if len (_aba .EG_TextRun )==0{_afg .Append ("\u000a");_dff .Add (_afg );continue ;};for _ ,_adef :=range _aba .EG_TextRun {if _dbfd :=_adef .TextRunChoice .Br ;_dbfd !=nil {_afg .Append ("\u000a");}else if _fcgf :=_adef .TextRunChoice .R ;_fcgf !=nil {_bagg :=_aabd (_fcgf .RPr ,_ada );
_bagg =_egdf (_bagg ,_bba );var _acag _cbc .Color ;if _bagg .FillPropertiesChoice .SolidFill !=nil {_acag ,_ =_ccbd .getColorFromSolidFill (_bagg .FillPropertiesChoice .SolidFill );}else {_acag =_cbc .ColorBlack ;};_caad ,_ebga ,_fcc ,_ :=_ccbd .makeStyleFromRPr (_bagg );
_caad .Color =_acag ;if _ebga {_caad .TextRise =0.5;}else if _fcc {_caad .TextRise =-0.5;};_gdfg :=_fcgf .T ;if _bagg .CapAttr ==_gg .ST_TextCapsTypeAll {for _ ,_gcd :=range _gdfg {_gcd =[]rune (_cb .ToUpper (string (_gcd )))[0];};};_dbe :=_afg .Append (_gdfg );
_dbe .Style =*_caad ;};};_ =_efdg ;_dff .Add (_afg );};};return _dff ;};func (_add *convertContext )getShapesFromSpPr (_dfb *_gg .CT_ShapeProperties ,_fcgg *_gg .CT_ShapeStyle ,_fgfa bool ,_gaddb float64 ,_ffg float64 )([]_cbc .Drawable ,float64 ,float64 ,float64 ,float64 ,_cbc .Color ,bool ){_badd :=[]_cbc .Drawable {};
var _gba ,_gab ,_cfcd ,_aae ,_bbg float64 ;var _fac ,_acd ,_ecagd ,_fdb _cbc .Color ;var _dfba *_gg .CT_BlipFillProperties ;_bafe ,_deff :=1.0,1.0;if _fcgg !=nil {_fac ,_acd ,_fdb =_add .getStyleColors (_fcgg );};if _efed :=_dfb .Ln ;_efed !=nil {if _efed .LineFillPropertiesChoice .NoFill !=nil {_ecagd ,_bbg =nil ,0;
}else {_ecagd ,_bbg ,_bafe =_add .getInfoFromLn (_efed );if _ecagd ==nil {_ecagd =_fdb ;};};};if _dfb .FillPropertiesChoice .NoFill !=nil {_acd ,_deff =nil ,0;}else if _fgfa {_acd =_add ._fef ._ebcg ;_deff =_add ._fef ._gbg ;_dfba =_add ._fef ._aace ;}else if _fdg :=_dfb .FillPropertiesChoice .SolidFill ;
_fdg !=nil {_acd ,_deff =_add .getColorFromSolidFill (_fdg );};var _bac bool ;if _fceb :=_dfb .Xfrm ;_fceb !=nil {_gba ,_gab ,_cfcd ,_aae =_d .GetDataFromXfrm (_fceb );_gba +=_gaddb ;_gab +=_ffg ;_bac =true ;};if _bafc :=_dfb .GeometryChoice .CustGeom ;
_bafc !=nil {_dfcg :=[]_cc .Point {};_gfe ,_ecdf :=1.0,1.0;if _dfdg :=_bafc .PathLst ;_dfdg !=nil {for _ ,_gfc :=range _dfdg .Path {if _gfc !=nil {if _egba :=_gfc .WAttr ;_egba !=nil {_gfe =_cfcd /_aa .FromEMU (*_egba );};if _dfa :=_gfc .HAttr ;_dfa !=nil {_ecdf =_aae /_aa .FromEMU (*_dfa );
};for _ ,_caa :=range _gfc .Path2DChoice {if _caa .Close !=nil {};if _cbbd :=_caa .MoveTo ;_caa .MoveTo !=nil {if _cbbd !=nil &&_cbbd .Pt !=nil {_aceb ,_bcc :=_gbgf (_cbbd .Pt );_dfcg =append (_dfcg ,_cc .Point {X :_aceb *_gfe +_gba ,Y :_bcc *_ecdf +_gab });
};};if _gac :=_caa .LnTo ;_gac !=nil &&_gac .Pt !=nil {_gc ,_ccgc :=_gbgf (_gac .Pt );_dfcg =append (_dfcg ,_cc .Point {X :_gc *_gfe +_gba ,Y :_ccgc *_ecdf +_gab });};};_aebe :=_add ._dedd .NewPolygon ([][]_cc .Point {_dfcg });_aebe .SetFillColor (_acd );
_aebe .SetFillOpacity (_deff );_aebe .SetBorderWidth (_bbg );if _ecagd !=nil {_aebe .SetBorderColor (_ecagd );_aebe .SetBorderOpacity (_bafe );};_badd =append (_badd ,_aebe );};};};};if _cafb :=_dfb .GeometryChoice .PrstGeom ;_cafb !=nil {switch _cafb .PrstAttr {case _gg .ST_ShapeTypeRect :if _dfba !=nil {_bdd :=_add .getShapeFromBlipFill (_dfba ,_gba ,_gab ,_cfcd ,_aae ,false );
_badd =append (_badd ,_bdd );}else {_dee :=_add ._dedd .NewRectangle (_gba ,_gab ,_cfcd ,_aae );_cffa :=_acd !=nil &&_deff > 0;if _cffa {_dee .SetFillColor (_acd );_dee .SetFillOpacity (_deff );};_geb :=_ecagd !=nil &&_bafe > 0&&_bbg > 0;if _geb {_dee .SetBorderWidth (_bbg );
_dee .SetBorderColor (_ecagd );_dee .SetBorderOpacity (_bafe );};if _cffa ||_geb {_badd =append (_badd ,_dee );};};case _gg .ST_ShapeTypeLine :_aca :=_add ._dedd .NewLine (_gba ,_gab ,_gba +_cfcd ,_gab +_aae );_aca .SetLineWidth (_bbg );if _ecagd !=nil {_aca .SetColor (_ecagd );
};_badd =append (_badd ,_aca );};};return _badd ,_gba ,_gab ,_cfcd ,_aae ,_fac ,_bac ;};type prefixData struct{_gbcb string ;_dcb bool ;_egff float64 ;_bbga float64 ;};func (_gf *convertContext )addShapes (_bfb *_ce .CT_CommonSlideData ,_ddc bool ){if _bfb ==nil {return ;
};_ccc :=&background {};if _edf :=_bfb .Bg ;_edf !=nil {if _fb :=_edf .BackgroundChoice .BgPr ;_fb !=nil {if _fb .FillPropertiesChoice .NoFill ==nil {if _cdd :=_fb .FillPropertiesChoice .SolidFill ;_cdd !=nil {_cg ,_df :=_gf .getColorFromSolidFill (_cdd );
if _cg !=nil {_ccc ._ebcg =_cg ;_ccc ._gbg =_df ;};}else if _efg :=_fb .FillPropertiesChoice .BlipFill ;_efg !=nil {_ccc ._aace =_efg ;};};};};_gf ._fef =_ccc ;if _fdd :=_bfb .SpTree ;_fdd !=nil {for _ ,_af :=range _fdd .GroupShapeChoice {if _af !=nil {if _af .Sp !=nil {_ebf :=_gf .getShapes (_af .Sp ,_ddc ,false );
_gf ._ccdd =append (_gf ._ccdd ,_ebf ...);};if _af .GraphicFrame !=nil {var _acb ,_ae ,_ecd ,_aadg float64 ;if _edd :=_af .GraphicFrame .Xfrm ;_edd !=nil {_acb ,_ae ,_ecd ,_aadg =_d .GetDataFromXfrm (_edd );};if _ecd ==0&&_aadg ==0{_ecd =_gf ._bfcac ;_aadg =_gf ._dcd ;
};if _ccb :=_af .GraphicFrame .Graphic ;_ccb !=nil {if _dbb :=_ccb .GraphicData ;_dbb !=nil {for _ ,_fgf :=range _dbb .Any {if _bgd ,_ca :=_fgf .(*_f .Chart );_ca {_dc ,_dad :=_gf .makePdfBlockFromChart (_bgd ,_ecd ,_aadg );if _dad !=nil {_ege .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_dad );
};if _dc !=nil {_dc .SetPos (_acb ,_ae );_gf ._ccdd =append (_gf ._ccdd ,_dc );};}else if _aee ,_acg :=_fgf .(*_gg .Tbl );_acg {_ccbf :=_gf .makePdfBlockFromTable (_aee );if _ccbf !=nil {_bfbg :=_cbc .NewBlock (_ecd ,_aadg );_bfbg .SetPos (_acb ,_ae );
_dca :=_bfbg .Draw (_ccbf );if _dca !=nil {_ege .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0064r\u0061\u0077\u0020\u0074\u0061b\u006c\u0065\u003a\u0020\u0025\u0073",_dca );if _dca ==_cbc .ErrContentNotFit {_bfbg =_cbc .NewBlock (_gf ._bfcac -1.5*_acb ,_gf ._dcd -1.5*_ae );
_bfbg .SetPos (_acb ,_ae );_dca =_bfbg .Draw (_ccbf );};};if _dca ==nil {_gf ._ccdd =append (_gf ._ccdd ,_bfbg );};};};};};};};if _af .CxnSp !=nil {_fe :=_gf .getConnectors (_af .CxnSp );_gf ._ccdd =append (_gf ._ccdd ,_fe ...);};if _af .GrpSp !=nil {_bab :=0.0;
_agb :=0.0;if _bgc :=_af .GrpSp .GrpSpPr .Xfrm ;_bgc !=nil {_bab ,_agb =_d .GetGroupOffsetFromXfrm (_bgc );};for _ ,_egb :=range _af .GrpSp .GroupShapeChoice {if _egb .CxnSp !=nil {_ade :=_gf .getGroupConnectors (_egb .CxnSp ,_bab ,_agb );_gf ._ccdd =append (_gf ._ccdd ,_ade ...);
};};};if _af .Pic !=nil {_bga :=false ;var _cbd ,_efga ,_def ,_bbc float64 ;if _dba :=_af .Pic .SpPr ;_dba !=nil {if _fdda :=_dba .Xfrm ;_fdda !=nil {_cbd ,_efga ,_def ,_bbc =_d .GetDataFromXfrm (_fdda );_bga =true ;};};var _dfc _ce .ST_PlaceholderType ;
var _eca *uint32 ;if _cfa :=_af .Pic .NvPicPr ;_cfa !=nil {if _cad :=_cfa .NvPr ;_cad !=nil {if _fed :=_cad .Ph ;_fed !=nil {_dfc =_fed .TypeAttr ;_eca =_fed .IdxAttr ;};};};_dgbe ,_ ,_ ,_ ,_ :=_ffab (_gf ._cgfd .CSld ,_dfc ,_eca );_ccg ,_ ,_ ,_ ,_ :=_ffab (_gf ._ccf .CSld ,_dfc ,_eca );
if _ccg ==nil {_ccg =_dgbe ;};if _ccg !=nil &&!_bga {_cbd ,_efga ,_def ,_bbc =_d .GetDataFromXfrm (_ccg );};if _ff :=_af .Pic .BlipFill ;_ff !=nil {_eed :=_gf .getShapeFromBlipFill (_ff ,_cbd ,_efga ,_def ,_bbc ,_ddc );_gf ._ccdd =append (_gf ._ccdd ,_eed );
};};};};};};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func (_ecg *convertContext )makeStyleFromRPr (_gdfc *_gg .CT_TextCharacterProperties )(*_cbc .TextStyle ,bool ,bool ,bool ){var _aff ,_fcdb ,_cdg bool ;
_adcc :=_ecg ._dedd .NewTextStyle ();if _gdfc !=nil {_gcb :=_d .FontStyle_Regular ;_beb :=_fcfc (_gdfc .BAttr );_bbgc :=_fcfc (_gdfc .IAttr );if _beb &&_bbgc {_gcb =_d .FontStyle_BoldItalic ;}else if _beb {_gcb =_d .FontStyle_Bold ;}else if _bbgc {_gcb =_d .FontStyle_Italic ;
};_cdg =_gdfc .UAttr !=_gg .ST_TextUnderlineTypeUnset &&_gdfc .UAttr !=_gg .ST_TextUnderlineTypeNone ;_agfc :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _agg :=_gdfc .Latin ;_agg !=nil {_agfc =_agg .TypefaceAttr ;}else if _cba :=_gdfc .Ea ;_cba !=nil {_agfc =_cba .TypefaceAttr ;
}else if _fdf :=_gdfc .Cs ;_fdf !=nil {_agfc =_fdf .TypefaceAttr ;}else if _bgg :=_gdfc .Sym ;_bgg !=nil {_agfc =_bgg .TypefaceAttr ;};if _bde ,_agcf :=_d .StdFontsMap [_agfc ];_agcf {_adcc .Font =_d .AssignStdFontByName (_adcc ,_bde [_gcb ]);}else if _egfd :=_d .GetRegisteredFont (_agfc ,_gcb );
_egfd !=nil {_adcc .Font =_egfd ;}else {_ege .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_agfc ,_gcb );
_adcc .Font =_d .AssignStdFontByName (_adcc ,_d .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_gcb ]);};var _aceg float64 ;if _baefc :=_gdfc .SzAttr ;_baefc !=nil {_aceg =_a .Round (float64 (*_baefc )/100)-0.5;}else {_aceg =_d .DefaultFontSize ;
};if _ebdac :=_gdfc .BaselineAttr ;_ebdac !=nil {if _gdaa :=_ebdac .ST_PercentageDecimal ;_gdaa !=nil {if *_gdaa > 0{_aff =true ;}else if *_gdaa < 0{_fcdb =true ;};};};if _aff ||_fcdb {_aceg =_a .Round (_aceg *0.64);};_adcc .FontSize =_aceg ;_ebdb :=0.0;
if _beeb :=_gdfc .SpcAttr ;_beeb !=nil {if _bgag :=_beeb .ST_TextPointUnqualified ;_bgag !=nil &&*_bgag > 0{_ebdb =float64 (*_bgag )/100;};};_adcc .CharSpacing =_ebdb ;};return &_adcc ,_aff ,_fcdb ,_cdg ;};func (_gfaf *textboxContext )drawParagraphs (){_gfaf ._dggc .NewPage ();
for _ ,_bgaf :=range _gfaf ._fga {for _ ,_aacg :=range _bgaf ._acdg {for _ ,_gega :=range _aacg ._baag {for _ ,_eacc :=range _gega ._dfec {_cffb :=_gfaf ._dggc .NewStyledParagraph ();if _eacc ._dafa {_eacc ._gcg =0;}else if _eacc ._fgb {_eacc ._gcg =1.2*_aacg ._efab -_eacc ._dgbd ;
};_ceg :=_gega ._dde +_eacc ._ffbe ;_dafb :=_bgaf ._eag +_aacg ._bbf +_eacc ._gcg ;_cffb .SetPos (_ceg ,_dafb );_cdaf :=_cffb .Append (_eacc ._gaf );if _eacc ._dae !=nil {_cdaf .Style =*_eacc ._dae ;};_gfaf ._dggc .Draw (_cffb );if _eacc ._ffce {_gddc :=_dafb +_eacc ._dgbd +2;
_d .DrawLine (_gfaf ._dggc ,_ceg ,_gddc ,_ceg +_eacc ._aced ,_gddc ,1,_eacc ._dae .Color );};};};};};};func (_ebg *convertContext )tileImage (_bfa *_cbc .Image ,_fae *_gg .CT_TileInfoProperties ,_bc ,_bae float64 )*_cbc .Image {_be ,_aeb :=1.0,1.0;if _fgc :=_fae .SxAttr ;
_fgc !=nil {_be =_d .FromSTPercentage (_fgc );};if _dbg :=_fae .SyAttr ;_dbg !=nil {_aeb =_d .FromSTPercentage (_dbg );};_fcb :=_d .MakeTempCreator (_bc ,_bae );_bfa .Scale (_be ,_aeb );_daf ,_fgg :=_bfa .Width (),_bfa .Height ();var _gfa ,_eec float64 ;
if _fda :=_fae .TxAttr ;_fda !=nil {_gfa =_aa .FromEMU (_d .FromSTCoordinate (*_fda ));};if _bdcb :=_fae .TyAttr ;_bdcb !=nil {_eec =_aa .FromEMU (_d .FromSTCoordinate (*_bdcb ));};if _gfa > 0{_gfa -=_daf ;};if _eec > 0{_eec -=_fgg ;};_egf :=_ebg ._bfcac /_daf +1;
_ceea :=_ebg ._dcd /_fgg +1;for _fbf :=0.0;_fbf <=_egf ;_fbf ++{_fde :=_fbf *_daf ;for _ecag :=0.0;_ecag <=_ceea ;_ecag ++{_fce :=_ecag *_fgg ;_bfa .SetPos (_fde +_gfa ,_fce +_eec );_fcb .Draw (_bfa );};};_abc ,_bfg :=_d .GetPageFromCreator (_fcb );if _bfg !=nil {_ege .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_bfg );
return nil ;};_fcbg ,_bfg :=_cfe .NewImageDevice ().Render (_abc );if _bfg !=nil {_ege .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_bfg );return nil ;};
_adc ,_bfg :=_ebg ._dedd .NewImageFromGoImage (_fcbg );if _bfg !=nil {_ege .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_bfg );
return nil ;};return _adc ;};func _eebf (_gceb ,_cebdf *_gg .CT_TextParagraphProperties )*_gg .CT_TextParagraphProperties {_fdcd :=_gg .NewCT_TextParagraphProperties ();if _gceb !=nil {*_fdcd =*_gceb ;};if _cebdf ==nil {return _fdcd ;};if _fdcd .MarLAttr ==nil {_fdcd .MarLAttr =_cebdf .MarLAttr ;
};if _fdcd .MarRAttr ==nil {_fdcd .MarRAttr =_cebdf .MarRAttr ;};if _fdcd .LvlAttr ==nil {_fdcd .LvlAttr =_cebdf .LvlAttr ;};if _fdcd .IndentAttr ==nil {_fdcd .IndentAttr =_cebdf .IndentAttr ;};if _fdcd .AlgnAttr ==_gg .ST_TextAlignTypeUnset {_fdcd .AlgnAttr =_cebdf .AlgnAttr ;
};if _fdcd .DefTabSzAttr ==nil {_fdcd .DefTabSzAttr =_cebdf .DefTabSzAttr ;};if _fdcd .RtlAttr ==nil {_fdcd .RtlAttr =_cebdf .RtlAttr ;};if _fdcd .EaLnBrkAttr ==nil {_fdcd .EaLnBrkAttr =_cebdf .EaLnBrkAttr ;};if _fdcd .FontAlgnAttr ==_gg .ST_TextFontAlignTypeUnset {_fdcd .FontAlgnAttr =_cebdf .FontAlgnAttr ;
};if _fdcd .LatinLnBrkAttr ==nil {_fdcd .LatinLnBrkAttr =_cebdf .LatinLnBrkAttr ;};if _fdcd .HangingPunctAttr ==nil {_fdcd .HangingPunctAttr =_cebdf .HangingPunctAttr ;};if _fdcd .LnSpc ==nil {_fdcd .LnSpc =_cebdf .LnSpc ;};if _fdcd .SpcBef ==nil {_fdcd .SpcBef =_cebdf .SpcBef ;
};if _fdcd .SpcAft ==nil {_fdcd .SpcAft =_cebdf .SpcAft ;};if _fdcd .TextBulletColorChoice .BuClrTx ==nil {_fdcd .TextBulletColorChoice .BuClrTx =_cebdf .TextBulletColorChoice .BuClrTx ;};if _fdcd .TextBulletColorChoice .BuClr ==nil {_fdcd .TextBulletColorChoice .BuClr =_cebdf .TextBulletColorChoice .BuClr ;
};if _fdcd .TextBulletSizeChoice .BuSzTx ==nil {_fdcd .TextBulletSizeChoice .BuSzTx =_cebdf .TextBulletSizeChoice .BuSzTx ;};if _fdcd .TextBulletSizeChoice .BuSzPct ==nil {_fdcd .TextBulletSizeChoice .BuSzPct =_cebdf .TextBulletSizeChoice .BuSzPct ;};if _fdcd .TextBulletSizeChoice .BuSzPts ==nil {_fdcd .TextBulletSizeChoice .BuSzPts =_cebdf .TextBulletSizeChoice .BuSzPts ;
};if _fdcd .TextBulletTypefaceChoice .BuFontTx ==nil {_fdcd .TextBulletTypefaceChoice .BuFontTx =_cebdf .TextBulletTypefaceChoice .BuFontTx ;};if _fdcd .TextBulletTypefaceChoice .BuFont ==nil {_fdcd .TextBulletTypefaceChoice .BuFont =_cebdf .TextBulletTypefaceChoice .BuFont ;
};if _fdcd .TextBulletChoice .BuNone ==nil {_fdcd .TextBulletChoice .BuNone =_cebdf .TextBulletChoice .BuNone ;};if _fdcd .TextBulletChoice .BuAutoNum ==nil {_fdcd .TextBulletChoice .BuAutoNum =_cebdf .TextBulletChoice .BuAutoNum ;};if _fdcd .TextBulletChoice .BuChar ==nil {_fdcd .TextBulletChoice .BuChar =_cebdf .TextBulletChoice .BuChar ;
};if _fdcd .TextBulletChoice .BuBlip ==nil {_fdcd .TextBulletChoice .BuBlip =_cebdf .TextBulletChoice .BuBlip ;};if _fdcd .TabLst ==nil {_fdcd .TabLst =_cebdf .TabLst ;};if _fdcd .ExtLst ==nil {_fdcd .ExtLst =_cebdf .ExtLst ;};_fdcd .DefRPr =_egdf (_fdcd .DefRPr ,_cebdf .DefRPr );
return _fdcd ;};

// ConvertToPdfWithOptions convert a presentation to PDF with given options.
func ConvertToPdfWithOptions (pr *_ac .Presentation ,opts *Options )*_cbc .Creator {_gad :=pr .X ().SldSz ;_aad :=_aa .FromEMU (int64 (_gad .CxAttr ));_gb :=_aa .FromEMU (int64 (_gad .CyAttr ));_fc :=_cbc .PageSize {_aad ,_gb };if (_fc ==_cbc .PageSize {}){_fc =_d .GetDefaultPageSize ();
if opts !=nil &&opts .DefaultPageSize !=_d .DefaultPageSize {_fc =_d .GetPageDimensions (opts .DefaultPageSize );};};_dd :=_cbc .New ();_dd .SetPageSize (_fc );var _cbb *_gg .Theme ;if len (pr .Themes ())> 0{_cbb =pr .Themes ()[0];};for _ ,_deg :=range pr .Slides (){if _deg .X ()==nil {continue ;
};_efd :=&convertContext {_dedd :_dd ,_fade :&_deg ,_ccf :_deg .GetSlideLayout (),_cgfd :pr .SlideMasters ()[0].X (),_bdeb :pr ,_bgca :_cbb ,_bfe :_deg .X ().ClrMapOvr ,_dcd :_fc [1],_bfcac :_fc [0]};_efd .extractDefaultProperties ();_efd .makeSlide ();
_efd .drawSlide ();};return _dd ;};func (_ggde *convertContext )getInfoFromLn (_fcbf *_gg .CT_LineProperties )(_cbc .Color ,float64 ,float64 ){if _fcbf ==nil ||_fcbf .LineFillPropertiesChoice .NoFill !=nil {return nil ,0,0;};var _adaf float64 ;_fdab ,_gebg :=_ggde .getColorFromSolidFill (_fcbf .LineFillPropertiesChoice .SolidFill );
if _cfab :=_fcbf .WAttr ;_cfab !=nil {_adaf =_aa .FromEMU (int64 (*_cfab ));}else {_adaf =1;};return _fdab ,_adaf ,_gebg ;};func (_cbde *textboxContext )addPrefix (_eea *prefixData ,_eecc *_cbc .TextStyle ){_ged :=_bgbg (_eea ._gbcb );_aedd :=*_eecc ;if _eea ._dcb {_aedd .Font =_d .AssignStdFontByName (_aedd ,"\u0053\u0079\u006d\u0062\u006f\u006c");
};for _ ,_dadg :=range _ged {_dadg ._dae =&_aedd ;_cbde .addTextSymbol (_dadg );};_ffbc :=-(_eea ._bbga +_cbde ._gbf ._bbfd );if _ffbc < 0{_ffbc =0;};_aec :=&symbol {_gaf :"\u0020",_aced :_ffbc };_cbde .addTextSymbol (_aec );_cbde ._gbf ._dde +=(_eea ._bbga +_eea ._egff );
};func (_afeb *convertContext )makePdfImageFromBlipFill (_fgae *_gg .CT_BlipFillProperties ,_gbbb bool )(*_cbc .Image ,[]*_gg .CT_BlipChoice ,error ){if _cgdf :=_fgae .Blip ;_cgdf !=nil {if _fcga :=_cgdf .EmbedAttr ;_fcga !=nil {var _defda _dg .ImageRef ;
var _addb bool ;if _gbbb {_defda ,_addb =_afeb ._fade .GetLayoutImageByRelID (*_fcga );}else {_defda ,_addb =_afeb ._fade .GetImageByRelID (*_fcga );};if _addb {_geda ,_eeb :=_bb .Open (_defda .Path ());if _eeb !=nil {_ege .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_eeb );
return nil ,nil ,_eeb ;};defer _geda .Close ();_abcf ,_ ,_eeb :=_b .Decode (_geda );if _eeb !=nil {_ege .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_eeb );return nil ,nil ,_eeb ;
};if _fbee :=_fgae .SrcRect ;_fbee !=nil {_ggge :=_abcf .Bounds ().Size ();_bfdb :=_ggge .X ;_bgba :=_ggge .Y ;var _ebdg ,_bed ,_fdad ,_cfca int ;var _fggf bool ;if _ddcfe :=_fbee .LAttr ;_ddcfe !=nil {_ebdg =int (float64 (_bfdb )*_d .FromSTPercentage (_ddcfe ));
_fggf =true ;}else {_ebdg =0;};if _edgf :=_fbee .TAttr ;_edgf !=nil {_fdad =int (float64 (_bgba )*_d .FromSTPercentage (_edgf ));_fggf =true ;}else {_fdad =0;};if _ffcg :=_fbee .RAttr ;_ffcg !=nil {_bed =int (float64 (_bfdb )*(1-_d .FromSTPercentage (_ffcg )));
_fggf =true ;}else {_bed =_bfdb ;};if _gbfb :=_fbee .BAttr ;_gbfb !=nil {_cfca =int (float64 (_bgba )*(1-_d .FromSTPercentage (_gbfb )));_fggf =true ;}else {_cfca =_bgba ;};if _fggf {_abcf =_d .CropImageByRect (_abcf ,_b .Rect (_ebdg ,_fdad ,_bed +1,_cfca +1));
};};_aedb ,_eeb :=_afeb ._dedd .NewImageFromGoImage (_abcf );_aedb .SetEncoder (_cf .NewFlateEncoder ());if _cb .ToLower (_defda .Format ())=="\u006a\u0070\u0067"||_cb .ToLower (_defda .Format ())=="\u006a\u0070\u0065\u0067"{_aedb .SetEncoder (_cf .NewDCTEncoder ());
};if _eeb !=nil {_ege .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_eeb );
return nil ,nil ,_eeb ;};return _aedb ,_cgdf .BlipChoice ,nil ;};};};return nil ,nil ,nil ;};func (_gadd *convertContext )stretchImage (_bbd *_cbc .Image ,_bee *_gg .CT_StretchInfoProperties ,_dcf ,_ggd ,_gbb ,_ecf float64 )(*_cbc .Image ,float64 ,float64 ){_dcfe :=_bee .FillRect ;
if _dcfe ==nil {_cbbg :=_bbd .Width ()/_bbd .Height ();_bag :=_gbb /_ecf ;var _fff ,_gbe float64 ;if _cbbg > _bag {_gbe =_ecf ;_fff =_ecf *_cbbg ;}else {_fff =_gbb ;_gbe =_gbb /_cbbg ;};_bbd .Scale (_fff /_bbd .Width (),_gbe /_bbd .Height ());return _bbd ,_dcf ,_ggd ;
};var _efe ,_bfaf ,_dgbc ,_cafe float64 ;if _gadf :=_dcfe .LAttr ;_gadf !=nil {_dgbc =_d .FromSTPercentage (_gadf );};if _efb :=_dcfe .TAttr ;_efb !=nil {_efe =_d .FromSTPercentage (_efb );};if _gde :=_dcfe .RAttr ;_gde !=nil {_cafe =_d .FromSTPercentage (_gde );
};if _baf :=_dcfe .BAttr ;_baf !=nil {_bfaf =_d .FromSTPercentage (_baf );};_efbd :=_gbb *(1-_dgbc -_cafe );_afc :=_ecf *(1-_efe -_bfaf );_bbd .Scale (_efbd /_bbd .Width (),_afc /_bbd .Height ());return _bbd ,_dcf +_dgbc *_gbb ,_ggd +_efe *_ecf ;};func (_gfcc *convertContext )applyBlipEffectsOnImg (_cabf *_cbc .Image ,_caed ,_cdaa float64 ,_fgfab []*_gg .CT_BlipChoice )*_cbc .Image {if len (_fgfab )==0{return _cabf ;
};_cabf .SetPos (_caed ,_cdaa );_ecaa ,_faba :=_gfcc .renderPageWithDrawableToGoImage (_cabf );if _faba !=nil {_ege .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_faba );
return _cabf ;};_ccef ,_faba :=_gfcc .renderCurrentStateToGoImage ();if _faba !=nil {_ege .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_faba );
return _cabf ;};_gccc :=_ecaa .Bounds ();_gebc :=_b .NewRGBA (_gccc );_ebcb ,_ecbg :=_cabf .Width (),_cabf .Height ();for _ ,_gaeg :=range _fgfab {if _bbab :=_gaeg .AlphaModFix ;_bbab ==nil {continue ;};if _cege :=_gaeg .AlphaModFix .AmtAttr ;_cege !=nil {if _fgda :=_cege .ST_PositivePercentageDecimal ;
_fgda !=nil {_bgagb :=uint8 (255*(*_fgda )/100000);_bfce :=_b .NewUniform (_eb .Alpha {_bgagb });_eg .Draw (_gebc ,_gccc ,_ccef ,_b .Point {0,0},_eg .Src );_eg .DrawMask (_gebc ,_gccc ,_ecaa ,_b .Point {0,0},_bfce ,_b .Point {0,0},_eg .Over );};};};_daff :=_b .Rect (int (_caed ),int (_cdaa ),int (_caed +_ebcb )+1,int (_cdaa +_ecbg )+1);
_bfed :=_d .CropImageByRect (_gebc ,_daff );_bedg ,_faba :=_gfcc ._dedd .NewImageFromGoImage (_bfed );if _faba !=nil {_ege .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_faba );
return _cabf ;};return _bedg ;};type paragraph struct{_eacbc float64 ;_fca float64 ;_aaca float64 ;_egfc float64 ;_abe float64 ;_bff float64 ;_eag float64 ;_bgaa float64 ;_ebaf _gg .ST_TextAlignType ;_ddga float64 ;_bdb bool ;_acdg []*line ;};func _fcdbe (_dcgd *_gg .CT_TableCellProperties ,_acfd *_gg .CT_TableStyleCellStyle ,_cafc ,_dgbcf ,_dfgb ,_ggdf bool )*_gg .CT_TableCellProperties {_bggf :=_gg .NewCT_TableCellProperties ();
if _dcgd !=nil {*_bggf =*_dcgd ;};if _acfd ==nil {return _bggf ;};if _acdc :=_acfd .ThemeableFillStyleChoice .FillRef ;_acdc !=nil {_cfac :=_gg .NewCT_SolidColorFillProperties ();_cfac .ScrgbClr =_acdc .ScrgbClr ;_cfac .SrgbClr =_acdc .SrgbClr ;_cfac .HslClr =_acdc .HslClr ;
_cfac .SysClr =_acdc .SysClr ;_cfac .SchemeClr =_acdc .SchemeClr ;_cfac .PrstClr =_acdc .PrstClr ;_bggf .FillPropertiesChoice .SolidFill =_cfac ;};if _bggf .FillPropertiesChoice .NoFill ==nil &&_bggf .FillPropertiesChoice .SolidFill ==nil {if _agbea :=_acfd .ThemeableFillStyleChoice .Fill ;
_agbea !=nil {if _bggf .FillPropertiesChoice .NoFill ==nil {_bggf .FillPropertiesChoice .NoFill =_agbea .FillPropertiesChoice .NoFill ;};if _bggf .FillPropertiesChoice .SolidFill ==nil {_bggf .FillPropertiesChoice .SolidFill =_agbea .FillPropertiesChoice .SolidFill ;
};};};if _ccdc :=_acfd .TcBdr ;_ccdc !=nil {if _bggf .LnL ==nil {var _degb *_gg .CT_ThemeableLineStyle ;if _dfgb {_degb =_ccdc .Left ;}else {_degb =_ccdc .InsideV ;};if _degb !=nil {_bggf .LnL =_degb .ThemeableLineStyleChoice .Ln ;};};if _bggf .LnR ==nil {var _bega *_gg .CT_ThemeableLineStyle ;
if _ggdf {_bega =_ccdc .Right ;}else {_bega =_ccdc .InsideV ;};if _bega !=nil {_bggf .LnR =_bega .ThemeableLineStyleChoice .Ln ;};};if _bggf .LnT ==nil {var _bdfa *_gg .CT_ThemeableLineStyle ;if _cafc {_bdfa =_ccdc .Top ;}else {_bdfa =_ccdc .InsideH ;};
if _bdfa !=nil {_bggf .LnT =_bdfa .ThemeableLineStyleChoice .Ln ;};};if _bggf .LnB ==nil {var _cgdd *_gg .CT_ThemeableLineStyle ;if _dgbcf {_cgdd =_ccdc .Bottom ;}else {_cgdd =_ccdc .InsideH ;};if _cgdd !=nil {_bggf .LnB =_cgdd .ThemeableLineStyleChoice .Ln ;
};};};return _bggf ;};func (_afcff *textboxContext )adjustHeights (_ddae float64 ){if _afcff ._bafea ._efab < _ddae {_afcff ._bcgb ._bgaa +=(_ddae -_afcff ._bafea ._efab );_afcff ._bafea ._efab =_ddae ;};};func (_eff *convertContext )makeSlide (){_eef :=_eff ._fade .GetSlideLayout ().CSld ;
_eff .addShapes (_eef ,true );_eef =_eff ._fade .X ().CSld ;_eff .addShapes (_eef ,false );};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_d .FontStyle ;func (_dec *textboxContext )newParagraph (){_afd :=&paragraph {};_afd ._eag =_dec ._fccc ;_dec ._bcgb =_afd ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_de .PdfFont ){_d .RegisterFont (name ,style ,font );};func (_bcca *textboxContext )addTextRun (_eaa *_gg .EG_TextRun ,_dded *_gg .CT_TextCharacterProperties ,_face _cbc .Color ,_dddc *prefixData ){if _gdd :=_eaa .TextRunChoice .Br ;
_gdd !=nil {_bcca .addCurrentWordToParagraph ();_bcca .newLine ();_bcca .newWord ();}else if _ffaf :=_eaa .TextRunChoice .R ;_ffaf !=nil {var _cfef _cbc .Color ;if _ffaf .RPr !=nil &&_ffaf .RPr .FillPropertiesChoice .SolidFill !=nil {_cfef ,_ =_bcca ._eafe .getColorFromSolidFill (_ffaf .RPr .FillPropertiesChoice .SolidFill );
}else if _face !=nil {_cfef =_face ;}else if _dded .FillPropertiesChoice .SolidFill !=nil {_cfef ,_ =_bcca ._eafe .getColorFromSolidFill (_dded .FillPropertiesChoice .SolidFill );}else {_cfef =_cbc .ColorBlack ;};_cgfg :=_egdf (_ffaf .RPr ,_dded );_fggc ,_gcfc ,_deea ,_bgaac :=_bcca ._eafe .makeStyleFromRPr (_cgfg );
_fggc .Color =_cfef ;if _dddc !=nil {_bcca .addPrefix (_dddc ,_fggc );};_dda :=_bgbg (_ffaf .T );for _ ,_agba :=range _dda {_agba ._dae =_fggc ;_agba ._dafa =_gcfc ;_agba ._fgb =_deea ;_agba ._ffce =_bgaac ;if _cgfg .CapAttr ==_gg .ST_TextCapsTypeAll {_agba ._gaf =_cb .ToUpper (_agba ._gaf );
};_bcca .addTextSymbol (_agba );};};};func _bgbg (_deeb string )[]*symbol {_dbfb :=[]*symbol {};for _ ,_edb :=range _deeb {_dbfb =append (_dbfb ,&symbol {_gaf :string (_edb )});};return _dbfb ;};func (_cbcg *textboxContext )assignPropsToCurrentParagraph (_ede *_gg .CT_TextParagraphProperties ){_dgge :=12.4;
if _ede ==nil {_cbcg ._bcgb ._ddga =_dgge ;return ;};if _adae :=_ede .DefRPr ;_adae !=nil {_dfbb :=_adae .SzAttr ;if _dfbb !=nil {_ebac :=float64 (*_dfbb )/1200;if _dgge <=_ebac {_dgge =_ebac ;};};};if _dgbeg :=_ede .MarLAttr ;_dgbeg !=nil {_cbcg ._bcgb ._abe =_aa .FromEMU (int64 (*_dgbeg ));
};_cbcg ._bcgb ._bff =_cbcg ._dagd ;if _fadec :=_ede .MarRAttr ;_fadec !=nil {_cbcg ._bcgb ._bff -=_aa .FromEMU (int64 (*_fadec ));};if _cadb :=_ede .IndentAttr ;_cadb !=nil {_cbcg ._bcgb ._egfc =_aa .FromEMU (int64 (*_cadb ));};if _edc :=_ede .LatinLnBrkAttr ;
_edc !=nil {_cbcg ._bcgb ._bdb =*_edc ;};if _dgggc :=_ede .LnSpc ;_dgggc !=nil &&_dgggc .TextSpacingChoice !=nil {if _beeg :=_dgggc .TextSpacingChoice .SpcPct ;_beeg !=nil {if _ddcf :=_beeg .ValAttr .ST_TextSpacingPercent ;_ddcf !=nil {_dgge =float64 (*_ddcf )/5000;
};};};var _agag float64 ;if _gbgd :=_ede .SpcBef ;_gbgd !=nil &&_gbgd .TextSpacingChoice !=nil {if _cfb :=_gbgd .TextSpacingChoice .SpcPts ;_cfb !=nil {_agag =float64 (_cfb .ValAttr )/100;};};_bfbb :=_cbcg ._fga ;if len (_bfbb )> 0{_agag -=_bfbb [len (_bfbb )-1]._aaca ;
if _agag < 0{_agag =0;};};_cbcg ._bcgb ._fca =_agag ;if _adac :=_ede .SpcAft ;_adac !=nil &&_adac .TextSpacingChoice !=nil {if _acba :=_adac .TextSpacingChoice .SpcPts ;_acba !=nil {_cbcg ._bcgb ._aaca =float64 (_acba .ValAttr )/100;};};_cbcg ._bcgb ._ddga =_dgge ;
_cbcg ._bcgb ._ebaf =_ede .AlgnAttr ;};func _dfee (_ceba float64 )float64 {return _ceba *_aa .Millimeter };

// Options contains the options for convert process
type Options struct{

// DefaultPageSize is applied when there is no page size explicitly set in the document.
// A4 is the default option.
DefaultPageSize _d .PageSize ;};func (_afbd *convertContext )getColorFromMatrixReference (_agbe *_gg .CT_StyleMatrixReference )_cbc .Color {if _agbe ==nil {return nil ;};var _eaga _cbc .Color ;var _fbca string ;if _eddc :=_agbe .SrgbClr ;_eddc !=nil {_fbca =_eddc .ValAttr ;
}else if _afcg :=_agbe .SchemeClr ;_afcg !=nil {_fbca =_d .GetColorStringFromDmlColor (_afbd ._bdeb .GetColorBySchemeColor (_afcg .ValAttr ));_fbca =_d .AdjustColor (_fbca ,_afcg .EG_ColorTransform );};if _fbca !=""{_eaga =_cbc .ColorRGBFromHex ("\u0023"+_fbca );
};return _eaga ;};func _egd (_bcb int ,_cab bool )string {_dga :=(_bcb -1)/26+1;_ebca :=byte ((_bcb -1)%26);if _cab {_ebca +=byte (65);}else {_ebca +=byte (97);};_ceec :=_ee .NewBuffer ([]byte {});for _gace :=0;_gace < _dga ;_gace ++{_ceec .Write ([]byte {_ebca });
};return _ceec .String ();};func (_dgf *convertContext )addCellToTable (_ffcb *_cbc .Table ,_agd *_gg .CT_TableCell ,_eggb *_gg .CT_TablePartStyle ,_bcd ,_ccaf ,_ceb ,_bdde bool )float64 {var _agdb *_cbc .TableCell ;_eaf :=1;if _agd .GridSpanAttr !=nil {_eaf =int (*_agd .GridSpanAttr );
};_agdb =_ffcb .MultiColCell (_eaf );_dge :=_agd .TcPr ;var _cgbe *_gg .CT_TableStyleTextStyle ;if _eggb !=nil {_dge =_fcdbe (_dge ,_eggb .TcStyle ,_bcd ,_ccaf ,_ceb ,_bdde );_cgbe =_eggb .TcTxStyle ;};_dea :=_fa ;_afgg :=_cbc .CellVerticalAlignmentMiddle ;
_bcace :=_cge (0.05);_fdc :=_cge (0.05);if _dge !=nil {if _bebc :=_dge .LnL ;_bebc !=nil {_gce ,_gbd ,_babd :=_dgf .getBorderStyle (_bebc );_agdb .SetBorder (_cbc .CellBorderSideLeft ,_gce ,_babd );if _gbd !=nil &&*_gbd !=nil {_agdb .SetSideBorderColor (_cbc .CellBorderSideLeft ,*_gbd );
};};if _faef :=_dge .LnT ;_faef !=nil {_cdce ,_ggdc ,_gded :=_dgf .getBorderStyle (_faef );_agdb .SetBorder (_cbc .CellBorderSideTop ,_cdce ,_gded );if _ggdc !=nil &&*_ggdc !=nil {_agdb .SetSideBorderColor (_cbc .CellBorderSideTop ,*_ggdc );};};if _dbbd :=_dge .LnR ;
_dbbd !=nil {_acdf ,_efc ,_gbeg :=_dgf .getBorderStyle (_dbbd );_agdb .SetBorder (_cbc .CellBorderSideRight ,_acdf ,_gbeg );if _efc !=nil &&*_efc !=nil {_agdb .SetSideBorderColor (_cbc .CellBorderSideRight ,*_efc );};};if _baeff :=_dge .LnB ;_baeff !=nil {_dedf ,_cfeg ,_aed :=_dgf .getBorderStyle (_baeff );
_agdb .SetBorder (_cbc .CellBorderSideBottom ,_dedf ,_aed );if _cfeg !=nil &&*_cfeg !=nil {_agdb .SetSideBorderColor (_cbc .CellBorderSideBottom ,*_cfeg );};};if _ecffc :=_dge .MarLAttr ;_ecffc !=nil {_dea =float64 (_d .FromSTCoordinate32 (*_ecffc ));};
switch _dge .AnchorAttr {case _gg .ST_TextAnchoringTypeT :_afgg =_cbc .CellVerticalAlignmentTop ;case _gg .ST_TextAnchoringTypeB :_afgg =_cbc .CellVerticalAlignmentBottom ;};if _dge .FillPropertiesChoice .NoFill ==nil {if _cdag :=_dge .FillPropertiesChoice .SolidFill ;
_cdag !=nil {_bfca ,_afa :=_dgf .getColorFromSolidFill (_cdag );_agdb .SetOpacity (_afa );_agdb .SetBackgroundColor (_bfca );};};if _egac :=_dge .MarBAttr ;_egac !=nil {_bcace =float64 (_d .FromSTCoordinate32 (*_egac ));};if _ggf :=_dge .MarTAttr ;_ggf !=nil {_fdc =float64 (_d .FromSTCoordinate32 (*_ggf ));
};};_agdb .SetVerticalAlignment (_afgg );_agdb .SetIndent (_dea );var _cfcdg float64 ;if _gabc :=_agd .TxBody ;_gabc !=nil {_dggg :=_dgf .makePdfDivisionFromTxBody (_gabc ,_cgbe );_cfcdg =_dggg .Height ()+_fdc +_bcace ;_agdb .SetContent (_dggg );};return _cfcdg ;
};func _gbgf (_dbeg *_gg .CT_AdjPoint2D )(float64 ,float64 ){var _facf ,_eaccd float64 ;_eee ,_dafaa :=_dbeg .XAttr ,_dbeg .YAttr ;if _ffgd :=_eee .ST_Coordinate ;_ffgd !=nil {_facf =_aa .FromEMU (_d .FromSTCoordinate (*_ffgd ));};if _becf :=_dafaa .ST_Coordinate ;
_becf !=nil {_eaccd =_aa .FromEMU (_d .FromSTCoordinate (*_becf ));};return _facf ,_eaccd ;};func _baba (_cgfa ,_efabb *_gg .CT_TextBodyProperties )*_gg .CT_TextBodyProperties {_afdf :=_gg .NewCT_TextBodyProperties ();if _cgfa !=nil {*_afdf =*_cgfa ;};
if _efabb ==nil {return _afdf ;};if _afdf .RotAttr ==nil {_afdf .RotAttr =_efabb .RotAttr ;};if _afdf .SpcFirstLastParaAttr ==nil {_afdf .SpcFirstLastParaAttr =_efabb .SpcFirstLastParaAttr ;};if _afdf .VertOverflowAttr ==_gg .ST_TextVertOverflowTypeUnset {_afdf .VertOverflowAttr =_efabb .VertOverflowAttr ;
};if _afdf .HorzOverflowAttr ==_gg .ST_TextHorzOverflowTypeUnset {_afdf .HorzOverflowAttr =_efabb .HorzOverflowAttr ;};if _afdf .VertAttr ==_gg .ST_TextVerticalTypeUnset {_afdf .VertAttr =_efabb .VertAttr ;};if _afdf .WrapAttr ==_gg .ST_TextWrappingTypeUnset {_afdf .WrapAttr =_efabb .WrapAttr ;
};if _afdf .LInsAttr ==nil {_afdf .LInsAttr =_efabb .LInsAttr ;};if _afdf .TInsAttr ==nil {_afdf .TInsAttr =_efabb .TInsAttr ;};if _afdf .RInsAttr ==nil {_afdf .RInsAttr =_efabb .RInsAttr ;};if _afdf .BInsAttr ==nil {_afdf .BInsAttr =_efabb .BInsAttr ;
};if _afdf .NumColAttr ==nil {_afdf .NumColAttr =_efabb .NumColAttr ;};if _afdf .SpcColAttr ==nil {_afdf .SpcColAttr =_efabb .SpcColAttr ;};if _afdf .RtlColAttr ==nil {_afdf .RtlColAttr =_efabb .RtlColAttr ;};if _afdf .AnchorAttr ==_gg .ST_TextAnchoringTypeUnset {_afdf .AnchorAttr =_efabb .AnchorAttr ;
};if _afdf .AnchorCtrAttr ==nil {_afdf .AnchorCtrAttr =_efabb .AnchorCtrAttr ;};if _afdf .ForceAAAttr ==nil {_afdf .ForceAAAttr =_efabb .ForceAAAttr ;};if _afdf .UprightAttr ==nil {_afdf .UprightAttr =_efabb .UprightAttr ;};if _afdf .CompatLnSpcAttr ==nil {_afdf .CompatLnSpcAttr =_efabb .CompatLnSpcAttr ;
};if _afdf .PrstTxWarp ==nil {_afdf .PrstTxWarp =_efabb .PrstTxWarp ;};if _afdf .TextAutofitChoice .NoAutofit ==nil {_afdf .TextAutofitChoice .NoAutofit =_efabb .TextAutofitChoice .NoAutofit ;};if _afdf .TextAutofitChoice .NormAutofit ==nil {_afdf .TextAutofitChoice .NormAutofit =_efabb .TextAutofitChoice .NormAutofit ;
};if _afdf .TextAutofitChoice .SpAutoFit ==nil {_afdf .TextAutofitChoice .SpAutoFit =_efabb .TextAutofitChoice .SpAutoFit ;};if _afdf .Scene3d ==nil {_afdf .Scene3d =_efabb .Scene3d ;};if _afdf .Text3DChoice .Sp3d ==nil {_afdf .Text3DChoice .Sp3d =_efabb .Text3DChoice .Sp3d ;
};if _afdf .Text3DChoice .FlatTx ==nil {_afdf .Text3DChoice .FlatTx =_efabb .Text3DChoice .FlatTx ;};if _afdf .ExtLst ==nil {_afdf .ExtLst =_efabb .ExtLst ;};return _afdf ;};func (_dcce *textboxContext )newWord (){_dcce ._gbf =&word {_dgggb :true ,_dde :_dcce ._bafea ._fge }};
func (_cgbc *textboxContext )alignParagraphsVertically (_fgga _gg .ST_TextAnchoringType ){if _fgga ==_gg .ST_TextAnchoringTypeT {return ;};_bbed :=0.0;for _ ,_faf :=range _cgbc ._fga {_bbed +=_faf ._fca +_faf ._bgaa +_faf ._aaca ;};var _gbdg float64 ;switch _fgga {case _gg .ST_TextAnchoringTypeCtr :_gbdg =(_cgbc ._fab -_bbed )/2;
case _gg .ST_TextAnchoringTypeB :_gbdg =_cgbc ._fab -_bbed ;};for _ ,_aaa :=range _cgbc ._fga {_aaa ._eag +=_gbdg ;};};func (_gege *textboxContext )addTextSymbol (_ced *symbol ){_gbaf :=_cbc .New ();_efgf :=_gbaf .NewStyledParagraph ();_efgf .SetMargins (0,0,0,0);
_fec :=_efgf .Append (_ced ._gaf );_gcdbe :=0.0;if _ced ._dae !=nil {_fec .Style =*_ced ._dae ;if _ced ._dae .CharSpacing !=0{_gcdbe =_ced ._dae .CharSpacing ;};};_ced ._dgbd =_efgf .Height ();_ced ._dfcd =_efgf .Height ()*1.2;if _ced ._aced ==0{_ced ._aced =_efgf .Width ()+_gcdbe ;
};if len (_gege ._gbf ._dfec )> 0{_bgcd :=_gege ._gbf ._dfec [len (_gege ._gbf ._dfec )-1]._gaf ;if _gege ._bcgb ._bdb ||_d .IsNoSpaceLanguage (_bgcd )||(_bgcd =="\u0020")!=(_ced ._gaf =="\u0020"){_gege .addCurrentWordToParagraph ();_gege .newWord ();};
};_gege ._gbf ._dfec =append (_gege ._gbf ._dfec ,_ced );_ced ._ffbe =_gege ._gbf ._bbfd ;_gege ._gbf ._bbfd +=_ced ._aced ;if _ced ._gaf !="\u0020"{_gege ._gbf ._dgggb =false ;};if _gege ._gbf ._bbfd >=_gege ._bcgb ._bff -_gege ._bcgb ._abe {_gege .addCurrentWordToParagraph ();
_gege .newLine ();_gege .newWord ();};};func (_aceba *textboxContext )alignVertically (_gcc _gg .ST_TextAnchoringType ){_aceba .alignParagraphsVertically (_gcc );_aceba .alignSymbolsVertically ();};func (_cdde *textboxContext )newLine (){if _cdde ._bcgb ==nil {_cdde .newParagraph ();
};_caba :=_cdde ._bcgb ._bgaa +_cdde ._bcgb ._fca ;_geea :=&line {};_geea ._ecdfg =_cdde ._bcgb ._abe ;if len (_cdde ._bcgb ._acdg )==0{_geea ._ecdfg +=_cdde ._bcgb ._egfc ;};_geea ._efca =_cdde ._bcgb ._bff ;_geea ._fge =_geea ._ecdfg ;_geea ._bbf =_caba ;
_cdde ._bcgb ._acdg =append (_cdde ._bcgb ._acdg ,_geea );_cdde ._bafea =_geea ;};type word struct{_dfec []*symbol ;_dde float64 ;_bbfd float64 ;_dgggb bool ;};func _dddb (_bdaaf ,_bdceg *_gg .CT_TablePartStyle )*_gg .CT_TablePartStyle {_cdb :=_gg .NewCT_TablePartStyle ();
if _bdaaf !=nil {*_cdb =*_bdaaf ;};if _bdceg ==nil {return _cdb ;};if _cdb .TcTxStyle ==nil {_cdb .TcTxStyle =_bdceg .TcTxStyle ;}else {_cdb .TcTxStyle =_beae (_cdb .TcTxStyle ,_bdceg .TcTxStyle );};if _cdb .TcStyle ==nil {_cdb .TcStyle =_bdceg .TcStyle ;
}else {_cdb .TcStyle =_ccdb (_cdb .TcStyle ,_bdceg .TcStyle );};return _cdb ;};var _adda =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};
func _abae (_gaba ,_dffg *_gg .CT_TextListStyle )*_gg .CT_TextListStyle {_gdeb :=_gg .NewCT_TextListStyle ();if _gaba !=nil {*_gdeb =*_gaba ;};if _dffg ==nil {return _gdeb ;};_gdeb .DefPPr =_eebf (_gdeb .DefPPr ,_dffg .DefPPr );_gdeb .Lvl1pPr =_eebf (_gdeb .Lvl1pPr ,_dffg .Lvl1pPr );
_gdeb .Lvl2pPr =_eebf (_gdeb .Lvl2pPr ,_dffg .Lvl2pPr );_gdeb .Lvl3pPr =_eebf (_gdeb .Lvl3pPr ,_dffg .Lvl3pPr );_gdeb .Lvl4pPr =_eebf (_gdeb .Lvl4pPr ,_dffg .Lvl4pPr );_gdeb .Lvl5pPr =_eebf (_gdeb .Lvl5pPr ,_dffg .Lvl5pPr );_gdeb .Lvl6pPr =_eebf (_gdeb .Lvl6pPr ,_dffg .Lvl6pPr );
_gdeb .Lvl7pPr =_eebf (_gdeb .Lvl7pPr ,_dffg .Lvl7pPr );_gdeb .Lvl8pPr =_eebf (_gdeb .Lvl8pPr ,_dffg .Lvl8pPr );_gdeb .Lvl9pPr =_eebf (_gdeb .Lvl9pPr ,_dffg .Lvl9pPr );return _gdeb ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _d .RegisterFontsFromDirectory (dirName )};func (_cbcgc *convertContext )getShapeFromBlipFill (_bea *_gg .CT_BlipFillProperties ,_aeg ,_gcdg ,_fdgf ,_bggg float64 ,_fdeb bool )_cbc .Drawable {_cade ,_ccbc ,_ccce :=_cbcgc .makePdfImageFromBlipFill (_bea ,_fdeb );
if _ccce !=nil {_ege .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_ccce );
return nil ;};if _cade ==nil {return nil ;};if _ebdf :=_bea .FillModePropertiesChoice .Tile ;_ebdf !=nil {_cade =_cbcgc .tileImage (_cade ,_bea .FillModePropertiesChoice .Tile ,_fdgf ,_bggg );};if _gfafa :=_bea .FillModePropertiesChoice .Stretch ;_gfafa !=nil {_cade ,_aeg ,_gcdg =_cbcgc .stretchImage (_cade ,_bea .FillModePropertiesChoice .Stretch ,_aeg ,_gcdg ,_fdgf ,_bggg );
};if _cade ==nil {return nil ;};if len (_ccbc )==0{_cade .SetPos (_aeg ,_gcdg );return _cade ;};_cade =_cbcgc .applyBlipEffectsOnImg (_cade ,_aeg ,_gcdg ,_ccbc );_cade .SetPos (_aeg ,_gcdg );return _cade ;};var _fa =_dfee (1.9);func (_gage *textboxContext )addCurrentWordToParagraph (){if _gage ._fgcc &&_gage ._bafea ._fge +_gage ._gbf ._bbfd > _gage ._bafea ._efca {_gage .newLine ();
};if !_gage ._gbf ._dgggb ||len (_gage ._bafea ._baag )> 0{_gage ._gbf ._dde =_gage ._bafea ._fge ;_gage ._bafea ._baag =append (_gage ._bafea ._baag ,_gage ._gbf );_gage ._bafea ._fge +=_gage ._gbf ._bbfd ;for _ ,_dcg :=range _gage ._gbf ._dfec {_gage .adjustHeights (_dcg ._dfcd );
};};};func (_dgg *convertContext )getShapes (_gda *_ce .CT_Shape ,_gae bool ,_fea bool )[]_cbc .Drawable {_efa :=[]_cbc .Drawable {};_gfd :=_gda .SpPr ;if _gfd ==nil {return _efa ;};var _dgc bool ;if _geg :=_gda .UseBgFillAttr ;_geg !=nil {_dgc =*_geg ;
};_dcc ,_dfcc ,_cbe ,_fbg ,_dag ,_eeff ,_gbed :=_dgg .getShapesFromSpPr (_gfd ,_gda .Style ,_dgc ,0.0,0.0);if !_fea {_efa =append (_efa ,_dcc ...);};if _gbba :=_gda .TxBody ;_gbba !=nil &&!_gae {_dbf ,_cfc ,_bfgf ,_cca ,_adf ,_bgb :=_dgg .getPhData (_gda );
if _fea &&!(_cca ||_adf ){return _efa ;};if _dbf !=nil &&!_gbed {_dfcc ,_cbe ,_fbg ,_dag =_d .GetDataFromXfrm (_dbf );};_afe ,_fcbga :=_dgg .makePdfBlockFromTxBody (_gbba ,_cfc ,_bfgf ,_fbg ,_dag ,_eeff ,_cca ,_bgb );if _fcbga !=nil {_ege .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_fcbga );
}else if _afe !=nil {_afe .SetPos (_dfcc ,_cbe );_efa =append (_efa ,_afe );};};return _efa ;};func _aabd (_abga *_gg .CT_TextCharacterProperties ,_cfff *_gg .CT_TableStyleTextStyle )*_gg .CT_TextCharacterProperties {_gfac :=_gg .NewCT_TextCharacterProperties ();
if _abga !=nil {*_gfac =*_abga ;};if _cfff ==nil {return _gfac ;};if _gfac .BAttr ==nil &&_cfff .BAttr !=_gg .ST_OnOffStyleTypeUnset {_gafa :=_cfff .BAttr ==_gg .ST_OnOffStyleTypeOn ;_gfac .BAttr =&_gafa ;};if _gfac .IAttr ==nil &&_cfff .IAttr !=_gg .ST_OnOffStyleTypeUnset {_fadba :=_cfff .IAttr ==_gg .ST_OnOffStyleTypeOn ;
_gfac .IAttr =&_fadba ;};if _gfac .FillPropertiesChoice .NoFill ==nil &&_gfac .FillPropertiesChoice .SolidFill ==nil {_gfac .FillPropertiesChoice .SolidFill =_gg .NewCT_SolidColorFillProperties ();_gfac .FillPropertiesChoice .SolidFill .ScrgbClr =_cfff .ScrgbClr ;
_gfac .FillPropertiesChoice .SolidFill .SrgbClr =_cfff .SrgbClr ;_gfac .FillPropertiesChoice .SolidFill .HslClr =_cfff .HslClr ;_gfac .FillPropertiesChoice .SolidFill .SysClr =_cfff .SysClr ;_gfac .FillPropertiesChoice .SolidFill .SchemeClr =_cfff .SchemeClr ;
_gfac .FillPropertiesChoice .SolidFill .PrstClr =_cfff .PrstClr ;};if _bfcd :=_cfff .ThemeableFontStylesChoice .Font ;_bfcd !=nil &&_gfac .Latin ==nil &&_gfac .Ea ==nil &&_gfac .Cs ==nil {_gfac .Latin =_bfcd .Latin ;_gfac .Ea =_bfcd .Ea ;_gfac .Cs =_bfcd .Cs ;
};return _gfac ;};func _daa (_bafeg ,_ddea *_gg .CT_TextBody )(*_gg .CT_TextBodyProperties ,*_gg .CT_TextListStyle ){if _bafeg ==nil &&_ddea ==nil {return nil ,nil ;};if _bafeg ==nil {return _ddea .BodyPr ,_ddea .LstStyle ;};if _ddea ==nil {return _bafeg .BodyPr ,_bafeg .LstStyle ;
};_ebgdg ,_geaa :=_bafeg .BodyPr ,_bafeg .LstStyle ;_dfg ,_gddcc :=_ddea .BodyPr ,_ddea .LstStyle ;_dcgf :=_baba (_ebgdg ,_dfg );_deddd :=_abae (_geaa ,_gddcc );return _dcgf ,_deddd ;};type romanMatch struct{_acae int ;_gdea string ;};func _fcfc (_cgfgd *bool )bool {return _cgfgd !=nil &&*_cgfgd };
type textboxContext struct{_eafe *convertContext ;_dagd float64 ;_fab float64 ;_dggc *_cbc .Creator ;_fccc float64 ;_fga []*paragraph ;_bcgb *paragraph ;_bafea *line ;_gbf *word ;_fgcc bool ;};func (_aaf *convertContext )getPhData (_dead *_ce .CT_Shape )(*_gg .CT_Transform2D ,*_gg .CT_TextBodyProperties ,*_gg .CT_TextListStyle ,bool ,bool ,bool ){_ffgc ,_fdfb :=_fcccd (_dead );
_ccea ,_dabb ,_fagg ,_bdbc ,_dfbc :=_ffab (_aaf ._cgfd .CSld ,_ffgc ,_fdfb );_dcde ,_bcf ,_bceg ,_gdg ,_feea :=_ffab (_aaf ._ccf .CSld ,_ffgc ,_fdfb );if _dcde ==nil {_dcde =_ccea ;};_dgdf ,_cede :=_daa (_bcf ,_dabb );var _fefb ,_aaff ,_cadg bool ;if _bceg ==nil {if _fagg !=nil {_fefb =*_fagg ;
};}else {_fefb =*_bceg ;};if _feea ==nil {if _dfbc !=nil {_cadg =*_dfbc ;};}else {_cadg =*_feea ;};if _gdg ==nil {if _bdbc !=nil {_aaff =*_bdbc ;};}else {_aaff =*_gdg ;};return _dcde ,_dgdf ,_cede ,_fefb ,_aaff ,_cadg ;};func (_bgdc *convertContext )renderCurrentStateToGoImage ()(_b .Image ,error ){_cced :=_d .MakeTempCreator (_bgdc ._bfcac ,_bgdc ._dcd );
_cced .NewPage ();for _ ,_bfee :=range _bgdc ._ccdd {if _bfee !=nil {_cced .MoveTo (0,0);_cced .Draw (_bfee );};};_adfb ,_bge :=_d .GetPageFromCreator (_cced );if _bge !=nil {return nil ,_bge ;};return _cfe .NewImageDevice ().Render (_adfb );};type convertContext struct{_dedd *_cbc .Creator ;
_gdfe *_d .Rectangle ;_bdeb *_ac .Presentation ;_fade *_ac .Slide ;_cgfd *_ce .SldMaster ;_ccf *_ce .SldLayout ;_dcd float64 ;_bfcac float64 ;_ccdd []_cbc .Drawable ;_fef *background ;_gbde *_gg .CT_TextParagraphProperties ;_eacb *_gg .CT_TextCharacterProperties ;
_efdd *_gg .CT_TextParagraphProperties ;_cga *_gg .CT_TextCharacterProperties ;_fgd *_gg .CT_TextParagraphProperties ;_gcdb *_gg .CT_TextCharacterProperties ;_ggc []*_gg .CT_TextParagraphProperties ;_aebf []*_gg .CT_TextParagraphProperties ;_cccg []*_gg .CT_TextParagraphProperties ;
_bgca *_gg .Theme ;_bfe *_gg .CT_ColorMappingOverride ;};func _cge (_ffcbe float64 )float64 {return _ffcbe *_aa .Inch };func _ccdb (_fegd ,_faab *_gg .CT_TableStyleCellStyle )*_gg .CT_TableStyleCellStyle {_bbef :=_gg .NewCT_TableStyleCellStyle ();if _fegd !=nil {*_bbef =*_fegd ;
};if _faab ==nil {return _bbef ;};if _bbef .TcBdr ==nil {_bbef .TcBdr =_faab .TcBdr ;}else {if _bbef .TcBdr .Left ==nil {_bbef .TcBdr .Left =_faab .TcBdr .Left ;};if _bbef .TcBdr .Right ==nil {_bbef .TcBdr .Right =_faab .TcBdr .Right ;};if _bbef .TcBdr .Top ==nil {_bbef .TcBdr .Top =_faab .TcBdr .Top ;
};if _bbef .TcBdr .Bottom ==nil {_bbef .TcBdr .Bottom =_faab .TcBdr .Bottom ;};if _bbef .TcBdr .InsideH ==nil {_bbef .TcBdr .InsideH =_faab .TcBdr .InsideH ;};if _bbef .TcBdr .InsideV ==nil {_bbef .TcBdr .InsideV =_faab .TcBdr .InsideV ;};};if _bbef .ThemeableFillStyleChoice .Fill ==nil {_bbef .ThemeableFillStyleChoice .Fill =_faab .ThemeableFillStyleChoice .Fill ;
};if _bbef .ThemeableFillStyleChoice .FillRef ==nil {_bbef .ThemeableFillStyleChoice .FillRef =_faab .ThemeableFillStyleChoice .FillRef ;};return _bbef ;};func (_gdda *textboxContext )addCurrentParagraph (){_gdda ._fccc =_gdda ._bcgb ._eag +_gdda ._bcgb ._fca +_gdda ._bcgb ._bgaa +_gdda ._bcgb ._aaca ;
_gdda ._fga =append (_gdda ._fga ,_gdda ._bcgb );_gdda .alignParagraph ();};var _bdcfa =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};func (_geaef *convertContext )getStyleColors (_ababe *_gg .CT_ShapeStyle )(_cbc .Color ,_cbc .Color ,_cbc .Color ){var _gec ,_cebd ,_daea _cbc .Color ;
if _gbge :=_ababe .LnRef ;_gbge !=nil {_cebd =_geaef .getColorFromMatrixReference (_gbge );};if _bcde :=_ababe .FillRef ;_bcde !=nil {_daea =_geaef .getColorFromMatrixReference (_bcde );};if _geeab :=_ababe .FontRef ;_geeab !=nil {_gec =_geaef .getColorFromFontReference (_geeab );
};return _gec ,_daea ,_cebd ;};func (_gbaa *convertContext )makePdfBlockFromTable (_fbd *_gg .Tbl )*_cbc .Table {_bccf :=_fbd .TblGrid ;if _bccf ==nil {return nil ;};_bdge :=len (_bccf .GridCol );if _bdge ==0{return nil ;};_ebdd :=[]float64 {};_gbc :=0.0;
for _ ,_eaef :=range _bccf .GridCol {_cfd :=_aa .FromEMU (_d .FromSTCoordinate (_eaef .WAttr ));_ebdd =append (_ebdd ,_cfd );_gbc +=_cfd ;};_ageg :=[]float64 {};for _afcd :=0;_afcd < _bdge ;_afcd ++{_ageg =append (_ageg ,_ebdd [_afcd ]/_gbc );};_ggg :=_gbaa ._dedd .NewTable (_bdge );
_ggg .SetColumnWidths (_ageg ...);_eba :=_fbd .TblPr ;var _eeg *_gg .CT_TableStyle ;if _ffga :=_eba .TablePropertiesChoice ;_ffga !=nil {if _ffga .TableStyle !=nil {_eeg =_ffga .TableStyle ;}else if _ffga .TableStyleId !=nil {_eeg =_gbaa ._bdeb .GetTableStyleById (*_ffga .TableStyleId );
};};_bdf :=_gg .NewCT_TablePartStyle ();_bdf .TcStyle =_gg .NewCT_TableStyleCellStyle ();_bdf .TcTxStyle =_gg .NewCT_TableStyleTextStyle ();if _eeg !=nil {if _eeg .WholeTbl !=nil {*_bdf =*_eeg .WholeTbl ;};if _eeg .TblBg !=nil {if _bdf .TcStyle .ThemeableFillStyleChoice .Fill ==nil {_bdf .TcStyle .ThemeableFillStyleChoice .Fill =_eeg .TblBg .ThemeableFillStyleChoice .Fill ;
};};};if _bdf .TcStyle .ThemeableFillStyleChoice .Fill ==nil {_bdf .TcStyle .ThemeableFillStyleChoice .Fill =_gg .NewCT_FillProperties ();_bdf .TcStyle .ThemeableFillStyleChoice .Fill .FillPropertiesChoice .NoFill =_eba .FillPropertiesChoice .NoFill ;_bdf .TcStyle .ThemeableFillStyleChoice .Fill .FillPropertiesChoice .SolidFill =_eba .FillPropertiesChoice .SolidFill ;
};_adee :=len (_fbd .Tr );_bfc :=_fbd .TblPr .BandRowAttr !=nil &&*_fbd .TblPr .BandRowAttr ;_dagc :=_fbd .TblPr .FirstRowAttr !=nil &&*_fbd .TblPr .FirstRowAttr ;_fag :=_fbd .TblPr .LastRowAttr !=nil &&*_fbd .TblPr .LastRowAttr ;_cbbf :=_fbd .TblPr .BandColAttr !=nil &&*_fbd .TblPr .BandColAttr ;
_acgb :=_fbd .TblPr .FirstColAttr !=nil &&*_fbd .TblPr .FirstColAttr ;_fbdb :=_fbd .TblPr .LastColAttr !=nil &&*_fbd .TblPr .LastColAttr ;for _ebgde ,_aeec :=range _fbd .Tr {_bdgeg :=_ebgde ==0;_edg :=_ebgde ==_adee -1;_fbe :=_ebgde %2==0;_gcf :=len (_aeec .Tc );
var _eefg *_gg .CT_TablePartStyle ;if _eeg !=nil {if _bdgeg &&_dagc {_eefg =_eeg .FirstRow ;}else if _edg &&_fag {_eefg =_eeg .LastRow ;}else if _fbe &&_bfc {_eefg =_eeg .Band2H ;}else if _bfc {_eefg =_eeg .Band1H ;};};var _bcac float64 ;for _acbb ,_cadf :=range _aeec .Tc {_dagf :=_acbb ==0;
_egg :=_acbb ==_gcf -1;_faec :=_acbb %2==0;var _fagc *_gg .CT_TablePartStyle ;if _eeg !=nil {if _dagf &&_acgb {_fagc =_eeg .FirstCol ;}else if _egg &&_fbdb {_fagc =_eeg .LastCol ;}else if _faec &&_cbbf {_fagc =_eeg .Band2V ;}else if _cbbf {_fagc =_eeg .Band1V ;
};};_gdfa :=_dddb (_dddb (_fagc ,_eefg ),_bdf );_ddcd :=_gbaa .addCellToTable (_ggg ,_cadf ,_gdfa ,_bdgeg ,_edg ,_dagf ,_egg );if _ddcd > _bcac {_bcac =_ddcd ;};};_fbfe :=_aa .FromEMU (_d .FromSTCoordinate (_aeec .HAttr ));if _fbfe < _bcac {_fbfe =_bcac ;
};if _fbfe < _dfee (4){_fbfe =_dfee (4);};_ggg .SetRowHeight (_ggg .CurRow (),_fbfe );};return _ggg ;};func (_efde *convertContext )getBorderStyle (_cdf *_gg .CT_LineProperties )(_cbc .CellBorderStyle ,*_cbc .Color ,float64 ){if _cdf ==nil ||_cdf .LineFillPropertiesChoice .NoFill !=nil {return _cbc .CellBorderStyleNone ,nil ,0;
};var _gee _cbc .Color ;if _gcfa :=_cdf .LineFillPropertiesChoice .SolidFill ;_gcfa !=nil {_gee ,_ =_efde .getColorFromSolidFill (_gcfa );};_dfce :=0.0;if _eac :=_cdf .WAttr ;_eac !=nil {_dfce =_aa .FromEMU (int64 (*_eac ));};return _cbc .CellBorderStyleSingle ,&_gee ,_dfce ;
};type line struct{_bbf float64 ;_ecdfg float64 ;_efca float64 ;_fge float64 ;_efab float64 ;_baag []*word ;};func (_fd *convertContext )extractDefaultProperties (){_gd :=_fd ._bdeb .X ();_dgb :=_gd .DefaultTextStyle ;var _ace ,_fcg ,_da ,_ag ,_ad ,_cff ,_bd ,_ebc ,_bdg ,_db *_gg .CT_TextParagraphProperties ;
if _dgb !=nil {_ace =_dgb .DefPPr ;_fcg =_eebf (_dgb .Lvl1pPr ,_ace );_da =_eebf (_dgb .Lvl2pPr ,_ace );_ag =_eebf (_dgb .Lvl3pPr ,_ace );_ad =_eebf (_dgb .Lvl4pPr ,_ace );_cff =_eebf (_dgb .Lvl5pPr ,_ace );_bd =_eebf (_dgb .Lvl6pPr ,_ace );_ebc =_eebf (_dgb .Lvl7pPr ,_ace );
_bdg =_eebf (_dgb .Lvl8pPr ,_ace );_db =_eebf (_dgb .Lvl9pPr ,_ace );_fd ._gbde =_ace ;_fd ._eacb =_ace .DefRPr ;};_fd ._ggc =make ([]*_gg .CT_TextParagraphProperties ,9);_fd ._ggc [0]=_fcg ;_fd ._ggc [1]=_da ;_fd ._ggc [2]=_ag ;_fd ._ggc [3]=_ad ;_fd ._ggc [4]=_cff ;
_fd ._ggc [5]=_bd ;_fd ._ggc [6]=_ebc ;_fd ._ggc [7]=_bdg ;_fd ._ggc [8]=_db ;_bf :=_fd ._bdeb .SlideMasters ()[0].X ();_cd :=_bf .TxStyles ;_aag :=_cd .TitleStyle ;_fd ._efdd =_eebf (_aag .DefPPr ,_ace );_fd ._cga =_fd ._efdd .DefRPr ;_fd ._aebf =make ([]*_gg .CT_TextParagraphProperties ,9);
_fd ._aebf [0]=_eebf (_aag .Lvl1pPr ,_fcg );_fd ._aebf [1]=_eebf (_aag .Lvl2pPr ,_da );_fd ._aebf [2]=_eebf (_aag .Lvl3pPr ,_ag );_fd ._aebf [3]=_eebf (_aag .Lvl4pPr ,_ad );_fd ._aebf [4]=_eebf (_aag .Lvl5pPr ,_cff );_fd ._aebf [5]=_eebf (_aag .Lvl6pPr ,_bd );
_fd ._aebf [6]=_eebf (_aag .Lvl7pPr ,_ebc );_fd ._aebf [7]=_eebf (_aag .Lvl8pPr ,_bdg );_fd ._aebf [8]=_eebf (_aag .Lvl9pPr ,_db );_agf :=_cd .BodyStyle ;_fd ._fgd =_eebf (_agf .DefPPr ,_ace );_fd ._gcdb =_fd ._fgd .DefRPr ;_fd ._cccg =make ([]*_gg .CT_TextParagraphProperties ,9);
_fd ._cccg [0]=_eebf (_agf .Lvl1pPr ,_fcg );_fd ._cccg [1]=_eebf (_agf .Lvl2pPr ,_da );_fd ._cccg [2]=_eebf (_agf .Lvl3pPr ,_ag );_fd ._cccg [3]=_eebf (_agf .Lvl4pPr ,_ad );_fd ._cccg [4]=_eebf (_agf .Lvl5pPr ,_cff );_fd ._cccg [5]=_eebf (_agf .Lvl6pPr ,_bd );
_fd ._cccg [6]=_eebf (_agf .Lvl7pPr ,_ebc );_fd ._cccg [7]=_eebf (_agf .Lvl8pPr ,_bdg );_fd ._cccg [8]=_eebf (_agf .Lvl9pPr ,_db );};func (_cbg *convertContext )getGroupConnectors (_abb *_ce .CT_Connector ,_dfd float64 ,_egec float64 )[]_cbc .Drawable {_ddce ,_ ,_ ,_ ,_ ,_ ,_ :=_cbg .getShapesFromSpPr (_abb .SpPr ,_abb .Style ,false ,_dfd ,_egec );
return _ddce ;};func _beae (_bccg ,_afab *_gg .CT_TableStyleTextStyle )*_gg .CT_TableStyleTextStyle {_feae :=_gg .NewCT_TableStyleTextStyle ();if _bccg !=nil {*_feae =*_bccg ;};if _afab ==nil {return _feae ;};if _feae .BAttr ==_gg .ST_OnOffStyleTypeUnset {_feae .BAttr =_afab .BAttr ;
};if _feae .IAttr ==_gg .ST_OnOffStyleTypeUnset {_feae .IAttr =_afab .IAttr ;};if _feae .ThemeableFontStylesChoice .Font ==nil {_feae .ThemeableFontStylesChoice .Font =_afab .ThemeableFontStylesChoice .Font ;};if _feae .ThemeableFontStylesChoice .FontRef ==nil {_feae .ThemeableFontStylesChoice .FontRef =_afab .ThemeableFontStylesChoice .FontRef ;
};if _feae .ScrgbClr ==nil {_feae .ScrgbClr =_afab .ScrgbClr ;};if _feae .SrgbClr ==nil {_feae .SrgbClr =_afab .SrgbClr ;};if _feae .HslClr ==nil {_feae .HslClr =_afab .HslClr ;};if _feae .SysClr ==nil {_feae .SysClr =_afab .SysClr ;};if _feae .SchemeClr ==nil {_feae .SchemeClr =_afab .SchemeClr ;
};if _feae .PrstClr ==nil {_feae .PrstClr =_afab .PrstClr ;};return _feae ;};func _gga (_dbd int ,_cgba bool )string {_dfcga :=_ee .NewBuffer ([]byte {});for _ ,_dbeb :=range _adda {for {if _dbd < _dbeb ._acae {break ;};_dfcga .WriteString (_dbeb ._gdea );
_dbd -=_dbeb ._acae ;};};_abd :=_dfcga .String ();if _cgba {_abd =_cb .ToUpper (_abd );};return _abd ;};type background struct{_ebcg _cbc .Color ;_gbg float64 ;_aace *_gg .CT_BlipFillProperties ;};func (_cee *convertContext )drawSlide (){_cee ._dedd .NewPage ();
for _ ,_cef :=range _cee ._ccdd {if _cef !=nil {_cee ._dedd .MoveTo (0,0);_cee ._dedd .Draw (_cef );};};};func _fcccd (_abf *_ce .CT_Shape )(_ce .ST_PlaceholderType ,*uint32 ){if _ccda :=_abf .NvSpPr ;_ccda !=nil {if _cfga :=_ccda .NvPr ;_cfga !=nil {if _ddgg :=_cfga .Ph ;
_ddgg !=nil {return _ddgg .TypeAttr ,_ddgg .IdxAttr ;};};};return _ce .ST_PlaceholderTypeUnset ,nil ;};func (_eege *convertContext )getColorFromSolidFill (_bebg *_gg .CT_SolidColorFillProperties )(_cbc .Color ,float64 ){if _bebg ==nil {return nil ,1;};
var _gbbe string ;_aecf :=1.0;if _agge :=_bebg .SrgbClr ;_agge !=nil {_gbbe =_agge .ValAttr ;_aecf =_d .GetOpacityFromColorTransform (_agge .EG_ColorTransform );}else if _daef :=_bebg .SchemeClr ;_daef !=nil {_gbbe =_d .GetColorStringFromDmlColor (_eege ._fade .GetColorBySchemeColor (_daef .ValAttr ));
_gbbe =_d .AdjustColor (_gbbe ,_daef .EG_ColorTransform );_aecf =_d .GetOpacityFromColorTransform (_daef .EG_ColorTransform );};if _gbbe !=""{_aaed :=_cbc .ColorRGBFromHex ("\u0023"+_gbbe );return _aaed ,_aecf ;};return nil ,1;};func (_dafg *convertContext )getConnectors (_eddf *_ce .CT_Connector )[]_cbc .Drawable {_ccd ,_ ,_ ,_ ,_ ,_ ,_ :=_dafg .getShapesFromSpPr (_eddf .SpPr ,_eddf .Style ,false ,0.0,0.0);
return _ccd ;};type symbolStyle struct{_gbda *string ;_cbge *float64 ;_acdgc *string ;_geae *bool ;_bbe *bool ;_ddd *bool ;_abg *bool ;_dbaf *bool ;};type symbol struct{_gaf string ;_ffbe float64 ;_dfcd float64 ;_dgbd float64 ;_gcg float64 ;_aced float64 ;
_dae *_cbc .TextStyle ;_fddf string ;_dafa bool ;_fgb bool ;_ffce bool ;};func (_ec *convertContext )makePdfBlockFromChart (_aac *_f .Chart ,_ed ,_fg float64 )(*_cbc .Block ,error ){_bg :=_aac .CT_RelId .IdAttr ;_ea :=_ec ._fade .GetChartSpaceByRelId (_bg );
if _ea ==nil {return nil ,_e .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _ef *_gg .Theme ;_ga :=_ec ._bdeb .Themes ();if len (_ga )> 0{_ef =_ga [0];};return _d .MakeBlockFromChartSpace (_ea ,_ed ,_fg ,_ef );
};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_ac .Presentation )*_cbc .Creator {return ConvertToPdfWithOptions (pr ,nil )};func (_gfafc *convertContext )renderPageWithDrawableToGoImage (_fdcf _cbc .Drawable )(_b .Image ,error ){_gfcce :=_d .MakeTempCreator (_gfafc ._bfcac ,_gfafc ._dcd );
_gfcce .NewPage ();_gfcce .Draw (_fdcf );_gfba ,_cbgf :=_d .GetPageFromCreator (_gfcce );if _cbgf !=nil {return nil ,_cbgf ;};return _cfe .NewImageDevice ().Render (_gfba );};func _ffab (_gebe *_ce .CT_CommonSlideData ,_gbafg _ce .ST_PlaceholderType ,_ggga *uint32 )(*_gg .CT_Transform2D ,*_gg .CT_TextBody ,*bool ,*bool ,*bool ){_bdaa :=_ggga ==nil ;
if _gebe !=nil &&(_gbafg !=_ce .ST_PlaceholderTypeUnset ||!_bdaa ){if _efbg :=_gebe .SpTree ;_efbg !=nil {for _ ,_cgafc :=range _efbg .GroupShapeChoice {if _cgafc !=nil {if _cgafc .Sp !=nil {_agbaf ,_faeg :=_fcccd (_cgafc .Sp );if _gbafg ==_agbaf {if (_bdaa &&_faeg ==nil )||(!_bdaa &&_faeg !=nil &&*_faeg ==*_ggga ){var _ebe *_gg .CT_Transform2D ;
if _cgafc .Sp .SpPr !=nil {_ebe =_cgafc .Sp .SpPr .Xfrm ;};_dbbb :=_gbafg ==_ce .ST_PlaceholderTypeTitle ||_gbafg ==_ce .ST_PlaceholderTypeCtrTitle ;_badgg :=_gbafg ==_ce .ST_PlaceholderTypeSubTitle ;_dcded :=!_dbbb &&_gbafg !=_ce .ST_PlaceholderTypeUnset ;
return _ebe ,_cgafc .Sp .TxBody ,&_dbbb ,&_badgg ,&_dcded ;};};};};};};};return nil ,nil ,nil ,nil ,nil ;};func (_dfe *convertContext )makePdfBlockFromTxBody (_babb *_gg .CT_TextBody ,_gag *_gg .CT_TextBodyProperties ,_dgd *_gg .CT_TextListStyle ,_cdc ,_cgb float64 ,_fcd _cbc .Color ,_cec ,_fbbf bool )(*_cbc .Block ,error ){var _bgdf *_gg .CT_TextParagraphProperties ;
if _agc :=_babb .LstStyle ;_agc !=nil {var _ffa *_gg .CT_TextParagraphProperties ;if _agc .Lvl1pPr !=nil {_ffa =_agc .Lvl1pPr ;};_bgdf =_eebf (_ffa ,_agc .DefPPr );};var _badg *_gg .CT_TextParagraphProperties ;if _bgdf !=nil {if _cec {_badg =_dfe ._aebf [0];
}else if _fbbf {_badg =_dfe ._cccg [0];}else {_badg =_dfe ._ggc [0];};if _dgd !=nil {_badg =_eebf (_eebf (_dgd .Lvl1pPr ,_dgd .DefPPr ),_badg );};_badg =_eebf (_bgdf ,_badg );}else {if _cec {_badg =_dfe ._efdd ;}else if _fbbf {_badg =_dfe ._fgd ;}else {_badg =_dfe ._gbde ;
};};_fbc ,_fdaf :=_dfee (2.5),_dfee (2.5);_agfb ,_aga :=_dfee (1.3),_dfee (1.3);_adb :=true ;_cda :=_gg .ST_TextAnchoringTypeT ;if _gag !=nil {if _ebcc :=_gag .AnchorAttr ;_ebcc !=_gg .ST_TextAnchoringTypeUnset {_cda =_ebcc ;};};if _fddab :=_babb .BodyPr ;
_fddab !=nil {if _dce :=_fddab .LInsAttr ;_dce !=nil {_fbc =_aa .FromEMU (_d .FromSTCoordinate32 (*_dce ));};if _fdbc :=_fddab .TInsAttr ;_fdbc !=nil {_agfb =_aa .FromEMU (_d .FromSTCoordinate32 (*_fdbc ));};if _fee :=_fddab .RInsAttr ;_fee !=nil {_fdaf =_aa .FromEMU (_d .FromSTCoordinate32 (*_fee ));
};if _ebd :=_fddab .BInsAttr ;_ebd !=nil {_aga =_aa .FromEMU (_d .FromSTCoordinate32 (*_ebd ));};_adb =_fddab .WrapAttr !=_gg .ST_TextWrappingTypeNone ;if _bda :=_fddab .AnchorAttr ;_bda !=_gg .ST_TextAnchoringTypeUnset {_cda =_fddab .AnchorAttr ;};};_ebda :=_d .MakeTempCreator (_cdc ,_cgb );
_ebda .SetPageMargins (_fbc ,_fdaf ,_agfb ,_aga );_bca :=&textboxContext {_eafe :_dfe ,_fgcc :_adb ,_dagd :_cdc -_fbc -_fdaf ,_fab :_cgb -_agfb -_aga ,_dggc :_ebda ,_fga :[]*paragraph {}};_bbcf :=1;for _ ,_babe :=range _babb .P {if _babe !=nil {_ffe :=_babe .PPr ;
var _defd *prefixData ;if _ffe !=nil &&_ffe .TextBulletChoice .BuNone ==nil {var _afcf string ;var _cae bool ;if _beg :=_ffe .TextBulletChoice .BuAutoNum ;_beg !=nil {var _dbce string ;if _baa :=_beg .StartAtAttr ;_baa !=nil {_bbcf =int (*_baa );};var _bcab string ;
switch _beg .TypeAttr {case _gg .ST_TextAutonumberSchemeAlphaUcParenBoth ,_gg .ST_TextAutonumberSchemeAlphaUcParenR ,_gg .ST_TextAutonumberSchemeAlphaUcPeriod :_bcab =_egd (_bbcf ,true );case _gg .ST_TextAutonumberSchemeAlphaLcParenBoth ,_gg .ST_TextAutonumberSchemeAlphaLcParenR ,_gg .ST_TextAutonumberSchemeAlphaLcPeriod :_bcab =_egd (_bbcf ,false );
case _gg .ST_TextAutonumberSchemeRomanUcParenBoth ,_gg .ST_TextAutonumberSchemeRomanUcParenR ,_gg .ST_TextAutonumberSchemeRomanUcPeriod :_bcab =_gga (_bbcf ,true );case _gg .ST_TextAutonumberSchemeRomanLcParenBoth ,_gg .ST_TextAutonumberSchemeRomanLcParenR ,_gg .ST_TextAutonumberSchemeRomanLcPeriod :_bcab =_gga (_bbcf ,false );
default:_bcab =_g .Itoa (_bbcf );};switch _beg .TypeAttr {case _gg .ST_TextAutonumberSchemeAlphaLcPeriod ,_gg .ST_TextAutonumberSchemeAlphaUcPeriod ,_gg .ST_TextAutonumberSchemeArabicPeriod ,_gg .ST_TextAutonumberSchemeRomanLcPeriod ,_gg .ST_TextAutonumberSchemeRomanUcPeriod ,_gg .ST_TextAutonumberSchemeArabicDbPeriod ,_gg .ST_TextAutonumberSchemeEa1ChsPeriod ,_gg .ST_TextAutonumberSchemeEa1ChtPeriod ,_gg .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_gg .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_gg .ST_TextAutonumberSchemeThaiAlphaPeriod ,_gg .ST_TextAutonumberSchemeThaiNumPeriod ,_gg .ST_TextAutonumberSchemeHindiAlphaPeriod ,_gg .ST_TextAutonumberSchemeHindiNumPeriod ,_gg .ST_TextAutonumberSchemeHindiAlpha1Period :_dbce ="\u002e";
case _gg .ST_TextAutonumberSchemeAlphaLcParenR ,_gg .ST_TextAutonumberSchemeAlphaUcParenR ,_gg .ST_TextAutonumberSchemeArabicParenR ,_gg .ST_TextAutonumberSchemeRomanLcParenR ,_gg .ST_TextAutonumberSchemeRomanUcParenR ,_gg .ST_TextAutonumberSchemeThaiAlphaParenR ,_gg .ST_TextAutonumberSchemeThaiNumParenR ,_gg .ST_TextAutonumberSchemeHindiNumParenR :_dbce ="\u0029";
};_afcf =_bcab +_dbce ;_bbcf ++;}else if _gfb :=_ffe .TextBulletChoice .BuChar ;_gfb !=nil {_aadb :=_gfb .CharAttr ;if _eaec ,_ebgd :=_bdcfa [_aadb ];_ebgd {_aadb =string (rune (_eaec ));}else {_aadb ="\u2022";};_afcf =_aadb ;_cae =true ;};if _afcf !=""{var _aab ,_bgcf float64 ;
if _ffe .MarLAttr !=nil {_aab =_aa .FromEMU (int64 (*_ffe .MarLAttr ));};if _ffe .IndentAttr !=nil {_bgcf =_aa .FromEMU (int64 (*_ffe .IndentAttr ));};_defd =&prefixData {_gbcb :_afcf ,_dcb :_cae ,_egff :_aab ,_bbga :_bgcf };};};_ffe =_eebf (_ffe ,_badg );
_ffc :=_egdf (_babe .EndParaRPr ,_ffe .DefRPr );_bca .newParagraph ();_bca .assignPropsToCurrentParagraph (_ffe );_bca .newLine ();_bca .newWord ();for _cgf ,_baae :=range _babe .EG_TextRun {_bca .addTextRun (_baae ,_ffc ,_fcd ,_defd );if _cgf > 0{_defd =nil ;
};};_bca .addCurrentWordToParagraph ();};_bca .addCurrentParagraph ();};_bca .alignVertically (_cda );_bca .drawParagraphs ();return _d .MakeBlockFromCreator (_ebda );};func (_ecb *convertContext )getColorFromFontReference (_bdga *_gg .CT_FontReference )_cbc .Color {var _bccb _cbc .Color ;
var _baaeb string ;if _adg :=_bdga .SrgbClr ;_adg !=nil {_baaeb =_adg .ValAttr ;}else if _ceeg :=_bdga .SchemeClr ;_ceeg !=nil {_baaeb =_d .GetColorStringFromDmlColor (_ecb ._bdeb .GetColorBySchemeColor (_ceeg .ValAttr ));_baaeb =_d .AdjustColor (_baaeb ,_ceeg .EG_ColorTransform );
};if _baaeb !=""{_bccb =_cbc .ColorRGBFromHex ("\u0023"+_baaeb );};return _bccb ;};func (_bdgf *textboxContext )alignSymbolsVertically (){for _ ,_edef :=range _bdgf ._fga {for _ ,_bce :=range _edef ._acdg {_fada :=0.0;for _ ,_cfaf :=range _bce ._baag {for _ ,_gef :=range _cfaf ._dfec {if _gef ._dfcd > _fada {_fada =_gef ._dfcd ;
};};};for _ ,_cbfb :=range _bce ._baag {for _ ,_fcca :=range _cbfb ._dfec {if _fcca ._dgbd < _fada {_fcca ._gcg =_fada -_fcca ._dgbd ;};};};};};};