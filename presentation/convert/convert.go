//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_c "bytes";_a "errors";_bb "github.com/unidoc/unioffice/v2/common";_ba "github.com/unidoc/unioffice/v2/common/logger";_ac "github.com/unidoc/unioffice/v2/common/tempstorage";_df "github.com/unidoc/unioffice/v2/internal/convertutils";
_fa "github.com/unidoc/unioffice/v2/measurement";_fg "github.com/unidoc/unioffice/v2/presentation";_cf "github.com/unidoc/unioffice/v2/schema/soo/dml";_gd "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_ab "github.com/unidoc/unioffice/v2/schema/soo/pml";
_ae "github.com/unidoc/unipdf/v4/contentstream/draw";_fac "github.com/unidoc/unipdf/v4/core";_ag "github.com/unidoc/unipdf/v4/creator";_ed "github.com/unidoc/unipdf/v4/model";_dc "github.com/unidoc/unipdf/v4/render";_f "image";_e "image/color";_b "image/draw";
_fd "math";_ef "strconv";_g "strings";);func _fgefd (_dafa ,_ffecc *_cf .CT_TableStyleTextStyle )*_cf .CT_TableStyleTextStyle {_gccf :=_cf .NewCT_TableStyleTextStyle ();if _dafa !=nil {*_gccf =*_dafa ;};if _ffecc ==nil {return _gccf ;};if _gccf .BAttr ==_cf .ST_OnOffStyleTypeUnset {_gccf .BAttr =_ffecc .BAttr ;
};if _gccf .IAttr ==_cf .ST_OnOffStyleTypeUnset {_gccf .IAttr =_ffecc .IAttr ;};if _gccf .ThemeableFontStylesChoice .Font ==nil {_gccf .ThemeableFontStylesChoice .Font =_ffecc .ThemeableFontStylesChoice .Font ;};if _gccf .ThemeableFontStylesChoice .FontRef ==nil {_gccf .ThemeableFontStylesChoice .FontRef =_ffecc .ThemeableFontStylesChoice .FontRef ;
};if _gccf .ScrgbClr ==nil {_gccf .ScrgbClr =_ffecc .ScrgbClr ;};if _gccf .SrgbClr ==nil {_gccf .SrgbClr =_ffecc .SrgbClr ;};if _gccf .HslClr ==nil {_gccf .HslClr =_ffecc .HslClr ;};if _gccf .SysClr ==nil {_gccf .SysClr =_ffecc .SysClr ;};if _gccf .SchemeClr ==nil {_gccf .SchemeClr =_ffecc .SchemeClr ;
};if _gccf .PrstClr ==nil {_gccf .PrstClr =_ffecc .PrstClr ;};return _gccf ;};func (_abb *convertContext )extractDefaultProperties (){_ffb :=_abb ._ggda .X ();_fe :=_ffb .DefaultTextStyle ;var _fb ,_dd ,_ee ,_gf ,_af ,_bd ,_ca ,_dcd ,_gdc ,_bac *_cf .CT_TextParagraphProperties ;
if _fe !=nil {_fb =_fe .DefPPr ;_dd =_bgea (_fe .Lvl1pPr ,_fb );_ee =_bgea (_fe .Lvl2pPr ,_fb );_gf =_bgea (_fe .Lvl3pPr ,_fb );_af =_bgea (_fe .Lvl4pPr ,_fb );_bd =_bgea (_fe .Lvl5pPr ,_fb );_ca =_bgea (_fe .Lvl6pPr ,_fb );_dcd =_bgea (_fe .Lvl7pPr ,_fb );
_gdc =_bgea (_fe .Lvl8pPr ,_fb );_bac =_bgea (_fe .Lvl9pPr ,_fb );_abb ._ggccd =_fb ;_abb ._gede =_fb .DefRPr ;};_abb ._gdg =make ([]*_cf .CT_TextParagraphProperties ,9);_abb ._gdg [0]=_dd ;_abb ._gdg [1]=_ee ;_abb ._gdg [2]=_gf ;_abb ._gdg [3]=_af ;_abb ._gdg [4]=_bd ;
_abb ._gdg [5]=_ca ;_abb ._gdg [6]=_dcd ;_abb ._gdg [7]=_gdc ;_abb ._gdg [8]=_bac ;_dcdg :=_abb ._ggda .SlideMasters ()[0].X ();_fbb :=_dcdg .TxStyles ;_afe :=_fbb .TitleStyle ;_abb ._gace =_bgea (_afe .DefPPr ,_fb );_abb ._fdga =_abb ._gace .DefRPr ;_abb ._fca =make ([]*_cf .CT_TextParagraphProperties ,9);
_abb ._fca [0]=_bgea (_afe .Lvl1pPr ,_dd );_abb ._fca [1]=_bgea (_afe .Lvl2pPr ,_ee );_abb ._fca [2]=_bgea (_afe .Lvl3pPr ,_gf );_abb ._fca [3]=_bgea (_afe .Lvl4pPr ,_af );_abb ._fca [4]=_bgea (_afe .Lvl5pPr ,_bd );_abb ._fca [5]=_bgea (_afe .Lvl6pPr ,_ca );
_abb ._fca [6]=_bgea (_afe .Lvl7pPr ,_dcd );_abb ._fca [7]=_bgea (_afe .Lvl8pPr ,_gdc );_abb ._fca [8]=_bgea (_afe .Lvl9pPr ,_bac );_bacf :=_fbb .BodyStyle ;_abb ._bfac =_bgea (_bacf .DefPPr ,_fb );_abb ._cfd =_abb ._bfac .DefRPr ;_abb ._defe =make ([]*_cf .CT_TextParagraphProperties ,9);
_abb ._defe [0]=_bgea (_bacf .Lvl1pPr ,_dd );_abb ._defe [1]=_bgea (_bacf .Lvl2pPr ,_ee );_abb ._defe [2]=_bgea (_bacf .Lvl3pPr ,_gf );_abb ._defe [3]=_bgea (_bacf .Lvl4pPr ,_af );_abb ._defe [4]=_bgea (_bacf .Lvl5pPr ,_bd );_abb ._defe [5]=_bgea (_bacf .Lvl6pPr ,_ca );
_abb ._defe [6]=_bgea (_bacf .Lvl7pPr ,_dcd );_abb ._defe [7]=_bgea (_bacf .Lvl8pPr ,_gdc );_abb ._defe [8]=_bgea (_bacf .Lvl9pPr ,_bac );};func (_cfcg *textboxContext )assignPropsToCurrentParagraph (_ddff *_cf .CT_TextParagraphProperties ){_dcdd :=12.4;
if _ddff ==nil {_cfcg ._gaa ._ced =_dcdd ;return ;};if _ddeg :=_ddff .DefRPr ;_ddeg !=nil {_ceec :=_ddeg .SzAttr ;if _ceec !=nil {_agfa :=float64 (*_ceec )/1200;if _dcdd <=_agfa {_dcdd =_agfa ;};};};if _acbb :=_ddff .MarLAttr ;_acbb !=nil {_cfcg ._gaa ._bad =_fa .FromEMU (int64 (*_acbb ));
};_cfcg ._gaa ._cgg =_cfcg ._eca ;if _gabg :=_ddff .MarRAttr ;_gabg !=nil {_cfcg ._gaa ._cgg -=_fa .FromEMU (int64 (*_gabg ));};if _gaag :=_ddff .IndentAttr ;_gaag !=nil {_cfcg ._gaa ._dcae =_fa .FromEMU (int64 (*_gaag ));};if _cbg :=_ddff .LatinLnBrkAttr ;
_cbg !=nil {_cfcg ._gaa ._cgdb =*_cbg ;};if _gbbf :=_ddff .LnSpc ;_gbbf !=nil &&_gbbf .TextSpacingChoice !=nil {if _dacf :=_gbbf .TextSpacingChoice .SpcPct ;_dacf !=nil {if _acbbb :=_dacf .ValAttr .ST_TextSpacingPercent ;_acbbb !=nil {_dcdd =float64 (*_acbbb )/5000;
};};};var _faf float64 ;if _bage :=_ddff .SpcBef ;_bage !=nil &&_bage .TextSpacingChoice !=nil {if _aeae :=_bage .TextSpacingChoice .SpcPts ;_aeae !=nil {_faf =float64 (_aeae .ValAttr )/100;};};_dee :=_cfcg ._dace ;if len (_dee )> 0{_faf -=_dee [len (_dee )-1]._fdce ;
if _faf < 0{_faf =0;};};_cfcg ._gaa ._afee =_faf ;if _cdca :=_ddff .SpcAft ;_cdca !=nil &&_cdca .TextSpacingChoice !=nil {if _babf :=_cdca .TextSpacingChoice .SpcPts ;_babf !=nil {_cfcg ._gaa ._fdce =float64 (_babf .ValAttr )/100;};};_cfcg ._gaa ._ced =_dcdd ;
_cfcg ._gaa ._ebbaa =_ddff .AlgnAttr ;};func (_eeb *convertContext )getShapesFromSpPr (_gfd *_cf .CT_ShapeProperties ,_gcd *_cf .CT_ShapeStyle ,_ccag bool ,_abbb float64 ,_cccc float64 )([]_ag .Drawable ,float64 ,float64 ,float64 ,float64 ,_ag .Color ,bool ){_gda :=[]_ag .Drawable {};
var _ecc ,_ffea ,_ccca ,_fef ,_cef float64 ;var _dbbf ,_dbe ,_egd ,_cae _ag .Color ;var _age *_cf .CT_BlipFillProperties ;_adg ,_bdee :=1.0,1.0;if _gcd !=nil {_dbbf ,_dbe ,_cae =_eeb .getStyleColors (_gcd );};if _geg :=_gfd .Ln ;_geg !=nil {if _geg .LineFillPropertiesChoice .NoFill !=nil {_egd ,_cef =nil ,0;
}else {_egd ,_cef ,_adg =_eeb .getInfoFromLn (_geg );if _egd ==nil {_egd =_cae ;};};};if _gfd .FillPropertiesChoice .NoFill !=nil {_dbe ,_bdee =nil ,0;}else if _ccag {_dbe =_eeb ._dded ._agf ;_bdee =_eeb ._dded ._dceg ;_age =_eeb ._dded ._cfbe ;}else if _dada :=_gfd .FillPropertiesChoice .SolidFill ;
_dada !=nil {_dbe ,_bdee =_eeb .getColorFromSolidFill (_dada );};var _aff bool ;if _dde :=_gfd .Xfrm ;_dde !=nil {_ecc ,_ffea ,_ccca ,_fef =_df .GetDataFromXfrm (_dde );_ecc +=_abbb ;_ffea +=_cccc ;_aff =true ;};if _afdg :=_gfd .GeometryChoice .CustGeom ;
_afdg !=nil {_bcc :=[]_ae .Point {};_ade ,_ddb :=1.0,1.0;if _fcfe :=_afdg .PathLst ;_fcfe !=nil {for _ ,_daec :=range _fcfe .Path {if _daec !=nil {if _beff :=_daec .WAttr ;_beff !=nil {_ade =_ccca /_fa .FromEMU (*_beff );};if _ffg :=_daec .HAttr ;_ffg !=nil {_ddb =_fef /_fa .FromEMU (*_ffg );
};for _ ,_eaad :=range _daec .Path2DChoice {if _eaad .Close !=nil {};if _gec :=_eaad .MoveTo ;_eaad .MoveTo !=nil {if _gec !=nil &&_gec .Pt !=nil {_fdg ,_gad :=_cbc (_gec .Pt );_bcc =append (_bcc ,_ae .Point {X :_fdg *_ade +_ecc ,Y :_gad *_ddb +_ffea });
};};if _gabe :=_eaad .LnTo ;_gabe !=nil &&_gabe .Pt !=nil {_add ,_cbb :=_cbc (_gabe .Pt );_bcc =append (_bcc ,_ae .Point {X :_add *_ade +_ecc ,Y :_cbb *_ddb +_ffea });};};_dff :=_eeb ._bbbf .NewPolygon ([][]_ae .Point {_bcc });_dff .SetFillColor (_dbe );
_dff .SetFillOpacity (_bdee );_dff .SetBorderWidth (_cef );if _egd !=nil {_dff .SetBorderColor (_egd );_dff .SetBorderOpacity (_adg );};_gda =append (_gda ,_dff );};};};};if _abdb :=_gfd .GeometryChoice .PrstGeom ;_abdb !=nil {switch _abdb .PrstAttr {case _cf .ST_ShapeTypeRect :if _age !=nil {_dbf :=_eeb .getShapeFromBlipFill (_age ,_ecc ,_ffea ,_ccca ,_fef ,false );
_gda =append (_gda ,_dbf );}else {_cfg :=_eeb ._bbbf .NewRectangle (_ecc ,_ffea ,_ccca ,_fef );_fefb :=_dbe !=nil &&_bdee > 0;if _fefb {_cfg .SetFillColor (_dbe );_cfg .SetFillOpacity (_bdee );};_cgd :=_egd !=nil &&_adg > 0&&_cef > 0;if _cgd {_cfg .SetBorderWidth (_cef );
_cfg .SetBorderColor (_egd );_cfg .SetBorderOpacity (_adg );};if _fefb ||_cgd {_gda =append (_gda ,_cfg );};};case _cf .ST_ShapeTypeLine :_fcg :=_eeb ._bbbf .NewLine (_ecc ,_ffea ,_ecc +_ccca ,_ffea +_fef );_fcg .SetLineWidth (_cef );if _egd !=nil {_fcg .SetColor (_egd );
};_gda =append (_gda ,_fcg );};};return _gda ,_ecc ,_ffea ,_ccca ,_fef ,_dbbf ,_aff ;};func _gaba (_dgce ,_fbga *_cf .CT_TextCharacterProperties )*_cf .CT_TextCharacterProperties {_afcg :=_cf .NewCT_TextCharacterProperties ();if _dgce !=nil {*_afcg =*_dgce ;
};if _fbga ==nil {return _afcg ;};if _afcg .KumimojiAttr ==nil {_afcg .KumimojiAttr =_fbga .KumimojiAttr ;};if _afcg .LangAttr ==nil {_afcg .LangAttr =_fbga .LangAttr ;};if _afcg .AltLangAttr ==nil {_afcg .AltLangAttr =_fbga .AltLangAttr ;};if _afcg .SzAttr ==nil {_afcg .SzAttr =_fbga .SzAttr ;
};if _afcg .BAttr ==nil {_afcg .BAttr =_fbga .BAttr ;};if _afcg .IAttr ==nil {_afcg .IAttr =_fbga .IAttr ;};if _afcg .UAttr ==_cf .ST_TextUnderlineTypeUnset {_afcg .UAttr =_fbga .UAttr ;};if _afcg .StrikeAttr ==_cf .ST_TextStrikeTypeUnset {_afcg .StrikeAttr =_fbga .StrikeAttr ;
};if _afcg .KernAttr ==nil {_afcg .KernAttr =_fbga .KernAttr ;};if _afcg .CapAttr ==_cf .ST_TextCapsTypeUnset {_afcg .CapAttr =_fbga .CapAttr ;};if _afcg .SpcAttr ==nil {_afcg .SpcAttr =_fbga .SpcAttr ;};if _afcg .NormalizeHAttr ==nil {_afcg .NormalizeHAttr =_fbga .NormalizeHAttr ;
};if _afcg .BaselineAttr ==nil {_afcg .BaselineAttr =_fbga .BaselineAttr ;};if _afcg .NoProofAttr ==nil {_afcg .NoProofAttr =_fbga .NoProofAttr ;};if _afcg .DirtyAttr ==nil {_afcg .DirtyAttr =_fbga .DirtyAttr ;};if _afcg .ErrAttr ==nil {_afcg .ErrAttr =_fbga .ErrAttr ;
};if _afcg .SmtCleanAttr ==nil {_afcg .SmtCleanAttr =_fbga .SmtCleanAttr ;};if _afcg .SmtIdAttr ==nil {_afcg .SmtIdAttr =_fbga .SmtIdAttr ;};if _afcg .BmkAttr ==nil {_afcg .BmkAttr =_fbga .BmkAttr ;};if _afcg .Ln ==nil {_afcg .Ln =_fbga .Ln ;};if _afcg .FillPropertiesChoice .NoFill ==nil {_afcg .FillPropertiesChoice .NoFill =_fbga .FillPropertiesChoice .NoFill ;
};if _afcg .FillPropertiesChoice .SolidFill ==nil {_afcg .FillPropertiesChoice .SolidFill =_fbga .FillPropertiesChoice .SolidFill ;};if _afcg .FillPropertiesChoice .BlipFill ==nil {_afcg .FillPropertiesChoice .BlipFill =_fbga .FillPropertiesChoice .BlipFill ;
};if _afcg .EffectPropertiesChoice .EffectLst ==nil {_afcg .EffectPropertiesChoice .EffectLst =_fbga .EffectPropertiesChoice .EffectLst ;};if _afcg .EffectPropertiesChoice .EffectDag ==nil {_afcg .EffectPropertiesChoice .EffectDag =_fbga .EffectPropertiesChoice .EffectDag ;
};if _afcg .Highlight ==nil {_afcg .Highlight =_fbga .Highlight ;};if _afcg .TextUnderlineLineChoice .ULnTx ==nil {_afcg .TextUnderlineLineChoice .ULnTx =_fbga .TextUnderlineLineChoice .ULnTx ;};if _afcg .TextUnderlineLineChoice .ULn ==nil {_afcg .TextUnderlineLineChoice .ULn =_fbga .TextUnderlineLineChoice .ULn ;
};if _afcg .TextUnderlineFillChoice .UFillTx ==nil {_afcg .TextUnderlineFillChoice .UFillTx =_fbga .TextUnderlineFillChoice .UFillTx ;};if _afcg .TextUnderlineFillChoice .UFill ==nil {_afcg .TextUnderlineFillChoice .UFill =_fbga .TextUnderlineFillChoice .UFill ;
};if _afcg .Latin ==nil {_afcg .Latin =_fbga .Latin ;};if _afcg .Ea ==nil {_afcg .Ea =_fbga .Ea ;};if _afcg .Cs ==nil {_afcg .Cs =_fbga .Cs ;};if _afcg .Sym ==nil {_afcg .Sym =_fbga .Sym ;};if _afcg .Rtl ==nil {_afcg .Rtl =_fbga .Rtl ;};return _afcg ;};
func (_gacef *textboxContext )newWord (){_gacef ._ece =&word {_gbdc :true ,_eae :_gacef ._aed ._fdbb }};func (_bgdba *convertContext )getInfoFromLn (_bcge *_cf .CT_LineProperties )(_ag .Color ,float64 ,float64 ){if _bcge ==nil ||_bcge .LineFillPropertiesChoice .NoFill !=nil {return nil ,0,0;
};var _eea float64 ;_cefc ,_eafc :=_bgdba .getColorFromSolidFill (_bcge .LineFillPropertiesChoice .SolidFill );if _bgb :=_bcge .WAttr ;_bgb !=nil {_eea =_fa .FromEMU (int64 (*_bgb ));}else {_eea =1;};return _cefc ,_eea ,_eafc ;};type symbolStyle struct{_bfdb *string ;
_fgfc *float64 ;_fbed *string ;_ebc *bool ;_gcfd *bool ;_dafc *bool ;_cceb *bool ;_ggg *bool ;};func (_dgaa *convertContext )getStyleColors (_gdgf *_cf .CT_ShapeStyle )(_ag .Color ,_ag .Color ,_ag .Color ){var _cbcf ,_bdge ,_gbfd _ag .Color ;if _bcfa :=_gdgf .LnRef ;
_bcfa !=nil {_bdge =_dgaa .getColorFromMatrixReference (_bcfa );};if _efcda :=_gdgf .FillRef ;_efcda !=nil {_gbfd =_dgaa .getColorFromMatrixReference (_efcda );};if _ded :=_gdgf .FontRef ;_ded !=nil {_cbcf =_dgaa .getColorFromFontReference (_ded );};return _cbcf ,_gbfd ,_bdge ;
};func _eeab (_bafc ,_fcabb *_cf .CT_TextBody )(*_cf .CT_TextBodyProperties ,*_cf .CT_TextListStyle ){if _bafc ==nil &&_fcabb ==nil {return nil ,nil ;};if _bafc ==nil {return _fcabb .BodyPr ,_fcabb .LstStyle ;};if _fcabb ==nil {return _bafc .BodyPr ,_bafc .LstStyle ;
};_ffbcd ,_gggd :=_bafc .BodyPr ,_bafc .LstStyle ;_cedg ,_cdd :=_fcabb .BodyPr ,_fcabb .LstStyle ;_aadg :=_eeca (_ffbcd ,_cedg );_dcea :=_bgab (_gggd ,_cdd );return _aadg ,_dcea ;};func (_bbbae *convertContext )getBorderStyle (_gef *_cf .CT_LineProperties )(_ag .CellBorderStyle ,*_ag .Color ,float64 ){if _gef ==nil ||_gef .LineFillPropertiesChoice .NoFill !=nil {return _ag .CellBorderStyleNone ,nil ,0;
};var _bbddg _ag .Color ;if _fgfe :=_gef .LineFillPropertiesChoice .SolidFill ;_fgfe !=nil {_bbddg ,_ =_bbbae .getColorFromSolidFill (_fgfe );};_geeg :=0.0;if _agef :=_gef .WAttr ;_agef !=nil {_geeg =_fa .FromEMU (int64 (*_agef ));};return _ag .CellBorderStyleSingle ,&_bbddg ,_geeg ;
};func (_dadfa *textboxContext )addTextSymbol (_cfce *symbol ){_faec :=_ag .New ();_caga :=_faec .NewStyledParagraph ();_caga .SetMargins (0,0,0,0);_fdee :=_caga .Append (_cfce ._cgcg );_aade :=0.0;if _cfce ._begb !=nil {_fdee .Style =*_cfce ._begb ;if _cfce ._begb .CharSpacing !=0{_aade =_cfce ._begb .CharSpacing ;
};};_cfce ._gada =_caga .Height ();_cfce ._edag =_caga .Height ()*1.2;if _cfce ._aec ==0{_cfce ._aec =_caga .Width ()+_aade ;};if len (_dadfa ._ece ._dfbd )> 0{_ggb :=_dadfa ._ece ._dfbd [len (_dadfa ._ece ._dfbd )-1]._cgcg ;if _dadfa ._gaa ._cgdb ||_df .IsNoSpaceLanguage (_ggb )||(_ggb =="\u0020")!=(_cfce ._cgcg =="\u0020"){_dadfa .addCurrentWordToParagraph ();
_dadfa .newWord ();};};_dadfa ._ece ._dfbd =append (_dadfa ._ece ._dfbd ,_cfce );_cfce ._befff =_dadfa ._ece ._cfcb ;_dadfa ._ece ._cfcb +=_cfce ._aec ;if _cfce ._cgcg !="\u0020"{_dadfa ._ece ._gbdc =false ;};if _dadfa ._ece ._cfcb >=_dadfa ._gaa ._cgg -_dadfa ._gaa ._bad {_dadfa .addCurrentWordToParagraph ();
_dadfa .newLine ();_dadfa .newWord ();};};func (_egg *convertContext )makePdfBlockFromTable (_daf *_cf .Tbl )*_ag .Table {_agd :=_daf .TblGrid ;if _agd ==nil {return nil ;};_gbbe :=len (_agd .GridCol );if _gbbe ==0{return nil ;};_dcb :=[]float64 {};_fff :=0.0;
for _ ,_bcag :=range _agd .GridCol {_ebf :=_fa .FromEMU (_df .FromSTCoordinate (_bcag .WAttr ));_dcb =append (_dcb ,_ebf );_fff +=_ebf ;};_edgba :=[]float64 {};for _feb :=0;_feb < _gbbe ;_feb ++{_edgba =append (_edgba ,_dcb [_feb ]/_fff );};_cffd :=_egg ._bbbf .NewTable (_gbbe );
_cffd .SetColumnWidths (_edgba ...);_ebba :=_daf .TblPr ;var _acea *_cf .CT_TableStyle ;if _gcga :=_ebba .TablePropertiesChoice ;_gcga !=nil {if _gcga .TableStyle !=nil {_acea =_gcga .TableStyle ;}else if _gcga .TableStyleId !=nil {_acea =_egg ._ggda .GetTableStyleById (*_gcga .TableStyleId );
};};_fgf :=_cf .NewCT_TablePartStyle ();_fgf .TcStyle =_cf .NewCT_TableStyleCellStyle ();_fgf .TcTxStyle =_cf .NewCT_TableStyleTextStyle ();if _acea !=nil {if _acea .WholeTbl !=nil {*_fgf =*_acea .WholeTbl ;};if _acea .TblBg !=nil {if _fgf .TcStyle .ThemeableFillStyleChoice .Fill ==nil {_fgf .TcStyle .ThemeableFillStyleChoice .Fill =_acea .TblBg .ThemeableFillStyleChoice .Fill ;
};};};if _fgf .TcStyle .ThemeableFillStyleChoice .Fill ==nil {_fgf .TcStyle .ThemeableFillStyleChoice .Fill =_cf .NewCT_FillProperties ();_fgf .TcStyle .ThemeableFillStyleChoice .Fill .FillPropertiesChoice .NoFill =_ebba .FillPropertiesChoice .NoFill ;
_fgf .TcStyle .ThemeableFillStyleChoice .Fill .FillPropertiesChoice .SolidFill =_ebba .FillPropertiesChoice .SolidFill ;};_edea :=len (_daf .Tr );_gba :=_daf .TblPr .BandRowAttr !=nil &&*_daf .TblPr .BandRowAttr ;_addec :=_daf .TblPr .FirstRowAttr !=nil &&*_daf .TblPr .FirstRowAttr ;
_gdd :=_daf .TblPr .LastRowAttr !=nil &&*_daf .TblPr .LastRowAttr ;_affa :=_daf .TblPr .BandColAttr !=nil &&*_daf .TblPr .BandColAttr ;_fbad :=_daf .TblPr .FirstColAttr !=nil &&*_daf .TblPr .FirstColAttr ;_accd :=_daf .TblPr .LastColAttr !=nil &&*_daf .TblPr .LastColAttr ;
for _daff ,_ccce :=range _daf .Tr {_dfd :=_daff ==0;_fdcc :=_daff ==_edea -1;_fgc :=_daff %2==0;_gccg :=len (_ccce .Tc );var _dgea *_cf .CT_TablePartStyle ;if _acea !=nil {if _dfd &&_addec {_dgea =_acea .FirstRow ;}else if _fdcc &&_gdd {_dgea =_acea .LastRow ;
}else if _fgc &&_gba {_dgea =_acea .Band2H ;}else if _gba {_dgea =_acea .Band1H ;};};var _dcdc float64 ;for _dfee ,_fdeg :=range _ccce .Tc {_afeg :=_dfee ==0;_gffa :=_dfee ==_gccg -1;_fefe :=_dfee %2==0;var _dda *_cf .CT_TablePartStyle ;if _acea !=nil {if _afeg &&_fbad {_dda =_acea .FirstCol ;
}else if _gffa &&_accd {_dda =_acea .LastCol ;}else if _fefe &&_affa {_dda =_acea .Band2V ;}else if _affa {_dda =_acea .Band1V ;};};_fea :=_dggg (_dggg (_dda ,_dgea ),_fgf );_bfb :=_egg .addCellToTable (_cffd ,_fdeg ,_fea ,_dfd ,_fdcc ,_afeg ,_gffa );if _bfb > _dcdc {_dcdc =_bfb ;
};};_fecb :=_fa .FromEMU (_df .FromSTCoordinate (_ccce .HAttr ));if _fecb < _dcdc {_fecb =_dcdc ;};if _fecb < _faffg (4){_fecb =_faffg (4);};_cffd .SetRowHeight (_cffd .CurRow (),_fecb );};return _cffd ;};func (_eabg *textboxContext )adjustHeights (_eggb float64 ){if _eabg ._aed ._dcbg < _eggb {_eabg ._gaa ._fgag +=(_eggb -_eabg ._aed ._dcbg );
_eabg ._aed ._dcbg =_eggb ;};};type textboxContext struct{_ccbef *convertContext ;_eca float64 ;_gdb float64 ;_dcba *_ag .Creator ;_fdcb float64 ;_dace []*paragraph ;_gaa *paragraph ;_aed *line ;_ece *word ;_aga bool ;};func (_ggcc *convertContext )getShapes (_eg *_ab .CT_Shape ,_afcd bool ,_dce bool )[]_ag .Drawable {_def :=[]_ag .Drawable {};
_aegdb :=_eg .SpPr ;if _aegdb ==nil {return _def ;};var _cbf bool ;if _bded :=_eg .UseBgFillAttr ;_bded !=nil {_cbf =*_bded ;};_bed ,_bbdf ,_bbba ,_edf ,_bff ,_aegg ,_bedg :=_ggcc .getShapesFromSpPr (_aegdb ,_eg .Style ,_cbf ,0.0,0.0);if !_dce {_def =append (_def ,_bed ...);
};if _gbd :=_eg .TxBody ;_gbd !=nil &&!_afcd {_ea ,_gfe ,_gbb ,_cda ,_gfg ,_cce :=_ggcc .getPhData (_eg );if _dce &&!(_cda ||_gfg ){return _def ;};if _ea !=nil &&!_bedg {_bbdf ,_bbba ,_edf ,_bff =_df .GetDataFromXfrm (_ea );};_bfa ,_gab :=_ggcc .makePdfBlockFromTxBody (_gbd ,_gfe ,_gbb ,_edf ,_bff ,_aegg ,_cda ,_cce );
if _gab !=nil {_ba .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_gab );
}else if _bfa !=nil {_bfa .SetPos (_bbdf ,_bbba );_def =append (_def ,_bfa );};};return _def ;};func (_fded *convertContext )makeStyleFromRPr (_aae *_cf .CT_TextCharacterProperties )(*_ag .TextStyle ,bool ,bool ,bool ){var _gbe ,_eda ,_cffg bool ;_gfb :=_fded ._bbbf .NewTextStyle ();
if _aae !=nil {_dgfg :=_df .FontStyle_Regular ;_edga :=_cdga (_aae .BAttr );_dadf :=_cdga (_aae .IAttr );if _edga &&_dadf {_dgfg =_df .FontStyle_BoldItalic ;}else if _edga {_dgfg =_df .FontStyle_Bold ;}else if _dadf {_dgfg =_df .FontStyle_Italic ;};_cffg =_aae .UAttr !=_cf .ST_TextUnderlineTypeUnset &&_aae .UAttr !=_cf .ST_TextUnderlineTypeNone ;
_fgef :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _ddf :=_aae .Latin ;_ddf !=nil {_fgef =_ddf .TypefaceAttr ;}else if _aggc :=_aae .Ea ;_aggc !=nil {_fgef =_aggc .TypefaceAttr ;}else if _gcg :=_aae .Cs ;_gcg !=nil {_fgef =_gcg .TypefaceAttr ;}else if _dfg :=_aae .Sym ;
_dfg !=nil {_fgef =_dfg .TypefaceAttr ;};if _acc ,_fgeg :=_df .StdFontsMap [_fgef ];_fgeg {_gfb .Font =_df .AssignStdFontByName (_gfb ,_acc [_dgfg ]);}else if _faa :=_df .GetRegisteredFont (_fgef ,_dgfg );_faa !=nil {_gfb .Font =_faa ;}else {_ba .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_fgef ,_dgfg );
_gfb .Font =_df .AssignStdFontByName (_gfb ,_df .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_dgfg ]);};var _gcfg float64 ;if _cecf :=_aae .SzAttr ;_cecf !=nil {_gcfg =_fd .Round (float64 (*_cecf )/100)-0.5;}else {_gcfg =_df .DefaultFontSize ;
};if _adbb :=_aae .BaselineAttr ;_adbb !=nil {if _ffbe :=_adbb .ST_PercentageDecimal ;_ffbe !=nil {if *_ffbe > 0{_gbe =true ;}else if *_ffbe < 0{_eda =true ;};};};if _gbe ||_eda {_gcfg =_fd .Round (_gcfg *0.64);};_gfb .FontSize =_gcfg ;_ccfb :=0.0;if _dgda :=_aae .SpcAttr ;
_dgda !=nil {if _dgbg :=_dgda .ST_TextPointUnqualified ;_dgbg !=nil &&*_dgbg > 0{_ccfb =float64 (*_dgbg )/100;};};_gfb .CharSpacing =_ccfb ;};return &_gfb ,_gbe ,_eda ,_cffg ;};func (_aaca *textboxContext )newLine (){if _aaca ._gaa ==nil {_aaca .newParagraph ();
};_abdc :=_aaca ._gaa ._fgag +_aaca ._gaa ._afee ;_dffee :=&line {};_dffee ._bdaa =_aaca ._gaa ._bad ;if len (_aaca ._gaa ._fcc )==0{_dffee ._bdaa +=_aaca ._gaa ._dcae ;};_dffee ._dgba =_aaca ._gaa ._cgg ;_dffee ._fdbb =_dffee ._bdaa ;_dffee ._bceb =_abdc ;
_aaca ._gaa ._fcc =append (_aaca ._gaa ._fcc ,_dffee );_aaca ._aed =_dffee ;};func (_dgc *line )moveRight (_cadcg float64 ){for _ ,_agc :=range _dgc ._facag {_agc ._eae +=_cadcg ;};};var _bgcb =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};
type line struct{_bceb float64 ;_bdaa float64 ;_dgba float64 ;_fdbb float64 ;_dcbg float64 ;_facag []*word ;};func _dbba (_bafd ,_cdff *_cf .CT_TableStyleCellStyle )*_cf .CT_TableStyleCellStyle {_cfe :=_cf .NewCT_TableStyleCellStyle ();if _bafd !=nil {*_cfe =*_bafd ;
};if _cdff ==nil {return _cfe ;};if _cfe .TcBdr ==nil {_cfe .TcBdr =_cdff .TcBdr ;}else {if _cfe .TcBdr .Left ==nil {_cfe .TcBdr .Left =_cdff .TcBdr .Left ;};if _cfe .TcBdr .Right ==nil {_cfe .TcBdr .Right =_cdff .TcBdr .Right ;};if _cfe .TcBdr .Top ==nil {_cfe .TcBdr .Top =_cdff .TcBdr .Top ;
};if _cfe .TcBdr .Bottom ==nil {_cfe .TcBdr .Bottom =_cdff .TcBdr .Bottom ;};if _cfe .TcBdr .InsideH ==nil {_cfe .TcBdr .InsideH =_cdff .TcBdr .InsideH ;};if _cfe .TcBdr .InsideV ==nil {_cfe .TcBdr .InsideV =_cdff .TcBdr .InsideV ;};};if _cfe .ThemeableFillStyleChoice .Fill ==nil {_cfe .ThemeableFillStyleChoice .Fill =_cdff .ThemeableFillStyleChoice .Fill ;
};if _cfe .ThemeableFillStyleChoice .FillRef ==nil {_cfe .ThemeableFillStyleChoice .FillRef =_cdff .ThemeableFillStyleChoice .FillRef ;};return _cfe ;};func (_fefc *textboxContext )alignParagraphsVertically (_addg _cf .ST_TextAnchoringType ){if _addg ==_cf .ST_TextAnchoringTypeT {return ;
};_abeg :=0.0;for _ ,_cgde :=range _fefc ._dace {_abeg +=_cgde ._afee +_cgde ._fgag +_cgde ._fdce ;};var _bgcg float64 ;switch _addg {case _cf .ST_TextAnchoringTypeCtr :_bgcg =(_fefc ._gdb -_abeg )/2;case _cf .ST_TextAnchoringTypeB :_bgcg =_fefc ._gdb -_abeg ;
};for _ ,_fdcgc :=range _fefc ._dace {_fdcgc ._bebe +=_bgcg ;};};func _cgbce (_gbefc *_cf .CT_TableCellProperties ,_dafe *_cf .CT_TableStyleCellStyle ,_fdbgc ,_bec ,_abfac ,_dgff bool )*_cf .CT_TableCellProperties {_baca :=_cf .NewCT_TableCellProperties ();
if _gbefc !=nil {*_baca =*_gbefc ;};if _dafe ==nil {return _baca ;};if _bdc :=_dafe .ThemeableFillStyleChoice .FillRef ;_bdc !=nil {_dec :=_cf .NewCT_SolidColorFillProperties ();_dec .ScrgbClr =_bdc .ScrgbClr ;_dec .SrgbClr =_bdc .SrgbClr ;_dec .HslClr =_bdc .HslClr ;
_dec .SysClr =_bdc .SysClr ;_dec .SchemeClr =_bdc .SchemeClr ;_dec .PrstClr =_bdc .PrstClr ;_baca .FillPropertiesChoice .SolidFill =_dec ;};if _baca .FillPropertiesChoice .NoFill ==nil &&_baca .FillPropertiesChoice .SolidFill ==nil {if _egge :=_dafe .ThemeableFillStyleChoice .Fill ;
_egge !=nil {if _baca .FillPropertiesChoice .NoFill ==nil {_baca .FillPropertiesChoice .NoFill =_egge .FillPropertiesChoice .NoFill ;};if _baca .FillPropertiesChoice .SolidFill ==nil {_baca .FillPropertiesChoice .SolidFill =_egge .FillPropertiesChoice .SolidFill ;
};};};if _cfda :=_dafe .TcBdr ;_cfda !=nil {if _baca .LnL ==nil {var _bfcae *_cf .CT_ThemeableLineStyle ;if _abfac {_bfcae =_cfda .Left ;}else {_bfcae =_cfda .InsideV ;};if _bfcae !=nil {_baca .LnL =_bfcae .ThemeableLineStyleChoice .Ln ;};};if _baca .LnR ==nil {var _dcda *_cf .CT_ThemeableLineStyle ;
if _dgff {_dcda =_cfda .Right ;}else {_dcda =_cfda .InsideV ;};if _dcda !=nil {_baca .LnR =_dcda .ThemeableLineStyleChoice .Ln ;};};if _baca .LnT ==nil {var _ddac *_cf .CT_ThemeableLineStyle ;if _fdbgc {_ddac =_cfda .Top ;}else {_ddac =_cfda .InsideH ;
};if _ddac !=nil {_baca .LnT =_ddac .ThemeableLineStyleChoice .Ln ;};};if _baca .LnB ==nil {var _aedd *_cf .CT_ThemeableLineStyle ;if _bec {_aedd =_cfda .Bottom ;}else {_aedd =_cfda .InsideH ;};if _aedd !=nil {_baca .LnB =_aedd .ThemeableLineStyleChoice .Ln ;
};};};return _baca ;};func (_fcfea *convertContext )applyBlipEffectsOnImg (_ebdf *_ag .Image ,_gadac ,_ageff float64 ,_dacff []*_cf .CT_BlipChoice )*_ag .Image {if len (_dacff )==0{return _ebdf ;};_ebdf .SetPos (_gadac ,_ageff );_gfff ,_dggc :=_fcfea .renderPageWithDrawableToGoImage (_ebdf );
if _dggc !=nil {_ba .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_dggc );
return _ebdf ;};_adgg ,_dggc :=_fcfea .renderCurrentStateToGoImage ();if _dggc !=nil {_ba .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_dggc );
return _ebdf ;};_edbd :=_gfff .Bounds ();_eabaa :=_f .NewRGBA (_edbd );_gfcb ,_fbd :=_ebdf .Width (),_ebdf .Height ();for _ ,_cfaa :=range _dacff {if _adec :=_cfaa .AlphaModFix ;_adec ==nil {continue ;};if _cgdf :=_cfaa .AlphaModFix .AmtAttr ;_cgdf !=nil {if _agbe :=_cgdf .ST_PositivePercentageDecimal ;
_agbe !=nil {_eead :=uint8 (255*(*_agbe )/100000);_edagb :=_f .NewUniform (_e .Alpha {_eead });_b .Draw (_eabaa ,_edbd ,_adgg ,_f .Point {0,0},_b .Src );_b .DrawMask (_eabaa ,_edbd ,_gfff ,_f .Point {0,0},_edagb ,_f .Point {0,0},_b .Over );};};};_ggfd :=_f .Rect (int (_gadac ),int (_ageff ),int (_gadac +_gfcb )+1,int (_ageff +_fbd )+1);
_cebg :=_df .CropImageByRect (_eabaa ,_ggfd );_fgbg ,_dggc :=_fcfea ._bbbf .NewImageFromGoImage (_cebg );if _dggc !=nil {_ba .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_dggc );
return _ebdf ;};return _fgbg ;};func (_ecg *convertContext )getColorFromSolidFill (_gdeb *_cf .CT_SolidColorFillProperties )(_ag .Color ,float64 ){if _gdeb ==nil {return nil ,1;};var _ddgc string ;_dabb :=1.0;if _bcaf :=_gdeb .SrgbClr ;_bcaf !=nil {_ddgc =_bcaf .ValAttr ;
_dabb =_df .GetOpacityFromColorTransform (_bcaf .EG_ColorTransform );}else if _aab :=_gdeb .SchemeClr ;_aab !=nil {_ddgc =_df .GetColorStringFromDmlColor (_ecg ._efc .GetColorBySchemeColor (_aab .ValAttr ));_ddgc =_df .AdjustColor (_ddgc ,_aab .EG_ColorTransform );
_dabb =_df .GetOpacityFromColorTransform (_aab .EG_ColorTransform );};if _ddgc !=""{_aeca :=_ag .ColorRGBFromHex ("\u0023"+_ddgc );return _aeca ,_dabb ;};return nil ,1;};func (_cdf *convertContext )getShapeFromBlipFill (_aeaa *_cf .CT_BlipFillProperties ,_ccfcf ,_ddfb ,_daba ,_gbbc float64 ,_gggg bool )_ag .Drawable {_cfgb ,_gabf ,_ebdg :=_cdf .makePdfImageFromBlipFill (_aeaa ,_gggg );
if _ebdg !=nil {_ba .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_ebdg );
return nil ;};if _cfgb ==nil {return nil ;};if _fcgcd :=_aeaa .FillModePropertiesChoice .Tile ;_fcgcd !=nil {_cfgb =_cdf .tileImage (_cfgb ,_aeaa .FillModePropertiesChoice .Tile ,_daba ,_gbbc );};if _bfff :=_aeaa .FillModePropertiesChoice .Stretch ;_bfff !=nil {_cfgb ,_ccfcf ,_ddfb =_cdf .stretchImage (_cfgb ,_aeaa .FillModePropertiesChoice .Stretch ,_ccfcf ,_ddfb ,_daba ,_gbbc );
};if _cfgb ==nil {return nil ;};if len (_gabf )==0{_cfgb .SetPos (_ccfcf ,_ddfb );return _cfgb ;};_cfgb =_cdf .applyBlipEffectsOnImg (_cfgb ,_ccfcf ,_ddfb ,_gabf );_cfgb .SetPos (_ccfcf ,_ddfb );return _cfgb ;};func (_gfgc *convertContext )renderCurrentStateToGoImage ()(_f .Image ,error ){_degd :=_df .MakeTempCreator (_gfgc ._bebf ,_gfgc ._cgcc );
_degd .NewPage ();for _ ,_fbc :=range _gfgc ._eed {if _fbc !=nil {_degd .MoveTo (0,0);_degd .Draw (_fbc );};};_dffc ,_cfef :=_df .GetPageFromCreator (_degd );if _cfef !=nil {return nil ,_cfef ;};return _dc .NewImageDevice ().Render (_dffc );};func _gffaf (_cfcc float64 )float64 {return _cfcc *_fa .Inch };


// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _df .RegisterFontsFromDirectory (dirName )};func _eeg (_edc *_cf .CT_TextCharacterProperties ,_dgcd *_cf .CT_TableStyleTextStyle )*_cf .CT_TextCharacterProperties {_ddab :=_cf .NewCT_TextCharacterProperties ();
if _edc !=nil {*_ddab =*_edc ;};if _dgcd ==nil {return _ddab ;};if _ddab .BAttr ==nil &&_dgcd .BAttr !=_cf .ST_OnOffStyleTypeUnset {_feaf :=_dgcd .BAttr ==_cf .ST_OnOffStyleTypeOn ;_ddab .BAttr =&_feaf ;};if _ddab .IAttr ==nil &&_dgcd .IAttr !=_cf .ST_OnOffStyleTypeUnset {_bagbc :=_dgcd .IAttr ==_cf .ST_OnOffStyleTypeOn ;
_ddab .IAttr =&_bagbc ;};if _ddab .FillPropertiesChoice .NoFill ==nil &&_ddab .FillPropertiesChoice .SolidFill ==nil {_ddab .FillPropertiesChoice .SolidFill =_cf .NewCT_SolidColorFillProperties ();_ddab .FillPropertiesChoice .SolidFill .ScrgbClr =_dgcd .ScrgbClr ;
_ddab .FillPropertiesChoice .SolidFill .SrgbClr =_dgcd .SrgbClr ;_ddab .FillPropertiesChoice .SolidFill .HslClr =_dgcd .HslClr ;_ddab .FillPropertiesChoice .SolidFill .SysClr =_dgcd .SysClr ;_ddab .FillPropertiesChoice .SolidFill .SchemeClr =_dgcd .SchemeClr ;
_ddab .FillPropertiesChoice .SolidFill .PrstClr =_dgcd .PrstClr ;};if _effbd :=_dgcd .ThemeableFontStylesChoice .Font ;_effbd !=nil &&_ddab .Latin ==nil &&_ddab .Ea ==nil &&_ddab .Cs ==nil {_ddab .Latin =_effbd .Latin ;_ddab .Ea =_effbd .Ea ;_ddab .Cs =_effbd .Cs ;
};return _ddab ;};func (_ggca *textboxContext )alignVertically (_gadd _cf .ST_TextAnchoringType ){_ggca .alignParagraphsVertically (_gadd );_ggca .alignSymbolsVertically ();};func _eaca (_bgce *_ab .CT_CommonSlideData ,_bffe _ab .ST_PlaceholderType ,_aedbb *uint32 )(*_cf .CT_Transform2D ,*_cf .CT_TextBody ,*bool ,*bool ,*bool ){_cgbc :=_aedbb ==nil ;
if _bgce !=nil &&(_bffe !=_ab .ST_PlaceholderTypeUnset ||!_cgbc ){if _cbbe :=_bgce .SpTree ;_cbbe !=nil {for _ ,_fegf :=range _cbbe .GroupShapeChoice {if _fegf !=nil {if _fegf .Sp !=nil {_cdcd ,_ecgg :=_dcce (_fegf .Sp );if _bffe ==_cdcd {if (_cgbc &&_ecgg ==nil )||(!_cgbc &&_ecgg !=nil &&*_ecgg ==*_aedbb ){var _bfca *_cf .CT_Transform2D ;
if _fegf .Sp .SpPr !=nil {_bfca =_fegf .Sp .SpPr .Xfrm ;};_agbb :=_bffe ==_ab .ST_PlaceholderTypeTitle ||_bffe ==_ab .ST_PlaceholderTypeCtrTitle ;_afbf :=_bffe ==_ab .ST_PlaceholderTypeSubTitle ;_bbde :=!_agbb &&_bffe !=_ab .ST_PlaceholderTypeUnset ;return _bfca ,_fegf .Sp .TxBody ,&_agbb ,&_afbf ,&_bbde ;
};};};};};};};return nil ,nil ,nil ,nil ,nil ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func _eeca (_ceafe ,_ededa *_cf .CT_TextBodyProperties )*_cf .CT_TextBodyProperties {_gefg :=_cf .NewCT_TextBodyProperties ();
if _ceafe !=nil {*_gefg =*_ceafe ;};if _ededa ==nil {return _gefg ;};if _gefg .RotAttr ==nil {_gefg .RotAttr =_ededa .RotAttr ;};if _gefg .SpcFirstLastParaAttr ==nil {_gefg .SpcFirstLastParaAttr =_ededa .SpcFirstLastParaAttr ;};if _gefg .VertOverflowAttr ==_cf .ST_TextVertOverflowTypeUnset {_gefg .VertOverflowAttr =_ededa .VertOverflowAttr ;
};if _gefg .HorzOverflowAttr ==_cf .ST_TextHorzOverflowTypeUnset {_gefg .HorzOverflowAttr =_ededa .HorzOverflowAttr ;};if _gefg .VertAttr ==_cf .ST_TextVerticalTypeUnset {_gefg .VertAttr =_ededa .VertAttr ;};if _gefg .WrapAttr ==_cf .ST_TextWrappingTypeUnset {_gefg .WrapAttr =_ededa .WrapAttr ;
};if _gefg .LInsAttr ==nil {_gefg .LInsAttr =_ededa .LInsAttr ;};if _gefg .TInsAttr ==nil {_gefg .TInsAttr =_ededa .TInsAttr ;};if _gefg .RInsAttr ==nil {_gefg .RInsAttr =_ededa .RInsAttr ;};if _gefg .BInsAttr ==nil {_gefg .BInsAttr =_ededa .BInsAttr ;
};if _gefg .NumColAttr ==nil {_gefg .NumColAttr =_ededa .NumColAttr ;};if _gefg .SpcColAttr ==nil {_gefg .SpcColAttr =_ededa .SpcColAttr ;};if _gefg .RtlColAttr ==nil {_gefg .RtlColAttr =_ededa .RtlColAttr ;};if _gefg .AnchorAttr ==_cf .ST_TextAnchoringTypeUnset {_gefg .AnchorAttr =_ededa .AnchorAttr ;
};if _gefg .AnchorCtrAttr ==nil {_gefg .AnchorCtrAttr =_ededa .AnchorCtrAttr ;};if _gefg .ForceAAAttr ==nil {_gefg .ForceAAAttr =_ededa .ForceAAAttr ;};if _gefg .UprightAttr ==nil {_gefg .UprightAttr =_ededa .UprightAttr ;};if _gefg .CompatLnSpcAttr ==nil {_gefg .CompatLnSpcAttr =_ededa .CompatLnSpcAttr ;
};if _gefg .PrstTxWarp ==nil {_gefg .PrstTxWarp =_ededa .PrstTxWarp ;};if _gefg .TextAutofitChoice .NoAutofit ==nil {_gefg .TextAutofitChoice .NoAutofit =_ededa .TextAutofitChoice .NoAutofit ;};if _gefg .TextAutofitChoice .NormAutofit ==nil {_gefg .TextAutofitChoice .NormAutofit =_ededa .TextAutofitChoice .NormAutofit ;
};if _gefg .TextAutofitChoice .SpAutoFit ==nil {_gefg .TextAutofitChoice .SpAutoFit =_ededa .TextAutofitChoice .SpAutoFit ;};if _gefg .Scene3d ==nil {_gefg .Scene3d =_ededa .Scene3d ;};if _gefg .Text3DChoice .Sp3d ==nil {_gefg .Text3DChoice .Sp3d =_ededa .Text3DChoice .Sp3d ;
};if _gefg .Text3DChoice .FlatTx ==nil {_gefg .Text3DChoice .FlatTx =_ededa .Text3DChoice .FlatTx ;};if _gefg .ExtLst ==nil {_gefg .ExtLst =_ededa .ExtLst ;};return _gefg ;};func (_bbc *convertContext )addShapes (_baeg *_ab .CT_CommonSlideData ,_abf bool ){if _baeg ==nil {return ;
};_cc :=&background {};if _aeg :=_baeg .Bg ;_aeg !=nil {if _gee :=_aeg .BackgroundChoice .BgPr ;_gee !=nil {if _gee .FillPropertiesChoice .NoFill ==nil {if _bacc :=_gee .FillPropertiesChoice .SolidFill ;_bacc !=nil {_dge ,_aa :=_bbc .getColorFromSolidFill (_bacc );
if _dge !=nil {_cc ._agf =_dge ;_cc ._dceg =_aa ;};}else if _cbe :=_gee .FillPropertiesChoice .BlipFill ;_cbe !=nil {_cc ._cfbe =_cbe ;};};};};_bbc ._dded =_cc ;if _bc :=_baeg .SpTree ;_bc !=nil {for _ ,_fae :=range _bc .GroupShapeChoice {if _fae !=nil {if _fae .Sp !=nil {_abd :=_bbc .getShapes (_fae .Sp ,_abf ,false );
_bbc ._eed =append (_bbc ._eed ,_abd ...);};if _fae .GraphicFrame !=nil {var _ccf ,_cca ,_gg ,_bg float64 ;if _fec :=_fae .GraphicFrame .Xfrm ;_fec !=nil {_ccf ,_cca ,_gg ,_bg =_df .GetDataFromXfrm (_fec );};if _gg ==0&&_bg ==0{_gg =_bbc ._bebf ;_bg =_bbc ._cgcc ;
};if _baa :=_fae .GraphicFrame .Graphic ;_baa !=nil {if _gc :=_baa .GraphicData ;_gc !=nil {for _ ,_dad :=range _gc .Any {if _bgc ,_fgg :=_dad .(*_gd .Chart );_fgg {_eb ,_gb :=_bbc .makePdfBlockFromChart (_bgc ,_gg ,_bg );if _gb !=nil {_ba .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_gb );
};if _eb !=nil {_eb .SetPos (_ccf ,_cca );_bbc ._eed =append (_bbc ._eed ,_eb );};}else if _fcf ,_agg :=_dad .(*_cf .Tbl );_agg {_ebd :=_bbc .makePdfBlockFromTable (_fcf );if _ebd !=nil {_bce :=_ag .NewBlock (_gg ,_bg );_bce .SetPos (_ccf ,_cca );_dcdb :=_bce .Draw (_ebd );
if _dcdb !=nil {_ba .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0064r\u0061\u0077\u0020\u0074\u0061b\u006c\u0065\u003a\u0020\u0025\u0073",_dcdb );if _dcdb ==_ag .ErrContentNotFit {_bce =_ag .NewBlock (_bbc ._bebf -1.5*_ccf ,_bbc ._cgcc -1.5*_cca );_bce .SetPos (_ccf ,_cca );
_dcdb =_bce .Draw (_ebd );};};if _dcdb ==nil {_bbc ._eed =append (_bbc ._eed ,_bce );};};};};};};};if _fae .CxnSp !=nil {_fge :=_bbc .getConnectors (_fae .CxnSp );_bbc ._eed =append (_bbc ._eed ,_fge ...);};if _fae .GrpSp !=nil {_bbb :=0.0;_eec :=0.0;if _bdd :=_fae .GrpSp .GrpSpPr .Xfrm ;
_bdd !=nil {_bbb ,_eec =_df .GetGroupOffsetFromXfrm (_bdd );};for _ ,_fda :=range _fae .GrpSp .GroupShapeChoice {if _fda .CxnSp !=nil {_gde :=_bbc .getGroupConnectors (_fda .CxnSp ,_bbb ,_eec );_bbc ._eed =append (_bbc ._eed ,_gde ...);};};};if _fae .Pic !=nil {_ebb :=false ;
var _bda ,_bbeg ,_cfb ,_aac float64 ;if _bgd :=_fae .Pic .SpPr ;_bgd !=nil {if _aea :=_bgd .Xfrm ;_aea !=nil {_bda ,_bbeg ,_cfb ,_aac =_df .GetDataFromXfrm (_aea );_ebb =true ;};};var _eff _ab .ST_PlaceholderType ;var _dfe *uint32 ;if _acb :=_fae .Pic .NvPicPr ;
_acb !=nil {if _bag :=_acb .NvPr ;_bag !=nil {if _ccc :=_bag .Ph ;_ccc !=nil {_eff =_ccc .TypeAttr ;_dfe =_ccc .IdxAttr ;};};};_bfg ,_ ,_ ,_ ,_ :=_eaca (_bbc ._acff .CSld ,_eff ,_dfe );_deg ,_ ,_ ,_ ,_ :=_eaca (_bbc ._caf .CSld ,_eff ,_dfe );if _deg ==nil {_deg =_bfg ;
};if _deg !=nil &&!_ebb {_bda ,_bbeg ,_cfb ,_aac =_df .GetDataFromXfrm (_deg );};if _fdag :=_fae .Pic .BlipFill ;_fdag !=nil {_dcc :=_bbc .getShapeFromBlipFill (_fdag ,_bda ,_bbeg ,_cfb ,_aac ,_abf );_bbc ._eed =append (_bbc ._eed ,_dcc );};};};};};};type convertContext struct{_bbbf *_ag .Creator ;
_bbgc *_df .Rectangle ;_ggda *_fg .Presentation ;_efc *_fg .Slide ;_acff *_ab .SldMaster ;_caf *_ab .SldLayout ;_cgcc float64 ;_bebf float64 ;_eed []_ag .Drawable ;_dded *background ;_ggccd *_cf .CT_TextParagraphProperties ;_gede *_cf .CT_TextCharacterProperties ;
_gace *_cf .CT_TextParagraphProperties ;_fdga *_cf .CT_TextCharacterProperties ;_bfac *_cf .CT_TextParagraphProperties ;_cfd *_cf .CT_TextCharacterProperties ;_gdg []*_cf .CT_TextParagraphProperties ;_fca []*_cf .CT_TextParagraphProperties ;_defe []*_cf .CT_TextParagraphProperties ;
_dfgc *_cf .Theme ;_ccde *_cf .CT_ColorMappingOverride ;};func (_fgb *convertContext )getPhData (_ecda *_ab .CT_Shape )(*_cf .CT_Transform2D ,*_cf .CT_TextBodyProperties ,*_cf .CT_TextListStyle ,bool ,bool ,bool ){_gbef ,_bcee :=_dcce (_ecda );_caa ,_ecaf ,_afg ,_aabe ,_ceg :=_eaca (_fgb ._acff .CSld ,_gbef ,_bcee );
_eaac ,_cecg ,_feae ,_acef ,_bdadg :=_eaca (_fgb ._caf .CSld ,_gbef ,_bcee );if _eaac ==nil {_eaac =_caa ;};_aafa ,_eee :=_eeab (_cecg ,_ecaf );var _bafac ,_cdde ,_cdaf bool ;if _feae ==nil {if _afg !=nil {_bafac =*_afg ;};}else {_bafac =*_feae ;};if _bdadg ==nil {if _ceg !=nil {_cdaf =*_ceg ;
};}else {_cdaf =*_bdadg ;};if _acef ==nil {if _aabe !=nil {_cdde =*_aabe ;};}else {_cdde =*_acef ;};return _eaac ,_aafa ,_eee ,_bafac ,_cdde ,_cdaf ;};func _bagf (_edgg int ,_ffed bool )string {_adee :=(_edgg -1)/26+1;_dgfe :=byte ((_edgg -1)%26);if _ffed {_dgfe +=byte (65);
}else {_dgfe +=byte (97);};_abfa :=_c .NewBuffer ([]byte {});for _gbfb :=0;_gbfb < _adee ;_gbfb ++{_abfa .Write ([]byte {_dgfe });};return _abfa .String ();};func (_gafd *textboxContext )addPrefix (_babg *prefixData ,_deea *_ag .TextStyle ){_gedc :=_dbeb (_babg ._dcec );
_ebec :=*_deea ;if _babg ._bcg {_ebec .Font =_df .AssignStdFontByName (_ebec ,"\u0053\u0079\u006d\u0062\u006f\u006c");};for _ ,_cfaf :=range _gedc {_cfaf ._begb =&_ebec ;_gafd .addTextSymbol (_cfaf );};_bge :=-(_babg ._eaf +_gafd ._ece ._cfcb );if _bge < 0{_bge =0;
};_ega :=&symbol {_cgcg :"\u0020",_aec :_bge };_gafd .addTextSymbol (_ega );_gafd ._ece ._eae +=(_babg ._eaf +_babg ._eefc );};func (_bbg *convertContext )makeSlide (){_aegd :=_bbg ._efc .GetSlideLayout ().CSld ;_bbg .addShapes (_aegd ,true );_aegd =_bbg ._efc .X ().CSld ;
_bbg .addShapes (_aegd ,false );};type romanMatch struct{_gacd int ;_bdbg string ;};func (_fcef *textboxContext )addCurrentParagraph (){_fcef ._fdcb =_fcef ._gaa ._bebe +_fcef ._gaa ._afee +_fcef ._gaa ._fgag +_fcef ._gaa ._fdce ;_fcef ._dace =append (_fcef ._dace ,_fcef ._gaa );
_fcef .alignParagraph ();};func (_cbeg *convertContext )stretchImage (_fga *_ag .Image ,_cff *_cf .CT_StretchInfoProperties ,_face ,_gaf ,_fbf ,_efb float64 )(*_ag .Image ,float64 ,float64 ){_fba :=_cff .FillRect ;if _fba ==nil {_bgg :=_fga .Width ()/_fga .Height ();
_bdg :=_fbf /_efb ;var _ede ,_beb float64 ;if _bgg > _bdg {_beb =_efb ;_ede =_efb *_bgg ;}else {_ede =_fbf ;_beb =_fbf /_bgg ;};_fga .Scale (_ede /_fga .Width (),_beb /_fga .Height ());return _fga ,_face ,_gaf ;};var _dag ,_bbdb ,_ccd ,_bcdf float64 ;if _degg :=_fba .LAttr ;
_degg !=nil {_ccd =_df .FromSTPercentage (_degg );};if _edg :=_fba .TAttr ;_edg !=nil {_dag =_df .FromSTPercentage (_edg );};if _bcde :=_fba .RAttr ;_bcde !=nil {_bcdf =_df .FromSTPercentage (_bcde );};if _afd :=_fba .BAttr ;_afd !=nil {_bbdb =_df .FromSTPercentage (_afd );
};_bef :=_fbf *(1-_ccd -_bcdf );_dea :=_efb *(1-_dag -_bbdb );_fga .Scale (_bef /_fga .Width (),_dea /_fga .Height ());return _fga ,_face +_ccd *_fbf ,_gaf +_dag *_efb ;};func (_ffcg *convertContext )getConnectors (_cgb *_ab .CT_Connector )[]_ag .Drawable {_cec ,_ ,_ ,_ ,_ ,_ ,_ :=_ffcg .getShapesFromSpPr (_cgb .SpPr ,_cgb .Style ,false ,0.0,0.0);
return _cec ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_df .FontStyle ;type word struct{_dfbd []*symbol ;_eae float64 ;_cfcb float64 ;_gbdc bool ;};func (_dba *convertContext )makePdfBlockFromTxBody (_fbae *_cf .CT_TextBody ,_ecb *_cf .CT_TextBodyProperties ,_baec *_cf .CT_TextListStyle ,_bbge ,_ddcb float64 ,_bbdd _ag .Color ,_cbfg ,_geb bool )(*_ag .Block ,error ){var _dfa *_cf .CT_TextParagraphProperties ;
if _adde :=_fbae .LstStyle ;_adde !=nil {var _efd *_cf .CT_TextParagraphProperties ;if _adde .Lvl1pPr !=nil {_efd =_adde .Lvl1pPr ;};_dfa =_bgea (_efd ,_adde .DefPPr );};var _bbbc *_cf .CT_TextParagraphProperties ;if _dfa !=nil {if _cbfg {_bbbc =_dba ._fca [0];
}else if _geb {_bbbc =_dba ._defe [0];}else {_bbbc =_dba ._gdg [0];};if _baec !=nil {_bbbc =_bgea (_bgea (_baec .Lvl1pPr ,_baec .DefPPr ),_bbbc );};_bbbc =_bgea (_dfa ,_bbbc );}else {if _cbfg {_bbbc =_dba ._gace ;}else if _geb {_bbbc =_dba ._bfac ;}else {_bbbc =_dba ._ggccd ;
};};_ddcbg ,_dage :=_faffg (2.5),_faffg (2.5);_dcaa ,_bea :=_faffg (1.3),_faffg (1.3);_cada :=true ;_fdfg :=_cf .ST_TextAnchoringTypeT ;if _ecb !=nil {if _aag :=_ecb .AnchorAttr ;_aag !=_cf .ST_TextAnchoringTypeUnset {_fdfg =_aag ;};};if _gcf :=_fbae .BodyPr ;
_gcf !=nil {if _fcgc :=_gcf .LInsAttr ;_fcgc !=nil {_ddcbg =_fa .FromEMU (_df .FromSTCoordinate32 (*_fcgc ));};if _dfed :=_gcf .TInsAttr ;_dfed !=nil {_dcaa =_fa .FromEMU (_df .FromSTCoordinate32 (*_dfed ));};if _ageg :=_gcf .RInsAttr ;_ageg !=nil {_dage =_fa .FromEMU (_df .FromSTCoordinate32 (*_ageg ));
};if _agb :=_gcf .BInsAttr ;_agb !=nil {_bea =_fa .FromEMU (_df .FromSTCoordinate32 (*_agb ));};_cada =_gcf .WrapAttr !=_cf .ST_TextWrappingTypeNone ;if _gff :=_gcf .AnchorAttr ;_gff !=_cf .ST_TextAnchoringTypeUnset {_fdfg =_gcf .AnchorAttr ;};};_geec :=_df .MakeTempCreator (_bbge ,_ddcb );
_geec .SetPageMargins (_ddcbg ,_dage ,_dcaa ,_bea );_bfcg :=&textboxContext {_ccbef :_dba ,_aga :_cada ,_eca :_bbge -_ddcbg -_dage ,_gdb :_ddcb -_dcaa -_bea ,_dcba :_geec ,_dace :[]*paragraph {}};_ebbc :=1;for _ ,_dcad :=range _fbae .P {if _dcad !=nil {_fag :=_dcad .PPr ;
var _agga *prefixData ;if _fag !=nil &&_fag .TextBulletChoice .BuNone ==nil {var _cbff string ;var _ccdf bool ;if _agea :=_fag .TextBulletChoice .BuAutoNum ;_agea !=nil {var _dga string ;if _ccdb :=_agea .StartAtAttr ;_ccdb !=nil {_ebbc =int (*_ccdb );
};var _ggf string ;switch _agea .TypeAttr {case _cf .ST_TextAutonumberSchemeAlphaUcParenBoth ,_cf .ST_TextAutonumberSchemeAlphaUcParenR ,_cf .ST_TextAutonumberSchemeAlphaUcPeriod :_ggf =_bagf (_ebbc ,true );case _cf .ST_TextAutonumberSchemeAlphaLcParenBoth ,_cf .ST_TextAutonumberSchemeAlphaLcParenR ,_cf .ST_TextAutonumberSchemeAlphaLcPeriod :_ggf =_bagf (_ebbc ,false );
case _cf .ST_TextAutonumberSchemeRomanUcParenBoth ,_cf .ST_TextAutonumberSchemeRomanUcParenR ,_cf .ST_TextAutonumberSchemeRomanUcPeriod :_ggf =_dab (_ebbc ,true );case _cf .ST_TextAutonumberSchemeRomanLcParenBoth ,_cf .ST_TextAutonumberSchemeRomanLcParenR ,_cf .ST_TextAutonumberSchemeRomanLcPeriod :_ggf =_dab (_ebbc ,false );
default:_ggf =_ef .Itoa (_ebbc );};switch _agea .TypeAttr {case _cf .ST_TextAutonumberSchemeAlphaLcPeriod ,_cf .ST_TextAutonumberSchemeAlphaUcPeriod ,_cf .ST_TextAutonumberSchemeArabicPeriod ,_cf .ST_TextAutonumberSchemeRomanLcPeriod ,_cf .ST_TextAutonumberSchemeRomanUcPeriod ,_cf .ST_TextAutonumberSchemeArabicDbPeriod ,_cf .ST_TextAutonumberSchemeEa1ChsPeriod ,_cf .ST_TextAutonumberSchemeEa1ChtPeriod ,_cf .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_cf .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_cf .ST_TextAutonumberSchemeThaiAlphaPeriod ,_cf .ST_TextAutonumberSchemeThaiNumPeriod ,_cf .ST_TextAutonumberSchemeHindiAlphaPeriod ,_cf .ST_TextAutonumberSchemeHindiNumPeriod ,_cf .ST_TextAutonumberSchemeHindiAlpha1Period :_dga ="\u002e";
case _cf .ST_TextAutonumberSchemeAlphaLcParenR ,_cf .ST_TextAutonumberSchemeAlphaUcParenR ,_cf .ST_TextAutonumberSchemeArabicParenR ,_cf .ST_TextAutonumberSchemeRomanLcParenR ,_cf .ST_TextAutonumberSchemeRomanUcParenR ,_cf .ST_TextAutonumberSchemeThaiAlphaParenR ,_cf .ST_TextAutonumberSchemeThaiNumParenR ,_cf .ST_TextAutonumberSchemeHindiNumParenR :_dga ="\u0029";
};_cbff =_ggf +_dga ;_ebbc ++;}else if _cdg :=_fag .TextBulletChoice .BuChar ;_cdg !=nil {_ebge :=_cdg .CharAttr ;if _afb ,_ceff :=_ddedc [_ebge ];_ceff {_ebge =string (rune (_afb ));}else {_ebge ="\u2022";};_cbff =_ebge ;_ccdf =true ;};if _cbff !=""{var _dgfd ,_ddge float64 ;
if _fag .MarLAttr !=nil {_dgfd =_fa .FromEMU (int64 (*_fag .MarLAttr ));};if _fag .IndentAttr !=nil {_ddge =_fa .FromEMU (int64 (*_fag .IndentAttr ));};_agga =&prefixData {_dcec :_cbff ,_bcg :_ccdf ,_eefc :_dgfd ,_eaf :_ddge };};};_fag =_bgea (_fag ,_bbbc );
_gccb :=_gaba (_dcad .EndParaRPr ,_fag .DefRPr );_bfcg .newParagraph ();_bfcg .assignPropsToCurrentParagraph (_fag );_bfcg .newLine ();_bfcg .newWord ();for _fdd ,_dfb :=range _dcad .EG_TextRun {_bfcg .addTextRun (_dfb ,_gccb ,_bbdd ,_agga );if _fdd > 0{_agga =nil ;
};};_bfcg .addCurrentWordToParagraph ();};_bfcg .addCurrentParagraph ();};_bfcg .alignVertically (_fdfg );_bfcg .drawParagraphs ();return _df .MakeBlockFromCreator (_geec );};type background struct{_agf _ag .Color ;_dceg float64 ;_cfbe *_cf .CT_BlipFillProperties ;
};func _dcce (_gaab *_ab .CT_Shape )(_ab .ST_PlaceholderType ,*uint32 ){if _bbec :=_gaab .NvSpPr ;_bbec !=nil {if _bedf :=_bbec .NvPr ;_bedf !=nil {if _bcdce :=_bedf .Ph ;_bcdce !=nil {return _bcdce .TypeAttr ,_bcdce .IdxAttr ;};};};return _ab .ST_PlaceholderTypeUnset ,nil ;
};func (_dac *convertContext )addCellToTable (_gege *_ag .Table ,_bgf *_cf .CT_TableCell ,_fbe *_cf .CT_TablePartStyle ,_daa ,_dbd ,_ddde ,_edgc bool )float64 {var _ebe *_ag .TableCell ;_beaf :=1;if _bgf .GridSpanAttr !=nil {_beaf =int (*_bgf .GridSpanAttr );
};_ebe =_gege .MultiColCell (_beaf );_aee :=_bgf .TcPr ;var _acfb *_cf .CT_TableStyleTextStyle ;if _fbe !=nil {_aee =_cgbce (_aee ,_fbe .TcStyle ,_daa ,_dbd ,_ddde ,_edgc );_acfb =_fbe .TcTxStyle ;};_eba :=_ad ;_beg :=_ag .CellVerticalAlignmentMiddle ;
_aaf :=_gffaf (0.05);_adga :=_gffaf (0.05);if _aee !=nil {if _dbgc :=_aee .LnL ;_dbgc !=nil {_bbed ,_cee ,_fbbe :=_dac .getBorderStyle (_dbgc );_ebe .SetBorder (_ag .CellBorderSideLeft ,_bbed ,_fbbe );if _cee !=nil &&*_cee !=nil {_ebe .SetSideBorderColor (_ag .CellBorderSideLeft ,*_cee );
};};if _ffga :=_aee .LnT ;_ffga !=nil {_bbege ,_faca ,_gfag :=_dac .getBorderStyle (_ffga );_ebe .SetBorder (_ag .CellBorderSideTop ,_bbege ,_gfag );if _faca !=nil &&*_faca !=nil {_ebe .SetSideBorderColor (_ag .CellBorderSideTop ,*_faca );};};if _feg :=_aee .LnR ;
_feg !=nil {_bfddc ,_gbf ,_fgd :=_dac .getBorderStyle (_feg );_ebe .SetBorder (_ag .CellBorderSideRight ,_bfddc ,_fgd );if _gbf !=nil &&*_gbf !=nil {_ebe .SetSideBorderColor (_ag .CellBorderSideRight ,*_gbf );};};if _ggd :=_aee .LnB ;_ggd !=nil {_eaba ,_ecd ,_cag :=_dac .getBorderStyle (_ggd );
_ebe .SetBorder (_ag .CellBorderSideBottom ,_eaba ,_cag );if _ecd !=nil &&*_ecd !=nil {_ebe .SetSideBorderColor (_ag .CellBorderSideBottom ,*_ecd );};};if _bbee :=_aee .MarLAttr ;_bbee !=nil {_eba =float64 (_df .FromSTCoordinate32 (*_bbee ));};switch _aee .AnchorAttr {case _cf .ST_TextAnchoringTypeT :_beg =_ag .CellVerticalAlignmentTop ;
case _cf .ST_TextAnchoringTypeB :_beg =_ag .CellVerticalAlignmentBottom ;};if _aee .FillPropertiesChoice .NoFill ==nil {if _cdae :=_aee .FillPropertiesChoice .SolidFill ;_cdae !=nil {_ccbe ,_cadc :=_dac .getColorFromSolidFill (_cdae );_ebe .SetOpacity (_cadc );
_ebe .SetBackgroundColor (_ccbe );};};if _fdaef :=_aee .MarBAttr ;_fdaef !=nil {_aaf =float64 (_df .FromSTCoordinate32 (*_fdaef ));};if _dfag :=_aee .MarTAttr ;_dfag !=nil {_adga =float64 (_df .FromSTCoordinate32 (*_dfag ));};};_ebe .SetVerticalAlignment (_beg );
_ebe .SetIndent (_eba );var _gfec float64 ;if _fdb :=_bgf .TxBody ;_fdb !=nil {_ffbb :=_dac .makePdfDivisionFromTxBody (_fdb ,_acfb );_gfec =_ffbb .Height ()+_adga +_aaf ;_ebe .SetContent (_ffbb );};return _gfec ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_ed .PdfFont ){_df .RegisterFont (name ,style ,font );};func (_cg *convertContext )drawSlide (){_cg ._bbbf .NewPage ();for _ ,_be :=range _cg ._eed {if _be !=nil {_cg ._bbbf .MoveTo (0,0);_cg ._bbbf .Draw (_be );
};};};func (_gfa *convertContext )getGroupConnectors (_bafa *_ab .CT_Connector ,_bga float64 ,_fde float64 )[]_ag .Drawable {_cad ,_ ,_ ,_ ,_ ,_ ,_ :=_gfa .getShapesFromSpPr (_bafa .SpPr ,_bafa .Style ,false ,_bga ,_fde );return _cad ;};func (_fdf *convertContext )makePdfBlockFromChart (_bf *_gd .Chart ,_cd ,_bba float64 )(*_ag .Block ,error ){_ec :=_bf .CT_RelId .IdAttr ;
_bbd :=_fdf ._efc .GetChartSpaceByRelId (_ec );if _bbd ==nil {return nil ,_a .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _db *_cf .Theme ;_da :=_fdf ._ggda .Themes ();if len (_da )> 0{_db =_da [0];};return _df .MakeBlockFromChartSpace (_bbd ,_cd ,_bba ,_db );
};

// Options contains the options for convert process
type Options struct{

// DefaultPageSize is applied when there is no page size explicitly set in the document.
// A4 is the default option.
DefaultPageSize _df .PageSize ;};func (_dafg *convertContext )makePdfImageFromBlipFill (_gga *_cf .CT_BlipFillProperties ,_ddbb bool )(*_ag .Image ,[]*_cf .CT_BlipChoice ,error ){if _bdad :=_gga .Blip ;_bdad !=nil {if _bcff :=_bdad .EmbedAttr ;_bcff !=nil {var _fdbgf _bb .ImageRef ;
var _cagag bool ;if _ddbb {_fdbgf ,_cagag =_dafg ._efc .GetLayoutImageByRelID (*_bcff );}else {_fdbgf ,_cagag =_dafg ._efc .GetImageByRelID (*_bcff );};if _cagag {_eecd ,_cgcff :=_ac .Open (_fdbgf .Path ());if _cgcff !=nil {_ba .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_cgcff );
return nil ,nil ,_cgcff ;};defer _eecd .Close ();_efcd ,_ ,_cgcff :=_f .Decode (_eecd );if _cgcff !=nil {_ba .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_cgcff );return nil ,nil ,_cgcff ;
};if _eada :=_gga .SrcRect ;_eada !=nil {_gcedb :=_efcd .Bounds ().Size ();_fbee :=_gcedb .X ;_bgde :=_gcedb .Y ;var _fgdg ,_gafe ,_cgce ,_gfagc int ;var _aafg bool ;if _baecd :=_eada .LAttr ;_baecd !=nil {_fgdg =int (float64 (_fbee )*_df .FromSTPercentage (_baecd ));
_aafg =true ;}else {_fgdg =0;};if _agaf :=_eada .TAttr ;_agaf !=nil {_cgce =int (float64 (_bgde )*_df .FromSTPercentage (_agaf ));_aafg =true ;}else {_cgce =0;};if _bgfg :=_eada .RAttr ;_bgfg !=nil {_gafe =int (float64 (_fbee )*(1-_df .FromSTPercentage (_bgfg )));
_aafg =true ;}else {_gafe =_fbee ;};if _bcdc :=_eada .BAttr ;_bcdc !=nil {_gfagc =int (float64 (_bgde )*(1-_df .FromSTPercentage (_bcdc )));_aafg =true ;}else {_gfagc =_bgde ;};if _aafg {_efcd =_df .CropImageByRect (_efcd ,_f .Rect (_fgdg ,_cgce ,_gafe +1,_gfagc +1));
};};_feba ,_cgcff :=_dafg ._bbbf .NewImageFromGoImage (_efcd );_feba .SetEncoder (_fac .NewFlateEncoder ());if _g .ToLower (_fdbgf .Format ())=="\u006a\u0070\u0067"||_g .ToLower (_fdbgf .Format ())=="\u006a\u0070\u0065\u0067"{_feba .SetEncoder (_fac .NewDCTEncoder ());
};if _cgcff !=nil {_ba .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_cgcff );
return nil ,nil ,_cgcff ;};return _feba ,_bdad .BlipChoice ,nil ;};};};return nil ,nil ,nil ;};func _dbeb (_dcdga string )[]*symbol {_cfc :=[]*symbol {};for _ ,_edff :=range _dcdga {_cfc =append (_cfc ,&symbol {_cgcg :string (_edff )});};return _cfc ;};
var _ad =_faffg (1.9);func (_fgff *textboxContext )addCurrentWordToParagraph (){if _fgff ._aga &&_fgff ._aed ._fdbb +_fgff ._ece ._cfcb > _fgff ._aed ._dgba {_fgff .newLine ();};if !_fgff ._ece ._gbdc ||len (_fgff ._aed ._facag )> 0{_fgff ._ece ._eae =_fgff ._aed ._fdbb ;
_fgff ._aed ._facag =append (_fgff ._aed ._facag ,_fgff ._ece );_fgff ._aed ._fdbb +=_fgff ._ece ._cfcb ;for _ ,_cbfb :=range _fgff ._ece ._dfbd {_fgff .adjustHeights (_cbfb ._edag );};};};func (_bab *textboxContext )newParagraph (){_bfe :=&paragraph {};
_bfe ._bebe =_bab ._fdcb ;_bab ._gaa =_bfe ;};func _faffg (_fcga float64 )float64 {return _fcga *_fa .Millimeter };func _cdga (_fbg *bool )bool {return _fbg !=nil &&*_fbg };func _bgab (_bbad ,_gdcf *_cf .CT_TextListStyle )*_cf .CT_TextListStyle {_fcdf :=_cf .NewCT_TextListStyle ();
if _bbad !=nil {*_fcdf =*_bbad ;};if _gdcf ==nil {return _fcdf ;};_fcdf .DefPPr =_bgea (_fcdf .DefPPr ,_gdcf .DefPPr );_fcdf .Lvl1pPr =_bgea (_fcdf .Lvl1pPr ,_gdcf .Lvl1pPr );_fcdf .Lvl2pPr =_bgea (_fcdf .Lvl2pPr ,_gdcf .Lvl2pPr );_fcdf .Lvl3pPr =_bgea (_fcdf .Lvl3pPr ,_gdcf .Lvl3pPr );
_fcdf .Lvl4pPr =_bgea (_fcdf .Lvl4pPr ,_gdcf .Lvl4pPr );_fcdf .Lvl5pPr =_bgea (_fcdf .Lvl5pPr ,_gdcf .Lvl5pPr );_fcdf .Lvl6pPr =_bgea (_fcdf .Lvl6pPr ,_gdcf .Lvl6pPr );_fcdf .Lvl7pPr =_bgea (_fcdf .Lvl7pPr ,_gdcf .Lvl7pPr );_fcdf .Lvl8pPr =_bgea (_fcdf .Lvl8pPr ,_gdcf .Lvl8pPr );
_fcdf .Lvl9pPr =_bgea (_fcdf .Lvl9pPr ,_gdcf .Lvl9pPr );return _fcdf ;};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_fg .Presentation )*_ag .Creator {return ConvertToPdfWithOptions (pr ,nil )};func _bgea (_dadff ,_gca *_cf .CT_TextParagraphProperties )*_cf .CT_TextParagraphProperties {_ddfc :=_cf .NewCT_TextParagraphProperties ();if _dadff !=nil {*_ddfc =*_dadff ;
};if _gca ==nil {return _ddfc ;};if _ddfc .MarLAttr ==nil {_ddfc .MarLAttr =_gca .MarLAttr ;};if _ddfc .MarRAttr ==nil {_ddfc .MarRAttr =_gca .MarRAttr ;};if _ddfc .LvlAttr ==nil {_ddfc .LvlAttr =_gca .LvlAttr ;};if _ddfc .IndentAttr ==nil {_ddfc .IndentAttr =_gca .IndentAttr ;
};if _ddfc .AlgnAttr ==_cf .ST_TextAlignTypeUnset {_ddfc .AlgnAttr =_gca .AlgnAttr ;};if _ddfc .DefTabSzAttr ==nil {_ddfc .DefTabSzAttr =_gca .DefTabSzAttr ;};if _ddfc .RtlAttr ==nil {_ddfc .RtlAttr =_gca .RtlAttr ;};if _ddfc .EaLnBrkAttr ==nil {_ddfc .EaLnBrkAttr =_gca .EaLnBrkAttr ;
};if _ddfc .FontAlgnAttr ==_cf .ST_TextFontAlignTypeUnset {_ddfc .FontAlgnAttr =_gca .FontAlgnAttr ;};if _ddfc .LatinLnBrkAttr ==nil {_ddfc .LatinLnBrkAttr =_gca .LatinLnBrkAttr ;};if _ddfc .HangingPunctAttr ==nil {_ddfc .HangingPunctAttr =_gca .HangingPunctAttr ;
};if _ddfc .LnSpc ==nil {_ddfc .LnSpc =_gca .LnSpc ;};if _ddfc .SpcBef ==nil {_ddfc .SpcBef =_gca .SpcBef ;};if _ddfc .SpcAft ==nil {_ddfc .SpcAft =_gca .SpcAft ;};if _ddfc .TextBulletColorChoice .BuClrTx ==nil {_ddfc .TextBulletColorChoice .BuClrTx =_gca .TextBulletColorChoice .BuClrTx ;
};if _ddfc .TextBulletColorChoice .BuClr ==nil {_ddfc .TextBulletColorChoice .BuClr =_gca .TextBulletColorChoice .BuClr ;};if _ddfc .TextBulletSizeChoice .BuSzTx ==nil {_ddfc .TextBulletSizeChoice .BuSzTx =_gca .TextBulletSizeChoice .BuSzTx ;};if _ddfc .TextBulletSizeChoice .BuSzPct ==nil {_ddfc .TextBulletSizeChoice .BuSzPct =_gca .TextBulletSizeChoice .BuSzPct ;
};if _ddfc .TextBulletSizeChoice .BuSzPts ==nil {_ddfc .TextBulletSizeChoice .BuSzPts =_gca .TextBulletSizeChoice .BuSzPts ;};if _ddfc .TextBulletTypefaceChoice .BuFontTx ==nil {_ddfc .TextBulletTypefaceChoice .BuFontTx =_gca .TextBulletTypefaceChoice .BuFontTx ;
};if _ddfc .TextBulletTypefaceChoice .BuFont ==nil {_ddfc .TextBulletTypefaceChoice .BuFont =_gca .TextBulletTypefaceChoice .BuFont ;};if _ddfc .TextBulletChoice .BuNone ==nil {_ddfc .TextBulletChoice .BuNone =_gca .TextBulletChoice .BuNone ;};if _ddfc .TextBulletChoice .BuAutoNum ==nil {_ddfc .TextBulletChoice .BuAutoNum =_gca .TextBulletChoice .BuAutoNum ;
};if _ddfc .TextBulletChoice .BuChar ==nil {_ddfc .TextBulletChoice .BuChar =_gca .TextBulletChoice .BuChar ;};if _ddfc .TextBulletChoice .BuBlip ==nil {_ddfc .TextBulletChoice .BuBlip =_gca .TextBulletChoice .BuBlip ;};if _ddfc .TabLst ==nil {_ddfc .TabLst =_gca .TabLst ;
};if _ddfc .ExtLst ==nil {_ddfc .ExtLst =_gca .ExtLst ;};_ddfc .DefRPr =_gaba (_ddfc .DefRPr ,_gca .DefRPr );return _ddfc ;};func (_ga *convertContext )tileImage (_bca *_ag .Image ,_bcd *_cf .CT_TileInfoProperties ,_eef ,_ace float64 )*_ag .Image {_gcc ,_fdc :=1.0,1.0;
if _dcg :=_bcd .SxAttr ;_dcg !=nil {_gcc =_df .FromSTPercentage (_dcg );};if _bde :=_bcd .SyAttr ;_bde !=nil {_fdc =_df .FromSTPercentage (_bde );};_geea :=_df .MakeTempCreator (_eef ,_ace );_bca .Scale (_gcc ,_fdc );_gfc ,_fdaeg :=_bca .Width (),_bca .Height ();
var _cfbc ,_aacg float64 ;if _dgd :=_bcd .TxAttr ;_dgd !=nil {_cfbc =_fa .FromEMU (_df .FromSTCoordinate (*_dgd ));};if _dgf :=_bcd .TyAttr ;_dgf !=nil {_aacg =_fa .FromEMU (_df .FromSTCoordinate (*_dgf ));};if _cfbc > 0{_cfbc -=_gfc ;};if _aacg > 0{_aacg -=_fdaeg ;
};_cbd :=_ga ._bebf /_gfc +1;_bfc :=_ga ._cgcc /_fdaeg +1;for _fce :=0.0;_fce <=_cbd ;_fce ++{_gag :=_fce *_gfc ;for _aeab :=0.0;_aeab <=_bfc ;_aeab ++{_afc :=_aeab *_fdaeg ;_bca .SetPos (_gag +_cfbc ,_afc +_aacg );_geea .Draw (_bca );};};_ged ,_agge :=_df .GetPageFromCreator (_geea );
if _agge !=nil {_ba .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_agge );return nil ;};_ddc ,_agge :=_dc .NewImageDevice ().Render (_ged );
if _agge !=nil {_ba .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_agge );return nil ;};_baf ,_agge :=_ga ._bbbf .NewImageFromGoImage (_ddc );if _agge !=nil {_ba .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_agge );
return nil ;};return _baf ;};func (_aedb *textboxContext )alignParagraph (){_edd :=_aedb ._gaa ;if _edd ._ebbaa ==_cf .ST_TextAlignTypeL {return ;};_acbd :=len (_edd ._fcc )-1;for _gcgf ,_bffga :=range _edd ._fcc {_daag :=true ;_cgga :=len (_bffga ._facag );
_aaa :=0.0;for _gcdf :=len (_bffga ._facag )-1;_gcdf >=0;_gcdf --{_defd :=_bffga ._facag [_gcdf ];if _daag &&_defd ._gbdc {_cgga =_gcdf ;}else {_daag =false ;for _ ,_cccd :=range _defd ._dfbd {_aaa +=_cccd ._aec ;};};};_bffga ._facag =_bffga ._facag [:_cgga ];
_fdbg :=_bffga ._dgba -_bffga ._bdaa -_aaa ;switch _edd ._ebbaa {case _cf .ST_TextAlignTypeR :_bffga .moveRight (_fdbg );case _cf .ST_TextAlignTypeCtr :_bffga .moveRight (_fdbg /2);case _cf .ST_TextAlignTypeJust :if _gcgf !=_acbd {_ccfc :=[]*word {};for _ ,_bgdb :=range _bffga ._facag {if _bgdb ._gbdc {_ccfc =append (_ccfc ,_bgdb );
};};_bggg :=_fdbg /float64 (len (_ccfc ));for _ ,_badb :=range _ccfc {_badb ._cfcb +=_bggg ;};var _dade *word ;for _ ,_gbbb :=range _bffga ._facag {if _dade !=nil {_gbbb ._eae =_dade ._eae +_dade ._cfcb ;};_dade =_gbbb ;};};};};};func (_bcdd *convertContext )makePdfDivisionFromTxBody (_deb *_cf .CT_TextBody ,_cgba *_cf .CT_TableStyleTextStyle )*_ag .Division {_bffg :=_bcdd ._bbbf .NewDivision ();
_eded :=_bcdd ._ggccd ;_edfa :=_cf .ST_TextAnchoringTypeT ;if _gcce :=_deb .BodyPr ;_gcce !=nil {if _dffb :=_gcce .AnchorAttr ;_dffb !=_cf .ST_TextAnchoringTypeUnset {_edfa =_gcce .AnchorAttr ;};};if _bdf :=_deb .LstStyle ;_bdf !=nil {var _fdgb *_cf .CT_TextParagraphProperties ;
if _bdf .Lvl1pPr !=nil {_fdgb =_bdf .Lvl1pPr ;}else {_fdgb =_bcdd ._gdg [0];};_eded =_bgea (_fdgb ,_bgea (_bdf .DefPPr ,_eded ));};for _ ,_dca :=range _deb .P {if _dca !=nil {_dgg :=_bcdd ._bbbf .NewStyledParagraph ();_dbbe :=_bgea (_dca .PPr ,_eded );
_acg :=_gaba (_dca .EndParaRPr ,_dbbe .DefRPr );switch _dbbe .AlgnAttr {case _cf .ST_TextAlignTypeR :_dgg .SetTextAlignment (_ag .TextAlignmentRight );case _cf .ST_TextAlignTypeCtr :_dgg .SetTextAlignment (_ag .TextAlignmentCenter );case _cf .ST_TextAlignTypeJust :_dgg .SetTextAlignment (_ag .TextAlignmentJustify );
};if len (_dca .EG_TextRun )==0{_dgg .Append ("\u000a");_bffg .Add (_dgg );continue ;};for _ ,_gfde :=range _dca .EG_TextRun {if _gccd :=_gfde .TextRunChoice .Br ;_gccd !=nil {_dgg .Append ("\u000a");}else if _ddg :=_gfde .TextRunChoice .R ;_ddg !=nil {_bfaa :=_eeg (_ddg .RPr ,_cgba );
_bfaa =_gaba (_bfaa ,_acg );var _edb _ag .Color ;if _bfaa .FillPropertiesChoice .SolidFill !=nil {_edb ,_ =_bcdd .getColorFromSolidFill (_bfaa .FillPropertiesChoice .SolidFill );}else {_edb =_ag .ColorBlack ;};_fdcg ,_cgc ,_acf ,_ :=_bcdd .makeStyleFromRPr (_bfaa );
_fdcg .Color =_edb ;if _cgc {_fdcg .TextRise =0.5;}else if _acf {_fdcg .TextRise =-0.5;};_bfd :=_ddg .T ;if _bfaa .CapAttr ==_cf .ST_TextCapsTypeAll {for _ ,_fbba :=range _bfd {_fbba =[]rune (_g .ToUpper (string (_fbba )))[0];};};_bfdd :=_dgg .Append (_bfd );
_bfdd .Style =*_fdcg ;};};_ =_edfa ;_bffg .Add (_dgg );};};return _bffg ;};func _dggg (_accb ,_gega *_cf .CT_TablePartStyle )*_cf .CT_TablePartStyle {_debe :=_cf .NewCT_TablePartStyle ();if _accb !=nil {*_debe =*_accb ;};if _gega ==nil {return _debe ;};
if _debe .TcTxStyle ==nil {_debe .TcTxStyle =_gega .TcTxStyle ;}else {_debe .TcTxStyle =_fgefd (_debe .TcTxStyle ,_gega .TcTxStyle );};if _debe .TcStyle ==nil {_debe .TcStyle =_gega .TcStyle ;}else {_debe .TcStyle =_dbba (_debe .TcStyle ,_gega .TcStyle );
};return _debe ;};func (_gaaga *textboxContext )drawParagraphs (){_gaaga ._dcba .NewPage ();for _ ,_ccebg :=range _gaaga ._dace {for _ ,_gefb :=range _ccebg ._fcc {for _ ,_fcfd :=range _gefb ._facag {for _ ,_feff :=range _fcfd ._dfbd {_dafd :=_gaaga ._dcba .NewStyledParagraph ();
if _feff ._dffe {_feff ._cfa =0;}else if _feff ._abe {_feff ._cfa =1.2*_gefb ._dcbg -_feff ._gada ;};_cab :=_fcfd ._eae +_feff ._befff ;_agbg :=_ccebg ._bebe +_gefb ._bceb +_feff ._cfa ;_dafd .SetPos (_cab ,_agbg );_bbdg :=_dafd .Append (_feff ._cgcg );
if _feff ._begb !=nil {_bbdg .Style =*_feff ._begb ;};_gaaga ._dcba .Draw (_dafd );if _feff ._ddbc {_cffdf :=_agbg +_feff ._gada +2;_df .DrawLine (_gaaga ._dcba ,_cab ,_cffdf ,_cab +_feff ._aec ,_cffdf ,1,_feff ._begb .Color );};};};};};};func (_cgccc *convertContext )renderPageWithDrawableToGoImage (_gegec _ag .Drawable )(_f .Image ,error ){_ccbefa :=_df .MakeTempCreator (_cgccc ._bebf ,_cgccc ._cgcc );
_ccbefa .NewPage ();_ccbefa .Draw (_gegec );_facaa ,_cceg :=_df .GetPageFromCreator (_ccbefa );if _cceg !=nil {return nil ,_cceg ;};return _dc .NewImageDevice ().Render (_facaa );};var _ddedc =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};
func (_ggbd *textboxContext )alignSymbolsVertically (){for _ ,_befg :=range _ggbd ._dace {for _ ,_edfd :=range _befg ._fcc {_eedf :=0.0;for _ ,_dfdg :=range _edfd ._facag {for _ ,_dcf :=range _dfdg ._dfbd {if _dcf ._edag > _eedf {_eedf =_dcf ._edag ;};
};};for _ ,_bebed :=range _edfd ._facag {for _ ,_fee :=range _bebed ._dfbd {if _fee ._gada < _eedf {_fee ._cfa =_eedf -_fee ._gada ;};};};};};};func _cbc (_fgfd *_cf .CT_AdjPoint2D )(float64 ,float64 ){var _gdab ,_ffec float64 ;_bdag ,_eag :=_fgfd .XAttr ,_fgfd .YAttr ;
if _ggdc :=_bdag .ST_Coordinate ;_ggdc !=nil {_gdab =_fa .FromEMU (_df .FromSTCoordinate (*_ggdc ));};if _bdeg :=_eag .ST_Coordinate ;_bdeg !=nil {_ffec =_fa .FromEMU (_df .FromSTCoordinate (*_bdeg ));};return _gdab ,_ffec ;};type symbol struct{_cgcg string ;
_befff float64 ;_edag float64 ;_gada float64 ;_cfa float64 ;_aec float64 ;_begb *_ag .TextStyle ;_ddaf string ;_dffe bool ;_abe bool ;_ddbc bool ;};func (_faef *convertContext )getColorFromFontReference (_aeabf *_cf .CT_FontReference )_ag .Color {var _afde _ag .Color ;
var _fgde string ;if _ddedd :=_aeabf .SrgbClr ;_ddedd !=nil {_fgde =_ddedd .ValAttr ;}else if _cede :=_aeabf .SchemeClr ;_cede !=nil {_fgde =_df .GetColorStringFromDmlColor (_faef ._ggda .GetColorBySchemeColor (_cede .ValAttr ));_fgde =_df .AdjustColor (_fgde ,_cede .EG_ColorTransform );
};if _fgde !=""{_afde =_ag .ColorRGBFromHex ("\u0023"+_fgde );};return _afde ;};type prefixData struct{_dcec string ;_bcg bool ;_eefc float64 ;_eaf float64 ;};

// ConvertToPdfWithOptions convert a presentation to PDF with given options.
func ConvertToPdfWithOptions (pr *_fg .Presentation ,opts *Options )*_ag .Creator {_fc :=pr .X ().SldSz ;_ff :=_fa .FromEMU (int64 (_fc .CxAttr ));_dg :=_fa .FromEMU (int64 (_fc .CyAttr ));_ge :=_ag .PageSize {_ff ,_dg };if (_ge ==_ag .PageSize {}){_ge =_df .GetDefaultPageSize ();
if opts !=nil &&opts .DefaultPageSize !=_df .DefaultPageSize {_ge =_df .GetPageDimensions (opts .DefaultPageSize );};};_dbb :=_ag .New ();_dbb .SetPageSize (_ge );var _dfc *_cf .Theme ;if len (pr .Themes ())> 0{_dfc =pr .Themes ()[0];};for _ ,_bae :=range pr .Slides (){if _bae .X ()==nil {continue ;
};_bbe :=&convertContext {_bbbf :_dbb ,_efc :&_bae ,_caf :_bae .GetSlideLayout (),_acff :pr .SlideMasters ()[0].X (),_ggda :pr ,_dfgc :_dfc ,_ccde :_bae .X ().ClrMapOvr ,_cgcc :_ge [1],_bebf :_ge [0]};_bbe .extractDefaultProperties ();_bbe .makeSlide ();
_bbe .drawSlide ();};return _dbb ;};func (_begbg *convertContext )getColorFromMatrixReference (_ffbc *_cf .CT_StyleMatrixReference )_ag .Color {if _ffbc ==nil {return nil ;};var _ffee _ag .Color ;var _bgfa string ;if _bagb :=_ffbc .SrgbClr ;_bagb !=nil {_bgfa =_bagb .ValAttr ;
}else if _aaac :=_ffbc .SchemeClr ;_aaac !=nil {_bgfa =_df .GetColorStringFromDmlColor (_begbg ._ggda .GetColorBySchemeColor (_aaac .ValAttr ));_bgfa =_df .AdjustColor (_bgfa ,_aaac .EG_ColorTransform );};if _bgfa !=""{_ffee =_ag .ColorRGBFromHex ("\u0023"+_bgfa );
};return _ffee ;};func _dab (_gbc int ,_aca bool )string {_cea :=_c .NewBuffer ([]byte {});for _ ,_gfdf :=range _bgcb {for {if _gbc < _gfdf ._gacd {break ;};_cea .WriteString (_gfdf ._bdbg );_gbc -=_gfdf ._gacd ;};};_cdc :=_cea .String ();if _aca {_cdc =_g .ToUpper (_cdc );
};return _cdc ;};type paragraph struct{_ecee float64 ;_afee float64 ;_fdce float64 ;_dcae float64 ;_bad float64 ;_cgg float64 ;_bebe float64 ;_fgag float64 ;_ebbaa _cf .ST_TextAlignType ;_ced float64 ;_cgdb bool ;_fcc []*line ;};func (_dccc *textboxContext )addTextRun (_aad *_cf .EG_TextRun ,_aadc *_cf .CT_TextCharacterProperties ,_ebecb _ag .Color ,_fcd *prefixData ){if _cbbb :=_aad .TextRunChoice .Br ;
_cbbb !=nil {_dccc .addCurrentWordToParagraph ();_dccc .newLine ();_dccc .newWord ();}else if _facd :=_aad .TextRunChoice .R ;_facd !=nil {var _dbcd _ag .Color ;if _facd .RPr !=nil &&_facd .RPr .FillPropertiesChoice .SolidFill !=nil {_dbcd ,_ =_dccc ._ccbef .getColorFromSolidFill (_facd .RPr .FillPropertiesChoice .SolidFill );
}else if _ebecb !=nil {_dbcd =_ebecb ;}else if _aadc .FillPropertiesChoice .SolidFill !=nil {_dbcd ,_ =_dccc ._ccbef .getColorFromSolidFill (_aadc .FillPropertiesChoice .SolidFill );}else {_dbcd =_ag .ColorBlack ;};_dccd :=_gaba (_facd .RPr ,_aadc );_faff ,_dfff ,_gce ,_cgcgf :=_dccc ._ccbef .makeStyleFromRPr (_dccd );
_faff .Color =_dbcd ;if _fcd !=nil {_dccc .addPrefix (_fcd ,_faff );};_gbdb :=_dbeb (_facd .T );for _ ,_bgaf :=range _gbdb {_bgaf ._begb =_faff ;_bgaf ._dffe =_dfff ;_bgaf ._abe =_gce ;_bgaf ._ddbc =_cgcgf ;if _dccd .CapAttr ==_cf .ST_TextCapsTypeAll {_bgaf ._cgcg =_g .ToUpper (_bgaf ._cgcg );
};_dccc .addTextSymbol (_bgaf );};};};