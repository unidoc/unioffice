//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_e "bytes";_c "errors";_d "github.com/unidoc/unioffice/v2/common";_g "github.com/unidoc/unioffice/v2/common/logger";_dc "github.com/unidoc/unioffice/v2/common/tempstorage";_cb "github.com/unidoc/unioffice/v2/internal/convertutils";
_ae "github.com/unidoc/unioffice/v2/measurement";_a "github.com/unidoc/unioffice/v2/presentation";_af "github.com/unidoc/unioffice/v2/schema/soo/dml";_cg "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_gb "github.com/unidoc/unioffice/v2/schema/soo/pml";
_cbg "github.com/unidoc/unipdf/v4/contentstream/draw";_bc "github.com/unidoc/unipdf/v4/core";_bf "github.com/unidoc/unipdf/v4/creator";_gd "github.com/unidoc/unipdf/v4/model";_eb "github.com/unidoc/unipdf/v4/render";_bb "image";_be "image/color";_f "image/draw";
_fe "math";_fc "strconv";_ce "strings";);func (_bffg *convertContext )getInfoFromLn (_gdaf *_af .CT_LineProperties )(_bf .Color ,float64 ,float64 ){if _gdaf ==nil ||_gdaf .LineFillPropertiesChoice .NoFill !=nil {return nil ,0,0;};var _gcd float64 ;_gedb ,_fbdgb :=_bffg .getColorFromSolidFill (_gdaf .LineFillPropertiesChoice .SolidFill );
if _agbe :=_gdaf .WAttr ;_agbe !=nil {_gcd =_ae .FromEMU (int64 (*_agbe ));}else {_gcd =1;};return _gedb ,_gcd ,_fbdgb ;};func (_bbac *convertContext )renderCurrentStateToGoImage ()(_bb .Image ,error ){_ebbb :=_cb .MakeTempCreator (_bbac ._cbab ,_bbac ._ddge );
_ebbb .NewPage ();for _ ,_ffce :=range _bbac ._fedg {if _ffce !=nil {_ebbb .MoveTo (0,0);_ebbb .Draw (_ffce );};};_ege ,_dgad :=_cb .GetPageFromCreator (_ebbb );if _dgad !=nil {return nil ,_dgad ;};return _eb .NewImageDevice ().Render (_ege );};func _dbgc (_gdfb float64 )float64 {return _gdfb *_ae .Millimeter };
func (_bdab *convertContext )getShapes (_ceb *_gb .CT_Shape ,_gefa bool ,_aedb bool )[]_bf .Drawable {_deg :=[]_bf .Drawable {};_dgcg :=_ceb .SpPr ;if _dgcg ==nil {return _deg ;};var _dbd bool ;if _dcdb :=_ceb .UseBgFillAttr ;_dcdb !=nil {_dbd =*_dcdb ;
};_cbe ,_fggd ,_bdg ,_fcc ,_bab ,_fgfe ,_dba :=_bdab .getShapesFromSpPr (_dgcg ,_ceb .Style ,_dbd ,0.0,0.0);if !_aedb {_deg =append (_deg ,_cbe ...);};if _fcce :=_ceb .TxBody ;_fcce !=nil &&!_gefa {_fbg ,_efd ,_bec ,_bea ,_fccf ,_ecg :=_bdab .getPhData (_ceb );
if _aedb &&!(_bea ||_fccf ){return _deg ;};if _fbg !=nil &&!_dba {_fggd ,_bdg ,_fcc ,_bab =_cb .GetDataFromXfrm (_fbg );};_ced ,_dac :=_bdab .makePdfBlockFromTxBody (_fcce ,_efd ,_bec ,_fcc ,_bab ,_fgfe ,_bea ,_ecg );if _dac !=nil {_g .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_dac );
}else if _ced !=nil {_ced .SetPos (_fggd ,_bdg );_deg =append (_deg ,_ced );};};return _deg ;};func _bfd (_dfda *_af .CT_TextCharacterProperties ,_fbfd *_af .CT_TableStyleTextStyle )*_af .CT_TextCharacterProperties {_ggff :=_af .NewCT_TextCharacterProperties ();
if _dfda !=nil {*_ggff =*_dfda ;};if _fbfd ==nil {return _ggff ;};if _ggff .BAttr ==nil &&_fbfd .BAttr !=_af .ST_OnOffStyleTypeUnset {_afec :=_fbfd .BAttr ==_af .ST_OnOffStyleTypeOn ;_ggff .BAttr =&_afec ;};if _ggff .IAttr ==nil &&_fbfd .IAttr !=_af .ST_OnOffStyleTypeUnset {_gge :=_fbfd .IAttr ==_af .ST_OnOffStyleTypeOn ;
_ggff .IAttr =&_gge ;};if _ggff .FillPropertiesChoice .NoFill ==nil &&_ggff .FillPropertiesChoice .SolidFill ==nil {_ggff .FillPropertiesChoice .SolidFill =_af .NewCT_SolidColorFillProperties ();_ggff .FillPropertiesChoice .SolidFill .ScrgbClr =_fbfd .ScrgbClr ;
_ggff .FillPropertiesChoice .SolidFill .SrgbClr =_fbfd .SrgbClr ;_ggff .FillPropertiesChoice .SolidFill .HslClr =_fbfd .HslClr ;_ggff .FillPropertiesChoice .SolidFill .SysClr =_fbfd .SysClr ;_ggff .FillPropertiesChoice .SolidFill .SchemeClr =_fbfd .SchemeClr ;
_ggff .FillPropertiesChoice .SolidFill .PrstClr =_fbfd .PrstClr ;};if _fadg :=_fbfd .ThemeableFontStylesChoice .Font ;_fadg !=nil &&_ggff .Latin ==nil &&_ggff .Ea ==nil &&_ggff .Cs ==nil {_ggff .Latin =_fadg .Latin ;_ggff .Ea =_fadg .Ea ;_ggff .Cs =_fadg .Cs ;
};return _ggff ;};func _cadg (_ddd ,_cfdb *_af .CT_TextCharacterProperties )*_af .CT_TextCharacterProperties {_ffg :=_af .NewCT_TextCharacterProperties ();if _ddd !=nil {*_ffg =*_ddd ;};if _cfdb ==nil {return _ffg ;};if _ffg .KumimojiAttr ==nil {_ffg .KumimojiAttr =_cfdb .KumimojiAttr ;
};if _ffg .LangAttr ==nil {_ffg .LangAttr =_cfdb .LangAttr ;};if _ffg .AltLangAttr ==nil {_ffg .AltLangAttr =_cfdb .AltLangAttr ;};if _ffg .SzAttr ==nil {_ffg .SzAttr =_cfdb .SzAttr ;};if _ffg .BAttr ==nil {_ffg .BAttr =_cfdb .BAttr ;};if _ffg .IAttr ==nil {_ffg .IAttr =_cfdb .IAttr ;
};if _ffg .UAttr ==_af .ST_TextUnderlineTypeUnset {_ffg .UAttr =_cfdb .UAttr ;};if _ffg .StrikeAttr ==_af .ST_TextStrikeTypeUnset {_ffg .StrikeAttr =_cfdb .StrikeAttr ;};if _ffg .KernAttr ==nil {_ffg .KernAttr =_cfdb .KernAttr ;};if _ffg .CapAttr ==_af .ST_TextCapsTypeUnset {_ffg .CapAttr =_cfdb .CapAttr ;
};if _ffg .SpcAttr ==nil {_ffg .SpcAttr =_cfdb .SpcAttr ;};if _ffg .NormalizeHAttr ==nil {_ffg .NormalizeHAttr =_cfdb .NormalizeHAttr ;};if _ffg .BaselineAttr ==nil {_ffg .BaselineAttr =_cfdb .BaselineAttr ;};if _ffg .NoProofAttr ==nil {_ffg .NoProofAttr =_cfdb .NoProofAttr ;
};if _ffg .DirtyAttr ==nil {_ffg .DirtyAttr =_cfdb .DirtyAttr ;};if _ffg .ErrAttr ==nil {_ffg .ErrAttr =_cfdb .ErrAttr ;};if _ffg .SmtCleanAttr ==nil {_ffg .SmtCleanAttr =_cfdb .SmtCleanAttr ;};if _ffg .SmtIdAttr ==nil {_ffg .SmtIdAttr =_cfdb .SmtIdAttr ;
};if _ffg .BmkAttr ==nil {_ffg .BmkAttr =_cfdb .BmkAttr ;};if _ffg .Ln ==nil {_ffg .Ln =_cfdb .Ln ;};if _ffg .FillPropertiesChoice .NoFill ==nil {_ffg .FillPropertiesChoice .NoFill =_cfdb .FillPropertiesChoice .NoFill ;};if _ffg .FillPropertiesChoice .SolidFill ==nil {_ffg .FillPropertiesChoice .SolidFill =_cfdb .FillPropertiesChoice .SolidFill ;
};if _ffg .FillPropertiesChoice .BlipFill ==nil {_ffg .FillPropertiesChoice .BlipFill =_cfdb .FillPropertiesChoice .BlipFill ;};if _ffg .EffectPropertiesChoice .EffectLst ==nil {_ffg .EffectPropertiesChoice .EffectLst =_cfdb .EffectPropertiesChoice .EffectLst ;
};if _ffg .EffectPropertiesChoice .EffectDag ==nil {_ffg .EffectPropertiesChoice .EffectDag =_cfdb .EffectPropertiesChoice .EffectDag ;};if _ffg .Highlight ==nil {_ffg .Highlight =_cfdb .Highlight ;};if _ffg .TextUnderlineLineChoice .ULnTx ==nil {_ffg .TextUnderlineLineChoice .ULnTx =_cfdb .TextUnderlineLineChoice .ULnTx ;
};if _ffg .TextUnderlineLineChoice .ULn ==nil {_ffg .TextUnderlineLineChoice .ULn =_cfdb .TextUnderlineLineChoice .ULn ;};if _ffg .TextUnderlineFillChoice .UFillTx ==nil {_ffg .TextUnderlineFillChoice .UFillTx =_cfdb .TextUnderlineFillChoice .UFillTx ;
};if _ffg .TextUnderlineFillChoice .UFill ==nil {_ffg .TextUnderlineFillChoice .UFill =_cfdb .TextUnderlineFillChoice .UFill ;};if _ffg .Latin ==nil {_ffg .Latin =_cfdb .Latin ;};if _ffg .Ea ==nil {_ffg .Ea =_cfdb .Ea ;};if _ffg .Cs ==nil {_ffg .Cs =_cfdb .Cs ;
};if _ffg .Sym ==nil {_ffg .Sym =_cfdb .Sym ;};if _ffg .Rtl ==nil {_ffg .Rtl =_cfdb .Rtl ;};return _ffg ;};func _bgdc (_fddf ,_dbca *_af .CT_TextParagraphProperties )*_af .CT_TextParagraphProperties {_gab :=_af .NewCT_TextParagraphProperties ();if _fddf !=nil {*_gab =*_fddf ;
};if _dbca ==nil {return _gab ;};if _gab .MarLAttr ==nil {_gab .MarLAttr =_dbca .MarLAttr ;};if _gab .MarRAttr ==nil {_gab .MarRAttr =_dbca .MarRAttr ;};if _gab .LvlAttr ==nil {_gab .LvlAttr =_dbca .LvlAttr ;};if _gab .IndentAttr ==nil {_gab .IndentAttr =_dbca .IndentAttr ;
};if _gab .AlgnAttr ==_af .ST_TextAlignTypeUnset {_gab .AlgnAttr =_dbca .AlgnAttr ;};if _gab .DefTabSzAttr ==nil {_gab .DefTabSzAttr =_dbca .DefTabSzAttr ;};if _gab .RtlAttr ==nil {_gab .RtlAttr =_dbca .RtlAttr ;};if _gab .EaLnBrkAttr ==nil {_gab .EaLnBrkAttr =_dbca .EaLnBrkAttr ;
};if _gab .FontAlgnAttr ==_af .ST_TextFontAlignTypeUnset {_gab .FontAlgnAttr =_dbca .FontAlgnAttr ;};if _gab .LatinLnBrkAttr ==nil {_gab .LatinLnBrkAttr =_dbca .LatinLnBrkAttr ;};if _gab .HangingPunctAttr ==nil {_gab .HangingPunctAttr =_dbca .HangingPunctAttr ;
};if _gab .LnSpc ==nil {_gab .LnSpc =_dbca .LnSpc ;};if _gab .SpcBef ==nil {_gab .SpcBef =_dbca .SpcBef ;};if _gab .SpcAft ==nil {_gab .SpcAft =_dbca .SpcAft ;};if _gab .TextBulletColorChoice .BuClrTx ==nil {_gab .TextBulletColorChoice .BuClrTx =_dbca .TextBulletColorChoice .BuClrTx ;
};if _gab .TextBulletColorChoice .BuClr ==nil {_gab .TextBulletColorChoice .BuClr =_dbca .TextBulletColorChoice .BuClr ;};if _gab .TextBulletSizeChoice .BuSzTx ==nil {_gab .TextBulletSizeChoice .BuSzTx =_dbca .TextBulletSizeChoice .BuSzTx ;};if _gab .TextBulletSizeChoice .BuSzPct ==nil {_gab .TextBulletSizeChoice .BuSzPct =_dbca .TextBulletSizeChoice .BuSzPct ;
};if _gab .TextBulletSizeChoice .BuSzPts ==nil {_gab .TextBulletSizeChoice .BuSzPts =_dbca .TextBulletSizeChoice .BuSzPts ;};if _gab .TextBulletTypefaceChoice .BuFontTx ==nil {_gab .TextBulletTypefaceChoice .BuFontTx =_dbca .TextBulletTypefaceChoice .BuFontTx ;
};if _gab .TextBulletTypefaceChoice .BuFont ==nil {_gab .TextBulletTypefaceChoice .BuFont =_dbca .TextBulletTypefaceChoice .BuFont ;};if _gab .TextBulletChoice .BuNone ==nil {_gab .TextBulletChoice .BuNone =_dbca .TextBulletChoice .BuNone ;};if _gab .TextBulletChoice .BuAutoNum ==nil {_gab .TextBulletChoice .BuAutoNum =_dbca .TextBulletChoice .BuAutoNum ;
};if _gab .TextBulletChoice .BuChar ==nil {_gab .TextBulletChoice .BuChar =_dbca .TextBulletChoice .BuChar ;};if _gab .TextBulletChoice .BuBlip ==nil {_gab .TextBulletChoice .BuBlip =_dbca .TextBulletChoice .BuBlip ;};if _gab .TabLst ==nil {_gab .TabLst =_dbca .TabLst ;
};if _gab .ExtLst ==nil {_gab .ExtLst =_dbca .ExtLst ;};_gab .DefRPr =_cadg (_gab .DefRPr ,_dbca .DefRPr );return _gab ;};func (_cbga *textboxContext )addPrefix (_ffbb *prefixData ,_babef *_bf .TextStyle ){_cbeb :=_ecb (_ffbb ._bcfa );_ddfd :=*_babef ;
if _ffbb ._facc {_ddfd .Font =_cb .AssignStdFontByName (_ddfd ,"\u0053\u0079\u006d\u0062\u006f\u006c");};for _ ,_fddee :=range _cbeb {_fddee ._faaag =&_ddfd ;_cbga .addTextSymbol (_fddee );};_ceg :=-(_ffbb ._fefb +_cbga ._edaf ._aeef );if _ceg < 0{_ceg =0;
};_bfca :=&symbol {_fcede :"\u0020",_bag :_ceg };_cbga .addTextSymbol (_bfca );_cbga ._edaf ._caff +=(_ffbb ._fefb +_ffbb ._bcbg );};type word struct{_aebb []*symbol ;_caff float64 ;_aeef float64 ;_geeaa bool ;};func _ffd (_dfbc ,_bggf *_af .CT_TextListStyle )*_af .CT_TextListStyle {_abdf :=_af .NewCT_TextListStyle ();
if _dfbc !=nil {*_abdf =*_dfbc ;};if _bggf ==nil {return _abdf ;};_abdf .DefPPr =_bgdc (_abdf .DefPPr ,_bggf .DefPPr );_abdf .Lvl1pPr =_bgdc (_abdf .Lvl1pPr ,_bggf .Lvl1pPr );_abdf .Lvl2pPr =_bgdc (_abdf .Lvl2pPr ,_bggf .Lvl2pPr );_abdf .Lvl3pPr =_bgdc (_abdf .Lvl3pPr ,_bggf .Lvl3pPr );
_abdf .Lvl4pPr =_bgdc (_abdf .Lvl4pPr ,_bggf .Lvl4pPr );_abdf .Lvl5pPr =_bgdc (_abdf .Lvl5pPr ,_bggf .Lvl5pPr );_abdf .Lvl6pPr =_bgdc (_abdf .Lvl6pPr ,_bggf .Lvl6pPr );_abdf .Lvl7pPr =_bgdc (_abdf .Lvl7pPr ,_bggf .Lvl7pPr );_abdf .Lvl8pPr =_bgdc (_abdf .Lvl8pPr ,_bggf .Lvl8pPr );
_abdf .Lvl9pPr =_bgdc (_abdf .Lvl9pPr ,_bggf .Lvl9pPr );return _abdf ;};func (_eddc *convertContext )getPhData (_cbafg *_gb .CT_Shape )(*_af .CT_Transform2D ,*_af .CT_TextBodyProperties ,*_af .CT_TextListStyle ,bool ,bool ,bool ){_bbge ,_dbge :=_gefae (_cbafg );
_bcfc ,_abdg ,_badf ,_faf ,_bfad :=_cdbde (_eddc ._bcg .CSld ,_bbge ,_dbge );_ccda ,_gaed ,_gabf ,_fgdgg ,_bcdc :=_cdbde (_eddc ._fced .CSld ,_bbge ,_dbge );if _ccda ==nil {_ccda =_bcfc ;};_aacb ,_aaaf :=_dcfff (_gaed ,_abdg );var _eddca ,_gffb ,_gefbc bool ;
if _gabf ==nil {if _badf !=nil {_eddca =*_badf ;};}else {_eddca =*_gabf ;};if _bcdc ==nil {if _bfad !=nil {_gefbc =*_bfad ;};}else {_gefbc =*_bcdc ;};if _fgdgg ==nil {if _faf !=nil {_gffb =*_faf ;};}else {_gffb =*_fgdgg ;};return _ccda ,_aacb ,_aaaf ,_eddca ,_gffb ,_gefbc ;
};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_gd .PdfFont ){_cb .RegisterFont (name ,style ,font );};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _cb .RegisterFontsFromDirectory (dirName )};func (_ffbc *convertContext )makePdfImageFromBlipFill (_cdea *_af .CT_BlipFillProperties ,_fcae bool )(*_bf .Image ,[]*_af .CT_BlipChoice ,error ){if _bfeec :=_cdea .Blip ;
_bfeec !=nil {if _ggdc :=_bfeec .EmbedAttr ;_ggdc !=nil {var _cdgd _d .ImageRef ;var _cddc bool ;if _fcae {_cdgd ,_cddc =_ffbc ._abcg .GetLayoutImageByRelID (*_ggdc );}else {_cdgd ,_cddc =_ffbc ._abcg .GetImageByRelID (*_ggdc );};if _cddc {_gfbc ,_bcaae :=_dc .Open (_cdgd .Path ());
if _bcaae !=nil {_g .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_bcaae );return nil ,nil ,_bcaae ;};defer _gfbc .Close ();_adfg ,_ ,_bcaae :=_bb .Decode (_gfbc );if _bcaae !=nil {_g .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_bcaae );
return nil ,nil ,_bcaae ;};if _cbbg :=_cdea .SrcRect ;_cbbg !=nil {_cfca :=_adfg .Bounds ().Size ();_abgd :=_cfca .X ;_faba :=_cfca .Y ;var _ggce ,_bafa ,_gea ,_dgac int ;var _fgff bool ;if _dfbd :=_cbbg .LAttr ;_dfbd !=nil {_ggce =int (float64 (_abgd )*_cb .FromSTPercentage (_dfbd ));
_fgff =true ;}else {_ggce =0;};if _cbgf :=_cbbg .TAttr ;_cbgf !=nil {_gea =int (float64 (_faba )*_cb .FromSTPercentage (_cbgf ));_fgff =true ;}else {_gea =0;};if _bafag :=_cbbg .RAttr ;_bafag !=nil {_bafa =int (float64 (_abgd )*(1-_cb .FromSTPercentage (_bafag )));
_fgff =true ;}else {_bafa =_abgd ;};if _febg :=_cbbg .BAttr ;_febg !=nil {_dgac =int (float64 (_faba )*(1-_cb .FromSTPercentage (_febg )));_fgff =true ;}else {_dgac =_faba ;};if _fgff {_adfg =_cb .CropImageByRect (_adfg ,_bb .Rect (_ggce ,_gea ,_bafa +1,_dgac +1));
};};_caaf ,_bcaae :=_ffbc ._cbfe .NewImageFromGoImage (_adfg );_caaf .SetEncoder (_bc .NewFlateEncoder ());if _ce .ToLower (_cdgd .Format ())=="\u006a\u0070\u0067"||_ce .ToLower (_cdgd .Format ())=="\u006a\u0070\u0065\u0067"{_caaf .SetEncoder (_bc .NewDCTEncoder ());
};if _bcaae !=nil {_g .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_bcaae );
return nil ,nil ,_bcaae ;};return _caaf ,_bfeec .BlipChoice ,nil ;};};};return nil ,nil ,nil ;};func _cced (_ccef *_af .CT_AdjPoint2D )(float64 ,float64 ){var _eaee ,_adecd float64 ;_efde ,_ecbb :=_ccef .XAttr ,_ccef .YAttr ;if _fccfc :=_efde .ST_Coordinate ;
_fccfc !=nil {_eaee =_ae .FromEMU (_cb .FromSTCoordinate (*_fccfc ));};if _cab :=_ecbb .ST_Coordinate ;_cab !=nil {_adecd =_ae .FromEMU (_cb .FromSTCoordinate (*_cab ));};return _eaee ,_adecd ;};func (_geea *convertContext )addCellToTable (_acc *_bf .Table ,_eaa *_af .CT_TableCell ,_bbf *_af .CT_TablePartStyle ,_afg ,_gdbc ,_fdfd ,_agcd bool )float64 {var _bgdb *_bf .TableCell ;
_bfa :=1;if _eaa .GridSpanAttr !=nil {_bfa =int (*_eaa .GridSpanAttr );};_bgdb =_acc .MultiColCell (_bfa );_aeg :=_eaa .TcPr ;var _bdad *_af .CT_TableStyleTextStyle ;if _bbf !=nil {_aeg =_fefef (_aeg ,_bbf .TcStyle ,_afg ,_gdbc ,_fdfd ,_agcd );_bdad =_bbf .TcTxStyle ;
};_fdfb :=_ed ;_gddc :=_bf .CellVerticalAlignmentMiddle ;_dacbc :=_fegd (0.05);_ddgd :=_fegd (0.05);if _aeg !=nil {if _aege :=_aeg .LnL ;_aege !=nil {_bffc ,_cbgd ,_fgdg :=_geea .getBorderStyle (_aege );_bgdb .SetBorder (_bf .CellBorderSideLeft ,_bffc ,_fgdg );
if _cbgd !=nil &&*_cbgd !=nil {_bgdb .SetSideBorderColor (_bf .CellBorderSideLeft ,*_cbgd );};};if _aegb :=_aeg .LnT ;_aegb !=nil {_eeecd ,_affd ,_bef :=_geea .getBorderStyle (_aegb );_bgdb .SetBorder (_bf .CellBorderSideTop ,_eeecd ,_bef );if _affd !=nil &&*_affd !=nil {_bgdb .SetSideBorderColor (_bf .CellBorderSideTop ,*_affd );
};};if _gbbg :=_aeg .LnR ;_gbbg !=nil {_faag ,_aaca ,_dgg :=_geea .getBorderStyle (_gbbg );_bgdb .SetBorder (_bf .CellBorderSideRight ,_faag ,_dgg );if _aaca !=nil &&*_aaca !=nil {_bgdb .SetSideBorderColor (_bf .CellBorderSideRight ,*_aaca );};};if _aafg :=_aeg .LnB ;
_aafg !=nil {_cea ,_aeeb ,_ebbe :=_geea .getBorderStyle (_aafg );_bgdb .SetBorder (_bf .CellBorderSideBottom ,_cea ,_ebbe );if _aeeb !=nil &&*_aeeb !=nil {_bgdb .SetSideBorderColor (_bf .CellBorderSideBottom ,*_aeeb );};};if _aca :=_aeg .MarLAttr ;_aca !=nil {_fdfb =float64 (_cb .FromSTCoordinate32 (*_aca ));
};switch _aeg .AnchorAttr {case _af .ST_TextAnchoringTypeT :_gddc =_bf .CellVerticalAlignmentTop ;case _af .ST_TextAnchoringTypeB :_gddc =_bf .CellVerticalAlignmentBottom ;};if _aeg .FillPropertiesChoice .NoFill ==nil {if _cbb :=_aeg .FillPropertiesChoice .SolidFill ;
_cbb !=nil {_gbad ,_ccf :=_geea .getColorFromSolidFill (_cbb );_bgdb .SetOpacity (_ccf );_bgdb .SetBackgroundColor (_gbad );};};if _cbf :=_aeg .MarBAttr ;_cbf !=nil {_dacbc =float64 (_cb .FromSTCoordinate32 (*_cbf ));};if _cef :=_aeg .MarTAttr ;_cef !=nil {_ddgd =float64 (_cb .FromSTCoordinate32 (*_cef ));
};};_bgdb .SetVerticalAlignment (_gddc );_bgdb .SetIndent (_fdfb );var _defa float64 ;if _dgfd :=_eaa .TxBody ;_dgfd !=nil {_fccb :=_geea .makePdfDivisionFromTxBody (_dgfd ,_bdad );_defa =_fccb .Height ()+_ddgd +_dacbc ;_bgdb .SetContent (_fccb );};return _defa ;
};func _gdfa (_acb ,_bdee *_af .CT_TablePartStyle )*_af .CT_TablePartStyle {_fccg :=_af .NewCT_TablePartStyle ();if _acb !=nil {*_fccg =*_acb ;};if _bdee ==nil {return _fccg ;};if _fccg .TcTxStyle ==nil {_fccg .TcTxStyle =_bdee .TcTxStyle ;}else {_fccg .TcTxStyle =_fea (_fccg .TcTxStyle ,_bdee .TcTxStyle );
};if _fccg .TcStyle ==nil {_fccg .TcStyle =_bdee .TcStyle ;}else {_fccg .TcStyle =_cgfb (_fccg .TcStyle ,_bdee .TcStyle );};return _fccg ;};func (_efbe *convertContext )getColorFromFontReference (_afda *_af .CT_FontReference )_bf .Color {var _fdge _bf .Color ;
var _gagb string ;if _cbgdg :=_afda .SrgbClr ;_cbgdg !=nil {_gagb =_cbgdg .ValAttr ;}else if _adec :=_afda .SchemeClr ;_adec !=nil {_gagb =_cb .GetColorStringFromDmlColor (_efbe ._daeb .GetColorBySchemeColor (_adec .ValAttr ));_gagb =_cb .AdjustColor (_gagb ,_adec .EG_ColorTransform );
};if _gagb !=""{_fdge =_bf .ColorRGBFromHex ("\u0023"+_gagb );};return _fdge ;};func (_bed *convertContext )addShapes (_bfc *_gb .CT_CommonSlideData ,_dgc bool ){if _bfc ==nil {return ;};_ag :=&background {};if _ccc :=_bfc .Bg ;_ccc !=nil {if _cgd :=_ccc .BackgroundChoice .BgPr ;
_cgd !=nil {if _cgd .FillPropertiesChoice .NoFill ==nil {if _dgcd :=_cgd .FillPropertiesChoice .SolidFill ;_dgcd !=nil {_ab ,_fb :=_bed .getColorFromSolidFill (_dgcd );if _ab !=nil {_ag ._gcfg =_ab ;_ag ._gfaf =_fb ;};}else if _fce :=_cgd .FillPropertiesChoice .BlipFill ;
_fce !=nil {_ag ._gcgf =_fce ;};};};};_bed ._ddba =_ag ;if _dga :=_bfc .SpTree ;_dga !=nil {for _ ,_adc :=range _dga .GroupShapeChoice {if _adc !=nil {if _adc .Sp !=nil {_bg :=_bed .getShapes (_adc .Sp ,_dgc ,false );_bed ._fedg =append (_bed ._fedg ,_bg ...);
};if _adc .GraphicFrame !=nil {var _bbd ,_efb ,_gdb ,_adb float64 ;if _ea :=_adc .GraphicFrame .Xfrm ;_ea !=nil {_bbd ,_efb ,_gdb ,_adb =_cb .GetDataFromXfrm (_ea );};if _gdb ==0&&_adb ==0{_gdb =_bed ._cbab ;_adb =_bed ._ddge ;};if _eaf :=_adc .GraphicFrame .Graphic ;
_eaf !=nil {if _dcb :=_eaf .GraphicData ;_dcb !=nil {for _ ,_aee :=range _dcb .Any {if _fgf ,_bd :=_aee .(*_cg .Chart );_bd {_bac ,_aga :=_bed .makePdfBlockFromChart (_fgf ,_gdb ,_adb );if _aga !=nil {_g .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_aga );
};if _bac !=nil {_bac .SetPos (_bbd ,_efb );_bed ._fedg =append (_bed ._fedg ,_bac );};}else if _eafa ,_gedd :=_aee .(*_af .Tbl );_gedd {_aeb :=_bed .makePdfBlockFromTable (_eafa );if _aeb !=nil {_ede :=_bf .NewBlock (_gdb ,_adb );_ede .SetPos (_bbd ,_efb );
_ec :=_ede .Draw (_aeb );if _ec !=nil {_g .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0064r\u0061\u0077\u0020\u0074\u0061b\u006c\u0065\u003a\u0020\u0025\u0073",_ec );if _ec ==_bf .ErrContentNotFit {_ede =_bf .NewBlock (_bed ._cbab -1.5*_bbd ,_bed ._ddge -1.5*_efb );
_ede .SetPos (_bbd ,_efb );_ec =_ede .Draw (_aeb );};};if _ec ==nil {_bed ._fedg =append (_bed ._fedg ,_ede );};};};};};};};if _adc .CxnSp !=nil {_fa :=_bed .getConnectors (_adc .CxnSp );_bed ._fedg =append (_bed ._fedg ,_fa ...);};if _adc .GrpSp !=nil {_caf :=0.0;
_feb :=0.0;if _cbd :=_adc .GrpSp .GrpSpPr .Xfrm ;_cbd !=nil {_caf ,_feb =_cb .GetGroupOffsetFromXfrm (_cbd );};for _ ,_gef :=range _adc .GrpSp .GroupShapeChoice {if _gef .CxnSp !=nil {_dab :=_bed .getGroupConnectors (_gef .CxnSp ,_caf ,_feb );_bed ._fedg =append (_bed ._fedg ,_dab ...);
};};};if _adc .Pic !=nil {_aaa :=false ;var _geg ,_fd ,_cd ,_abg float64 ;if _dbc :=_adc .Pic .SpPr ;_dbc !=nil {if _eda :=_dbc .Xfrm ;_eda !=nil {_geg ,_fd ,_cd ,_abg =_cb .GetDataFromXfrm (_eda );_aaa =true ;};};var _aff _gb .ST_PlaceholderType ;var _gefg *uint32 ;
if _aag :=_adc .Pic .NvPicPr ;_aag !=nil {if _baa :=_aag .NvPr ;_baa !=nil {if _cfd :=_baa .Ph ;_cfd !=nil {_aff =_cfd .TypeAttr ;_gefg =_cfd .IdxAttr ;};};};_aed ,_ ,_ ,_ ,_ :=_cdbde (_bed ._bcg .CSld ,_aff ,_gefg );_aac ,_ ,_ ,_ ,_ :=_cdbde (_bed ._fced .CSld ,_aff ,_gefg );
if _aac ==nil {_aac =_aed ;};if _aac !=nil &&!_aaa {_geg ,_fd ,_cd ,_abg =_cb .GetDataFromXfrm (_aac );};if _fff :=_adc .Pic .BlipFill ;_fff !=nil {_gedc :=_bed .getShapeFromBlipFill (_fff ,_geg ,_fd ,_cd ,_abg ,_dgc );_bed ._fedg =append (_bed ._fedg ,_gedc );
};};};};};};func (_fcf *convertContext )getShapesFromSpPr (_fcda *_af .CT_ShapeProperties ,_abfc *_af .CT_ShapeStyle ,_fcdc bool ,_ddc float64 ,_fecd float64 )([]_bf .Drawable ,float64 ,float64 ,float64 ,float64 ,_bf .Color ,bool ){_eab :=[]_bf .Drawable {};
var _ebeg ,_gede ,_cde ,_cbdcd ,_ebb float64 ;var _dfac ,_efg ,_geb ,_dbg _bf .Color ;var _fba *_af .CT_BlipFillProperties ;_bgf ,_fda :=1.0,1.0;if _abfc !=nil {_dfac ,_efg ,_dbg =_fcf .getStyleColors (_abfc );};if _dege :=_fcda .Ln ;_dege !=nil {if _dege .LineFillPropertiesChoice .NoFill !=nil {_geb ,_ebb =nil ,0;
}else {_geb ,_ebb ,_bgf =_fcf .getInfoFromLn (_dege );if _geb ==nil {_geb =_dbg ;};};};if _fcda .FillPropertiesChoice .NoFill !=nil {_efg ,_fda =nil ,0;}else if _fcdc {_efg =_fcf ._ddba ._gcfg ;_fda =_fcf ._ddba ._gfaf ;_fba =_fcf ._ddba ._gcgf ;}else if _adce :=_fcda .FillPropertiesChoice .SolidFill ;
_adce !=nil {_efg ,_fda =_fcf .getColorFromSolidFill (_adce );};var _bcc bool ;if _edee :=_fcda .Xfrm ;_edee !=nil {_ebeg ,_gede ,_cde ,_cbdcd =_cb .GetDataFromXfrm (_edee );_ebeg +=_ddc ;_gede +=_fecd ;_bcc =true ;};if _egc :=_fcda .GeometryChoice .CustGeom ;
_egc !=nil {_ecc :=[]_cbg .Point {};_eed ,_bcad :=1.0,1.0;if _fcbc :=_egc .PathLst ;_fcbc !=nil {for _ ,_cba :=range _fcbc .Path {if _cba !=nil {if _cbae :=_cba .WAttr ;_cbae !=nil {_eed =_cde /_ae .FromEMU (*_cbae );};if _fbgg :=_cba .HAttr ;_fbgg !=nil {_bcad =_cbdcd /_ae .FromEMU (*_fbgg );
};for _ ,_gc :=range _cba .Path2DChoice {if _gc .Close !=nil {};if _daf :=_gc .MoveTo ;_gc .MoveTo !=nil {if _daf !=nil &&_daf .Pt !=nil {_ecee ,_fdg :=_cced (_daf .Pt );_ecc =append (_ecc ,_cbg .Point {X :_ecee *_eed +_ebeg ,Y :_fdg *_bcad +_gede });};
};if _ebd :=_gc .LnTo ;_ebd !=nil &&_ebd .Pt !=nil {_dcac ,_fdd :=_cced (_ebd .Pt );_ecc =append (_ecc ,_cbg .Point {X :_dcac *_eed +_ebeg ,Y :_fdd *_bcad +_gede });};};_gbe :=_fcf ._cbfe .NewPolygon ([][]_cbg .Point {_ecc });_gbe .SetFillColor (_efg );
_gbe .SetFillOpacity (_fda );_gbe .SetBorderWidth (_ebb );if _geb !=nil {_gbe .SetBorderColor (_geb );_gbe .SetBorderOpacity (_bgf );};_eab =append (_eab ,_gbe );};};};};if _fadb :=_fcda .GeometryChoice .PrstGeom ;_fadb !=nil {switch _fadb .PrstAttr {case _af .ST_ShapeTypeRect :if _fba !=nil {_cdb :=_fcf .getShapeFromBlipFill (_fba ,_ebeg ,_gede ,_cde ,_cbdcd ,false );
_eab =append (_eab ,_cdb );}else {_edae :=_fcf ._cbfe .NewRectangle (_ebeg ,_gede ,_cde ,_cbdcd );_fgfd :=_efg !=nil &&_fda > 0;if _fgfd {_edae .SetFillColor (_efg );_edae .SetFillOpacity (_fda );};_agd :=_geb !=nil &&_bgf > 0&&_ebb > 0;if _agd {_edae .SetBorderWidth (_ebb );
_edae .SetBorderColor (_geb );_edae .SetBorderOpacity (_bgf );};if _fgfd ||_agd {_eab =append (_eab ,_edae );};};case _af .ST_ShapeTypeLine :_gbd :=_fcf ._cbfe .NewLine (_ebeg ,_gede ,_ebeg +_cde ,_gede +_cbdcd );_gbd .SetLineWidth (_ebb );if _geb !=nil {_gbd .SetColor (_geb );
};_eab =append (_eab ,_gbd );};};return _eab ,_ebeg ,_gede ,_cde ,_cbdcd ,_dfac ,_bcc ;};func (_dgfc *convertContext )getGroupConnectors (_deea *_gb .CT_Connector ,_fbd float64 ,_abe float64 )[]_bf .Drawable {_bdf ,_ ,_ ,_ ,_ ,_ ,_ :=_dgfc .getShapesFromSpPr (_deea .SpPr ,_deea .Style ,false ,_fbd ,_abe );
return _bdf ;};func (_cfgb *textboxContext )addTextRun (_dfdf *_af .EG_TextRun ,_bgag *_af .CT_TextCharacterProperties ,_cgbd _bf .Color ,_eafae *prefixData ){if _dgdbf :=_dfdf .TextRunChoice .Br ;_dgdbf !=nil {_cfgb .addCurrentWordToParagraph ();_cfgb .newLine ();
_cfgb .newWord ();}else if _egcg :=_dfdf .TextRunChoice .R ;_egcg !=nil {var _befb _bf .Color ;if _egcg .RPr !=nil &&_egcg .RPr .FillPropertiesChoice .SolidFill !=nil {_befb ,_ =_cfgb ._dead .getColorFromSolidFill (_egcg .RPr .FillPropertiesChoice .SolidFill );
}else if _cgbd !=nil {_befb =_cgbd ;}else if _bgag .FillPropertiesChoice .SolidFill !=nil {_befb ,_ =_cfgb ._dead .getColorFromSolidFill (_bgag .FillPropertiesChoice .SolidFill );}else {_befb =_bf .ColorBlack ;};_ccec :=_cadg (_egcg .RPr ,_bgag );_fddc ,_dagce ,_ffbd ,_cfbg :=_cfgb ._dead .makeStyleFromRPr (_ccec );
_fddc .Color =_befb ;if _eafae !=nil {_cfgb .addPrefix (_eafae ,_fddc );};_cggf :=_ecb (_egcg .T );for _ ,_dfba :=range _cggf {_dfba ._faaag =_fddc ;_dfba ._dcf =_dagce ;_dfba ._gdg =_ffbd ;_dfba ._fbdg =_cfbg ;if _ccec .CapAttr ==_af .ST_TextCapsTypeAll {_dfba ._fcede =_ce .ToUpper (_dfba ._fcede );
};_cfgb .addTextSymbol (_dfba );};};};func (_aabf *textboxContext )addCurrentWordToParagraph (){if _aabf ._dced &&_aabf ._abed ._eccb +_aabf ._edaf ._aeef > _aabf ._abed ._dfd {_aabf .newLine ();};if !_aabf ._edaf ._geeaa ||len (_aabf ._abed ._gaeb )> 0{_aabf ._edaf ._caff =_aabf ._abed ._eccb ;
_aabf ._abed ._gaeb =append (_aabf ._abed ._gaeb ,_aabf ._edaf );_aabf ._abed ._eccb +=_aabf ._edaf ._aeef ;for _ ,_fee :=range _aabf ._edaf ._aebb {_aabf .adjustHeights (_fee ._ddbaa );};};};func (_gbca *textboxContext )newWord (){_gbca ._edaf =&word {_geeaa :true ,_caff :_gbca ._abed ._eccb }};
func _cdbde (_egge *_gb .CT_CommonSlideData ,_cee _gb .ST_PlaceholderType ,_fefe *uint32 )(*_af .CT_Transform2D ,*_af .CT_TextBody ,*bool ,*bool ,*bool ){_cfce :=_fefe ==nil ;if _egge !=nil &&(_cee !=_gb .ST_PlaceholderTypeUnset ||!_cfce ){if _cggc :=_egge .SpTree ;
_cggc !=nil {for _ ,_dda :=range _cggc .GroupShapeChoice {if _dda !=nil {if _dda .Sp !=nil {_cccc ,_dbbf :=_gefae (_dda .Sp );if _cee ==_cccc {if (_cfce &&_dbbf ==nil )||(!_cfce &&_dbbf !=nil &&*_dbbf ==*_fefe ){var _bccb *_af .CT_Transform2D ;if _dda .Sp .SpPr !=nil {_bccb =_dda .Sp .SpPr .Xfrm ;
};_dbdf :=_cee ==_gb .ST_PlaceholderTypeTitle ||_cee ==_gb .ST_PlaceholderTypeCtrTitle ;_fdfa :=_cee ==_gb .ST_PlaceholderTypeSubTitle ;_bggfa :=!_dbdf &&_cee !=_gb .ST_PlaceholderTypeUnset ;return _bccb ,_dda .Sp .TxBody ,&_dbdf ,&_fdfa ,&_bggfa ;};};
};};};};};return nil ,nil ,nil ,nil ,nil ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_cb .FontStyle ;func (_aaag *convertContext )getConnectors (_cad *_gb .CT_Connector )[]_bf .Drawable {_bca ,_ ,_ ,_ ,_ ,_ ,_ :=_aaag .getShapesFromSpPr (_cad .SpPr ,_cad .Style ,false ,0.0,0.0);return _bca ;};type symbolStyle struct{_degfa *string ;
_ead *float64 ;_baf *string ;_dad *bool ;_ddeg *bool ;_babe *bool ;_baac *bool ;_defab *bool ;};func (_gff *textboxContext )adjustHeights (_ccd float64 ){if _gff ._abed ._defac < _ccd {_gff ._gefb ._degfd +=(_ccd -_gff ._abed ._defac );_gff ._abed ._defac =_ccd ;
};};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_a .Presentation )*_bf .Creator {return ConvertToPdfWithOptions (pr ,nil )};type romanMatch struct{_gdda int ;_gde string ;};type background struct{_gcfg _bf .Color ;_gfaf float64 ;_gcgf *_af .CT_BlipFillProperties ;};var _fae =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};


// ConvertToPdfWithOptions convert a presentation to PDF with given options.
func ConvertToPdfWithOptions (pr *_a .Presentation ,opts *Options )*_bf .Creator {_ca :=pr .X ().SldSz ;_fcg :=_ae .FromEMU (int64 (_ca .CxAttr ));_dcd :=_ae .FromEMU (int64 (_ca .CyAttr ));_de :=_bf .PageSize {_fcg ,_dcd };if (_de ==_bf .PageSize {}){_de =_cb .GetDefaultPageSize ();
if opts !=nil &&opts .DefaultPageSize !=_cb .DefaultPageSize {_de =_cb .GetPageDimensions (opts .DefaultPageSize );};};_bfe :=_bf .New ();_bfe .SetPageSize (_de );var _afb *_af .Theme ;if len (pr .Themes ())> 0{_afb =pr .Themes ()[0];};for _ ,_ga :=range pr .Slides (){if _ga .X ()==nil {continue ;
};_dg :=&convertContext {_cbfe :_bfe ,_abcg :&_ga ,_fced :_ga .GetSlideLayout (),_bcg :pr .SlideMasters ()[0].X (),_daeb :pr ,_ebge :_afb ,_bbg :_ga .X ().ClrMapOvr ,_ddge :_de [1],_cbab :_de [0]};_dg .extractDefaultProperties ();_dg .makeSlide ();_dg .drawSlide ();
};return _bfe ;};func (_gfb *textboxContext )alignVertically (_bafd _af .ST_TextAnchoringType ){_gfb .alignParagraphsVertically (_bafd );_gfb .alignSymbolsVertically ();};func (_fcb *convertContext )makePdfBlockFromChart (_aa *_cg .Chart ,_ge ,_ged float64 )(*_bf .Block ,error ){_gbb :=_aa .CT_RelId .IdAttr ;
_aef :=_fcb ._abcg .GetChartSpaceByRelId (_gbb );if _aef ==nil {return nil ,_c .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _da *_af .Theme ;_ee :=_fcb ._daeb .Themes ();if len (_ee )> 0{_da =_ee [0];};return _cb .MakeBlockFromChartSpace (_aef ,_ge ,_ged ,_da );
};func (_bfee *convertContext )makePdfBlockFromTxBody (_afe *_af .CT_TextBody ,_dgdb *_af .CT_TextBodyProperties ,_fdgf *_af .CT_TextListStyle ,_gdf ,_def float64 ,_fdb _bf .Color ,_ddb ,_aabg bool )(*_bf .Block ,error ){var _afa *_af .CT_TextParagraphProperties ;
if _gece :=_afe .LstStyle ;_gece !=nil {var _fceg *_af .CT_TextParagraphProperties ;if _gece .Lvl1pPr !=nil {_fceg =_gece .Lvl1pPr ;};_afa =_bgdc (_fceg ,_gece .DefPPr );};var _fdbd *_af .CT_TextParagraphProperties ;if _afa !=nil {if _ddb {_fdbd =_bfee ._fcga [0];
}else if _aabg {_fdbd =_bfee ._fdde [0];}else {_fdbd =_bfee ._ffe [0];};if _fdgf !=nil {_fdbd =_bgdc (_bgdc (_fdgf .Lvl1pPr ,_fdgf .DefPPr ),_fdbd );};_fdbd =_bgdc (_afa ,_fdbd );}else {if _ddb {_fdbd =_bfee ._ecaf ;}else if _aabg {_fdbd =_bfee ._eafe ;
}else {_fdbd =_bfee ._gcf ;};};_edea ,_agfee :=_dbgc (2.5),_dbgc (2.5);_eefg ,_afc :=_dbgc (1.3),_dbgc (1.3);_fbda :=true ;_eded :=_af .ST_TextAnchoringTypeT ;if _dgdb !=nil {if _bcd :=_dgdb .AnchorAttr ;_bcd !=_af .ST_TextAnchoringTypeUnset {_eded =_bcd ;
};};if _gag :=_afe .BodyPr ;_gag !=nil {if _ddcd :=_gag .LInsAttr ;_ddcd !=nil {_edea =_ae .FromEMU (_cb .FromSTCoordinate32 (*_ddcd ));};if _afef :=_gag .TInsAttr ;_afef !=nil {_eefg =_ae .FromEMU (_cb .FromSTCoordinate32 (*_afef ));};if _cge :=_gag .RInsAttr ;
_cge !=nil {_agfee =_ae .FromEMU (_cb .FromSTCoordinate32 (*_cge ));};if _ac :=_gag .BInsAttr ;_ac !=nil {_afc =_ae .FromEMU (_cb .FromSTCoordinate32 (*_ac ));};_fbda =_gag .WrapAttr !=_af .ST_TextWrappingTypeNone ;if _decb :=_gag .AnchorAttr ;_decb !=_af .ST_TextAnchoringTypeUnset {_eded =_gag .AnchorAttr ;
};};_aae :=_cb .MakeTempCreator (_gdf ,_def );_aae .SetPageMargins (_edea ,_agfee ,_eefg ,_afc );_fdf :=&textboxContext {_dead :_bfee ,_dced :_fbda ,_fabc :_gdf -_edea -_agfee ,_fbfc :_def -_eefg -_afc ,_gcg :_aae ,_bga :[]*paragraph {}};_afbc :=1;for _ ,_fgd :=range _afe .P {if _fgd !=nil {_becf :=_fgd .PPr ;
var _ecag *prefixData ;if _becf !=nil &&_becf .TextBulletChoice .BuNone ==nil {var _dgff string ;var _dgcf bool ;if _geff :=_becf .TextBulletChoice .BuAutoNum ;_geff !=nil {var _fdgg string ;if _cfg :=_geff .StartAtAttr ;_cfg !=nil {_afbc =int (*_cfg );
};var _abd string ;switch _geff .TypeAttr {case _af .ST_TextAutonumberSchemeAlphaUcParenBoth ,_af .ST_TextAutonumberSchemeAlphaUcParenR ,_af .ST_TextAutonumberSchemeAlphaUcPeriod :_abd =_aaaa (_afbc ,true );case _af .ST_TextAutonumberSchemeAlphaLcParenBoth ,_af .ST_TextAutonumberSchemeAlphaLcParenR ,_af .ST_TextAutonumberSchemeAlphaLcPeriod :_abd =_aaaa (_afbc ,false );
case _af .ST_TextAutonumberSchemeRomanUcParenBoth ,_af .ST_TextAutonumberSchemeRomanUcParenR ,_af .ST_TextAutonumberSchemeRomanUcPeriod :_abd =_gfe (_afbc ,true );case _af .ST_TextAutonumberSchemeRomanLcParenBoth ,_af .ST_TextAutonumberSchemeRomanLcParenR ,_af .ST_TextAutonumberSchemeRomanLcPeriod :_abd =_gfe (_afbc ,false );
default:_abd =_fc .Itoa (_afbc );};switch _geff .TypeAttr {case _af .ST_TextAutonumberSchemeAlphaLcPeriod ,_af .ST_TextAutonumberSchemeAlphaUcPeriod ,_af .ST_TextAutonumberSchemeArabicPeriod ,_af .ST_TextAutonumberSchemeRomanLcPeriod ,_af .ST_TextAutonumberSchemeRomanUcPeriod ,_af .ST_TextAutonumberSchemeArabicDbPeriod ,_af .ST_TextAutonumberSchemeEa1ChsPeriod ,_af .ST_TextAutonumberSchemeEa1ChtPeriod ,_af .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_af .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_af .ST_TextAutonumberSchemeThaiAlphaPeriod ,_af .ST_TextAutonumberSchemeThaiNumPeriod ,_af .ST_TextAutonumberSchemeHindiAlphaPeriod ,_af .ST_TextAutonumberSchemeHindiNumPeriod ,_af .ST_TextAutonumberSchemeHindiAlpha1Period :_fdgg ="\u002e";
case _af .ST_TextAutonumberSchemeAlphaLcParenR ,_af .ST_TextAutonumberSchemeAlphaUcParenR ,_af .ST_TextAutonumberSchemeArabicParenR ,_af .ST_TextAutonumberSchemeRomanLcParenR ,_af .ST_TextAutonumberSchemeRomanUcParenR ,_af .ST_TextAutonumberSchemeThaiAlphaParenR ,_af .ST_TextAutonumberSchemeThaiNumParenR ,_af .ST_TextAutonumberSchemeHindiNumParenR :_fdgg ="\u0029";
};_dgff =_abd +_fdgg ;_afbc ++;}else if _aebc :=_becf .TextBulletChoice .BuChar ;_aebc !=nil {_gbfg :=_aebc .CharAttr ;if _cdf ,_ccb :=_efc [_gbfg ];_ccb {_gbfg =string (rune (_cdf ));}else {_gbfg ="\u2022";};_dgff =_gbfg ;_dgcf =true ;};if _dgff !=""{var _debb ,_dcg float64 ;
if _becf .MarLAttr !=nil {_debb =_ae .FromEMU (int64 (*_becf .MarLAttr ));};if _becf .IndentAttr !=nil {_dcg =_ae .FromEMU (int64 (*_becf .IndentAttr ));};_ecag =&prefixData {_bcfa :_dgff ,_facc :_dgcf ,_bcbg :_debb ,_fefb :_dcg };};};_becf =_bgdc (_becf ,_fdbd );
_bdeb :=_cadg (_fgd .EndParaRPr ,_becf .DefRPr );_fdf .newParagraph ();_fdf .assignPropsToCurrentParagraph (_becf );_fdf .newLine ();_fdf .newWord ();for _ggc ,_aefg :=range _fgd .EG_TextRun {_fdf .addTextRun (_aefg ,_bdeb ,_fdb ,_ecag );if _ggc > 0{_ecag =nil ;
};};_fdf .addCurrentWordToParagraph ();};_fdf .addCurrentParagraph ();};_fdf .alignVertically (_eded );_fdf .drawParagraphs ();return _cb .MakeBlockFromCreator (_aae );};var _ed =_dbgc (1.9);func (_eea *convertContext )stretchImage (_feca *_bf .Image ,_ffc *_af .CT_StretchInfoProperties ,_fca ,_gee ,_dd ,_fef float64 )(*_bf .Image ,float64 ,float64 ){_dca :=_ffc .FillRect ;
if _dca ==nil {_bfcg :=_feca .Width ()/_feca .Height ();_fcea :=_dd /_fef ;var _dbf ,_cbdc float64 ;if _bfcg > _fcea {_cbdc =_fef ;_dbf =_fef *_bfcg ;}else {_dbf =_dd ;_cbdc =_dd /_bfcg ;};_feca .Scale (_dbf /_feca .Width (),_cbdc /_feca .Height ());return _feca ,_fca ,_gee ;
};var _eae ,_bedc ,_dbee ,_bde float64 ;if _gdc :=_dca .LAttr ;_gdc !=nil {_dbee =_cb .FromSTPercentage (_gdc );};if _bfg :=_dca .TAttr ;_bfg !=nil {_eae =_cb .FromSTPercentage (_bfg );};if _cac :=_dca .RAttr ;_cac !=nil {_bde =_cb .FromSTPercentage (_cac );
};if _fga :=_dca .BAttr ;_fga !=nil {_bedc =_cb .FromSTPercentage (_fga );};_fad :=_dd *(1-_dbee -_bde );_bgd :=_fef *(1-_eae -_bedc );_feca .Scale (_fad /_feca .Width (),_bgd /_feca .Height ());return _feca ,_fca +_dbee *_dd ,_gee +_eae *_fef ;};func (_aegc *convertContext )getColorFromMatrixReference (_gdad *_af .CT_StyleMatrixReference )_bf .Color {if _gdad ==nil {return nil ;
};var _adg _bf .Color ;var _fgeg string ;if _abcf :=_gdad .SrgbClr ;_abcf !=nil {_fgeg =_abcf .ValAttr ;}else if _edgb :=_gdad .SchemeClr ;_edgb !=nil {_fgeg =_cb .GetColorStringFromDmlColor (_aegc ._daeb .GetColorBySchemeColor (_edgb .ValAttr ));_fgeg =_cb .AdjustColor (_fgeg ,_edgb .EG_ColorTransform );
};if _fgeg !=""{_adg =_bf .ColorRGBFromHex ("\u0023"+_fgeg );};return _adg ;};func (_fbag *textboxContext )alignParagraphsVertically (_gfbf _af .ST_TextAnchoringType ){if _gfbf ==_af .ST_TextAnchoringTypeT {return ;};_dcacd :=0.0;for _ ,_edag :=range _fbag ._bga {_dcacd +=_edag ._ffff +_edag ._degfd +_edag ._bfbb ;
};var _dcafd float64 ;switch _gfbf {case _af .ST_TextAnchoringTypeCtr :_dcafd =(_fbag ._fbfc -_dcacd )/2;case _af .ST_TextAnchoringTypeB :_dcafd =_fbag ._fbfc -_dcacd ;};for _ ,_ggg :=range _fbag ._bga {_ggg ._dgdc +=_dcafd ;};};func _fegd (_ebed float64 )float64 {return _ebed *_ae .Inch };
func (_gfac *convertContext )applyBlipEffectsOnImg (_aacg *_bf .Image ,_cadc ,_faeb float64 ,_bcee []*_af .CT_BlipChoice )*_bf .Image {if len (_bcee )==0{return _aacg ;};_aacg .SetPos (_cadc ,_faeb );_gffe ,_cga :=_gfac .renderPageWithDrawableToGoImage (_aacg );
if _cga !=nil {_g .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_cga );
return _aacg ;};_dcab ,_cga :=_gfac .renderCurrentStateToGoImage ();if _cga !=nil {_g .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_cga );
return _aacg ;};_effgf :=_gffe .Bounds ();_bead :=_bb .NewRGBA (_effgf );_gbdf ,_fgggf :=_aacg .Width (),_aacg .Height ();for _ ,_fdfdb :=range _bcee {if _cccb :=_fdfdb .AlphaModFix ;_cccb ==nil {continue ;};if _deebe :=_fdfdb .AlphaModFix .AmtAttr ;_deebe !=nil {if _cgge :=_deebe .ST_PositivePercentageDecimal ;
_cgge !=nil {_fgea :=uint8 (255*(*_cgge )/100000);_ccdg :=_bb .NewUniform (_be .Alpha {_fgea });_f .Draw (_bead ,_effgf ,_dcab ,_bb .Point {0,0},_f .Src );_f .DrawMask (_bead ,_effgf ,_gffe ,_bb .Point {0,0},_ccdg ,_bb .Point {0,0},_f .Over );};};};_dgae :=_bb .Rect (int (_cadc ),int (_faeb ),int (_cadc +_gbdf )+1,int (_faeb +_fgggf )+1);
_fdac :=_cb .CropImageByRect (_bead ,_dgae );_bgde ,_cga :=_gfac ._cbfe .NewImageFromGoImage (_fdac );if _cga !=nil {_g .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_cga );
return _aacg ;};return _bgde ;};func (_gfa *convertContext )makePdfDivisionFromTxBody (_cebf *_af .CT_TextBody ,_deeb *_af .CT_TableStyleTextStyle )*_bf .Division {_fed :=_gfa ._cbfe .NewDivision ();_bad :=_gfa ._gcf ;_cddb :=_af .ST_TextAnchoringTypeT ;
if _cddg :=_cebf .BodyPr ;_cddg !=nil {if _fgag :=_cddg .AnchorAttr ;_fgag !=_af .ST_TextAnchoringTypeUnset {_cddb =_cddg .AnchorAttr ;};};if _eeg :=_cebf .LstStyle ;_eeg !=nil {var _gfaa *_af .CT_TextParagraphProperties ;if _eeg .Lvl1pPr !=nil {_gfaa =_eeg .Lvl1pPr ;
}else {_gfaa =_gfa ._ffe [0];};_bad =_bgdc (_gfaa ,_bgdc (_eeg .DefPPr ,_bad ));};for _ ,_bfcc :=range _cebf .P {if _bfcc !=nil {_fdc :=_gfa ._cbfe .NewStyledParagraph ();_adca :=_bgdc (_bfcc .PPr ,_bad );_cdc :=_cadg (_bfcc .EndParaRPr ,_adca .DefRPr );
switch _adca .AlgnAttr {case _af .ST_TextAlignTypeR :_fdc .SetTextAlignment (_bf .TextAlignmentRight );case _af .ST_TextAlignTypeCtr :_fdc .SetTextAlignment (_bf .TextAlignmentCenter );case _af .ST_TextAlignTypeJust :_fdc .SetTextAlignment (_bf .TextAlignmentJustify );
};if len (_bfcc .EG_TextRun )==0{_fdc .Append ("\u000a");_fed .Add (_fdc );continue ;};for _ ,_ecca :=range _bfcc .EG_TextRun {if _degf :=_ecca .TextRunChoice .Br ;_degf !=nil {_fdc .Append ("\u000a");}else if _ddg :=_ecca .TextRunChoice .R ;_ddg !=nil {_ade :=_bfd (_ddg .RPr ,_deeb );
_ade =_cadg (_ade ,_cdc );var _ecd _bf .Color ;if _ade .FillPropertiesChoice .SolidFill !=nil {_ecd ,_ =_gfa .getColorFromSolidFill (_ade .FillPropertiesChoice .SolidFill );}else {_ecd =_bf .ColorBlack ;};_bgg ,_gbf ,_gefag ,_ :=_gfa .makeStyleFromRPr (_ade );
_bgg .Color =_ecd ;if _gbf {_bgg .TextRise =0.5;}else if _gefag {_bgg .TextRise =-0.5;};_dbad :=_ddg .T ;if _ade .CapAttr ==_af .ST_TextCapsTypeAll {for _ ,_dff :=range _dbad {_dff =[]rune (_ce .ToUpper (string (_dff )))[0];};};_cbaf :=_fdc .Append (_dbad );
_cbaf .Style =*_bgg ;};};_ =_cddb ;_fed .Add (_fdc );};};return _fed ;};func (_dcff *textboxContext )addTextSymbol (_cfgd *symbol ){_afae :=_bf .New ();_ddec :=_afae .NewStyledParagraph ();_ddec .SetMargins (0,0,0,0);_geceg :=_ddec .Append (_cfgd ._fcede );
_dcaf :=0.0;if _cfgd ._faaag !=nil {_geceg .Style =*_cfgd ._faaag ;if _cfgd ._faaag .CharSpacing !=0{_dcaf =_cfgd ._faaag .CharSpacing ;};};_cfgd ._agcf =_ddec .Height ();_cfgd ._ddbaa =_ddec .Height ()*1.2;if _cfgd ._bag ==0{_cfgd ._bag =_ddec .Width ()+_dcaf ;
};if len (_dcff ._edaf ._aebb )> 0{_cefb :=_dcff ._edaf ._aebb [len (_dcff ._edaf ._aebb )-1]._fcede ;if _dcff ._gefb ._cdec ||_cb .IsNoSpaceLanguage (_cefb )||(_cefb =="\u0020")!=(_cfgd ._fcede =="\u0020"){_dcff .addCurrentWordToParagraph ();_dcff .newWord ();
};};_dcff ._edaf ._aebb =append (_dcff ._edaf ._aebb ,_cfgd );_cfgd ._agag =_dcff ._edaf ._aeef ;_dcff ._edaf ._aeef +=_cfgd ._bag ;if _cfgd ._fcede !="\u0020"{_dcff ._edaf ._geeaa =false ;};if _dcff ._edaf ._aeef >=_dcff ._gefb ._acg -_dcff ._gefb ._cgfg {_dcff .addCurrentWordToParagraph ();
_dcff .newLine ();_dcff .newWord ();};};func (_geba *textboxContext )drawParagraphs (){_geba ._gcg .NewPage ();for _ ,_deggb :=range _geba ._bga {for _ ,_gbgd :=range _deggb ._deeab {for _ ,_fbgb :=range _gbgd ._gaeb {for _ ,_dcffd :=range _fbgb ._aebb {_bada :=_geba ._gcg .NewStyledParagraph ();
if _dcffd ._dcf {_dcffd ._ebaf =0;}else if _dcffd ._gdg {_dcffd ._ebaf =1.2*_gbgd ._defac -_dcffd ._agcf ;};_bbe :=_fbgb ._caff +_dcffd ._agag ;_cbag :=_deggb ._dgdc +_gbgd ._bfaf +_dcffd ._ebaf ;_bada .SetPos (_bbe ,_cbag );_geed :=_bada .Append (_dcffd ._fcede );
if _dcffd ._faaag !=nil {_geed .Style =*_dcffd ._faaag ;};_geba ._gcg .Draw (_bada );if _dcffd ._fbdg {_dbbb :=_cbag +_dcffd ._agcf +2;_cb .DrawLine (_geba ._gcg ,_bbe ,_dbbb ,_bbe +_dcffd ._bag ,_dbbb ,1,_dcffd ._faaag .Color );};};};};};};func _aaaa (_ecbd int ,_abgf bool )string {_aaga :=(_ecbd -1)/26+1;
_feg :=byte ((_ecbd -1)%26);if _abgf {_feg +=byte (65);}else {_feg +=byte (97);};_cefd :=_e .NewBuffer ([]byte {});for _beg :=0;_beg < _aaga ;_beg ++{_cefd .Write ([]byte {_feg });};return _cefd .String ();};func _gefae (_eag *_gb .CT_Shape )(_gb .ST_PlaceholderType ,*uint32 ){if _bace :=_eag .NvSpPr ;
_bace !=nil {if _eeb :=_bace .NvPr ;_eeb !=nil {if _caag :=_eeb .Ph ;_caag !=nil {return _caag .TypeAttr ,_caag .IdxAttr ;};};};return _gb .ST_PlaceholderTypeUnset ,nil ;};type textboxContext struct{_dead *convertContext ;_fabc float64 ;_fbfc float64 ;
_gcg *_bf .Creator ;_cgb float64 ;_bga []*paragraph ;_gefb *paragraph ;_abed *line ;_edaf *word ;_dced bool ;};func (_efdd *convertContext )renderPageWithDrawableToGoImage (_gbge _bf .Drawable )(_bb .Image ,error ){_gfcg :=_cb .MakeTempCreator (_efdd ._cbab ,_efdd ._ddge );
_gfcg .NewPage ();_gfcg .Draw (_gbge );_cbcd ,_afdg :=_cb .GetPageFromCreator (_gfcg );if _afdg !=nil {return nil ,_afdg ;};return _eb .NewImageDevice ().Render (_cbcd );};func (_cfgda *convertContext )getShapeFromBlipFill (_eefgd *_af .CT_BlipFillProperties ,_abgc ,_febc ,_edfb ,_cdge float64 ,_cbfed bool )_bf .Drawable {_befd ,_ebdc ,_dcede :=_cfgda .makePdfImageFromBlipFill (_eefgd ,_cbfed );
if _dcede !=nil {_g .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_dcede );
return nil ;};if _befd ==nil {return nil ;};if _fbce :=_eefgd .FillModePropertiesChoice .Tile ;_fbce !=nil {_befd =_cfgda .tileImage (_befd ,_eefgd .FillModePropertiesChoice .Tile ,_edfb ,_cdge );};if _edd :=_eefgd .FillModePropertiesChoice .Stretch ;_edd !=nil {_befd ,_abgc ,_febc =_cfgda .stretchImage (_befd ,_eefgd .FillModePropertiesChoice .Stretch ,_abgc ,_febc ,_edfb ,_cdge );
};if _befd ==nil {return nil ;};if len (_ebdc )==0{_befd .SetPos (_abgc ,_febc );return _befd ;};_befd =_cfgda .applyBlipEffectsOnImg (_befd ,_abgc ,_febc ,_ebdc );_befd .SetPos (_abgc ,_febc );return _befd ;};func _dcfff (_bdd ,_ccbf *_af .CT_TextBody )(*_af .CT_TextBodyProperties ,*_af .CT_TextListStyle ){if _bdd ==nil &&_ccbf ==nil {return nil ,nil ;
};if _bdd ==nil {return _ccbf .BodyPr ,_ccbf .LstStyle ;};if _ccbf ==nil {return _bdd .BodyPr ,_bdd .LstStyle ;};_gaac ,_cafd :=_bdd .BodyPr ,_bdd .LstStyle ;_aaff ,_bbdf :=_ccbf .BodyPr ,_ccbf .LstStyle ;_cdbd :=_adecg (_gaac ,_aaff );_dbfc :=_ffd (_cafd ,_bbdf );
return _cdbd ,_dbfc ;};func _ecb (_fbfg string )[]*symbol {_gga :=[]*symbol {};for _ ,_eeeg :=range _fbfg {_gga =append (_gga ,&symbol {_fcede :string (_eeeg )});};return _gga ;};func (_dacb *convertContext )makeStyleFromRPr (_eba *_af .CT_TextCharacterProperties )(*_bf .TextStyle ,bool ,bool ,bool ){var _gcc ,_ebga ,_ggcb bool ;
_bgge :=_dacb ._cbfe .NewTextStyle ();if _eba !=nil {_bfge :=_cb .FontStyle_Regular ;_cbee :=_aaagc (_eba .BAttr );_ffcf :=_aaagc (_eba .IAttr );if _cbee &&_ffcf {_bfge =_cb .FontStyle_BoldItalic ;}else if _cbee {_bfge =_cb .FontStyle_Bold ;}else if _ffcf {_bfge =_cb .FontStyle_Italic ;
};_ggcb =_eba .UAttr !=_af .ST_TextUnderlineTypeUnset &&_eba .UAttr !=_af .ST_TextUnderlineTypeNone ;_agg :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _fgb :=_eba .Latin ;_fgb !=nil {_agg =_fgb .TypefaceAttr ;}else if _gdcf :=_eba .Ea ;_gdcf !=nil {_agg =_gdcf .TypefaceAttr ;
}else if _dbeee :=_eba .Cs ;_dbeee !=nil {_agg =_dbeee .TypefaceAttr ;}else if _eeda :=_eba .Sym ;_eeda !=nil {_agg =_eeda .TypefaceAttr ;};if _bge ,_dgdbd :=_cb .StdFontsMap [_agg ];_dgdbd {_bgge .Font =_cb .AssignStdFontByName (_bgge ,_bge [_bfge ]);
}else if _adcg :=_cb .GetRegisteredFont (_agg ,_bfge );_adcg !=nil {_bgge .Font =_adcg ;}else {_g .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_agg ,_bfge );
_bgge .Font =_cb .AssignStdFontByName (_bgge ,_cb .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_bfge ]);};var _ffb float64 ;if _dea :=_eba .SzAttr ;_dea !=nil {_ffb =_fe .Round (float64 (*_dea )/100)-0.5;}else {_ffb =_cb .DefaultFontSize ;};if _eeea :=_eba .BaselineAttr ;
_eeea !=nil {if _gbc :=_eeea .ST_PercentageDecimal ;_gbc !=nil {if *_gbc > 0{_gcc =true ;}else if *_gbc < 0{_ebga =true ;};};};if _gcc ||_ebga {_ffb =_fe .Round (_ffb *0.64);};_bgge .FontSize =_ffb ;_bceb :=0.0;if _fbb :=_eba .SpcAttr ;_fbb !=nil {if _dbb :=_fbb .ST_TextPointUnqualified ;
_dbb !=nil &&*_dbb > 0{_bceb =float64 (*_dbb )/100;};};_bgge .CharSpacing =_bceb ;};return &_bgge ,_gcc ,_ebga ,_ggcb ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);
func _fea (_edgc ,_eaec *_af .CT_TableStyleTextStyle )*_af .CT_TableStyleTextStyle {_bbba :=_af .NewCT_TableStyleTextStyle ();if _edgc !=nil {*_bbba =*_edgc ;};if _eaec ==nil {return _bbba ;};if _bbba .BAttr ==_af .ST_OnOffStyleTypeUnset {_bbba .BAttr =_eaec .BAttr ;
};if _bbba .IAttr ==_af .ST_OnOffStyleTypeUnset {_bbba .IAttr =_eaec .IAttr ;};if _bbba .ThemeableFontStylesChoice .Font ==nil {_bbba .ThemeableFontStylesChoice .Font =_eaec .ThemeableFontStylesChoice .Font ;};if _bbba .ThemeableFontStylesChoice .FontRef ==nil {_bbba .ThemeableFontStylesChoice .FontRef =_eaec .ThemeableFontStylesChoice .FontRef ;
};if _bbba .ScrgbClr ==nil {_bbba .ScrgbClr =_eaec .ScrgbClr ;};if _bbba .SrgbClr ==nil {_bbba .SrgbClr =_eaec .SrgbClr ;};if _bbba .HslClr ==nil {_bbba .HslClr =_eaec .HslClr ;};if _bbba .SysClr ==nil {_bbba .SysClr =_eaec .SysClr ;};if _bbba .SchemeClr ==nil {_bbba .SchemeClr =_eaec .SchemeClr ;
};if _bbba .PrstClr ==nil {_bbba .PrstClr =_eaec .PrstClr ;};return _bbba ;};func (_gbg *textboxContext )newParagraph (){_afd :=&paragraph {};_afd ._dgdc =_gbg ._cgb ;_gbg ._gefb =_afd ;};func (_cdg *textboxContext )alignParagraph (){_cec :=_cdg ._gefb ;
if _cec ._afbg ==_af .ST_TextAlignTypeL {return ;};_cbfg :=len (_cec ._deeab )-1;for _fgaa ,_afff :=range _cec ._deeab {_abgef :=true ;_gdcg :=len (_afff ._gaeb );_fbdgf :=0.0;for _gfec :=len (_afff ._gaeb )-1;_gfec >=0;_gfec --{_fgdd :=_afff ._gaeb [_gfec ];
if _abgef &&_fgdd ._geeaa {_gdcg =_gfec ;}else {_abgef =false ;for _ ,_bede :=range _fgdd ._aebb {_fbdgf +=_bede ._bag ;};};};_afff ._gaeb =_afff ._gaeb [:_gdcg ];_ggb :=_afff ._dfd -_afff ._gfd -_fbdgf ;switch _cec ._afbg {case _af .ST_TextAlignTypeR :_afff .moveRight (_ggb );
case _af .ST_TextAlignTypeCtr :_afff .moveRight (_ggb /2);case _af .ST_TextAlignTypeJust :if _fgaa !=_cbfg {_bbc :=[]*word {};for _ ,_afbd :=range _afff ._gaeb {if _afbd ._geeaa {_bbc =append (_bbc ,_afbd );};};_gdce :=_ggb /float64 (len (_bbc ));for _ ,_bbfc :=range _bbc {_bbfc ._aeef +=_gdce ;
};var _fdcb *word ;for _ ,_ddgc :=range _afff ._gaeb {if _fdcb !=nil {_ddgc ._caff =_fdcb ._caff +_fdcb ._aeef ;};_fdcb =_ddgc ;};};};};};func (_dee *convertContext )makeSlide (){_bdcb :=_dee ._abcg .GetSlideLayout ().CSld ;_dee .addShapes (_bdcb ,true );
_bdcb =_dee ._abcg .X ().CSld ;_dee .addShapes (_bdcb ,false );};func (_bedee *convertContext )getStyleColors (_ecef *_af .CT_ShapeStyle )(_bf .Color ,_bf .Color ,_bf .Color ){var _cgc ,_dcae ,_effg _bf .Color ;if _feea :=_ecef .LnRef ;_feea !=nil {_dcae =_bedee .getColorFromMatrixReference (_feea );
};if _eede :=_ecef .FillRef ;_eede !=nil {_effg =_bedee .getColorFromMatrixReference (_eede );};if _eeab :=_ecef .FontRef ;_eeab !=nil {_cgc =_bedee .getColorFromFontReference (_eeab );};return _cgc ,_effg ,_dcae ;};type prefixData struct{_bcfa string ;
_facc bool ;_bcbg float64 ;_fefb float64 ;};func (_bafe *textboxContext )newLine (){if _bafe ._gefb ==nil {_bafe .newParagraph ();};_bgae :=_bafe ._gefb ._degfd +_bafe ._gefb ._ffff ;_ccbdg :=&line {};_ccbdg ._gfd =_bafe ._gefb ._cgfg ;if len (_bafe ._gefb ._deeab )==0{_ccbdg ._gfd +=_bafe ._gefb ._bgdd ;
};_ccbdg ._dfd =_bafe ._gefb ._acg ;_ccbdg ._eccb =_ccbdg ._gfd ;_ccbdg ._bfaf =_bgae ;_bafe ._gefb ._deeab =append (_bafe ._gefb ._deeab ,_ccbdg );_bafe ._abed =_ccbdg ;};func (_ebea *convertContext )getBorderStyle (_daca *_af .CT_LineProperties )(_bf .CellBorderStyle ,*_bf .Color ,float64 ){if _daca ==nil ||_daca .LineFillPropertiesChoice .NoFill !=nil {return _bf .CellBorderStyleNone ,nil ,0;
};var _dce _bf .Color ;if _bebe :=_daca .LineFillPropertiesChoice .SolidFill ;_bebe !=nil {_dce ,_ =_ebea .getColorFromSolidFill (_bebe );};_fab :=0.0;if _ccfb :=_daca .WAttr ;_ccfb !=nil {_fab =_ae .FromEMU (int64 (*_ccfb ));};return _bf .CellBorderStyleSingle ,&_dce ,_fab ;
};func (_daeda *textboxContext )alignSymbolsVertically (){for _ ,_gccd :=range _daeda ._bga {for _ ,_gbbe :=range _gccd ._deeab {_ace :=0.0;for _ ,_eff :=range _gbbe ._gaeb {for _ ,_ecbg :=range _eff ._aebb {if _ecbg ._ddbaa > _ace {_ace =_ecbg ._ddbaa ;
};};};for _ ,_ceac :=range _gbbe ._gaeb {for _ ,_dceb :=range _ceac ._aebb {if _dceb ._agcf < _ace {_dceb ._ebaf =_ace -_dceb ._agcf ;};};};};};};func (_eec *textboxContext )assignPropsToCurrentParagraph (_fccc *_af .CT_TextParagraphProperties ){_ccg :=12.4;
if _fccc ==nil {_eec ._gefb ._afad =_ccg ;return ;};if _dedg :=_fccc .DefRPr ;_dedg !=nil {_fcbb :=_dedg .SzAttr ;if _fcbb !=nil {_eacf :=float64 (*_fcbb )/1200;if _ccg <=_eacf {_ccg =_eacf ;};};};if _aaad :=_fccc .MarLAttr ;_aaad !=nil {_eec ._gefb ._cgfg =_ae .FromEMU (int64 (*_aaad ));
};_eec ._gefb ._acg =_eec ._fabc ;if _degg :=_fccc .MarRAttr ;_degg !=nil {_eec ._gefb ._acg -=_ae .FromEMU (int64 (*_degg ));};if _cbc :=_fccc .IndentAttr ;_cbc !=nil {_eec ._gefb ._bgdd =_ae .FromEMU (int64 (*_cbc ));};if _ccbd :=_fccc .LatinLnBrkAttr ;
_ccbd !=nil {_eec ._gefb ._cdec =*_ccbd ;};if _gdca :=_fccc .LnSpc ;_gdca !=nil &&_gdca .TextSpacingChoice !=nil {if _eaaf :=_gdca .TextSpacingChoice .SpcPct ;_eaaf !=nil {if _gce :=_eaaf .ValAttr .ST_TextSpacingPercent ;_gce !=nil {_ccg =float64 (*_gce )/5000;
};};};var _egfa float64 ;if _cfb :=_fccc .SpcBef ;_cfb !=nil &&_cfb .TextSpacingChoice !=nil {if _fgac :=_cfb .TextSpacingChoice .SpcPts ;_fgac !=nil {_egfa =float64 (_fgac .ValAttr )/100;};};_afdb :=_eec ._bga ;if len (_afdb )> 0{_egfa -=_afdb [len (_afdb )-1]._bfbb ;
if _egfa < 0{_egfa =0;};};_eec ._gefb ._ffff =_egfa ;if _begb :=_fccc .SpcAft ;_begb !=nil &&_begb .TextSpacingChoice !=nil {if _add :=_begb .TextSpacingChoice .SpcPts ;_add !=nil {_eec ._gefb ._bfbb =float64 (_add .ValAttr )/100;};};_eec ._gefb ._afad =_ccg ;
_eec ._gefb ._afbg =_fccc .AlgnAttr ;};func (_gcfe *line )moveRight (_fcec float64 ){for _ ,_eeag :=range _gcfe ._gaeb {_eeag ._caff +=_fcec ;};};func (_gdd *convertContext )drawSlide (){_gdd ._cbfe .NewPage ();for _ ,_adab :=range _gdd ._fedg {if _adab !=nil {_gdd ._cbfe .MoveTo (0,0);
_gdd ._cbfe .Draw (_adab );};};};type convertContext struct{_cbfe *_bf .Creator ;_fdag *_cb .Rectangle ;_daeb *_a .Presentation ;_abcg *_a .Slide ;_bcg *_gb .SldMaster ;_fced *_gb .SldLayout ;_ddge float64 ;_cbab float64 ;_fedg []_bf .Drawable ;_ddba *background ;
_gcf *_af .CT_TextParagraphProperties ;_cce *_af .CT_TextCharacterProperties ;_ecaf *_af .CT_TextParagraphProperties ;_agdb *_af .CT_TextCharacterProperties ;_eafe *_af .CT_TextParagraphProperties ;_ecdc *_af .CT_TextCharacterProperties ;_ffe []*_af .CT_TextParagraphProperties ;
_fcga []*_af .CT_TextParagraphProperties ;_fdde []*_af .CT_TextParagraphProperties ;_ebge *_af .Theme ;_bbg *_af .CT_ColorMappingOverride ;};func (_caa *convertContext )getColorFromSolidFill (_aecb *_af .CT_SolidColorFillProperties )(_bf .Color ,float64 ){if _aecb ==nil {return nil ,1;
};var _cfbaf string ;_cfgbg :=1.0;if _dgba :=_aecb .SrgbClr ;_dgba !=nil {_cfbaf =_dgba .ValAttr ;_cfgbg =_cb .GetOpacityFromColorTransform (_dgba .EG_ColorTransform );}else if _babd :=_aecb .SchemeClr ;_babd !=nil {_cfbaf =_cb .GetColorStringFromDmlColor (_caa ._abcg .GetColorBySchemeColor (_babd .ValAttr ));
_cfbaf =_cb .AdjustColor (_cfbaf ,_babd .EG_ColorTransform );_cfgbg =_cb .GetOpacityFromColorTransform (_babd .EG_ColorTransform );};if _cfbaf !=""{_efgb :=_bf .ColorRGBFromHex ("\u0023"+_cfbaf );return _efgb ,_cfgbg ;};return nil ,1;};func _aaagc (_bdff *bool )bool {return _bdff !=nil &&*_bdff };
func _cgfb (_ffga ,_bcab *_af .CT_TableStyleCellStyle )*_af .CT_TableStyleCellStyle {_eega :=_af .NewCT_TableStyleCellStyle ();if _ffga !=nil {*_eega =*_ffga ;};if _bcab ==nil {return _eega ;};if _eega .TcBdr ==nil {_eega .TcBdr =_bcab .TcBdr ;}else {if _eega .TcBdr .Left ==nil {_eega .TcBdr .Left =_bcab .TcBdr .Left ;
};if _eega .TcBdr .Right ==nil {_eega .TcBdr .Right =_bcab .TcBdr .Right ;};if _eega .TcBdr .Top ==nil {_eega .TcBdr .Top =_bcab .TcBdr .Top ;};if _eega .TcBdr .Bottom ==nil {_eega .TcBdr .Bottom =_bcab .TcBdr .Bottom ;};if _eega .TcBdr .InsideH ==nil {_eega .TcBdr .InsideH =_bcab .TcBdr .InsideH ;
};if _eega .TcBdr .InsideV ==nil {_eega .TcBdr .InsideV =_bcab .TcBdr .InsideV ;};};if _eega .ThemeableFillStyleChoice .Fill ==nil {_eega .ThemeableFillStyleChoice .Fill =_bcab .ThemeableFillStyleChoice .Fill ;};if _eega .ThemeableFillStyleChoice .FillRef ==nil {_eega .ThemeableFillStyleChoice .FillRef =_bcab .ThemeableFillStyleChoice .FillRef ;
};return _eega ;};type paragraph struct{_bdbb float64 ;_ffff float64 ;_bfbb float64 ;_bgdd float64 ;_cgfg float64 ;_acg float64 ;_dgdc float64 ;_degfd float64 ;_afbg _af .ST_TextAlignType ;_afad float64 ;_cdec bool ;_deeab []*line ;};var _efc =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};
type symbol struct{_fcede string ;_agag float64 ;_ddbaa float64 ;_agcf float64 ;_ebaf float64 ;_bag float64 ;_faaag *_bf .TextStyle ;_debc string ;_dcf bool ;_gdg bool ;_fbdg bool ;};func _fefef (_cfda *_af .CT_TableCellProperties ,_abdgd *_af .CT_TableStyleCellStyle ,_eedee ,_ecde ,_fbcd ,_dfbe bool )*_af .CT_TableCellProperties {_ecga :=_af .NewCT_TableCellProperties ();
if _cfda !=nil {*_ecga =*_cfda ;};if _abdgd ==nil {return _ecga ;};if _bee :=_abdgd .ThemeableFillStyleChoice .FillRef ;_bee !=nil {_faaaf :=_af .NewCT_SolidColorFillProperties ();_faaaf .ScrgbClr =_bee .ScrgbClr ;_faaaf .SrgbClr =_bee .SrgbClr ;_faaaf .HslClr =_bee .HslClr ;
_faaaf .SysClr =_bee .SysClr ;_faaaf .SchemeClr =_bee .SchemeClr ;_faaaf .PrstClr =_bee .PrstClr ;_ecga .FillPropertiesChoice .SolidFill =_faaaf ;};if _ecga .FillPropertiesChoice .NoFill ==nil &&_ecga .FillPropertiesChoice .SolidFill ==nil {if _fdbc :=_abdgd .ThemeableFillStyleChoice .Fill ;
_fdbc !=nil {if _ecga .FillPropertiesChoice .NoFill ==nil {_ecga .FillPropertiesChoice .NoFill =_fdbc .FillPropertiesChoice .NoFill ;};if _ecga .FillPropertiesChoice .SolidFill ==nil {_ecga .FillPropertiesChoice .SolidFill =_fdbc .FillPropertiesChoice .SolidFill ;
};};};if _abcgf :=_abdgd .TcBdr ;_abcgf !=nil {if _ecga .LnL ==nil {var _acbe *_af .CT_ThemeableLineStyle ;if _fbcd {_acbe =_abcgf .Left ;}else {_acbe =_abcgf .InsideV ;};if _acbe !=nil {_ecga .LnL =_acbe .ThemeableLineStyleChoice .Ln ;};};if _ecga .LnR ==nil {var _dcag *_af .CT_ThemeableLineStyle ;
if _dfbe {_dcag =_abcgf .Right ;}else {_dcag =_abcgf .InsideV ;};if _dcag !=nil {_ecga .LnR =_dcag .ThemeableLineStyleChoice .Ln ;};};if _ecga .LnT ==nil {var _dbea *_af .CT_ThemeableLineStyle ;if _eedee {_dbea =_abcgf .Top ;}else {_dbea =_abcgf .InsideH ;
};if _dbea !=nil {_ecga .LnT =_dbea .ThemeableLineStyleChoice .Ln ;};};if _ecga .LnB ==nil {var _cdeb *_af .CT_ThemeableLineStyle ;if _ecde {_cdeb =_abcgf .Bottom ;}else {_cdeb =_abcgf .InsideH ;};if _cdeb !=nil {_ecga .LnB =_cdeb .ThemeableLineStyleChoice .Ln ;
};};};return _ecga ;};

// Options contains the options for convert process
type Options struct{

// DefaultPageSize is applied when there is no page size explicitly set in the document.
// A4 is the default option.
DefaultPageSize _cb .PageSize ;};type line struct{_bfaf float64 ;_gfd float64 ;_dfd float64 ;_eccb float64 ;_defac float64 ;_gaeb []*word ;};func (_dbbg *convertContext )makePdfBlockFromTable (_aec *_af .Tbl )*_bf .Table {_cdef :=_aec .TblGrid ;if _cdef ==nil {return nil ;
};_cgg :=len (_cdef .GridCol );if _cgg ==0{return nil ;};_bcaa :=[]float64 {};_abc :=0.0;for _ ,_bece :=range _cdef .GridCol {_ageb :=_ae .FromEMU (_cb .FromSTCoordinate (_bece .WAttr ));_bcaa =append (_bcaa ,_ageb );_abc +=_ageb ;};_cgeg :=[]float64 {};
for _dbde :=0;_dbde < _cgg ;_dbde ++{_cgeg =append (_cgeg ,_bcaa [_dbde ]/_abc );};_cfa :=_dbbg ._cbfe .NewTable (_cgg );_cfa .SetColumnWidths (_cgeg ...);_afaf :=_aec .TblPr ;var _agc *_af .CT_TableStyle ;if _bdb :=_afaf .TablePropertiesChoice ;_bdb !=nil {if _bdb .TableStyle !=nil {_agc =_bdb .TableStyle ;
}else if _bdb .TableStyleId !=nil {_agc =_dbbg ._daeb .GetTableStyleById (*_bdb .TableStyleId );};};_abge :=_af .NewCT_TablePartStyle ();_abge .TcStyle =_af .NewCT_TableStyleCellStyle ();_abge .TcTxStyle =_af .NewCT_TableStyleTextStyle ();if _agc !=nil {if _agc .WholeTbl !=nil {*_abge =*_agc .WholeTbl ;
};if _agc .TblBg !=nil {if _abge .TcStyle .ThemeableFillStyleChoice .Fill ==nil {_abge .TcStyle .ThemeableFillStyleChoice .Fill =_agc .TblBg .ThemeableFillStyleChoice .Fill ;};};};if _abge .TcStyle .ThemeableFillStyleChoice .Fill ==nil {_abge .TcStyle .ThemeableFillStyleChoice .Fill =_af .NewCT_FillProperties ();
_abge .TcStyle .ThemeableFillStyleChoice .Fill .FillPropertiesChoice .NoFill =_afaf .FillPropertiesChoice .NoFill ;_abge .TcStyle .ThemeableFillStyleChoice .Fill .FillPropertiesChoice .SolidFill =_afaf .FillPropertiesChoice .SolidFill ;};_fbdd :=len (_aec .Tr );
_aaf :=_aec .TblPr .BandRowAttr !=nil &&*_aec .TblPr .BandRowAttr ;_ecgg :=_aec .TblPr .FirstRowAttr !=nil &&*_aec .TblPr .FirstRowAttr ;_efgd :=_aec .TblPr .LastRowAttr !=nil &&*_aec .TblPr .LastRowAttr ;_dfb :=_aec .TblPr .BandColAttr !=nil &&*_aec .TblPr .BandColAttr ;
_eeec :=_aec .TblPr .FirstColAttr !=nil &&*_aec .TblPr .FirstColAttr ;_fag :=_aec .TblPr .LastColAttr !=nil &&*_aec .TblPr .LastColAttr ;for _gba ,_baaa :=range _aec .Tr {_edf :=_gba ==0;_faaa :=_gba ==_fbdd -1;_edb :=_gba %2==0;_bff :=len (_baaa .Tc );
var _fbc *_af .CT_TablePartStyle ;if _agc !=nil {if _edf &&_ecgg {_fbc =_agc .FirstRow ;}else if _faaa &&_efgd {_fbc =_agc .LastRow ;}else if _edb &&_aaf {_fbc =_agc .Band2H ;}else if _aaf {_fbc =_agc .Band1H ;};};var _gac float64 ;for _ggf ,_daee :=range _baaa .Tc {_geeg :=_ggf ==0;
_dde :=_ggf ==_bff -1;_badd :=_ggf %2==0;var _gagd *_af .CT_TablePartStyle ;if _agc !=nil {if _geeg &&_eeec {_gagd =_agc .FirstCol ;}else if _dde &&_fag {_gagd =_agc .LastCol ;}else if _badd &&_dfb {_gagd =_agc .Band2V ;}else if _dfb {_gagd =_agc .Band1V ;
};};_dabf :=_gdfa (_gdfa (_gagd ,_fbc ),_abge );_caca :=_dbbg .addCellToTable (_cfa ,_daee ,_dabf ,_edf ,_faaa ,_geeg ,_dde );if _caca > _gac {_gac =_caca ;};};_geee :=_ae .FromEMU (_cb .FromSTCoordinate (_baaa .HAttr ));if _geee < _gac {_geee =_gac ;};
if _geee < _dbgc (4){_geee =_dbgc (4);};_cfa .SetRowHeight (_cfa .CurRow (),_geee );};return _cfa ;};func _adecg (_gedba ,_badg *_af .CT_TextBodyProperties )*_af .CT_TextBodyProperties {_cfag :=_af .NewCT_TextBodyProperties ();if _gedba !=nil {*_cfag =*_gedba ;
};if _badg ==nil {return _cfag ;};if _cfag .RotAttr ==nil {_cfag .RotAttr =_badg .RotAttr ;};if _cfag .SpcFirstLastParaAttr ==nil {_cfag .SpcFirstLastParaAttr =_badg .SpcFirstLastParaAttr ;};if _cfag .VertOverflowAttr ==_af .ST_TextVertOverflowTypeUnset {_cfag .VertOverflowAttr =_badg .VertOverflowAttr ;
};if _cfag .HorzOverflowAttr ==_af .ST_TextHorzOverflowTypeUnset {_cfag .HorzOverflowAttr =_badg .HorzOverflowAttr ;};if _cfag .VertAttr ==_af .ST_TextVerticalTypeUnset {_cfag .VertAttr =_badg .VertAttr ;};if _cfag .WrapAttr ==_af .ST_TextWrappingTypeUnset {_cfag .WrapAttr =_badg .WrapAttr ;
};if _cfag .LInsAttr ==nil {_cfag .LInsAttr =_badg .LInsAttr ;};if _cfag .TInsAttr ==nil {_cfag .TInsAttr =_badg .TInsAttr ;};if _cfag .RInsAttr ==nil {_cfag .RInsAttr =_badg .RInsAttr ;};if _cfag .BInsAttr ==nil {_cfag .BInsAttr =_badg .BInsAttr ;};if _cfag .NumColAttr ==nil {_cfag .NumColAttr =_badg .NumColAttr ;
};if _cfag .SpcColAttr ==nil {_cfag .SpcColAttr =_badg .SpcColAttr ;};if _cfag .RtlColAttr ==nil {_cfag .RtlColAttr =_badg .RtlColAttr ;};if _cfag .AnchorAttr ==_af .ST_TextAnchoringTypeUnset {_cfag .AnchorAttr =_badg .AnchorAttr ;};if _cfag .AnchorCtrAttr ==nil {_cfag .AnchorCtrAttr =_badg .AnchorCtrAttr ;
};if _cfag .ForceAAAttr ==nil {_cfag .ForceAAAttr =_badg .ForceAAAttr ;};if _cfag .UprightAttr ==nil {_cfag .UprightAttr =_badg .UprightAttr ;};if _cfag .CompatLnSpcAttr ==nil {_cfag .CompatLnSpcAttr =_badg .CompatLnSpcAttr ;};if _cfag .PrstTxWarp ==nil {_cfag .PrstTxWarp =_badg .PrstTxWarp ;
};if _cfag .TextAutofitChoice .NoAutofit ==nil {_cfag .TextAutofitChoice .NoAutofit =_badg .TextAutofitChoice .NoAutofit ;};if _cfag .TextAutofitChoice .NormAutofit ==nil {_cfag .TextAutofitChoice .NormAutofit =_badg .TextAutofitChoice .NormAutofit ;};
if _cfag .TextAutofitChoice .SpAutoFit ==nil {_cfag .TextAutofitChoice .SpAutoFit =_badg .TextAutofitChoice .SpAutoFit ;};if _cfag .Scene3d ==nil {_cfag .Scene3d =_badg .Scene3d ;};if _cfag .Text3DChoice .Sp3d ==nil {_cfag .Text3DChoice .Sp3d =_badg .Text3DChoice .Sp3d ;
};if _cfag .Text3DChoice .FlatTx ==nil {_cfag .Text3DChoice .FlatTx =_badg .Text3DChoice .FlatTx ;};if _cfag .ExtLst ==nil {_cfag .ExtLst =_badg .ExtLst ;};return _cfag ;};func (_gec *convertContext )tileImage (_deb *_bf .Image ,_cbge *_af .CT_TileInfoProperties ,_abf ,_aab float64 )*_bf .Image {_gfc ,_fec :=1.0,1.0;
if _eg :=_cbge .SxAttr ;_eg !=nil {_gfc =_cb .FromSTPercentage (_eg );};if _bda :=_cbge .SyAttr ;_bda !=nil {_fec =_cb .FromSTPercentage (_bda );};_abgg :=_cb .MakeTempCreator (_abf ,_aab );_deb .Scale (_gfc ,_fec );_bcb ,_cgf :=_deb .Width (),_deb .Height ();
var _fbf ,_fcd float64 ;if _geca :=_cbge .TxAttr ;_geca !=nil {_fbf =_ae .FromEMU (_cb .FromSTCoordinate (*_geca ));};if _fac :=_cbge .TyAttr ;_fac !=nil {_fcd =_ae .FromEMU (_cb .FromSTCoordinate (*_fac ));};if _fbf > 0{_fbf -=_bcb ;};if _fcd > 0{_fcd -=_cgf ;
};_fbe :=_gec ._cbab /_bcb +1;_gecf :=_gec ._ddge /_cgf +1;for _cdd :=0.0;_cdd <=_fbe ;_cdd ++{_gfg :=_cdd *_bcb ;for _bce :=0.0;_bce <=_gecf ;_bce ++{_gaa :=_bce *_cgf ;_deb .SetPos (_gfg +_fbf ,_gaa +_fcd );_abgg .Draw (_deb );};};_ece ,_dagc :=_cb .GetPageFromCreator (_abgg );
if _dagc !=nil {_g .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_dagc );return nil ;};_bbb ,_dagc :=_eb .NewImageDevice ().Render (_ece );
if _dagc !=nil {_g .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_dagc );return nil ;};_agf ,_dagc :=_gec ._cbfe .NewImageFromGoImage (_bbb );if _dagc !=nil {_g .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_dagc );
return nil ;};return _agf ;};func _gfe (_agb int ,_aedg bool )string {_bgc :=_e .NewBuffer ([]byte {});for _ ,_bebeg :=range _fae {for {if _agb < _bebeg ._gdda {break ;};_bgc .WriteString (_bebeg ._gde );_agb -=_bebeg ._gdda ;};};_ded :=_bgc .String ();
if _aedg {_ded =_ce .ToUpper (_ded );};return _ded ;};func (_dgf *convertContext )extractDefaultProperties (){_ff :=_dgf ._daeb .X ();_cc :=_ff .DefaultTextStyle ;var _gae ,_beb ,_gf ,_df ,_bfb ,_ba ,_ef ,_cf ,_dag ,_ebe *_af .CT_TextParagraphProperties ;
if _cc !=nil {_gae =_cc .DefPPr ;_beb =_bgdc (_cc .Lvl1pPr ,_gae );_gf =_bgdc (_cc .Lvl2pPr ,_gae );_df =_bgdc (_cc .Lvl3pPr ,_gae );_bfb =_bgdc (_cc .Lvl4pPr ,_gae );_ba =_bgdc (_cc .Lvl5pPr ,_gae );_ef =_bgdc (_cc .Lvl6pPr ,_gae );_cf =_bgdc (_cc .Lvl7pPr ,_gae );
_dag =_bgdc (_cc .Lvl8pPr ,_gae );_ebe =_bgdc (_cc .Lvl9pPr ,_gae );_dgf ._gcf =_gae ;_dgf ._cce =_gae .DefRPr ;};_dgf ._ffe =make ([]*_af .CT_TextParagraphProperties ,9);_dgf ._ffe [0]=_beb ;_dgf ._ffe [1]=_gf ;_dgf ._ffe [2]=_df ;_dgf ._ffe [3]=_bfb ;
_dgf ._ffe [4]=_ba ;_dgf ._ffe [5]=_ef ;_dgf ._ffe [6]=_cf ;_dgf ._ffe [7]=_dag ;_dgf ._ffe [8]=_ebe ;_fg :=_dgf ._daeb .SlideMasters ()[0].X ();_fge :=_fg .TxStyles ;_db :=_fge .TitleStyle ;_dgf ._ecaf =_bgdc (_db .DefPPr ,_gae );_dgf ._agdb =_dgf ._ecaf .DefRPr ;
_dgf ._fcga =make ([]*_af .CT_TextParagraphProperties ,9);_dgf ._fcga [0]=_bgdc (_db .Lvl1pPr ,_beb );_dgf ._fcga [1]=_bgdc (_db .Lvl2pPr ,_gf );_dgf ._fcga [2]=_bgdc (_db .Lvl3pPr ,_df );_dgf ._fcga [3]=_bgdc (_db .Lvl4pPr ,_bfb );_dgf ._fcga [4]=_bgdc (_db .Lvl5pPr ,_ba );
_dgf ._fcga [5]=_bgdc (_db .Lvl6pPr ,_ef );_dgf ._fcga [6]=_bgdc (_db .Lvl7pPr ,_cf );_dgf ._fcga [7]=_bgdc (_db .Lvl8pPr ,_dag );_dgf ._fcga [8]=_bgdc (_db .Lvl9pPr ,_ebe );_ada :=_fge .BodyStyle ;_dgf ._eafe =_bgdc (_ada .DefPPr ,_gae );_dgf ._ecdc =_dgf ._eafe .DefRPr ;
_dgf ._fdde =make ([]*_af .CT_TextParagraphProperties ,9);_dgf ._fdde [0]=_bgdc (_ada .Lvl1pPr ,_beb );_dgf ._fdde [1]=_bgdc (_ada .Lvl2pPr ,_gf );_dgf ._fdde [2]=_bgdc (_ada .Lvl3pPr ,_df );_dgf ._fdde [3]=_bgdc (_ada .Lvl4pPr ,_bfb );_dgf ._fdde [4]=_bgdc (_ada .Lvl5pPr ,_ba );
_dgf ._fdde [5]=_bgdc (_ada .Lvl6pPr ,_ef );_dgf ._fdde [6]=_bgdc (_ada .Lvl7pPr ,_cf );_dgf ._fdde [7]=_bgdc (_ada .Lvl8pPr ,_dag );_dgf ._fdde [8]=_bgdc (_ada .Lvl9pPr ,_ebe );};func (_ddfg *textboxContext )addCurrentParagraph (){_ddfg ._cgb =_ddfg ._gefb ._dgdc +_ddfg ._gefb ._ffff +_ddfg ._gefb ._degfd +_ddfg ._gefb ._bfbb ;
_ddfg ._bga =append (_ddfg ._bga ,_ddfg ._gefb );_ddfg .alignParagraph ();};